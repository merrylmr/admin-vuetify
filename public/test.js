var EshiminjsSDK=function(){"use strict";function o(e){return"function"==typeof e||void console.log("调用eshimin方法缺少回调函数!")}function a(e,i,n){var t=null;void 0!==(t="string"==typeof i?JSON.parse(i):i).errorCode&&void 0===t.code&&(0==t.errorCode?(t.msg="success",t.code="200"):t.code=t.errorCode),"200"==t.code||console.log("调用eshimin方法"+e+"失败："+t.msg),o(n)&&n(t)}function t(e,i,n){var t=null;(t="string"==typeof i?JSON.parse(i):i).errorMessage?t.msg=t.errorMessage:t.msg=t.msg?t.msg:null,void 0!==t.errorCode&&(t.code=t.errorCode,0==t.errorCode?(t.msg="success",t.code="200"):-1==t.errorCode?t.msg="此接口不存在":-2==t.errorCode?t.msg="无权限使用此接口":-3==t.errorCode?t.msg="其它错误":-4==t.errorCode?t.msg="参数不符合要求":-5==t.errorCode&&(t.msg="用户取消")),"200"==t.code||console.log("调用eshimin方法"+e+"失败："+t.msg),o(n)&&n(t)}function r(e,i){var n={code:404,msg:"无此侨联方法"};console.log("调用eshimin方法"+e+"失败：无此侨联方法"),o(i)&&i(n)}function n(e,i,n){for(var t=null,t="string"==typeof e?JSON.parse(e):e,o=0;o<n.length;o++){var s=n[o];void 0!==t[s]&&(t[i]=t[s])}return t}function f(e,i){console.log("eshimin is undefined");var n={code:405,msg:"请确保侨联JS引入以后调用此方法"};console.log("调用eshimin方法"+e+"失败：请确保侨联JS引入以后调用此方法"),o(i)&&i(n)}var e={getDeviceId:function(e,i){"undefined"!=typeof eshimin?eshimin.getDeviceId?eshimin.getDeviceId({onResponse:function(e){a("getDeviceId",n(e,"deviceId",["data"]),i)}}):r("getDeviceId",i):f("getDeviceId",i)},getUserInfo:function(e,i){"undefined"!=typeof eshimin?eshimin.getUserInfo?eshimin.getUserInfo({onResponse:function(e){a("getUserInfo",n(e,"userName",["data"]),i)}}):r("getUserInfo",i):f("getUserInfo",i)},getCityCode:function(e,i){"undefined"!=typeof eshimin?eshimin.getCityCode?eshimin.getCityCode({onResponse:function(e){a("getCityCode",e,i)}}):r("getCityCode",i):f("getCityCode",i)},getLocation:function(e,i){"undefined"!=typeof eshimin?eshimin.getLocation?eshimin.getLocation({onResponse:function(e){a("getLocation",e,i)}}):r("getLocation",i):f("getLocation",i)},getBarcode:function(e,i){"undefined"!=typeof eshimin?eshimin.getBarcode?eshimin.getBarcode({onResponse:function(e){a("getBarcode",n(e,"barcode",["value","img"]),i)}}):r("getBarcode",i):f("getBarcode",i)},setTitle:function(e,i){var n;"undefined"!=typeof eshimin?eshimin.setTitle?(n=e.title,eshimin.setTitle({title:n,onResponse:function(e){a("setTitle",e,i)}})):r("setTitle",i):f("setTitle",i)},savePhoto:function(e,i){var n,t;"undefined"!=typeof eshimin?eshimin.savePhoto?(n=e.name,t=e.imgData,eshimin.savePhoto({name:n,url:"",imgData:t,onResponse:function(e){a("savePhoto",e,i)}})):r("savePhoto",i):f("savePhoto",i)},getAddress:function(e,i){"undefined"!=typeof eshimin?eshimin.getAddress?eshimin.getAddress({onResponse:function(e){a("getAddress",e,i)}}):r("getAddress",i):f("getAddress",i)},share:function(e,i){var n,t,o,s,c,d;"undefined"!=typeof eshimin?eshimin.share?(n=e.title,t=e.content,o=e.imgUrl,s=e.link,c=e.login?e.login:"",d=e.platformType?e.platformType:"",eshimin.share({title:n,content:t,imgUrl:o,link:s,login:c,platformType:d,onResponse:function(e){a("share",e,i)}})):r("share",i):f("share",i)},chooseImage:function(e,i){"undefined"!=typeof eshimin?eshimin.chooseImage?eshimin.chooseImage({onResponse:function(e){a("chooseImage",e,i)}}):r("chooseImage",i):f("chooseImage",i)},openWebUrl:function(e,i){var n,t;"undefined"!=typeof eshimin?eshimin.openWindow?(n=e.webUrl,t=e.title,eshimin.openWindow({url:n,title:t,onResponse:function(e){a("openWebUrl",e,i)}})):r("openWebUrl",i):f("openWebUrl",i)},closeWindow:function(e,i){"undefined"!=typeof eshimin?eshimin.closeWindow?eshimin.closeWindow({onResponse:function(e){a("closeWindow",e,i)}}):r("closeWindow",i):f("closeWindow",i)},phoneCall:function(e,i){var n;"undefined"!=typeof eshimin?eshimin.phoneCall?(n=e.num,eshimin.phoneCall({num:n,onResponse:function(e){a("phoneCall",e,i)}})):r("phoneCall",i):f("phoneCall",i)},facialIdentification:function(e,i){var n,t;"undefined"!=typeof eshimin?eshimin.facialIdentification?(n=e.token?e.token:"",t=e.clientId?e.clientId:"",eshimin.facialIdentification({token:n,clientId:t,onResponse:function(e){a("facialIdentification",e,i)}})):r("facialIdentification",i):f("facialIdentification",i)}},s={getDeviceId:e.getDeviceId,getUserInfo:e.getUserInfo,getCityCode:function(e,i){if("undefined"==typeof eshimin)return console.log("eshimin is undefined"),void a("getCityCode",{code:"200",cityCode:"430100"},i);eshimin.getCity?eshimin.getCity({onResponse:function(e){a("getCityCode",e,i)}}):a("getCityCode",{code:"200",cityCode:"430100"},i)},getLocation:e.getLocation,getBarcode:e.getBarcode,setTitle:e.setTitle,savePhoto:e.savePhoto,getAddress:e.getAddress,share:e.share,chooseImage:e.chooseImage,openWebUrl:e.openWebUrl,closeWindow:e.closeWindow,phoneCall:e.phoneCall,facialIdentification:function(e,i){var n=e.token?e.token:"",t=e.clientId?e.clientId:"";eshimin.realPersonAuth({token:n,clientId:t,onResponse:function(e){a("facialIdentification",e,i)}})}},c={getDeviceId:e.getDeviceId,getUserInfo:e.getUserInfo,getCityCode:function(e,i){if("undefined"==typeof eshimin)return console.log("eshimin is undefined"),void a("getCityCode",{code:"200",cityCode:"310100"},i);eshimin.getCity?eshimin.getCity({onResponse:function(e){a("getCityCode",e,i)}}):a("getCityCode",{code:"200",cityCode:"310100"},i)},getLocation:e.getLocation,getBarcode:e.getBarcode,setTitle:e.setTitle,savePhoto:function(e,i){e.name;var n=e.imgData;eshimin.downloadImageWithBase({url:n,onResponse:function(e){a("savePhoto",e,i)}})},getAddress:e.getAddress,share:e.share,chooseImage:e.chooseImage,openWebUrl:e.openWebUrl,closeWindow:e.closeWindow,phoneCall:e.phoneCall,facialIdentification:function(e,i){var n=e.token?e.token:"",t=e.clientId?e.clientId:"",o=e.text?e.text:"",s=e.uniqueId?e.uniqueId:"";eshimin.realPersonAuth({token:n,clientId:t,text:o,uniqueId:s,onResponse:function(e){a("facialIdentification",e,i)}})}},d={getDeviceId:e.getDeviceId,getUserInfo:e.getUserInfo,getCityCode:function(e,i){"undefined"!=typeof eshimin?eshimin.getCityCode({onResponse:function(e){a("getCityCode",e,i)}}):(console.log("eshimin is undefined"),a("getCityCode",{code:"200",cityCode:"510100"},i))},getLocation:e.getLocation,getBarcode:e.getBarcode,setTitle:e.setTitle,savePhoto:function(e,i){var n=e.imgData;eshimin.saveImage({imgStr:n,onResponse:function(e){a("saveImage",e,i)}})},getAddress:e.getAddress,share:e.share,chooseImage:e.chooseImage,openWebUrl:function(e,i){var n=e.webUrl,t=e.title;eshimin.openWebUrl({webUrl:n,title:t,onResponse:function(e){a("openWebUrl",e,i)}})},closeWindow:e.closeWindow,phoneCall:e.phoneCall,facialIdentification:e.facialIdentification},h={getDeviceId:e.getDeviceId,getUserInfo:e.getUserInfo,getCityCode:function(e,i){if("undefined"==typeof eshimin)return console.log("eshimin is undefined"),void a("getCityCode",{code:"200",cityCode:"321000"},i);eshimin.getCity?eshimin.getCity({onResponse:function(e){a("getCityCode",e,i)}}):a("getCityCode",{code:"200",cityCode:"321000"},i)},getLocation:e.getLocation,getBarcode:e.getBarcode,setTitle:e.setTitle,savePhoto:e.savePhoto,getAddress:e.getAddress,share:e.share,chooseImage:e.chooseImage,openWebUrl:e.openWebUrl,closeWindow:e.closeWindow,phoneCall:e.phoneCall,facialIdentification:function(e,i){eshimin.facialIdentification({type:e.type?e.type:"self",certifyUrl:e.certifyUrl?e.certifyUrl:"",certifyId:e.certifyId?e.certifyId:"",onResponse:function(e){a("facialIdentification",e,i)}})}},l={getDeviceId:e.getDeviceId,getUserInfo:e.getUserInfo,getCityCode:function(e,i){if("undefined"==typeof eshimin)return console.log("eshimin is undefined"),void a("getCityCode",{code:"200",cityCode:"450200"},i);eshimin.getCity?eshimin.getCity({onResponse:function(e){a("getCityCode",e,i)}}):a("getCityCode",{code:"200",cityCode:"450200"},i)},getLocation:e.getLocation,getBarcode:e.getBarcode,setTitle:e.setTitle,savePhoto:e.savePhoto,getAddress:e.getAddress,share:e.share,chooseImage:e.chooseImage,openWebUrl:e.openWebUrl,closeWindow:e.closeWindow,phoneCall:e.phoneCall,facialIdentification:function(e,i){var n=e.token?e.token:"",t=e.clientId?e.clientId:"";eshimin.realPersonAuth({token:n,clientId:t,onResponse:function(e){a("facialIdentification",e,i)}})}},g={getDeviceId:function(e,i){"undefined"!=typeof eshimin?eshimin.invoke("getDeviceId",null,function(e){t("getDeviceId",e,i)}):f("getDeviceId",i)},getUserInfo:function(e,i){"undefined"!=typeof eshimin?eshimin.invoke("getUserStatus",null,function(e){t("getUserInfo",n(e,"isUserLogined",["value"]),i)}):f("getUserInfo",i)},getCityCode:function(e,i){"undefined"!=typeof eshimin?eshimin.invoke("getCity",null,function(e){t("getCityCode",e,i)}):f("getCityCode",i)},getLocation:function(e,i){"undefined"!=typeof eshimin?eshimin.invoke("getLocation",{timeout:8,accuracy:100,requireAddress:!1,allowLastKnown:30},function(e){t("getLocation",e,i)}):f("getLocation",i)},getBarcode:function(e,i){"undefined"!=typeof eshimin?eshimin.invoke("scanCode",null,function(e){t("getBarcode",n(e,"barcode",["value"]),i)}):f("getBarcode",i)},setTitle:function(e,i){"undefined"!=typeof eshimin?eshimin.invoke("setTitle",{title:e.title},function(e){t("setTitle",e,i)}):f("setTitle",i)},savePhoto:function(e,i){var n;"undefined"!=typeof eshimin?(n=e.type?e.type:"base64",eshimin.invoke("saveImage",{type:n,data:e.imgData,name:e.name},function(e){t("savePhoto",e,i)})):f("savePhoto",i)},getAddress:function(e,i){"undefined"!=typeof eshimin?eshimin.invoke("getLocation",{timeout:8,accuracy:100,requireAddress:!0,allowLastKnown:30},function(e){t("getAddress",n(e,"address",["description"]),i)}):f("getAddress",i)},share:function(e,i){"undefined"!=typeof eshimin?eshimin.invoke("share",{title:e.title,content:e.content,imgUrl:e.imgUrl,link:e.link},function(e){t("share",e,i)}):f("share",i)},chooseImage:function(e,i){"undefined"!=typeof eshimin?eshimin.invoke("chooseImage",{sourceTypes:["camera","album"]},function(e){n(e,"img",["imageData"]);t("chooseImage",e,i)}):f("chooseImage",i)},openWebUrl:function(e,i){"undefined"!=typeof eshimin?eshimin.invoke("openWindow",{title:e.title,url:e.webUrl},function(e){t("openWebUrl",e,i)}):f("openWebUrl",i)},closeWindow:function(e,i){"undefined"!=typeof eshimin?eshimin.invoke("closeWindow",null,function(e){t("closeWindow",e,i)}):f("closeWindow",i)},phoneCall:function(e,i){"undefined"!=typeof eshimin?(window.location.href="tel://"+e.num,i({code:"200",msg:"success"})):f("phoneCall",i)},facialIdentification:function(e,i){var n;"undefined"!=typeof eshimin?("alipay"==(n={type:e.type?e.type:"self"}).type&&(n.certifyUrl=e.certifyUrl,n.certifyId=e.certifyId),eshimin.invoke("facialIdentification",n,function(e){t("facialIdentification",e,i)})):f("facialIdentification",i)}},u=[{city_ua:"cssmy",url:"https://mycs.csbtv.com/web/common/eshiminJS.js"},{city_ua:"eshiminapp",url:"https://api.eshimin.com/api/js/eshiminJS-1.0.0.js"},{city_ua:"tfsmy",url:"https://cdpre.tfsmy.com/api/js/eshiminJS-1.0.0.js"},{city_ua:"yzsmy",url:"https://myyztest.yzsmk.net/api/js/eshiminJS-1.0.0.js"},{city_ua:"lcsmy",url:"https://wonders.yun.liuzhou.gov.cn/api/js/eshiminJS-1.0.0.js"},{city_ua:"other_city_ua",url:"https://testapps.eshiyun.info/jsapi/2.0.0/eshiminjs.min.js"}];function i(){this.ua="other_city_ua",this.url="https://testapps.eshiyun.info/jsapi/2.0.0/eshiminjs.min.js"}return i.prototype.init=function(e){var i=window.navigator.userAgent.toLowerCase();console.log("eshimin_uagent: ",i);for(var n=0;n<u.length;n++)-1<i.indexOf(u[n].city_ua)&&(this.url=u[n].url,this.ua=u[n].city_ua);var t=document.createElement("script");t.type="text/javascript",t.id="EshiminjsSDK",t.src=this.url,t.addEventListener("load",function(){e()},!1);var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(t,o)},i.prototype.getMethod=function(e,i,n){console.log(this.ua,e),"cssmy"==this.ua?s[e](i,n):"eshiminapp"==this.ua?c[e](i,n):"tfsmy"==this.ua?d[e](i,n):"yzsmy"==this.ua?h[e](i,n):"lcsmy"==this.ua?l[e](i,n):"other_city_ua"==this.ua&&g[e](i,n)},i.prototype.getDeviceId=function(e,i){this.getMethod("getDeviceId",e,i)},i.prototype.getUserInfo=function(e,i){this.getMethod("getUserInfo",e,i)},i.prototype.getCityCode=function(e,i){this.getMethod("getCityCode",e,i)},i.prototype.getLocation=function(e,i){this.getMethod("getLocation",e,i)},i.prototype.getBarcode=function(e,i){this.getMethod("getBarcode",e,i)},i.prototype.setTitle=function(e,i){this.getMethod("setTitle",e,i)},i.prototype.savePhoto=function(e,i){e.name=e.name?e.name:"saveImg.jpg",this.getMethod("savePhoto",e,i)},i.prototype.getAddress=function(e,i){this.getMethod("getAddress",e,i)},i.prototype.share=function(e,i){this.getMethod("share",e,i)},i.prototype.chooseImage=function(e,i){this.getMethod("chooseImage",e,i)},i.prototype.openWebUrl=function(e,i){this.getMethod("openWebUrl",e,i)},i.prototype.closeWindow=function(e,i){this.getMethod("closeWindow",e,i)},i.prototype.phoneCall=function(e,i){this.getMethod("phoneCall",e,i)},i.prototype.facialIdentification=function(e,i){this.getMethod("facialIdentification",e,i)},new i}();