(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-70ef1d21"],{"1da1":function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));i("d3b7");function r(t,e,i,r,n,o,a){try{var c=t[o](a),s=c.value}catch(h){return void i(h)}c.done?e(s):Promise.resolve(s).then(r,n)}function n(t){return function(){var e=this,i=arguments;return new Promise((function(n,o){var a=t.apply(e,i);function c(t){r(a,n,o,c,s,"next",t)}function s(t){r(a,n,o,c,s,"throw",t)}c(void 0)}))}}},"1f56":function(t,e,i){},"4d76":function(t,e,i){"use strict";i.d(e,"a",(function(){return r})),i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return o})),i.d(e,"d",(function(){return a}));var r={rect:"",circle:"/img/circle.svg",triangle:"/img/triangle.svg"},n={forward:"img/new_spotd1_gif.png",left:"img/new_spotd2_gif.png"},o={"img/new_spotd1_gif.png":"img/arrow1.png","img/new_spotd2_gif.png":"img/arrow2.png"},a={"img/arrow1.png":"img/new_spotd1_gif.png","img/arrow2.png":"img/new_spotd2_gif.png"}},"7db0":function(t,e,i){"use strict";var r=i("23e7"),n=i("b727").find,o=i("44d2"),a="find",c=!0;a in[]&&Array(1)[a]((function(){c=!1})),r({target:"Array",proto:!0,forced:c},{find:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),o(a)},"96cf":function(t,e,i){var r=function(t){"use strict";var e,i=Object.prototype,r=i.hasOwnProperty,n="function"===typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",c=n.toStringTag||"@@toStringTag";function s(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(I){s=function(t,e,i){return t[e]=i}}function h(t,e,i,r){var n=e&&e.prototype instanceof m?e:m,o=Object.create(n.prototype),a=new C(r||[]);return o._invoke=_(t,i,a),o}function l(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(I){return{type:"throw",arg:I}}}t.wrap=h;var u="suspendedStart",d="suspendedYield",g="executing",p="completed",f={};function m(){}function v(){}function w(){}var y={};s(y,o,(function(){return this}));var b=Object.getPrototypeOf,x=b&&b(b(j([])));x&&x!==i&&r.call(x,o)&&(y=x);var k=w.prototype=m.prototype=Object.create(y);function S(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function z(t,e){function i(n,o,a,c){var s=l(t[n],t,o);if("throw"!==s.type){var h=s.arg,u=h.value;return u&&"object"===typeof u&&r.call(u,"__await")?e.resolve(u.__await).then((function(t){i("next",t,a,c)}),(function(t){i("throw",t,a,c)})):e.resolve(u).then((function(t){h.value=t,a(h)}),(function(t){return i("throw",t,a,c)}))}c(s.arg)}var n;function o(t,r){function o(){return new e((function(e,n){i(t,r,e,n)}))}return n=n?n.then(o,o):o()}this._invoke=o}function _(t,e,i){var r=u;return function(n,o){if(r===g)throw new Error("Generator is already running");if(r===p){if("throw"===n)throw o;return O()}i.method=n,i.arg=o;while(1){var a=i.delegate;if(a){var c=R(a,i);if(c){if(c===f)continue;return c}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===u)throw r=p,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=g;var s=l(t,e,i);if("normal"===s.type){if(r=i.done?p:d,s.arg===f)continue;return{value:s.arg,done:i.done}}"throw"===s.type&&(r=p,i.method="throw",i.arg=s.arg)}}}function R(t,i){var r=t.iterator[i.method];if(r===e){if(i.delegate=null,"throw"===i.method){if(t.iterator["return"]&&(i.method="return",i.arg=e,R(t,i),"throw"===i.method))return f;i.method="throw",i.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var n=l(r,t.iterator,i.arg);if("throw"===n.type)return i.method="throw",i.arg=n.arg,i.delegate=null,f;var o=n.arg;return o?o.done?(i[t.resultName]=o.value,i.next=t.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,f):o:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,f)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function j(t){if(t){var i=t[o];if(i)return i.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var n=-1,a=function i(){while(++n<t.length)if(r.call(t,n))return i.value=t[n],i.done=!1,i;return i.value=e,i.done=!0,i};return a.next=a}}return{next:O}}function O(){return{value:e,done:!0}}return v.prototype=w,s(k,"constructor",w),s(w,"constructor",v),v.displayName=s(w,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"===typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,c,"GeneratorFunction")),t.prototype=Object.create(k),t},t.awrap=function(t){return{__await:t}},S(z.prototype),s(z.prototype,a,(function(){return this})),t.AsyncIterator=z,t.async=function(e,i,r,n,o){void 0===o&&(o=Promise);var a=new z(h(e,i,r,n),o);return t.isGeneratorFunction(i)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},S(k),s(k,c,"Generator"),s(k,o,(function(){return this})),s(k,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var i in t)e.push(i);return e.reverse(),function i(){while(e.length){var r=e.pop();if(r in t)return i.value=r,i.done=!1,i}return i.done=!0,i}},t.values=j,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var i=this;function n(r,n){return c.type="throw",c.arg=t,i.next=r,n&&(i.method="next",i.arg=e),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],c=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),h=r.call(a,"finallyLoc");if(s&&h){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),E(i),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var r=i.completion;if("throw"===r.type){var n=r.arg;E(i)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(t,i,r){return this.delegate={iterator:j(t),resultName:i,nextLoc:r},"next"===this.method&&(this.arg=e),f}},t}(t.exports);try{regeneratorRuntime=r}catch(n){"object"===typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},"99af":function(t,e,i){"use strict";var r=i("23e7"),n=i("da84"),o=i("d039"),a=i("e8b5"),c=i("861d"),s=i("7b0b"),h=i("07fa"),l=i("8418"),u=i("65f0"),d=i("1dde"),g=i("b622"),p=i("2d00"),f=g("isConcatSpreadable"),m=9007199254740991,v="Maximum allowed index exceeded",w=n.TypeError,y=p>=51||!o((function(){var t=[];return t[f]=!1,t.concat()[0]!==t})),b=d("concat"),x=function(t){if(!c(t))return!1;var e=t[f];return void 0!==e?!!e:a(t)},k=!y||!b;r({target:"Array",proto:!0,forced:k},{concat:function(t){var e,i,r,n,o,a=s(this),c=u(a,0),d=0;for(e=-1,r=arguments.length;e<r;e++)if(o=-1===e?a:arguments[e],x(o)){if(n=h(o),d+n>m)throw w(v);for(i=0;i<n;i++,d++)i in o&&l(c,d,o[i])}else{if(d>=m)throw w(v);l(c,d++,o)}return c.length=d,c}})},b1de:function(t,e,i){"use strict";i.r(e);var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"ma-4"},[i("v-btn",{on:{click:function(e){t.visible=!0}}},[t._v("裁剪")]),i("v-row",{staticClass:"mt-2"},[i("v-col",{attrs:{cols:"6"}},[i("v-card",{style:t.cropMask},[i("img",{staticStyle:{width:"100%"},attrs:{src:t.url}})])],1),t.visible?i("CropDlg",{attrs:{visible:t.visible,crop:t.crop},on:{close:function(e){t.visible=!1},change:t.cropHandle}}):t._e()],1)],1)},n=[],o=(i("99af"),i("caad"),i("2532"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-dialog",{attrs:{width:"1000",value:t.visible},on:{"click:outside":t.handleClose}},[i("v-card",[i("div",{staticClass:"main d-flex"},[i("div",{staticClass:"left-section d-flex"},[i("div",{staticClass:"text-label"},[t._v("图片裁剪")]),i("div",{staticClass:"clip-area d-flex justify-center align-center"},[i("div",{staticClass:"img-wrapper"},[i("img",{style:{width:t.imgSize.width+"px",height:t.imgSize.height+"px"},attrs:{src:t.src}}),i("div",{staticClass:"clip-place"},[i("div",{staticStyle:{position:"absolute"},style:t.cropStyle},[i("div",{staticClass:"img-mask",staticStyle:{position:"absolute"},style:Object.assign({},t.cropMaskUrl)},[i("img",{staticStyle:{position:"absolute"},style:{width:t.imgSize.width+"px",height:t.imgSize.height+"px",left:-t.clipRect.x+"px",top:-t.clipRect.y+"px"},attrs:{src:t.src,alt:""}})]),i("div",{staticClass:"clip-h-line"}),i("div",{staticClass:"clip-h-line bottom"}),i("div",{staticClass:"clip-v-line"}),i("div",{staticClass:"clip-v-line right"}),i("div",{staticClass:"clip-move",on:{mousedown:t.startMoveHandle}}),i("div",{staticClass:"handles"},t._l(t.handles,(function(e,r){return i("div",{key:r,staticClass:"handle",class:"handle-"+e,style:{cursor:t.cursors[r]},on:{mousedown:function(i){return t.mousedownHandle(i,e)}}})})),0)]),i("div")]),i("img",{staticClass:"bg-img",style:{width:t.imgSize.width+"px",height:t.imgSize.height+"px"},attrs:{src:t.src}})])])]),i("div",{staticClass:"right-section"},[i("div",{staticClass:"text-label"},[t._v("裁剪形状")]),i("div",{staticClass:"shape-list d-flex"},t._l(t.shapeList,(function(e,r){return i("div",{key:r,staticClass:"shape-item",class:{"is-active":e.type===t.selectedShape.type},on:{click:function(i){return t.selectShapeHandle(e)}}},[e.url?i("img",{attrs:{src:e.url,alt:""}}):i("span")])})),0),i("div",{staticClass:"text-label"},[t._v("裁剪比例")]),i("v-radio-group",{on:{change:t.changeRateHandle},model:{value:t.clipRect.rate,callback:function(e){t.$set(t.clipRect,"rate",e)},expression:"clipRect.rate"}},t._l(t.rateList,(function(t,e){return i("v-radio",{key:e,attrs:{value:t.value,label:t.label}})})),1),i("div",{staticClass:"btn-bottom"},[i("v-btn",{on:{click:t.handleClose}},[t._v("取消")]),i("v-btn",{attrs:{color:"primary ml-2"},on:{click:t.sureAction}},[t._v("确定 ")])],1)],1)])])],1)}),a=[],c=i("1da1");i("96cf"),i("7db0"),i("d3b7");function s(t){return new Promise((function(e,i){var r=new Image;r.src=t,r.complete?e({width:r.width,height:r.height}):r.onload=function(){e({width:r.width,height:r.height})},r.onerror=function(){i("getImgAspectRatio 出错")}}))}var h={name:"crop-comp",props:{visible:{type:Boolean},crop:{type:Object,default:function(){return{type:"",x:0,y:0,width:0,height:0}}},src:{type:String,default:"https://dora-doc.qiniu.com/gogopher.jpg"}},data:function(){return{shapeList:[{label:"矩形",type:"rect",url:""},{label:"圆形",type:"circle",url:"/img/circle.svg"},{label:"三角形",type:"triangle",url:"/img/triangle.svg"}],handles:["tl","t","tr","r","br","b","bl","l"],cursors:["nw-resize","n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize"],rateList:[{label:"原始比列",value:"origin"},{label:"1:1",value:"1"},{label:"4:3",value:"4/3"},{label:"3:4",value:"3/4"},{label:"自定义",value:"custom"}],imgSize:{width:200,height:200},clipRect:{width:100,height:100,x:10,y:10,type:"rect",rate:"custom"},rate:1}},computed:{cropStyle:function(){return{width:this.clipRect.width+"px",height:this.clipRect.height+"px",left:this.clipRect.x+"px",top:this.clipRect.y+"px"}},cropMaskUrl:function(){return this.selectedShape.url?{"-webkit-mask-box-image-source":"url(".concat(this.selectedShape.url,")")," -webkit-mask-box-image-slice":"initial","-webkit-mask-box-image-width":"initial","-webkit-mask-box-image-outset":"initial","-webkit-mask-box-image-repeat":"initial"}:{}},selectedShape:function(){var t=this;return this.shapeList.find((function(e){return t.clipRect.type===e.type}))}},methods:{handleClose:function(){this.$emit("close")},getClipArea:function(){var t=document.querySelector(".clip-area");return console.log("clipAreaDom",t.clientWidth,t.clientHeight),{width:t.clientWidth,height:t.clientHeight}},calcImgSize:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){var i,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=t.getClipArea(),e.next=3,s(t.src);case 3:if(r=e.sent,!(r.width<i.width&&r.height<i.height)){e.next=8;break}return e.abrupt("return",r);case 8:if(!(r.width>r.height)){e.next=13;break}return t.rate=300/r.width,e.abrupt("return",{width:300,height:300*r.height/r.width});case 13:return t.rate=300/r.height,e.abrupt("return",{height:300,width:r.width/r.height*300});case 15:case"end":return e.stop()}}),e)})))()},selectShapeHandle:function(t){this.clipRect.type=t.type},mousedownHandle:function(t,e){var i=this,r={x:t.clientX,y:t.clientY},n=this._.cloneDeep(this.clipRect),o=this._.cloneDeep(this.clipRect),a=function(t){var a={x:t.clientX,y:t.clientY},c=a.x-r.x,s=a.y-r.y;switch(e){case"r":n.width+c+n.x>i.imgSize.width&&(c=i.imgSize.width-n.width-n.x),o.width=n.width+c;break;case"l":n.x+c<0&&(c=-n.x),o.width=n.width-c,o.x=n.x+c;break;case"t":n.y+s<0&&(s=-n.y),o.height=n.height-s,o.y=n.y+s;break;case"b":n.height+s+n.y>i.imgSize.height&&(s=i.imgSize.height-n.height-n.y),o.height=n.height+s;break;case"tr":n.y+s<0&&(s=-n.y),o.height=n.height-s,o.y=n.y+s,n.width+c+n.x>i.imgSize.width&&(c=i.imgSize.width-n.width-n.x),o.width=n.width+c;break;case"tl":n.y+s<0&&(s=-n.y),o.height=n.height-s,o.y=n.y+s,n.x+c<0&&(c=-n.x),o.width=n.width-c,o.x=n.x+c;break;case"bl":n.height+s+n.y>i.imgSize.height&&(s=i.imgSize.height-n.height-n.y),o.height=n.height+s,n.x+c<0&&(c=-n.x),o.width=n.width-c,o.x=n.x+c;break;case"br":n.height+s+n.y>i.imgSize.height&&(s=i.imgSize.height-n.height-n.y),o.height=n.height+s,n.width+c+n.x>i.imgSize.width&&(c=i.imgSize.width-n.width-n.x),o.width=n.width+c;break;default:break}i.clipRect=i._.cloneDeep(o)},c=function t(){document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",t)};document.addEventListener("mousemove",a),document.addEventListener("mouseup",c),console.log("dir",e)},startMoveHandle:function(t){var e=this,i={x:t.clientX,y:t.clientY},r=this._.cloneDeep(this.clipRect),n=this._.cloneDeep(this.clipRect),o=function(t){var o=t.clientX-i.x,a=t.clientY-i.y;r.x+o<0?o=-r.x:r.x+o+r.width>e.imgSize.width&&(o=e.imgSize.width-r.width-r.x),r.y+a<0?a=-r.y:r.y+a+r.height>e.imgSize.height&&(a=e.imgSize.height-r.height-r.y),n.x=r.x+o,n.y=r.y+a,e.clipRect=n},a=function t(){document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",t)};document.addEventListener("mousemove",o),document.addEventListener("mouseup",a)},sureAction:function(){var t=this._.cloneDeep(this.clipRect);1!==this.rate&&(t.width=parseInt(t.width/this.rate),t.height=parseInt(t.height/this.rate),t.x=parseInt(t.x/this.rate),t.y=parseInt(t.y/this.rate)),console.log("this.clipRect",t),this.$emit("change",t)},changeRateHandle:function(){switch(this.clipRect.x=0,this.clipRect.y=0,this.clipRect.rate){case"origin":this.clipRect.width=this.imgSize.width,this.clipRect.height=this.imgSize.height;break;case"1":var t=Math.min(this.imgSize.width,this.imgSize.height);this.clipRect.width=t,this.clipRect.height=t;break;case"4/3":this.imgSize.height>=this.imgSize.width?(this.clipRect.width=this.imgSize.width,this.clipRect.height=3*this.imgSize.width/4):(this.clipRect.width=4*this.imgSize.height/3,this.clipRect.height=this.imgSize.height);break;case"3/4":this.imgSize.height>this.imgSize.width?(this.clipRect.width=this.imgSize.width,this.clipRect.height=4*this.imgSize.width/3):(this.clipRect.width=3*this.imgSize.height/4,this.clipRect.height=this.imgSize.height);break;case"custom":break;default:break}}},mounted:function(){var t=this;this.$nextTick(Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.calcImgSize();case 2:t.imgSize=e.sent,t.clipRect={type:t.crop.type||"rect",x:t.crop.x*t.rate,y:t.crop.y*t.rate,width:t.crop.width*t.rate||t.imgSize.width,height:t.crop.height*t.rate||t.imgSize.height,rate:t.crop.rate||"custom"};case 4:case"end":return e.stop()}}),e)}))))}},l=h,u=(i("d676"),i("2877")),d=Object(u["a"])(l,o,a,!1,null,"e9207988",null),g=d.exports,p=i("4d76"),f={name:"crop",data:function(){return{visible:!1,src:"https://dora-doc.qiniu.com/gogopher.jpg",crop:{type:"",x:0,y:0,width:0,height:0}}},components:{CropDlg:g},computed:{cropMask:function(){var t=this.crop;if(!t)return{};var e=p["a"][t.type];return e?{"-webkit-mask-box-image-source":"url(".concat(e,")"),"mask-box-image-source":"url(".concat(e,")")," -webkit-mask-box-image-slice":"initial","-webkit-mask-box-image-width":"initial","-webkit-mask-box-image-outset":"initial","-webkit-mask-box-image-repeat":"initial"}:{}},url:function(){return this.cropImg(this.src)}},methods:{cropImg:function(t){var e=this.crop,i=this.src;if(i&&e.width&&e.height){var r="imageMogr2/crop/!".concat(e.width,"x").concat(e.height,"a").concat(e.x,"a").concat(e.y),n=t.includes("?")?"&":"?";return t+n+r}return t},cropHandle:function(t){this.crop=t,this.visible=!1}}},m=f,v=Object(u["a"])(m,r,n,!1,null,null,null);e["default"]=v.exports},d676:function(t,e,i){"use strict";i("1f56")}}]);
//# sourceMappingURL=chunk-70ef1d21.183b5a60.js.map