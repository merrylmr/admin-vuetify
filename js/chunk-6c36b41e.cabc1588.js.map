{"version":3,"sources":["webpack:///./node_modules/core-js/modules/web.dom-collections.for-each.js","webpack:///./node_modules/core-js/internals/array-for-each.js","webpack:///./node_modules/jspreadsheet-ce/dist/index.js","webpack:///./node_modules/core-js/internals/this-number-value.js","webpack:///./src/views/plugin/Sheet.vue?7a50","webpack:///./node_modules/core-js/internals/array-from.js","webpack:///./node_modules/core-js/internals/whitespaces.js","webpack:///./node_modules/core-js/internals/string-trim.js","webpack:///./node_modules/jsuites/dist/jsuites.js","webpack:///./node_modules/core-js/internals/inherit-if-required.js","webpack:///./src/views/plugin/Sheet.vue?666c","webpack:///./node_modules/core-js/internals/call-with-safe-iteration-closing.js","webpack:///./node_modules/core-js/modules/es.array.from.js","webpack:///./node_modules/core-js/internals/array-method-is-strict.js","webpack:///./src/views/plugin/Sheet.vue?36a6","webpack:///src/views/plugin/Sheet.vue","webpack:///./src/views/plugin/Sheet.vue?4bd1","webpack:///./src/views/plugin/Sheet.vue","webpack:///./node_modules/core-js/modules/es.number.constructor.js","webpack:///./node_modules/core-js/modules/es.array.find-index.js","webpack:///./node_modules/core-js/modules/es.array.slice.js"],"names":["global","DOMIterables","DOMTokenListPrototype","forEach","createNonEnumerableProperty","handlePrototype","CollectionPrototype","error","COLLECTION_NAME","prototype","$forEach","arrayMethodIsStrict","STRICT_METHOD","module","exports","callbackfn","this","arguments","length","undefined","formula","nil","Error","div0","value","ref","name","num","na","data","utils","array","reduce","a","b","aIsArray","Array","isArray","bIsArray","concat","push","i","result","argsToArray","apply","isFlat","flattenShallow","args","arrayEach","possibleNumbers","flatten","filter","el","number","power","Math","round","bool","up","toUpperCase","Date","isNaN","string","parseFloat","arr","len","parsed","parseNumber","matrix","pnarr","parseNumberArray","d1900","UTC","parseDate","date","d","parseInt","getTime","parseDateArray","anyIsError","n","arrayValuesToNumbers","rest","idx","slice","initial","iteratee","index","transpose","map","col","row","met","datetime","WEEK_TYPES","serial","addOn","DATE","year","month","day","DATEVALUE","date_text","parse","DAY","serial_number","getDate","DAYS","end_date","start_date","DAYS360","method","EDATE","months","setMonth","getMonth","EOMONTH","getFullYear","HOUR","getHours","INTERVAL","second","floor","hour","min","sec","ISOWEEKNUM","setHours","setDate","getDay","yearStart","ceil","MINUTE","getMinutes","MONTH","NETWORKDAYS","holidays","INTL","weekend","NOW","SECOND","getSeconds","TIME","minute","TIMEVALUE","time_text","TODAY","WEEKDAY","return_type","WEEKNUM","WORKDAY","days","YEAR","YEARFRAC","basis","database","compact","findResultIndex","criterias","matches","maxCriteriaLength","k","l","currentCriteriaResult","hasMatchingCriteria","j","criteria","criteriaField","p","eval","FINDFIELD","title","DAVERAGE","field","resultIndexes","targetFields","sum","DCOUNT","DCOUNTA","DGET","DMAX","maxValue","DMIN","minValue","DPRODUCT","targetValues","DSTDEV","DSTDEVP","DSUM","DVAR","DVARP","MATCH","lookupValue","lookupArray","matchType","indexValue","replace","toLowerCase","match","engineering","isValidBinaryNumber","test","BESSELI","x","BESSELJ","BESSELK","BESSELY","BIN2DEC","stringified","toString","substring","BIN2HEX","places","REPT","BIN2OCT","BITAND","number1","number2","BITLSHIFT","shift","abs","BITOR","BITRSHIFT","BITXOR","COMPLEX","real","imaginary","suffix","sign","CONVERT","from_unit","to_unit","alt","units","binary_prefixes","Yi","Zi","Ei","Pi","Ti","Gi","Mi","ki","unit_prefixes","Y","Z","E","P","T","G","M","h","e","c","m","u","f","z","y","from","to","base_from_unit","base_to_unit","from_multiplier","to_multiplier","indexOf","from_binary_prefix","from_unit_prefix","to_binary_prefix","to_unit_prefix","DEC2BIN","DEC2HEX","DEC2OCT","DELTA","ERF","lower_bound","upper_bound","PRECISE","ERFC","GESTEP","step","HEX2BIN","negative","decimal","HEX2DEC","HEX2OCT","IMABS","inumber","IMREAL","IMAGINARY","sqrt","pow","plus","minus","last","unit","Number","IMARGUMENT","PI","atan","IMCONJUGATE","IMCOS","cos","exp","sin","IMCOSH","IMCOT","IMDIV","IMSIN","inumber1","inumber2","unit1","unit2","den","IMEXP","IMLN","log","IMLOG10","IMLOG2","IMPOWER","t","IMPRODUCT","IMSEC","IMSECH","IMSINH","IMSQRT","s","IMCSC","IMCSCH","IMSUB","IMSUM","IMTAN","OCT2BIN","OCT2DEC","OCT2HEX","financial","validDate","ensureDate","ACCRINT","issue","first","settlement","rate","par","frequency","ACCRINTM","AMORDEGRC","AMORLINC","COUPDAYBS","COUPDAYS","COUPDAYSNC","COUPNCD","COUPNUM","COUPPCD","CUMIPMT","periods","start","end","type","payment","PMT","interest","FV","CUMPRINC","principal","DB","cost","salvage","life","period","toFixed","total","current","ceiling","DDB","factor","DISC","DOLLARDE","dollar","fraction","LN10","LN2","DOLLARFR","DURATION","EFFECT","term","FVSCHEDULE","schedule","future","INTRATE","IPMT","present","IRR","values","guess","irrResult","dates","r","irrResultDeriv","frac","positive","newRate","epsRate","resultValue","resultRate","epsMax","contLoop","ISPMT","MDURATION","MIRR","finance_rate","reinvest_rate","payments","incomes","NPV","NOMINAL","NPER","ODDFPRICE","ODDFYIELD","ODDLPRICE","ODDLYIELD","PDURATION","PPMT","PRICE","PRICEDISC","PRICEMAT","PV","RATE","iterMax","iter","close","t1","t2","f1","f2","f3","NaN","RECEIVED","RRI","SLN","SYD","TBILLEQ","maturity","discount","TBILLPRICE","TBILLYIELD","price","VDB","XIRR","XNPV","YIELD","YIELDDISC","YIELDMAT","information","ERROR","TYPE","error_val","INFO","ISBLANK","ISBINARY","ISERR","isFinite","ISERROR","ISEVEN","ISFORMULA","ISLOGICAL","ISNA","ISNONTEXT","ISNUMBER","ISODD","ISREF","ISTEXT","N","NA","SHEET","SHEETS","logical","then_value","otherwise_value","valueIfError","value_if_na","targetValue","argc","switchCount","switchSatisfied","defaultClause","math","acos","text","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I","asin","number_x","number_y","atan2","radix","min_length","max","join","significance","mode","CEILING","MATH","COMBIN","number_chosen","FACT","COMBINA","COS","COSH","COT","tan","COTH","e2","CSC","CSCH","DECIMAL","DEGREES","EVEN","EXP","MEMOIZED_FACT","FACTDOUBLE","FLOOR","GCD","INT","LCM","o","pop","splice","LN","LOG","base","LOG10","MDETERM","MINVERSE","MMULT","MOD","dividend","divisor","modulus","MROUND","multiple","MULTINOMIAL","MUNIT","ODD","temp","POWER","PRODUCT","QUOTIENT","numerator","denominator","RADIANS","RAND","random","RANDBETWEEN","bottom","top","ROMAN","ROUND","digits","ROUNDDOWN","ROUNDUP","SEC","SECH","SERIESSUM","coefficients","SIGN","SIN","SINH","SQRT","SQRTPI","SUBTOTAL","ADD","num1","num2","MINUS","DIVIDE","MULTIPLY","factor1","factor2","GTE","LT","LTE","EQ","value1","value2","NE","POW","exponent","SUM","argsKeys","Object","keys","elt","SUMIF","range","SUMIFS","n_range_elements","n_criterias","condition","SUMPRODUCT","SUMSQ","numbers","SUMX2MY2","array_x","array_y","SUMX2PY2","SUMXMY2","TAN","TANH","TRUNC","misc","hasElement","element","FLATTEN","ARGS2ARRAY","call","REFERENCE","context","reference","path","split","opening","JOIN","separator","NUMBERS","NUMERAL","String","fromCharCode","re","charCodeAt","trueFound","falseFound","text1","text2","find_text","within_text","position","line","begin","txt","charAt","substr","regular_expression","RegExp","full","replacement","new_text","foundAt","old_text","occurrence","trim","UNICHAR","CHAR","UNICODE","CODE","UPPER","VALUE","stats","SQRT2PI","AVEDEV","AVERAGE","count","AVERAGEA","AVERAGEIF","average_range","average_count","AVERAGEIFS","COUNT","COUNTA","COUNTBLANK","COUNTIN","blanks","COUNTIF","COUNTIFS","results","COUNTUNIQUE","UNIQUE","FISHER","FISHERINV","e2y","FREQUENCY","bins","LARGE","sort","MAX","MAXA","MIN","MINA","MODE","MULT","currentItem","maxItems","SNGL","PERCENTILE","EXC","fl","cleanFloat","INC","PERCENTRANK","uniques","PERMUT","PERMUTATIONA","PHI","PROB","probability","lower","upper","sorted","QUARTILE","quart","RANK","AVG","order","RSQ","data_x","data_y","PEARSON","SMALL","STANDARDIZE","mean","sd","STDEV","v","VAR","S","STDEVA","VARA","STDEVPA","VARPA","sigma","WEIBULL","DIST","alpha","beta","cumulative","TEST","NORM","color","html","methods","window","tmp","instance","F","getColumnNameFromCoords","processed","getValueFromCoords","secureFormula","oldValue","runtime","newValue","inside","special","tokensUpdate","tokens","getTokensFromRange","expression","variables","obj","Function","getColumnName","letter","getCoordsFromColumnName","columnName","exec","code","getRangeFromTokens","Helpers","e1","x1","x2","y1","y2","vars","setFormula","jSuites","factory","Version","info","version","host","license","print","isFormula","getMask","format","mask","locale","opt","options","jexcel","Element","HTMLDocument","console","tagName","createFromTable","div","document","createElement","parentNode","insertBefore","remove","defaults","url","requestVariables","sorting","copyCompatibility","root","rows","columns","colHeaders","colWidths","colAlignments","nestedHeaders","defaultColWidth","defaultColAlign","defaultRowHeight","minSpareRows","minSpareCols","minDimensions","allowExport","includeHeadersOnDownload","includeHeadersOnCopy","columnSorting","columnDrag","columnResize","rowResize","rowDrag","editable","allowInsertRow","allowManualInsertRow","allowInsertColumn","allowManualInsertColumn","allowDeleteRow","allowDeletingAllRows","allowDeleteColumn","allowRenameColumn","allowComments","wordWrap","imageOptions","csv","csvFileName","csvHeaders","csvDelimiter","parseTableFirstRowAsHeader","parseTableAutoCellType","selectionCopy","mergeCells","toolbar","search","pagination","paginationOptions","fullscreen","lazyLoading","loadingSpin","tableOverflow","tableHeight","tableWidth","textOverflow","meta","style","classes","parseFormulas","autoIncrement","autoCasting","secureFormulas","stripHTML","stripHTMLOnCopy","filters","footers","onundo","onredo","onload","onchange","oncomments","onbeforechange","onafterchanges","onbeforeinsertrow","oninsertrow","onbeforeinsertcolumn","oninsertcolumn","onbeforedeleterow","ondeleterow","onbeforedeletecolumn","ondeletecolumn","onmoverow","onmovecolumn","onresizerow","onresizecolumn","onsort","onselection","oncopy","onpaste","onbeforepaste","onmerge","onfocus","onblur","onchangeheader","oncreateeditor","oneditionstart","oneditionend","onchangestyle","onchangemeta","onchangepage","onbeforesave","onsave","onevent","persistance","updateTable","detachForUpdates","freezeColumns","noRecordsFound","showingPage","show","entries","insertANewColumnBefore","insertANewColumnAfter","deleteSelectedColumns","renameThisColumn","orderAscending","orderDescending","insertANewRowBefore","insertANewRowAfter","deleteSelectedRows","editComments","addComments","comments","clearComments","copy","paste","saveAs","about","areYouSureToDeleteTheSelectedRows","areYouSureToDeleteTheSelectedColumns","thisActionWillDestroyAnyExistingMergedCellsAreYouSure","thisActionWillClearYourSearchResultsAreYouSure","thereIsAConflictWithAnotherMergedCell","invalidMergeProperties","cellAlreadyMerged","noCellsSelected","property","hasOwnProperty","textKey","corner","contextMenu","textarea","ads","content","table","thead","tbody","searchInput","pageNumber","headerContainer","colgroupContainer","headers","records","history","colgroup","selection","highlighted","selectedCell","selectedContainer","cursor","historyIndex","ignoreEvents","ignoreHistory","edition","hashString","resizing","dragging","activate","classList","add","dispatch","event","ret","prepareJson","save","prepareTable","size","source","editor","allowEmpty","width","align","dataType","success","ajax","createTable","onscroll","scrollControls","onwheel","wheelControls","searchContainer","searchText","createTextNode","appendChild","resetSelection","paginationUpdateContainer","paginationDropdown","page","innerHTML","tempCol","setAttribute","createNestedHeader","createCellHeader","td","className","display","id","tabIndex","contextmenu","onclick","sessionStorage","getItem","setItem","img","src","exception","span","container","paginationInfo","paginationPages","createToolbar","maxHeight","setData","setStyle","cell","getIdFromColumnName","refresh","loading","hide","JSON","size_i","size_j","min_i","min_j","max_i","max_j","startNumber","finalNumber","tr","createRow","updatePagination","setMerge","getData","dataOnly","dataset","px","py","contains","getJsonRow","rowNumber","rowData","getJson","stringify","getRowData","setRowData","getColumnNameFromId","setValue","getColumnData","columnNumber","setColumnData","colNumber","height","createCell","parseValue","executeFormula","masked","render","val","innerText","checked","readOnly","formatted","calendar","extractDateFromString","getDateString","getDropDownValue","backgroundColor","stripScript","colAlign","textAlign","whiteSpace","overflow","colWidth","updateNestedHeader","children","nestedInformation","headerIndex","colspan","numberOfColumns","column","toolbarItem","tooltip","getAttribute","toolbarDropdownOption","cellName","rowspan","ignoreHistoryAndEvents","alert","updateCell","updateSelection","setHistory","action","getMerge","removeMerge","keepOptions","removeAttribute","destroyMerged","isColMerged","cols","isRowMerged","openFilter","columnId","optionsFiltered","hasBlanks","paddingLeft","paddingRight","autocomplete","opened","onclose","resetFilters","dropdown","getValue","getText","closeFilter","refreshSelection","query","updateResult","openEditor","empty","createEditor","getBoundingClientRect","minHeight","closeEditor","focus","rect","rectContent","innerHeight","image","disabledMaskOnEdition","input","scrollLeft","scrollWidth","extract","getCell","getColumnOptions","getCellFromCoords","getLabel","getLabelFromCoords","processedValue","force","updateFormulaChain","setValueFromCoords","setCheckRadioValue","Option","getElementsByTagName","removeChild","record","copyData","breakControl","posx","posy","affectedTokens","token","updateFormula","doubleDigitFormat","updateSelectionFromCoords","conditionalSelectionUpdate","blur","previousStatus","ux","uy","left","el1","el2","origin","previousState","borderLeft","borderRight","borderTop","borderBottom","removeCopyingSelection","updateCornerPosition","removeCopySelection","updateCopySelection","x3","y3","contentRect","lastRect","w2","h2","scrollTop","getFreezeWidth","updateScroll","direction","w1","h1","referenceRect","freezed","getWidth","$","setWidth","oldWidth","w","setHeight","oldHeight","getHeight","setFooter","tfoot","getHeader","setHeader","prompt","getHeaders","asArray","getMeta","key","setMeta","prop","updateMeta","affectedCells","newMeta","getStyle","resetStyle","applyStyle","cellId","currentValue","oneApplication","getComments","withAuthor","setComments","author","getConfig","orderBy","confirm","valueA","valueB","updateOrderArrow","updateOrder","updateTableReferences","loadPage","moveRow","ignoreDom","resetSearch","nextSibling","insertRow","mixed","numOfRows","lastRow","rowIndex","currentRecords","currentData","currentRows","rowRecords","rowNode","deleteRow","getSelectedRows","mergeExists","moveColumn","insertColumn","properties","numOfColumns","lastColumn","columnIndex","injectArray","currentHeaders","currentColgroup","historyHeaders","historyColgroup","historyRecords","historyData","historyFooters","currentRecord","deleteColumn","getSelectedColumns","asIds","getHighlighted","mergeCellUpdates","updatePosition","columnIdFrom","columnIdTo","totalX","totalY","updateFormulas","numBlankRows","numBlankCols","setTimeout","isReadOnly","setReadOnly","state","showRow","hideRow","showColumn","hideColumn","showIndex","hideIndex","chainLoopProtection","referencesToUpdate","newFormula","testLetter","testNumber","formulaResults","formulaLoopProtection","execute","parentId","formulaExpressions","res","shiftKey","ctrlKey","visible","loadValidation","item","firstChild","loadUp","whichPage","group","get","down","lastChild","loadDown","right","selectAll","quantityPerPage","startRow","finalRow","currentPage","selectedPage","totalPages","addToResult","oldPage","quantyOfPages","paginationItem","download","includeHeaders","blob","Blob","navigator","msSaveOrOpenBlob","pom","URL","createObjectURL","href","body","click","changes","delimiter","returnData","header","colLabel","rowLabel","copyHeader","numOfCols","nested","label","str","strLabel","select","execCommand","hash","parseCSV","newStyle","oldStyle","styleIndex","colIndex","copying","querySelectorAll","historyProcessRow","historyRecord","historyProcessColumn","undo","redo","combo","quote","cc","nc","chr","destroy","init","build","addEventListener","newData","items","comment","shortcut","clipboard","readText","then","updateFreezePosition","target","timeControlLoading","clientHeight","scrollHeight","shifted","jspreadsheet","setDictionary","setExtensions","timeControl","destroyEventHandlers","removeEventListener","mouseUpControls","mouseDownControls","mouseMoveControls","mouseOverControls","doubleClickControls","pasteControls","contextMenuControls","touchStartControls","touchEndControls","keyDownControls","which","preventDefault","altKey","editorTextarea","editorValue","editorIndexOf","selectionStart","selectionEnd","selectedRow","selectedHeader","metaKey","rowId","keyCode","validLetter","cutControls","copyControls","clearTimeout","isMouseAction","buttons","mouseButton","button","jexcelTable","getElement","selectedCorner","offsetX","mousePosition","pageX","offsetY","destination","c1","c2","pageY","clientWidth","getCellCoords","newWidth","currentWidth","newHeight","previousSibling","tempWidth","tempHeight","clientX","clientY","enabled","clipboardData","open","tmpElement","tabs","instances","spreadsheet","link","worksheet","sheetName","createTabs","fromSpreadsheet","file","__callback","oReq","convert","workbook","spreadsheets","SheetNames","Sheets","wpx","hpx","max_x","max_y","fgColor","rgb","numColumns","XMLHttpRequest","Uint8Array","responseType","arraybuffer","response","wb","XLSX","read","cellFormula","cellStyles","setRequestHeader","onreadystatechange","readyState","status","ff","convertResponseBodyToText","responseBody","send","regex","jexcelSection","jexcelElement","parseHeader","cells","mergedColspan","mergedRowspan","footer","pattern","testCalendar","helpers","component","config","pos","getSelection","rangeCount","getRangeAt","cloneRange","selectNodeContents","setEnd","endContainer","endOffset","limit","flag","closed","fn","spreadsheetContainer","jQuery","uncurryThis","valueOf","bind","toObject","callWithSafeIterationClosing","isArrayIteratorMethod","isConstructor","lengthOfArrayLike","createProperty","getIterator","getIteratorMethod","arrayLike","O","IS_CONSTRUCTOR","argumentsLength","mapfn","mapping","iterator","next","iteratorMethod","done","requireObjectCoercible","whitespaces","whitespace","ltrim","rtrim","createMethod","$this","find","DOMElement","isOpened","changedTouches","shadowRoot","elementFromPoint","tracking","dictionary","weekdays","translate","weekdaysShort","monthsShort","complete","parseData","FileList","encodeURIComponent","FormData","append","httpRequest","contentType","cache","withCredentials","beforeSend","responseText","err","queue","requests","oncomplete","pending","exists","http","message","getWindowWidth","dialog","animation","slideLeft","slideRight","slideTop","slideBottom","fadeIn","fadeOut","setOptions","reset","validRange","startingDay","readonly","today","time","resetButton","placeholder","monthsFull","weekdays_short","textDone","textReset","textUpdate","onopen","onupdate","calendarReset","isNumeric","numToDate","calendarConfirm","calendarControlsUpdateButton","now","getDays","getMonths","calendarSelectHour","calendarSelectMin","calendarContent","calendarContainer","innerWidth","update","querySelector","getYears","toISOString","setLabel","two","elements","updateActions","calendarLabelYear","calendarLabelMonth","isCurrentMonthAndYear","currentDay","numberOfDays","firstDay","calendarBody","emptyRow","fontWeight","test1","test2","calendarControlsTime","currentYear","currentMonth","selectedYear","selectedMonth","findElement","prev","keyUpControls","calendarTable","calendarControls","calendarControlsUpdate","calendarTableContainer","calendarHeaderPrev","calendarHeaderTitle","calendarHeaderNext","calendarHeader","calendarHeaderRow","calendarControlsFooter","maxWidth","flexGrow","calendarBackdrop","stopPropagation","onmouseup","documentElement","hasEvents","keydown","change","prettify","texts","justNow","xMinutesAgo","xHoursAgo","xDaysAgo","xWeeksAgo","xMonthsAgo","xYearsAgo","d1","d2","prettifyAll","dateOnly","toArray","dateToNum","splitStr","getMilliseconds","backdrop","closeButton","jsuitesTabs","closeOnChange","palette","doneLabel","resetLabel","updateContent","setBorder","getActive","HexToRgb","rgbInputs","rgbInput","dispatchEvent","Event","slidersResult","selected","backdropClickControl","decToHex","hex","rgbToHex","g","hexToDec","tableContainer","canvas","getContext","resizeCanvas","gradient","createLinearGradient","addColorStop","fillStyle","fillRect","hsl","point","pixel","getImageData","changeInputColors","currentColor","newGradient","backgroundImage","sliders","slidersElement","slidersBody","createSliderInput","inputContainer","subContainer","slidersResultColor","resultElement","visibility","resultColor","removeProperty","controls","contentElement","createHeader","createItemElement","itemContainer","itemText","icon","disabled","submenu","itemIconSubmenu","el_submenu","itemContainerSubMenu","itemShortCut","create","itemHeader","foundId","sortResults","sortData","applyValue","itemA","itemB","testA","testB","localeCompare","resetValue","Value","Text","remoteSearch","newOptions","oninsert","onbeforeinsert","autofocus","minWidth","containerHeader","keyTimer","extractFromDom","groups","onkeyup","mouseup","getUrl","setUrl","callback","setId","guid","newItem","createItem","groupName","node","appendData","counter","groupNames","groupArrow","groupContent","getPosition","resetSelected","selectIndex","setCursor","selectItem","unshift","synonym","rectContainer","setPosition","currentIndex","offsetTop","clientTop","resetCursor","updateCursor","loadFirst","newIndex","loadLast","nextElementSibling","previousElementSibling","fistItem","lastItem","offsetWidth","snippet","remoteParser","parseURL","filterPaste","dropZone","dropAsSnippet","acceptImages","acceptFiles","maxFileSize","allowImageResize","border","padding","onkeydown","editorTimer","editorAction","files","overflowY","extractImageFromHtml","addImage","insertNodeAtCaret","newNode","sel","deleteContents","insertNode","setStartAfter","setEndAfter","removeAllRanges","addRange","updateTotalImages","appendImage","appendElement","verifyEditor","detectUrl","youtubeParser","parseWebsite","parseContent","youtubeId","description","encodeURI","getFiles","json","addPdf","Image","ctx","drawImage","toBlob","newImage","extension","asSnippet","lastIndexOf","toDataURL","addFile","reader","FileReader","lastModified","readAsDataURL","editorMouseUp","editorMouseDown","editorMouseMove","editorKeyUp","editorKeyDown","editorDragStart","editorDragEnter","editorDragOver","editorDrop","editorPaste","editorBlur","editorFocus","removeRange","HTMLUnknownElement","HTMLAudioElement","HTMLEmbedElement","HTMLIFrameElement","HTMLTextAreaElement","HTMLInputElement","HTMLScriptElement","validProperty","validStyle","attributes","elementStyle","attr","numAttributes","constructor","parser","DOMParser","parseFromString","originalEvent","caretRangeFromPoint","rangeParent","createRange","setStart","rangeOffset","anchorNode","dataTransfer","getDefaultToolbar","responsive","startContainer","getDomain","links","regExp","queryCommandState","form","ignore","currentHash","submitButton","validations","onbeforeload","onbeforeremove","onremove","onerror","email","required","load","setElements","validate","getElements","addError","delError","validateElement","validation","getError","setHash","getHash","isChanged","resetTracker","setIgnore","ignoreFlag","confirmationMessage","returnValue","tracker","childNodes","collapse","getNode","nodeType","randomColor","lum","getWindowHeight","evt","MouseEvent","bubbles","cancelable","view","foundElement","sha512","int64","msint_32","lsint_32","highOrder","lowOrder","T1","T2","H","K","W","charsize","utf8_encode","unescape","str2binb","bin","binb2hex","binarray","srcByte","hex_tab","safe_add_2","lsw","msw","safe_add_4","safe_add_5","maj","ch","rotr","sigma0","rotr28","rotr34","rotr39","sigma1","rotr14","rotr18","rotr41","gamma0","rotr1","rotr8","shr7","shr","gamma1","rotr19","rotr61","shr6","strlen","login","upload","maxJpegSizeBytes","extensionNotAllowed","addFromFile","readFile","srcElement","lastmodified","addFromUrl","mime","timer","currency","percentage","numeric","general","isBlank","chartAt","getDecimal","Intl","NumberFormat","toLocaleString","ParseValue","FormatValue","Format","Caret","Extract","adjustNumeric","updateCaret","weekDaysFull","weekDays","FIND","N60","neg","reverse","getTokens","getMethod","types","getMethods","getType","toPlainString","returnObject","caret","inputType","prepare","run","fullMask","fillWithBlanks","minimumFractionDigits","maximumFractionDigits","set","modal","resetPosition","isOpen","modals","notification","timeout","autoHide","closeable","notificationContainer","notificationHeader","notificationImage","notificationIcon","notificationName","notificationClose","notificationDate","notificationContent","notificationTitle","notificationMessage","notificationTimeout","isVisible","material","fire","baby","chart","picker","dropdownHeader","dropdownContent","createContent","dropdownItem","onselect","rectHeader","marginTop","marginLeft","onmousedown","progressbar","bar","rating","createList","forceSelect","terms","keyup","slider","grid","currentImage","caption","updateCounter","offsetHeight","nextImage","mouseUp","pointer","ondragstart","ondragend","ondrop","dragElement","opacity","hasAttribute","allowCreate","allowChangePosition","oncreate","ondelete","onbeforecreate","onchangeposition","hideHeaders","offsetLeft","updateControls","scrollTo","behavior","previous","r1","r2","rename","deleteElement","nextNumber","cb","newContent","contentItem","replaceChild","move","titleElement","headerItem","iconContainer","loadingRemoteData","tags","limitMessage","onlimit","colors","setFocus","setLimit","extractTags","isValid","tagsMouseUp","tagsKeyDown","tagsKeyUp","tagsPaste","tagsFocus","tagsBlur","isEmpty","word","anchorOffset","app","badge","toolbarArrow","toolbarFloating","toolbarContent","setBadge","updateState","active","toolbarIcon","class","toolbarBadge","toolbarBadgeContent","toolbarTitle","route","pages","available","isNumber","valueComparisons","constraint","itemList","some","includes","constraints","isCallable","isObject","setPrototypeOf","dummy","Wrapper","NewTarget","NewTargetPrototype","anObject","iteratorClose","ENTRIES","checkCorrectnessOfIteration","INCORRECT_ITERATION","iterable","stat","forced","fails","METHOD_NAME","argument","_vm","_h","$createElement","_c","_self","staticClass","on","setTableDataHandle","domProps","_s","_v","attrs","changeHandle","model","$$v","$set","changeHeaderTypeHandle","_l","$event","changeColumnType","staticRenderFns","fakeData","totalNum","columnTypes","itemValue","selectionActive","cellName1","_this","selectedColumns","colSpan","merges","hasMerged","rowSpan","startPos","mergeInSelectedArea","startRange","endRange","oneName","inRangeMerge","sheetClickEvent","dom","mounted","$nextTick","DESCRIPTORS","isForced","redefine","hasOwn","inheritIfRequired","isPrototypeOf","isSymbol","toPrimitive","getOwnPropertyNames","getOwnPropertyDescriptor","defineProperty","thisNumberValue","NUMBER","NativeNumber","NumberPrototype","TypeError","arraySlice","toNumeric","primValue","toNumber","third","maxCode","it","NumberWrapper","$findIndex","findIndex","addToUnscopables","FIND_INDEX","SKIPS_HOLES","proto","toAbsoluteIndex","toIndexedObject","wellKnownSymbol","arrayMethodHasSpeciesSupport","un$Slice","HAS_SPECIES_SUPPORT","SPECIES","Constructor","fin"],"mappings":"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","file":"js/chunk-6c36b41e.cabc1588.js","sourcesContent":["var global = require('../internals/global');\nvar DOMIterables = require('../internals/dom-iterables');\nvar DOMTokenListPrototype = require('../internals/dom-token-list-prototype');\nvar forEach = require('../internals/array-for-each');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\n\nvar handlePrototype = function (CollectionPrototype) {\n  // some Chrome versions have non-configurable methods on DOMTokenList\n  if (CollectionPrototype && CollectionPrototype.forEach !== forEach) try {\n    createNonEnumerableProperty(CollectionPrototype, 'forEach', forEach);\n  } catch (error) {\n    CollectionPrototype.forEach = forEach;\n  }\n};\n\nfor (var COLLECTION_NAME in DOMIterables) {\n  if (DOMIterables[COLLECTION_NAME]) {\n    handlePrototype(global[COLLECTION_NAME] && global[COLLECTION_NAME].prototype);\n  }\n}\n\nhandlePrototype(DOMTokenListPrototype);\n","'use strict';\nvar $forEach = require('../internals/array-iteration').forEach;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\n\nvar STRICT_METHOD = arrayMethodIsStrict('forEach');\n\n// `Array.prototype.forEach` method implementation\n// https://tc39.es/ecma262/#sec-array.prototype.foreach\nmodule.exports = !STRICT_METHOD ? function forEach(callbackfn /* , thisArg */) {\n  return $forEach(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n// eslint-disable-next-line es/no-array-prototype-foreach -- safe\n} : [].forEach;\n","/**\r\n * Jspreadsheet v4.9.6\r\n *\r\n * Website: https://bossanova.uk/jspreadsheet/\r\n * Description: Create amazing web based spreadsheets.\r\n *\r\n * This software is distribute under MIT License\r\n */\r\n\r\nvar formula = (function() {\r\n    // Based on sutoiku work (https://github.com/sutoiku)\r\n    var error = (function() {\r\n        var exports = {};\r\n\r\n        exports.nil = new Error('#NULL!');\r\n        exports.div0 = new Error('#DIV/0!');\r\n        exports.value = new Error('#VALUE!');\r\n        exports.ref = new Error('#REF!');\r\n        exports.name = new Error('#NAME?');\r\n        exports.num = new Error('#NUM!');\r\n        exports.na = new Error('#N/A');\r\n        exports.error = new Error('#ERROR!');\r\n        exports.data = new Error('#GETTING_DATA');\r\n\r\n        return exports;\r\n    })();\r\n\r\n    var utils = (function() {\r\n        var exports = {};\r\n\r\n        exports.flattenShallow = function(array) {\r\n            if (!array || !array.reduce) {\r\n                return array;\r\n            }\r\n\r\n            return array.reduce(function(a, b) {\r\n                var aIsArray = Array.isArray(a);\r\n                var bIsArray = Array.isArray(b);\r\n\r\n                if (aIsArray && bIsArray) {\r\n                    return a.concat(b);\r\n                }\r\n                if (aIsArray) {\r\n                    a.push(b);\r\n\r\n                    return a;\r\n                }\r\n                if (bIsArray) {\r\n                    return [ a ].concat(b);\r\n                }\r\n\r\n                return [ a, b ];\r\n            });\r\n        };\r\n\r\n        exports.isFlat = function(array) {\r\n            if (!array) {\r\n                return false;\r\n            }\r\n\r\n            for (var i = 0; i < array.length; ++i) {\r\n                if (Array.isArray(array[i])) {\r\n                    return false;\r\n                }\r\n            }\r\n\r\n            return true;\r\n        };\r\n\r\n        exports.flatten = function() {\r\n            var result = exports.argsToArray.apply(null, arguments);\r\n\r\n            while (!exports.isFlat(result)) {\r\n                result = exports.flattenShallow(result);\r\n            }\r\n\r\n            return result;\r\n        };\r\n\r\n        exports.argsToArray = function(args) {\r\n            var result = [];\r\n\r\n            exports.arrayEach(args, function(value) {\r\n                result.push(value);\r\n            });\r\n\r\n            return result;\r\n        };\r\n\r\n        exports.numbers = function() {\r\n            var possibleNumbers = this.flatten.apply(null, arguments);\r\n            return possibleNumbers.filter(function(el) {\r\n                return typeof el === 'number';\r\n            });\r\n        };\r\n\r\n        exports.cleanFloat = function(number) {\r\n            var power = 1e14;\r\n            return Math.round(number * power) / power;\r\n        };\r\n\r\n        exports.parseBool = function(bool) {\r\n            if (typeof bool === 'boolean') {\r\n                return bool;\r\n            }\r\n\r\n            if (bool instanceof Error) {\r\n                return bool;\r\n            }\r\n\r\n            if (typeof bool === 'number') {\r\n                return bool !== 0;\r\n            }\r\n\r\n            if (typeof bool === 'string') {\r\n                var up = bool.toUpperCase();\r\n                if (up === 'TRUE') {\r\n                    return true;\r\n                }\r\n\r\n                if (up === 'FALSE') {\r\n                    return false;\r\n                }\r\n            }\r\n\r\n            if (bool instanceof Date && !isNaN(bool)) {\r\n                return true;\r\n            }\r\n\r\n            return error.value;\r\n        };\r\n\r\n        exports.parseNumber = function(string) {\r\n            if (string === undefined || string === '') {\r\n                return error.value;\r\n            }\r\n            if (!isNaN(string)) {\r\n                return parseFloat(string);\r\n            }\r\n\r\n            return error.value;\r\n        };\r\n\r\n        exports.parseNumberArray = function(arr) {\r\n            var len;\r\n\r\n            if (!arr || (len = arr.length) === 0) {\r\n                return error.value;\r\n            }\r\n\r\n            var parsed;\r\n\r\n            while (len--) {\r\n                parsed = exports.parseNumber(arr[len]);\r\n                if (parsed === error.value) {\r\n                    return parsed;\r\n                }\r\n                arr[len] = parsed;\r\n            }\r\n\r\n            return arr;\r\n        };\r\n\r\n        exports.parseMatrix = function(matrix) {\r\n            var n;\r\n\r\n            if (!matrix || (n = matrix.length) === 0) {\r\n                return error.value;\r\n            }\r\n            var pnarr;\r\n\r\n            for (var i = 0; i < matrix.length; i++) {\r\n                pnarr = exports.parseNumberArray(matrix[i]);\r\n                matrix[i] = pnarr;\r\n\r\n                if (pnarr instanceof Error) {\r\n                    return pnarr;\r\n                }\r\n            }\r\n\r\n            return matrix;\r\n        };\r\n\r\n        var d1900 = new Date(Date.UTC(1900, 0, 1));\r\n        exports.parseDate = function(date) {\r\n            if (!isNaN(date)) {\r\n                if (date instanceof Date) {\r\n                    return new Date(date);\r\n                }\r\n                var d = parseInt(date, 10);\r\n                if (d < 0) {\r\n                    return error.num;\r\n                }\r\n                if (d <= 60) {\r\n                    return new Date(d1900.getTime() + (d - 1) * 86400000);\r\n                }\r\n                return new Date(d1900.getTime() + (d - 2) * 86400000);\r\n            }\r\n            if (typeof date === 'string') {\r\n                date = new Date(date);\r\n                if (!isNaN(date)) {\r\n                    return date;\r\n                }\r\n            }\r\n            return error.value;\r\n        };\r\n\r\n        exports.parseDateArray = function(arr) {\r\n            var len = arr.length;\r\n            var parsed;\r\n            while (len--) {\r\n                parsed = this.parseDate(arr[len]);\r\n                if (parsed === error.value) {\r\n                    return parsed;\r\n                }\r\n                arr[len] = parsed;\r\n            }\r\n            return arr;\r\n        };\r\n\r\n        exports.anyIsError = function() {\r\n            var n = arguments.length;\r\n            while (n--) {\r\n                if (arguments[n] instanceof Error) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        };\r\n\r\n        exports.arrayValuesToNumbers = function(arr) {\r\n            var n = arr.length;\r\n            var el;\r\n            while (n--) {\r\n                el = arr[n];\r\n                if (typeof el === 'number') {\r\n                    continue;\r\n                }\r\n                if (el === true) {\r\n                    arr[n] = 1;\r\n                    continue;\r\n                }\r\n                if (el === false) {\r\n                    arr[n] = 0;\r\n                    continue;\r\n                }\r\n                if (typeof el === 'string') {\r\n                    var number = this.parseNumber(el);\r\n                    if (number instanceof Error) {\r\n                        arr[n] = 0;\r\n                    } else {\r\n                        arr[n] = number;\r\n                    }\r\n                }\r\n            }\r\n            return arr;\r\n        };\r\n\r\n        exports.rest = function(array, idx) {\r\n            idx = idx || 1;\r\n            if (!array || typeof array.slice !== 'function') {\r\n                return array;\r\n            }\r\n            return array.slice(idx);\r\n        };\r\n\r\n        exports.initial = function(array, idx) {\r\n            idx = idx || 1;\r\n            if (!array || typeof array.slice !== 'function') {\r\n                return array;\r\n            }\r\n            return array.slice(0, array.length - idx);\r\n        };\r\n\r\n        exports.arrayEach = function(array, iteratee) {\r\n            var index = -1, length = array.length;\r\n\r\n            while (++index < length) {\r\n                if (iteratee(array[index], index, array) === false) {\r\n                    break;\r\n                }\r\n            }\r\n\r\n            return array;\r\n        };\r\n\r\n        exports.transpose = function(matrix) {\r\n            if (!matrix) {\r\n                return error.value;\r\n            }\r\n\r\n            return matrix[0].map(function(col, i) {\r\n                return matrix.map(function(row) {\r\n                    return row[i];\r\n                });\r\n            });\r\n        };\r\n\r\n        return exports;\r\n    })();\r\n\r\n    var met = {};\r\n\r\n    met.datetime = (function() {\r\n        var exports = {};\r\n\r\n        var d1900 = new Date(1900, 0, 1);\r\n        var WEEK_STARTS = [\r\n            undefined,\r\n            0,\r\n            1,\r\n            undefined,\r\n            undefined,\r\n            undefined,\r\n            undefined,\r\n            undefined,\r\n            undefined,\r\n            undefined,\r\n            undefined,\r\n            undefined,\r\n            1,\r\n            2,\r\n            3,\r\n            4,\r\n            5,\r\n            6,\r\n            0\r\n        ];\r\n        var WEEK_TYPES = [\r\n            [],\r\n            [1, 2, 3, 4, 5, 6, 7],\r\n            [7, 1, 2, 3, 4, 5, 6],\r\n            [6, 0, 1, 2, 3, 4, 5],\r\n            [],\r\n            [],\r\n            [],\r\n            [],\r\n            [],\r\n            [],\r\n            [],\r\n            [7, 1, 2, 3, 4, 5, 6],\r\n            [6, 7, 1, 2, 3, 4, 5],\r\n            [5, 6, 7, 1, 2, 3, 4],\r\n            [4, 5, 6, 7, 1, 2, 3],\r\n            [3, 4, 5, 6, 7, 1, 2],\r\n            [2, 3, 4, 5, 6, 7, 1],\r\n            [1, 2, 3, 4, 5, 6, 7]\r\n        ];\r\n        var WEEKEND_TYPES = [\r\n            [],\r\n            [6, 0],\r\n            [0, 1],\r\n            [1, 2],\r\n            [2, 3],\r\n            [3, 4],\r\n            [4, 5],\r\n            [5, 6],\r\n            undefined,\r\n            undefined,\r\n            undefined, [0, 0],\r\n            [1, 1],\r\n            [2, 2],\r\n            [3, 3],\r\n            [4, 4],\r\n            [5, 5],\r\n            [6, 6]\r\n        ];\r\n\r\n        exports.DATE = function(year, month, day) {\r\n            year = utils.parseNumber(year);\r\n            month = utils.parseNumber(month);\r\n            day = utils.parseNumber(day);\r\n            if (utils.anyIsError(year, month, day)) {\r\n                return error.value;\r\n            }\r\n            if (year < 0 || month < 0 || day < 0) {\r\n                return error.num;\r\n            }\r\n            var date = new Date(year, month - 1, day);\r\n            return date;\r\n        };\r\n\r\n        exports.DATEVALUE = function(date_text) {\r\n            if (typeof date_text !== 'string') {\r\n                return error.value;\r\n            }\r\n            var date = Date.parse(date_text);\r\n            if (isNaN(date)) {\r\n                return error.value;\r\n            }\r\n            if (date <= -2203891200000) {\r\n                return (date - d1900) / 86400000 + 1;\r\n            }\r\n            return (date - d1900) / 86400000 + 2;\r\n        };\r\n\r\n        exports.DAY = function(serial_number) {\r\n            var date = utils.parseDate(serial_number);\r\n            if (date instanceof Error) {\r\n                return date;\r\n            }\r\n            return date.getDate();\r\n        };\r\n\r\n        exports.DAYS = function(end_date, start_date) {\r\n            end_date = utils.parseDate(end_date);\r\n            start_date = utils.parseDate(start_date);\r\n            if (end_date instanceof Error) {\r\n                return end_date;\r\n            }\r\n            if (start_date instanceof Error) {\r\n                return start_date;\r\n            }\r\n            return serial(end_date) - serial(start_date);\r\n        };\r\n\r\n        exports.DAYS360 = function(start_date, end_date, method) {\r\n        };\r\n\r\n        exports.EDATE = function(start_date, months) {\r\n            start_date = utils.parseDate(start_date);\r\n            if (start_date instanceof Error) {\r\n                return start_date;\r\n            }\r\n            if (isNaN(months)) {\r\n                return error.value;\r\n            }\r\n            months = parseInt(months, 10);\r\n            start_date.setMonth(start_date.getMonth() + months);\r\n            return serial(start_date);\r\n        };\r\n\r\n        exports.EOMONTH = function(start_date, months) {\r\n            start_date = utils.parseDate(start_date);\r\n            if (start_date instanceof Error) {\r\n                return start_date;\r\n            }\r\n            if (isNaN(months)) {\r\n                return error.value;\r\n            }\r\n            months = parseInt(months, 10);\r\n            return serial(new Date(start_date.getFullYear(), start_date.getMonth() + months + 1, 0));\r\n        };\r\n\r\n        exports.HOUR = function(serial_number) {\r\n            serial_number = utils.parseDate(serial_number);\r\n            if (serial_number instanceof Error) {\r\n                return serial_number;\r\n            }\r\n            return serial_number.getHours();\r\n        };\r\n\r\n        exports.INTERVAL = function(second) {\r\n            if (typeof second !== 'number' && typeof second !== 'string') {\r\n                return error.value;\r\n            } else {\r\n                second = parseInt(second, 10);\r\n            }\r\n\r\n            var year  = Math.floor(second/946080000);\r\n            second    = second%946080000;\r\n            var month = Math.floor(second/2592000);\r\n            second    = second%2592000;\r\n            var day   = Math.floor(second/86400);\r\n            second    = second%86400;\r\n\r\n            var hour  = Math.floor(second/3600);\r\n            second    = second%3600;\r\n            var min   = Math.floor(second/60);\r\n            second    = second%60;\r\n            var sec   = second;\r\n\r\n            year  = (year  > 0) ? year  + 'Y' : '';\r\n            month = (month > 0) ? month + 'M' : '';\r\n            day   = (day   > 0) ? day   + 'D' : '';\r\n            hour  = (hour  > 0) ? hour  + 'H' : '';\r\n            min   = (min   > 0) ? min   + 'M' : '';\r\n            sec   = (sec   > 0) ? sec   + 'S' : '';\r\n\r\n            return 'P' + year + month + day + 'T' + hour + min + sec;\r\n        };\r\n\r\n        exports.ISOWEEKNUM = function(date) {\r\n            date = utils.parseDate(date);\r\n            if (date instanceof Error) {\r\n                return date;\r\n            }\r\n\r\n            date.setHours(0, 0, 0);\r\n            date.setDate(date.getDate() + 4 - (date.getDay() || 7));\r\n            var yearStart = new Date(date.getFullYear(), 0, 1);\r\n            return Math.ceil((((date - yearStart) / 86400000) + 1) / 7);\r\n        };\r\n\r\n        exports.MINUTE = function(serial_number) {\r\n            serial_number = utils.parseDate(serial_number);\r\n            if (serial_number instanceof Error) {\r\n                return serial_number;\r\n            }\r\n            return serial_number.getMinutes();\r\n        };\r\n\r\n        exports.MONTH = function(serial_number) {\r\n            serial_number = utils.parseDate(serial_number);\r\n            if (serial_number instanceof Error) {\r\n                return serial_number;\r\n            }\r\n            return serial_number.getMonth() + 1;\r\n        };\r\n\r\n        exports.NETWORKDAYS = function(start_date, end_date, holidays) {\r\n        };\r\n\r\n        exports.NETWORKDAYS.INTL = function(start_date, end_date, weekend, holidays) {\r\n        };\r\n\r\n        exports.NOW = function() {\r\n            return new Date();\r\n        };\r\n\r\n        exports.SECOND = function(serial_number) {\r\n            serial_number = utils.parseDate(serial_number);\r\n            if (serial_number instanceof Error) {\r\n                return serial_number;\r\n            }\r\n            return serial_number.getSeconds();\r\n        };\r\n\r\n        exports.TIME = function(hour, minute, second) {\r\n            hour = utils.parseNumber(hour);\r\n            minute = utils.parseNumber(minute);\r\n            second = utils.parseNumber(second);\r\n            if (utils.anyIsError(hour, minute, second)) {\r\n                return error.value;\r\n            }\r\n            if (hour < 0 || minute < 0 || second < 0) {\r\n                return error.num;\r\n            }\r\n            return (3600 * hour + 60 * minute + second) / 86400;\r\n        };\r\n\r\n        exports.TIMEVALUE = function(time_text) {\r\n            time_text = utils.parseDate(time_text);\r\n            if (time_text instanceof Error) {\r\n                return time_text;\r\n            }\r\n            return (3600 * time_text.getHours() + 60 * time_text.getMinutes() + time_text.getSeconds()) / 86400;\r\n        };\r\n\r\n        exports.TODAY = function() {\r\n            return new Date();\r\n        };\r\n\r\n        exports.WEEKDAY = function(serial_number, return_type) {\r\n            serial_number = utils.parseDate(serial_number);\r\n            if (serial_number instanceof Error) {\r\n                return serial_number;\r\n            }\r\n            if (return_type === undefined) {\r\n                return_type = 1;\r\n            }\r\n            var day = serial_number.getDay();\r\n            return WEEK_TYPES[return_type][day];\r\n        };\r\n\r\n        exports.WEEKNUM = function(serial_number, return_type) {\r\n        };\r\n\r\n        exports.WORKDAY = function(start_date, days, holidays) {\r\n        };\r\n\r\n        exports.WORKDAY.INTL = function(start_date, days, weekend, holidays) {\r\n        };\r\n\r\n        exports.YEAR = function(serial_number) {\r\n            serial_number = utils.parseDate(serial_number);\r\n            if (serial_number instanceof Error) {\r\n                return serial_number;\r\n            }\r\n            return serial_number.getFullYear();\r\n        };\r\n\r\n        function isLeapYear(year) {\r\n            return new Date(year, 1, 29).getMonth() === 1;\r\n        }\r\n\r\n        exports.YEARFRAC = function(start_date, end_date, basis) {\r\n        };\r\n\r\n        function serial(date) {\r\n            var addOn = (date > -2203891200000)?2:1;\r\n            return (date - d1900) / 86400000 + addOn;\r\n        }\r\n\r\n        return exports;\r\n    })();\r\n\r\n    met.database = (function() {\r\n        var exports = {};\r\n\r\n        function compact(array) {\r\n            if (!array) {\r\n                return array;\r\n            }\r\n            var result = [];\r\n            for (var i = 0; i < array.length; ++i) {\r\n                if (!array[i]) {\r\n                    continue;\r\n                }\r\n                result.push(array[i]);\r\n            }\r\n            return result;\r\n        }\r\n\r\n        exports.FINDFIELD = function(database, title) {\r\n            var index = null;\r\n            for (var i = 0; i < database.length; i++) {\r\n                if (database[i][0] === title) {\r\n                    index = i;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            // Return error if the input field title is incorrect\r\n            if (index == null) {\r\n                return error.value;\r\n            }\r\n            return index;\r\n        };\r\n\r\n        function findResultIndex(database, criterias) {\r\n            var matches = {};\r\n            for (var i = 1; i < database[0].length; ++i) {\r\n                matches[i] = true;\r\n            }\r\n            var maxCriteriaLength = criterias[0].length;\r\n            for (i = 1; i < criterias.length; ++i) {\r\n                if (criterias[i].length > maxCriteriaLength) {\r\n                    maxCriteriaLength = criterias[i].length;\r\n                }\r\n            }\r\n\r\n            for (var k = 1; k < database.length; ++k) {\r\n                for (var l = 1; l < database[k].length; ++l) {\r\n                    var currentCriteriaResult = false;\r\n                    var hasMatchingCriteria = false;\r\n                    for (var j = 0; j < criterias.length; ++j) {\r\n                        var criteria = criterias[j];\r\n                        if (criteria.length < maxCriteriaLength) {\r\n                            continue;\r\n                        }\r\n\r\n                        var criteriaField = criteria[0];\r\n                        if (database[k][0] !== criteriaField) {\r\n                            continue;\r\n                        }\r\n                        hasMatchingCriteria = true;\r\n                        for (var p = 1; p < criteria.length; ++p) {\r\n                            currentCriteriaResult = currentCriteriaResult\r\n                                || eval(database[k][l] + criteria[p]); // jshint\r\n                            // ignore:line\r\n                        }\r\n                    }\r\n                    if (hasMatchingCriteria) {\r\n                        matches[l] = matches[l] && currentCriteriaResult;\r\n                    }\r\n                }\r\n            }\r\n\r\n            var result = [];\r\n            for (var n = 0; n < database[0].length; ++n) {\r\n                if (matches[n]) {\r\n                    result.push(n - 1);\r\n                }\r\n            }\r\n            return result;\r\n        }\r\n\r\n        // Database functions\r\n        exports.DAVERAGE = function(database, field, criteria) {\r\n            // Return error if field is not a number and not a string\r\n            if (isNaN(field) && (typeof field !== \"string\")) {\r\n                return error.value;\r\n            }\r\n            var resultIndexes = findResultIndex(database, criteria);\r\n            var targetFields = [];\r\n            if (typeof field === \"string\") {\r\n                var index = exports.FINDFIELD(database, field);\r\n                targetFields = utils.rest(database[index]);\r\n            } else {\r\n                targetFields = utils.rest(database[field]);\r\n            }\r\n            var sum = 0;\r\n            for (var i = 0; i < resultIndexes.length; i++) {\r\n                sum += targetFields[resultIndexes[i]];\r\n            }\r\n            return resultIndexes.length === 0 ? error.div0 : sum / resultIndexes.length;\r\n        };\r\n\r\n        exports.DCOUNT = function(database, field, criteria) {\r\n        };\r\n\r\n        exports.DCOUNTA = function(database, field, criteria) {\r\n        };\r\n\r\n        exports.DGET = function(database, field, criteria) {\r\n            // Return error if field is not a number and not a string\r\n            if (isNaN(field) && (typeof field !== \"string\")) {\r\n                return error.value;\r\n            }\r\n            var resultIndexes = findResultIndex(database, criteria);\r\n            var targetFields = [];\r\n            if (typeof field === \"string\") {\r\n                var index = exports.FINDFIELD(database, field);\r\n                targetFields = utils.rest(database[index]);\r\n            } else {\r\n                targetFields = utils.rest(database[field]);\r\n            }\r\n            // Return error if no record meets the criteria\r\n            if (resultIndexes.length === 0) {\r\n                return error.value;\r\n            }\r\n            // Returns the #NUM! error value because more than one record meets the\r\n            // criteria\r\n            if (resultIndexes.length > 1) {\r\n                return error.num;\r\n            }\r\n\r\n            return targetFields[resultIndexes[0]];\r\n        };\r\n\r\n        exports.DMAX = function(database, field, criteria) {\r\n            // Return error if field is not a number and not a string\r\n            if (isNaN(field) && (typeof field !== \"string\")) {\r\n                return error.value;\r\n            }\r\n            var resultIndexes = findResultIndex(database, criteria);\r\n            var targetFields = [];\r\n            if (typeof field === \"string\") {\r\n                var index = exports.FINDFIELD(database, field);\r\n                targetFields = utils.rest(database[index]);\r\n            } else {\r\n                targetFields = utils.rest(database[field]);\r\n            }\r\n            var maxValue = targetFields[resultIndexes[0]];\r\n            for (var i = 1; i < resultIndexes.length; i++) {\r\n                if (maxValue < targetFields[resultIndexes[i]]) {\r\n                    maxValue = targetFields[resultIndexes[i]];\r\n                }\r\n            }\r\n            return maxValue;\r\n        };\r\n\r\n        exports.DMIN = function(database, field, criteria) {\r\n            // Return error if field is not a number and not a string\r\n            if (isNaN(field) && (typeof field !== \"string\")) {\r\n                return error.value;\r\n            }\r\n            var resultIndexes = findResultIndex(database, criteria);\r\n            var targetFields = [];\r\n            if (typeof field === \"string\") {\r\n                var index = exports.FINDFIELD(database, field);\r\n                targetFields = utils.rest(database[index]);\r\n            } else {\r\n                targetFields = utils.rest(database[field]);\r\n            }\r\n            var minValue = targetFields[resultIndexes[0]];\r\n            for (var i = 1; i < resultIndexes.length; i++) {\r\n                if (minValue > targetFields[resultIndexes[i]]) {\r\n                    minValue = targetFields[resultIndexes[i]];\r\n                }\r\n            }\r\n            return minValue;\r\n        };\r\n\r\n        exports.DPRODUCT = function(database, field, criteria) {\r\n            // Return error if field is not a number and not a string\r\n            if (isNaN(field) && (typeof field !== \"string\")) {\r\n                return error.value;\r\n            }\r\n            var resultIndexes = findResultIndex(database, criteria);\r\n            var targetFields = [];\r\n            if (typeof field === \"string\") {\r\n                var index = exports.FINDFIELD(database, field);\r\n                targetFields = utils.rest(database[index]);\r\n            } else {\r\n                targetFields = utils.rest(database[field]);\r\n            }\r\n            var targetValues = [];\r\n            for (var i = 0; i < resultIndexes.length; i++) {\r\n                targetValues[i] = targetFields[resultIndexes[i]];\r\n            }\r\n            targetValues = compact(targetValues);\r\n            var result = 1;\r\n            for (i = 0; i < targetValues.length; i++) {\r\n                result *= targetValues[i];\r\n            }\r\n            return result;\r\n        };\r\n\r\n        exports.DSTDEV = function(database, field, criteria) {\r\n        };\r\n\r\n        exports.DSTDEVP = function(database, field, criteria) {\r\n        };\r\n\r\n        exports.DSUM = function(database, field, criteria) {\r\n        };\r\n\r\n        exports.DVAR = function(database, field, criteria) {\r\n        };\r\n\r\n        exports.DVARP = function(database, field, criteria) {\r\n        };\r\n\r\n        exports.MATCH = function(lookupValue, lookupArray, matchType) {\r\n            if (!lookupValue && !lookupArray) {\r\n                return error.na;\r\n            }\r\n            if (arguments.length === 2) {\r\n                matchType = 1;\r\n            }\r\n            if (!(lookupArray instanceof Array)) {\r\n                return error.na;\r\n            }\r\n            if (matchType !== -1 && matchType !== 0 && matchType !== 1) {\r\n                return error.na;\r\n            }\r\n\r\n            var index;\r\n            var indexValue;\r\n\r\n            for (var idx = 0; idx < lookupArray.length; idx++) {\r\n                if (matchType === 1) {\r\n                    if (lookupArray[idx] === lookupValue) {\r\n                        return idx + 1;\r\n                    } else if (lookupArray[idx] < lookupValue) {\r\n                        if (!indexValue) {\r\n                            index = idx + 1;\r\n                            indexValue = lookupArray[idx];\r\n                        } else if (lookupArray[idx] > indexValue) {\r\n                            index = idx + 1;\r\n                            indexValue = lookupArray[idx];\r\n                        }\r\n                    }\r\n                } else if (matchType === 0) {\r\n                    if (typeof lookupValue === 'string') {\r\n                        lookupValue = lookupValue.replace(/\\?/g, '.');\r\n                        if (lookupArray[idx].toLowerCase().match(lookupValue.toLowerCase())) {\r\n                            return idx + 1;\r\n                        }\r\n                    } else {\r\n                        if (lookupArray[idx] === lookupValue) {\r\n                            return idx + 1;\r\n                        }\r\n                    }\r\n                } else if (matchType === -1) {\r\n                    if (lookupArray[idx] === lookupValue) {\r\n                        return idx + 1;\r\n                    } else if (lookupArray[idx] > lookupValue) {\r\n                        if (!indexValue) {\r\n                            index = idx + 1;\r\n                            indexValue = lookupArray[idx];\r\n                        } else if (lookupArray[idx] < indexValue) {\r\n                            index = idx + 1;\r\n                            indexValue = lookupArray[idx];\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            return index ? index : error.na;\r\n        };\r\n\r\n        return exports;\r\n    })();\r\n\r\n    met.engineering = (function() {\r\n        var exports = {};\r\n\r\n        function isValidBinaryNumber(number) {\r\n            return (/^[01]{1,10}$/).test(number);\r\n        }\r\n\r\n        exports.BESSELI = function(x, n) {\r\n        };\r\n\r\n        exports.BESSELJ = function(x, n) {\r\n        };\r\n\r\n        exports.BESSELK = function(x, n) {\r\n        };\r\n\r\n        exports.BESSELY = function(x, n) {\r\n        };\r\n\r\n        exports.BIN2DEC = function(number) {\r\n            // Return error if number is not binary or contains more than 10\r\n            // characters (10 digits)\r\n            if (!isValidBinaryNumber(number)) {\r\n                return error.num;\r\n            }\r\n\r\n            // Convert binary number to decimal\r\n            var result = parseInt(number, 2);\r\n\r\n            // Handle negative numbers\r\n            var stringified = number.toString();\r\n            if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\r\n                return parseInt(stringified.substring(1), 2) - 512;\r\n            } else {\r\n                return result;\r\n            }\r\n        };\r\n\r\n        exports.BIN2HEX = function(number, places) {\r\n            // Return error if number is not binary or contains more than 10\r\n            // characters (10 digits)\r\n            if (!isValidBinaryNumber(number)) {\r\n                return error.num;\r\n            }\r\n\r\n            // Ignore places and return a 10-character hexadecimal number if number\r\n            // is negative\r\n            var stringified = number.toString();\r\n            if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\r\n                return (1099511627264 + parseInt(stringified.substring(1), 2)).toString(16);\r\n            }\r\n\r\n            // Convert binary number to hexadecimal\r\n            var result = parseInt(number, 2).toString(16);\r\n\r\n            // Return hexadecimal number using the minimum number of characters\r\n            // necessary if places is undefined\r\n            if (places === undefined) {\r\n                return result;\r\n            } else {\r\n                // Return error if places is nonnumeric\r\n                if (isNaN(places)) {\r\n                    return error.value;\r\n                }\r\n\r\n                // Return error if places is negative\r\n                if (places < 0) {\r\n                    return error.num;\r\n                }\r\n\r\n                // Truncate places in case it is not an integer\r\n                places = Math.floor(places);\r\n\r\n                // Pad return value with leading 0s (zeros) if necessary (using\r\n                // Underscore.string)\r\n                return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n            }\r\n        };\r\n\r\n        exports.BIN2OCT = function(number, places) {\r\n            // Return error if number is not binary or contains more than 10\r\n            // characters (10 digits)\r\n            if (!isValidBinaryNumber(number)) {\r\n                return error.num;\r\n            }\r\n\r\n            // Ignore places and return a 10-character octal number if number is\r\n            // negative\r\n            var stringified = number.toString();\r\n            if (stringified.length === 10 && stringified.substring(0, 1) === '1') {\r\n                return (1073741312 + parseInt(stringified.substring(1), 2)).toString(8);\r\n            }\r\n\r\n            // Convert binary number to octal\r\n            var result = parseInt(number, 2).toString(8);\r\n\r\n            // Return octal number using the minimum number of characters necessary\r\n            // if places is undefined\r\n            if (places === undefined) {\r\n                return result;\r\n            } else {\r\n                // Return error if places is nonnumeric\r\n                if (isNaN(places)) {\r\n                    return error.value;\r\n                }\r\n\r\n                // Return error if places is negative\r\n                if (places < 0) {\r\n                    return error.num;\r\n                }\r\n\r\n                // Truncate places in case it is not an integer\r\n                places = Math.floor(places);\r\n\r\n                // Pad return value with leading 0s (zeros) if necessary (using\r\n                // Underscore.string)\r\n                return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n            }\r\n        };\r\n\r\n        exports.BITAND = function(number1, number2) {\r\n            // Return error if either number is a non-numeric value\r\n            number1 = utils.parseNumber(number1);\r\n            number2 = utils.parseNumber(number2);\r\n            if (utils.anyIsError(number1, number2)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return error if either number is less than 0\r\n            if (number1 < 0 || number2 < 0) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return error if either number is a non-integer\r\n            if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return error if either number is greater than (2^48)-1\r\n            if (number1 > 281474976710655 || number2 > 281474976710655) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return bitwise AND of two numbers\r\n            return number1 & number2;\r\n        };\r\n\r\n        exports.BITLSHIFT = function(number, shift) {\r\n            number = utils.parseNumber(number);\r\n            shift = utils.parseNumber(shift);\r\n            if (utils.anyIsError(number, shift)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return error if number is less than 0\r\n            if (number < 0) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return error if number is a non-integer\r\n            if (Math.floor(number) !== number) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return error if number is greater than (2^48)-1\r\n            if (number > 281474976710655) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return error if the absolute value of shift is greater than 53\r\n            if (Math.abs(shift) > 53) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return number shifted by shift bits to the left or to the right if\r\n            // shift is negative\r\n            return (shift >= 0) ? number << shift : number >> -shift;\r\n        };\r\n\r\n        exports.BITOR = function(number1, number2) {\r\n            number1 = utils.parseNumber(number1);\r\n            number2 = utils.parseNumber(number2);\r\n            if (utils.anyIsError(number1, number2)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return error if either number is less than 0\r\n            if (number1 < 0 || number2 < 0) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return error if either number is a non-integer\r\n            if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return error if either number is greater than (2^48)-1\r\n            if (number1 > 281474976710655 || number2 > 281474976710655) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return bitwise OR of two numbers\r\n            return number1 | number2;\r\n        };\r\n\r\n        exports.BITRSHIFT = function(number, shift) {\r\n            number = utils.parseNumber(number);\r\n            shift = utils.parseNumber(shift);\r\n            if (utils.anyIsError(number, shift)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return error if number is less than 0\r\n            if (number < 0) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return error if number is a non-integer\r\n            if (Math.floor(number) !== number) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return error if number is greater than (2^48)-1\r\n            if (number > 281474976710655) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return error if the absolute value of shift is greater than 53\r\n            if (Math.abs(shift) > 53) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return number shifted by shift bits to the right or to the left if\r\n            // shift is negative\r\n            return (shift >= 0) ? number >> shift : number << -shift;\r\n        };\r\n\r\n        exports.BITXOR = function(number1, number2) {\r\n            number1 = utils.parseNumber(number1);\r\n            number2 = utils.parseNumber(number2);\r\n            if (utils.anyIsError(number1, number2)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return error if either number is less than 0\r\n            if (number1 < 0 || number2 < 0) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return error if either number is a non-integer\r\n            if (Math.floor(number1) !== number1 || Math.floor(number2) !== number2) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return error if either number is greater than (2^48)-1\r\n            if (number1 > 281474976710655 || number2 > 281474976710655) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return bitwise XOR of two numbers\r\n            return number1 ^ number2;\r\n        };\r\n\r\n        exports.COMPLEX = function(real, imaginary, suffix) {\r\n            real = utils.parseNumber(real);\r\n            imaginary = utils.parseNumber(imaginary);\r\n            if (utils.anyIsError(real, imaginary)) {\r\n                return real;\r\n            }\r\n\r\n            // Set suffix\r\n            suffix = (suffix === undefined) ? 'i' : suffix;\r\n\r\n            // Return error if suffix is neither \"i\" nor \"j\"\r\n            if (suffix !== 'i' && suffix !== 'j') {\r\n                return error.value;\r\n            }\r\n\r\n            // Return complex number\r\n            if (real === 0 && imaginary === 0) {\r\n                return 0;\r\n            } else if (real === 0) {\r\n                return (imaginary === 1) ? suffix : imaginary.toString() + suffix;\r\n            } else if (imaginary === 0) {\r\n                return real.toString();\r\n            } else {\r\n                var sign = (imaginary > 0) ? '+' : '';\r\n                return real.toString() + sign + ((imaginary === 1) ? suffix : imaginary.toString() + suffix);\r\n            }\r\n        };\r\n\r\n        exports.CONVERT = function(number, from_unit, to_unit) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n\r\n            // List of units supported by CONVERT and units defined by the\r\n            // International System of Units\r\n            // [Name, Symbol, Alternate symbols, Quantity, ISU, CONVERT, Conversion\r\n            // ratio]\r\n            var units = [\r\n                [\"a.u. of action\", \"?\", null, \"action\", false, false, 1.05457168181818e-34],\r\n                [\"a.u. of charge\", \"e\", null, \"electric_charge\", false, false, 1.60217653141414e-19],\r\n                [\"a.u. of energy\", \"Eh\", null, \"energy\", false, false, 4.35974417757576e-18],\r\n                [\"a.u. of length\", \"a?\", null, \"length\", false, false, 5.29177210818182e-11],\r\n                [\"a.u. of mass\", \"m?\", null, \"mass\", false, false, 9.10938261616162e-31],\r\n                [\"a.u. of time\", \"?/Eh\", null, \"time\", false, false, 2.41888432650516e-17],\r\n                [\"admiralty knot\", \"admkn\", null, \"speed\", false, true, 0.514773333],\r\n                [\"ampere\", \"A\", null, \"electric_current\", true, false, 1],\r\n                [\"ampere per meter\", \"A/m\", null, \"magnetic_field_intensity\", true, false, 1],\r\n                [\"ångström\", \"Å\", [\"ang\"], \"length\", false, true, 1e-10],\r\n                [\"are\", \"ar\", null, \"area\", false, true, 100],\r\n                [\"astronomical unit\", \"ua\", null, \"length\", false, false, 1.49597870691667e-11],\r\n                [\"bar\", \"bar\", null, \"pressure\", false, false, 100000],\r\n                [\"barn\", \"b\", null, \"area\", false, false, 1e-28],\r\n                [\"becquerel\", \"Bq\", null, \"radioactivity\", true, false, 1],\r\n                [\"bit\", \"bit\", [\"b\"], \"information\", false, true, 1],\r\n                [\"btu\", \"BTU\", [\"btu\"], \"energy\", false, true, 1055.05585262],\r\n                [\"byte\", \"byte\", null, \"information\", false, true, 8],\r\n                [\"candela\", \"cd\", null, \"luminous_intensity\", true, false, 1],\r\n                [\"candela per square metre\", \"cd/m?\", null, \"luminance\", true, false, 1],\r\n                [\"coulomb\", \"C\", null, \"electric_charge\", true, false, 1],\r\n                [\"cubic ångström\", \"ang3\", [\"ang^3\"], \"volume\", false, true, 1e-30],\r\n                [\"cubic foot\", \"ft3\", [\"ft^3\"], \"volume\", false, true, 0.028316846592],\r\n                [\"cubic inch\", \"in3\", [\"in^3\"], \"volume\", false, true, 0.000016387064],\r\n                [\"cubic light-year\", \"ly3\", [\"ly^3\"], \"volume\", false, true, 8.46786664623715e-47],\r\n                [\"cubic metre\", \"m?\", null, \"volume\", true, true, 1],\r\n                [\"cubic mile\", \"mi3\", [\"mi^3\"], \"volume\", false, true, 4168181825.44058],\r\n                [\"cubic nautical mile\", \"Nmi3\", [\"Nmi^3\"], \"volume\", false, true, 6352182208],\r\n                [\"cubic Pica\", \"Pica3\", [\"Picapt3\", \"Pica^3\", \"Picapt^3\"], \"volume\", false, true, 7.58660370370369e-8],\r\n                [\"cubic yard\", \"yd3\", [\"yd^3\"], \"volume\", false, true, 0.764554857984],\r\n                [\"cup\", \"cup\", null, \"volume\", false, true, 0.0002365882365],\r\n                [\"dalton\", \"Da\", [\"u\"], \"mass\", false, false, 1.66053886282828e-27],\r\n                [\"day\", \"d\", [\"day\"], \"time\", false, true, 86400],\r\n                [\"degree\", \"°\", null, \"angle\", false, false, 0.0174532925199433],\r\n                [\"degrees Rankine\", \"Rank\", null, \"temperature\", false, true, 0.555555555555556],\r\n                [\"dyne\", \"dyn\", [\"dy\"], \"force\", false, true, 0.00001],\r\n                [\"electronvolt\", \"eV\", [\"ev\"], \"energy\", false, true, 1.60217656514141],\r\n                [\"ell\", \"ell\", null, \"length\", false, true, 1.143],\r\n                [\"erg\", \"erg\", [\"e\"], \"energy\", false, true, 1e-7],\r\n                [\"farad\", \"F\", null, \"electric_capacitance\", true, false, 1],\r\n                [\"fluid ounce\", \"oz\", null, \"volume\", false, true, 0.0000295735295625],\r\n                [\"foot\", \"ft\", null, \"length\", false, true, 0.3048],\r\n                [\"foot-pound\", \"flb\", null, \"energy\", false, true, 1.3558179483314],\r\n                [\"gal\", \"Gal\", null, \"acceleration\", false, false, 0.01],\r\n                [\"gallon\", \"gal\", null, \"volume\", false, true, 0.003785411784],\r\n                [\"gauss\", \"G\", [\"ga\"], \"magnetic_flux_density\", false, true, 1],\r\n                [\"grain\", \"grain\", null, \"mass\", false, true, 0.0000647989],\r\n                [\"gram\", \"g\", null, \"mass\", false, true, 0.001],\r\n                [\"gray\", \"Gy\", null, \"absorbed_dose\", true, false, 1],\r\n                [\"gross registered ton\", \"GRT\", [\"regton\"], \"volume\", false, true, 2.8316846592],\r\n                [\"hectare\", \"ha\", null, \"area\", false, true, 10000],\r\n                [\"henry\", \"H\", null, \"inductance\", true, false, 1],\r\n                [\"hertz\", \"Hz\", null, \"frequency\", true, false, 1],\r\n                [\"horsepower\", \"HP\", [\"h\"], \"power\", false, true, 745.69987158227],\r\n                [\"horsepower-hour\", \"HPh\", [\"hh\", \"hph\"], \"energy\", false, true, 2684519.538],\r\n                [\"hour\", \"h\", [\"hr\"], \"time\", false, true, 3600],\r\n                [\"imperial gallon (U.K.)\", \"uk_gal\", null, \"volume\", false, true, 0.00454609],\r\n                [\"imperial hundredweight\", \"lcwt\", [\"uk_cwt\", \"hweight\"], \"mass\", false, true, 50.802345],\r\n                [\"imperial quart (U.K)\", \"uk_qt\", null, \"volume\", false, true, 0.0011365225],\r\n                [\"imperial ton\", \"brton\", [\"uk_ton\", \"LTON\"], \"mass\", false, true, 1016.046909],\r\n                [\"inch\", \"in\", null, \"length\", false, true, 0.0254],\r\n                [\"international acre\", \"uk_acre\", null, \"area\", false, true, 4046.8564224],\r\n                [\"IT calorie\", \"cal\", null, \"energy\", false, true, 4.1868],\r\n                [\"joule\", \"J\", null, \"energy\", true, true, 1],\r\n                [\"katal\", \"kat\", null, \"catalytic_activity\", true, false, 1],\r\n                [\"kelvin\", \"K\", [\"kel\"], \"temperature\", true, true, 1],\r\n                [\"kilogram\", \"kg\", null, \"mass\", true, true, 1],\r\n                [\"knot\", \"kn\", null, \"speed\", false, true, 0.514444444444444],\r\n                [\"light-year\", \"ly\", null, \"length\", false, true, 9460730472580800],\r\n                [\"litre\", \"L\", [\"l\", \"lt\"], \"volume\", false, true, 0.001],\r\n                [\"lumen\", \"lm\", null, \"luminous_flux\", true, false, 1],\r\n                [\"lux\", \"lx\", null, \"illuminance\", true, false, 1],\r\n                [\"maxwell\", \"Mx\", null, \"magnetic_flux\", false, false, 1e-18],\r\n                [\"measurement ton\", \"MTON\", null, \"volume\", false, true, 1.13267386368],\r\n                [\"meter per hour\", \"m/h\", [\"m/hr\"], \"speed\", false, true, 0.00027777777777778],\r\n                [\"meter per second\", \"m/s\", [\"m/sec\"], \"speed\", true, true, 1],\r\n                [\"meter per second squared\", \"m?s??\", null, \"acceleration\", true, false, 1],\r\n                [\"parsec\", \"pc\", [\"parsec\"], \"length\", false, true, 30856775814671900],\r\n                [\"meter squared per second\", \"m?/s\", null, \"kinematic_viscosity\", true, false, 1],\r\n                [\"metre\", \"m\", null, \"length\", true, true, 1],\r\n                [\"miles per hour\", \"mph\", null, \"speed\", false, true, 0.44704],\r\n                [\"millimetre of mercury\", \"mmHg\", null, \"pressure\", false, false, 133.322],\r\n                [\"minute\", \"?\", null, \"angle\", false, false, 0.000290888208665722],\r\n                [\"minute\", \"min\", [\"mn\"], \"time\", false, true, 60],\r\n                [\"modern teaspoon\", \"tspm\", null, \"volume\", false, true, 0.000005],\r\n                [\"mole\", \"mol\", null, \"amount_of_substance\", true, false, 1],\r\n                [\"morgen\", \"Morgen\", null, \"area\", false, true, 2500],\r\n                [\"n.u. of action\", \"?\", null, \"action\", false, false, 1.05457168181818e-34],\r\n                [\"n.u. of mass\", \"m?\", null, \"mass\", false, false, 9.10938261616162e-31],\r\n                [\"n.u. of speed\", \"c?\", null, \"speed\", false, false, 299792458],\r\n                [\"n.u. of time\", \"?/(me?c??)\", null, \"time\", false, false, 1.28808866778687e-21],\r\n                [\"nautical mile\", \"M\", [\"Nmi\"], \"length\", false, true, 1852],\r\n                [\"newton\", \"N\", null, \"force\", true, true, 1],\r\n                [\"œrsted\", \"Oe \", null, \"magnetic_field_intensity\", false, false, 79.5774715459477],\r\n                [\"ohm\", \"Ω\", null, \"electric_resistance\", true, false, 1],\r\n                [\"ounce mass\", \"ozm\", null, \"mass\", false, true, 0.028349523125],\r\n                [\"pascal\", \"Pa\", null, \"pressure\", true, false, 1],\r\n                [\"pascal second\", \"Pa?s\", null, \"dynamic_viscosity\", true, false, 1],\r\n                [\"pferdestärke\", \"PS\", null, \"power\", false, true, 735.49875],\r\n                [\"phot\", \"ph\", null, \"illuminance\", false, false, 0.0001],\r\n                [\"pica (1/6 inch)\", \"pica\", null, \"length\", false, true, 0.00035277777777778],\r\n                [\"pica (1/72 inch)\", \"Pica\", [\"Picapt\"], \"length\", false, true, 0.00423333333333333],\r\n                [\"poise\", \"P\", null, \"dynamic_viscosity\", false, false, 0.1],\r\n                [\"pond\", \"pond\", null, \"force\", false, true, 0.00980665],\r\n                [\"pound force\", \"lbf\", null, \"force\", false, true, 4.4482216152605],\r\n                [\"pound mass\", \"lbm\", null, \"mass\", false, true, 0.45359237],\r\n                [\"quart\", \"qt\", null, \"volume\", false, true, 0.000946352946],\r\n                [\"radian\", \"rad\", null, \"angle\", true, false, 1],\r\n                [\"second\", \"?\", null, \"angle\", false, false, 0.00000484813681109536],\r\n                [\"second\", \"s\", [\"sec\"], \"time\", true, true, 1],\r\n                [\"short hundredweight\", \"cwt\", [\"shweight\"], \"mass\", false, true, 45.359237],\r\n                [\"siemens\", \"S\", null, \"electrical_conductance\", true, false, 1],\r\n                [\"sievert\", \"Sv\", null, \"equivalent_dose\", true, false, 1],\r\n                [\"slug\", \"sg\", null, \"mass\", false, true, 14.59390294],\r\n                [\"square ångström\", \"ang2\", [\"ang^2\"], \"area\", false, true, 1e-20],\r\n                [\"square foot\", \"ft2\", [\"ft^2\"], \"area\", false, true, 0.09290304],\r\n                [\"square inch\", \"in2\", [\"in^2\"], \"area\", false, true, 0.00064516],\r\n                [\"square light-year\", \"ly2\", [\"ly^2\"], \"area\", false, true, 8.95054210748189e+31],\r\n                [\"square meter\", \"m?\", null, \"area\", true, true, 1],\r\n                [\"square mile\", \"mi2\", [\"mi^2\"], \"area\", false, true, 2589988.110336],\r\n                [\"square nautical mile\", \"Nmi2\", [\"Nmi^2\"], \"area\", false, true, 3429904],\r\n                [\"square Pica\", \"Pica2\", [\"Picapt2\", \"Pica^2\", \"Picapt^2\"], \"area\", false, true, 0.00001792111111111],\r\n                [\"square yard\", \"yd2\", [\"yd^2\"], \"area\", false, true, 0.83612736],\r\n                [\"statute mile\", \"mi\", null, \"length\", false, true, 1609.344],\r\n                [\"steradian\", \"sr\", null, \"solid_angle\", true, false, 1],\r\n                [\"stilb\", \"sb\", null, \"luminance\", false, false, 0.0001],\r\n                [\"stokes\", \"St\", null, \"kinematic_viscosity\", false, false, 0.0001],\r\n                [\"stone\", \"stone\", null, \"mass\", false, true, 6.35029318],\r\n                [\"tablespoon\", \"tbs\", null, \"volume\", false, true, 0.0000147868],\r\n                [\"teaspoon\", \"tsp\", null, \"volume\", false, true, 0.00000492892],\r\n                [\"tesla\", \"T\", null, \"magnetic_flux_density\", true, true, 1],\r\n                [\"thermodynamic calorie\", \"c\", null, \"energy\", false, true, 4.184],\r\n                [\"ton\", \"ton\", null, \"mass\", false, true, 907.18474],\r\n                [\"tonne\", \"t\", null, \"mass\", false, false, 1000],\r\n                [\"U.K. pint\", \"uk_pt\", null, \"volume\", false, true, 0.00056826125],\r\n                [\"U.S. bushel\", \"bushel\", null, \"volume\", false, true, 0.03523907],\r\n                [\"U.S. oil barrel\", \"barrel\", null, \"volume\", false, true, 0.158987295],\r\n                [\"U.S. pint\", \"pt\", [\"us_pt\"], \"volume\", false, true, 0.000473176473],\r\n                [\"U.S. survey mile\", \"survey_mi\", null, \"length\", false, true, 1609.347219],\r\n                [\"U.S. survey/statute acre\", \"us_acre\", null, \"area\", false, true, 4046.87261],\r\n                [\"volt\", \"V\", null, \"voltage\", true, false, 1],\r\n                [\"watt\", \"W\", null, \"power\", true, true, 1],\r\n                [\"watt-hour\", \"Wh\", [\"wh\"], \"energy\", false, true, 3600],\r\n                [\"weber\", \"Wb\", null, \"magnetic_flux\", true, false, 1],\r\n                [\"yard\", \"yd\", null, \"length\", false, true, 0.9144],\r\n                [\"year\", \"yr\", null, \"time\", false, true, 31557600]\r\n            ];\r\n\r\n            // Binary prefixes\r\n            // [Name, Prefix power of 2 value, Previx value, Abbreviation, Derived\r\n            // from]\r\n            var binary_prefixes = {\r\n                Yi: [\"yobi\", 80, 1208925819614629174706176, \"Yi\", \"yotta\"],\r\n                Zi: [\"zebi\", 70, 1180591620717411303424, \"Zi\", \"zetta\"],\r\n                Ei: [\"exbi\", 60, 1152921504606846976, \"Ei\", \"exa\"],\r\n                Pi: [\"pebi\", 50, 1125899906842624, \"Pi\", \"peta\"],\r\n                Ti: [\"tebi\", 40, 1099511627776, \"Ti\", \"tera\"],\r\n                Gi: [\"gibi\", 30, 1073741824, \"Gi\", \"giga\"],\r\n                Mi: [\"mebi\", 20, 1048576, \"Mi\", \"mega\"],\r\n                ki: [\"kibi\", 10, 1024, \"ki\", \"kilo\"]\r\n            };\r\n\r\n            // Unit prefixes\r\n            // [Name, Multiplier, Abbreviation]\r\n            var unit_prefixes = {\r\n                Y: [\"yotta\", 1e+24, \"Y\"],\r\n                Z: [\"zetta\", 1e+21, \"Z\"],\r\n                E: [\"exa\", 1e+18, \"E\"],\r\n                P: [\"peta\", 1e+15, \"P\"],\r\n                T: [\"tera\", 1e+12, \"T\"],\r\n                G: [\"giga\", 1e+09, \"G\"],\r\n                M: [\"mega\", 1e+06, \"M\"],\r\n                k: [\"kilo\", 1e+03, \"k\"],\r\n                h: [\"hecto\", 1e+02, \"h\"],\r\n                e: [\"dekao\", 1e+01, \"e\"],\r\n                d: [\"deci\", 1e-01, \"d\"],\r\n                c: [\"centi\", 1e-02, \"c\"],\r\n                m: [\"milli\", 1e-03, \"m\"],\r\n                u: [\"micro\", 1e-06, \"u\"],\r\n                n: [\"nano\", 1e-09, \"n\"],\r\n                p: [\"pico\", 1e-12, \"p\"],\r\n                f: [\"femto\", 1e-15, \"f\"],\r\n                a: [\"atto\", 1e-18, \"a\"],\r\n                z: [\"zepto\", 1e-21, \"z\"],\r\n                y: [\"yocto\", 1e-24, \"y\"]\r\n            };\r\n\r\n            // Initialize units and multipliers\r\n            var from = null;\r\n            var to = null;\r\n            var base_from_unit = from_unit;\r\n            var base_to_unit = to_unit;\r\n            var from_multiplier = 1;\r\n            var to_multiplier = 1;\r\n            var alt;\r\n\r\n            // Lookup from and to units\r\n            for (var i = 0; i < units.length; i++) {\r\n                alt = (units[i][2] === null) ? [] : units[i][2];\r\n                if (units[i][1] === base_from_unit || alt.indexOf(base_from_unit) >= 0) {\r\n                    from = units[i];\r\n                }\r\n                if (units[i][1] === base_to_unit || alt.indexOf(base_to_unit) >= 0) {\r\n                    to = units[i];\r\n                }\r\n            }\r\n\r\n            // Lookup from prefix\r\n            if (from === null) {\r\n                var from_binary_prefix = binary_prefixes[from_unit.substring(0, 2)];\r\n                var from_unit_prefix = unit_prefixes[from_unit.substring(0, 1)];\r\n\r\n                // Handle dekao unit prefix (only unit prefix with two characters)\r\n                if (from_unit.substring(0, 2) === 'da') {\r\n                    from_unit_prefix = [\"dekao\", 1e+01, \"da\"];\r\n                }\r\n\r\n                // Handle binary prefixes first (so that 'Yi' is processed before\r\n                // 'Y')\r\n                if (from_binary_prefix) {\r\n                    from_multiplier = from_binary_prefix[2];\r\n                    base_from_unit = from_unit.substring(2);\r\n                } else if (from_unit_prefix) {\r\n                    from_multiplier = from_unit_prefix[1];\r\n                    base_from_unit = from_unit.substring(from_unit_prefix[2].length);\r\n                }\r\n\r\n                // Lookup from unit\r\n                for (var j = 0; j < units.length; j++) {\r\n                    alt = (units[j][2] === null) ? [] : units[j][2];\r\n                    if (units[j][1] === base_from_unit || alt.indexOf(base_from_unit) >= 0) {\r\n                        from = units[j];\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Lookup to prefix\r\n            if (to === null) {\r\n                var to_binary_prefix = binary_prefixes[to_unit.substring(0, 2)];\r\n                var to_unit_prefix = unit_prefixes[to_unit.substring(0, 1)];\r\n\r\n                // Handle dekao unit prefix (only unit prefix with two characters)\r\n                if (to_unit.substring(0, 2) === 'da') {\r\n                    to_unit_prefix = [\"dekao\", 1e+01, \"da\"];\r\n                }\r\n\r\n                // Handle binary prefixes first (so that 'Yi' is processed before\r\n                // 'Y')\r\n                if (to_binary_prefix) {\r\n                    to_multiplier = to_binary_prefix[2];\r\n                    base_to_unit = to_unit.substring(2);\r\n                } else if (to_unit_prefix) {\r\n                    to_multiplier = to_unit_prefix[1];\r\n                    base_to_unit = to_unit.substring(to_unit_prefix[2].length);\r\n                }\r\n\r\n                // Lookup to unit\r\n                for (var k = 0; k < units.length; k++) {\r\n                    alt = (units[k][2] === null) ? [] : units[k][2];\r\n                    if (units[k][1] === base_to_unit || alt.indexOf(base_to_unit) >= 0) {\r\n                        to = units[k];\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Return error if a unit does not exist\r\n            if (from === null || to === null) {\r\n                return error.na;\r\n            }\r\n\r\n            // Return error if units represent different quantities\r\n            if (from[3] !== to[3]) {\r\n                return error.na;\r\n            }\r\n\r\n            // Return converted number\r\n            return number * from[6] * from_multiplier / (to[6] * to_multiplier);\r\n        };\r\n\r\n        exports.DEC2BIN = function(number, places) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n\r\n            // Return error if number is not decimal, is lower than -512, or is\r\n            // greater than 511\r\n            if (!/^-?[0-9]{1,3}$/.test(number) || number < -512 || number > 511) {\r\n                return error.num;\r\n            }\r\n\r\n            // Ignore places and return a 10-character binary number if number is\r\n            // negative\r\n            if (number < 0) {\r\n                return '1' + REPT('0', 9 - (512 + number).toString(2).length) + (512 + number).toString(2);\r\n            }\r\n\r\n            // Convert decimal number to binary\r\n            var result = parseInt(number, 10).toString(2);\r\n\r\n            // Return binary number using the minimum number of characters necessary\r\n            // if places is undefined\r\n            if (typeof places === 'undefined') {\r\n                return result;\r\n            } else {\r\n                // Return error if places is nonnumeric\r\n                if (isNaN(places)) {\r\n                    return error.value;\r\n                }\r\n\r\n                // Return error if places is negative\r\n                if (places < 0) {\r\n                    return error.num;\r\n                }\r\n\r\n                // Truncate places in case it is not an integer\r\n                places = Math.floor(places);\r\n\r\n                // Pad return value with leading 0s (zeros) if necessary (using\r\n                // Underscore.string)\r\n                return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n            }\r\n        };\r\n\r\n        exports.DEC2HEX = function(number, places) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n\r\n            // Return error if number is not decimal, is lower than -549755813888,\r\n            // or is greater than 549755813887\r\n            if (!/^-?[0-9]{1,12}$/.test(number) || number < -549755813888 || number > 549755813887) {\r\n                return error.num;\r\n            }\r\n\r\n            // Ignore places and return a 10-character hexadecimal number if number\r\n            // is negative\r\n            if (number < 0) {\r\n                return (1099511627776 + number).toString(16);\r\n            }\r\n\r\n            // Convert decimal number to hexadecimal\r\n            var result = parseInt(number, 10).toString(16);\r\n\r\n            // Return hexadecimal number using the minimum number of characters\r\n            // necessary if places is undefined\r\n            if (typeof places === 'undefined') {\r\n                return result;\r\n            } else {\r\n                // Return error if places is nonnumeric\r\n                if (isNaN(places)) {\r\n                    return error.value;\r\n                }\r\n\r\n                // Return error if places is negative\r\n                if (places < 0) {\r\n                    return error.num;\r\n                }\r\n\r\n                // Truncate places in case it is not an integer\r\n                places = Math.floor(places);\r\n\r\n                // Pad return value with leading 0s (zeros) if necessary (using\r\n                // Underscore.string)\r\n                return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n            }\r\n        };\r\n\r\n        exports.DEC2OCT = function(number, places) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n\r\n            // Return error if number is not decimal, is lower than -549755813888,\r\n            // or is greater than 549755813887\r\n            if (!/^-?[0-9]{1,9}$/.test(number) || number < -536870912 || number > 536870911) {\r\n                return error.num;\r\n            }\r\n\r\n            // Ignore places and return a 10-character octal number if number is\r\n            // negative\r\n            if (number < 0) {\r\n                return (1073741824 + number).toString(8);\r\n            }\r\n\r\n            // Convert decimal number to octal\r\n            var result = parseInt(number, 10).toString(8);\r\n\r\n            // Return octal number using the minimum number of characters necessary\r\n            // if places is undefined\r\n            if (typeof places === 'undefined') {\r\n                return result;\r\n            } else {\r\n                // Return error if places is nonnumeric\r\n                if (isNaN(places)) {\r\n                    return error.value;\r\n                }\r\n\r\n                // Return error if places is negative\r\n                if (places < 0) {\r\n                    return error.num;\r\n                }\r\n\r\n                // Truncate places in case it is not an integer\r\n                places = Math.floor(places);\r\n\r\n                // Pad return value with leading 0s (zeros) if necessary (using\r\n                // Underscore.string)\r\n                return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n            }\r\n        };\r\n\r\n        exports.DELTA = function(number1, number2) {\r\n            // Set number2 to zero if undefined\r\n            number2 = (number2 === undefined) ? 0 : number2;\r\n            number1 = utils.parseNumber(number1);\r\n            number2 = utils.parseNumber(number2);\r\n            if (utils.anyIsError(number1, number2)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return delta\r\n            return (number1 === number2) ? 1 : 0;\r\n        };\r\n\r\n        exports.ERF = function(lower_bound, upper_bound) {\r\n        };\r\n\r\n        exports.ERF.PRECISE = function() {\r\n        };\r\n\r\n        exports.ERFC = function(x) {\r\n        };\r\n\r\n        exports.ERFC.PRECISE = function() {\r\n        };\r\n\r\n        exports.GESTEP = function(number, step) {\r\n            step = step || 0;\r\n            number = utils.parseNumber(number);\r\n            if (utils.anyIsError(step, number)) {\r\n                return number;\r\n            }\r\n\r\n            // Return delta\r\n            return (number >= step) ? 1 : 0;\r\n        };\r\n\r\n        exports.HEX2BIN = function(number, places) {\r\n            // Return error if number is not hexadecimal or contains more than ten\r\n            // characters (10 digits)\r\n            if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\r\n                return error.num;\r\n            }\r\n\r\n            // Check if number is negative\r\n            var negative = (number.length === 10 && number.substring(0, 1).toLowerCase() === 'f') ? true : false;\r\n\r\n            // Convert hexadecimal number to decimal\r\n            var decimal = (negative) ? parseInt(number, 16) - 1099511627776 : parseInt(number, 16);\r\n\r\n            // Return error if number is lower than -512 or greater than 511\r\n            if (decimal < -512 || decimal > 511) {\r\n                return error.num;\r\n            }\r\n\r\n            // Ignore places and return a 10-character binary number if number is\r\n            // negative\r\n            if (negative) {\r\n                return '1' + REPT('0', 9 - (512 + decimal).toString(2).length) + (512 + decimal).toString(2);\r\n            }\r\n\r\n            // Convert decimal number to binary\r\n            var result = decimal.toString(2);\r\n\r\n            // Return binary number using the minimum number of characters necessary\r\n            // if places is undefined\r\n            if (places === undefined) {\r\n                return result;\r\n            } else {\r\n                // Return error if places is nonnumeric\r\n                if (isNaN(places)) {\r\n                    return error.value;\r\n                }\r\n\r\n                // Return error if places is negative\r\n                if (places < 0) {\r\n                    return error.num;\r\n                }\r\n\r\n                // Truncate places in case it is not an integer\r\n                places = Math.floor(places);\r\n\r\n                // Pad return value with leading 0s (zeros) if necessary (using\r\n                // Underscore.string)\r\n                return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n            }\r\n        };\r\n\r\n        exports.HEX2DEC = function(number) {\r\n            // Return error if number is not hexadecimal or contains more than ten\r\n            // characters (10 digits)\r\n            if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\r\n                return error.num;\r\n            }\r\n\r\n            // Convert hexadecimal number to decimal\r\n            var decimal = parseInt(number, 16);\r\n\r\n            // Return decimal number\r\n            return (decimal >= 549755813888) ? decimal - 1099511627776 : decimal;\r\n        };\r\n\r\n        exports.HEX2OCT = function(number, places) {\r\n            // Return error if number is not hexadecimal or contains more than ten\r\n            // characters (10 digits)\r\n            if (!/^[0-9A-Fa-f]{1,10}$/.test(number)) {\r\n                return error.num;\r\n            }\r\n\r\n            // Convert hexadecimal number to decimal\r\n            var decimal = parseInt(number, 16);\r\n\r\n            // Return error if number is positive and greater than 0x1fffffff\r\n            // (536870911)\r\n            if (decimal > 536870911 && decimal < 1098974756864) {\r\n                return error.num;\r\n            }\r\n\r\n            // Ignore places and return a 10-character octal number if number is\r\n            // negative\r\n            if (decimal >= 1098974756864) {\r\n                return (decimal - 1098437885952).toString(8);\r\n            }\r\n\r\n            // Convert decimal number to octal\r\n            var result = decimal.toString(8);\r\n\r\n            // Return octal number using the minimum number of characters necessary\r\n            // if places is undefined\r\n            if (places === undefined) {\r\n                return result;\r\n            } else {\r\n                // Return error if places is nonnumeric\r\n                if (isNaN(places)) {\r\n                    return error.value;\r\n                }\r\n\r\n                // Return error if places is negative\r\n                if (places < 0) {\r\n                    return error.num;\r\n                }\r\n\r\n                // Truncate places in case it is not an integer\r\n                places = Math.floor(places);\r\n\r\n                // Pad return value with leading 0s (zeros) if necessary (using\r\n                // Underscore.string)\r\n                return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n            }\r\n        };\r\n\r\n        exports.IMABS = function(inumber) {\r\n            // Lookup real and imaginary coefficients using exports.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n\r\n            // Return error if either coefficient is not a number\r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return absolute value of complex number\r\n            return Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2));\r\n        };\r\n\r\n        exports.IMAGINARY = function(inumber) {\r\n            if (inumber === undefined || inumber === true || inumber === false) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return 0 if inumber is equal to 0\r\n            if (inumber === 0 || inumber === '0') {\r\n                return 0;\r\n            }\r\n\r\n            // Handle special cases\r\n            if (['i', 'j'].indexOf(inumber) >= 0) {\r\n                return 1;\r\n            }\r\n\r\n            // Normalize imaginary coefficient\r\n            inumber = inumber.replace('+i', '+1i').replace('-i', '-1i').replace('+j', '+1j').replace('-j', '-1j');\r\n\r\n            // Lookup sign\r\n            var plus = inumber.indexOf('+');\r\n            var minus = inumber.indexOf('-');\r\n            if (plus === 0) {\r\n                plus = inumber.indexOf('+', 1);\r\n            }\r\n\r\n            if (minus === 0) {\r\n                minus = inumber.indexOf('-', 1);\r\n            }\r\n\r\n            // Lookup imaginary unit\r\n            var last = inumber.substring(inumber.length - 1, inumber.length);\r\n            var unit = (last === 'i' || last === 'j');\r\n\r\n            if (plus >= 0 || minus >= 0) {\r\n                // Return error if imaginary unit is neither i nor j\r\n                if (!unit) {\r\n                    return error.num;\r\n                }\r\n\r\n                // Return imaginary coefficient of complex number\r\n                if (plus >= 0) {\r\n                    return (isNaN(inumber.substring(0, plus)) || isNaN(inumber.substring(plus + 1, inumber.length - 1))) ?\r\n                        error.num :\r\n                        Number(inumber.substring(plus + 1, inumber.length - 1));\r\n                } else {\r\n                    return (isNaN(inumber.substring(0, minus)) || isNaN(inumber.substring(minus + 1, inumber.length - 1))) ?\r\n                        error.num :\r\n                        -Number(inumber.substring(minus + 1, inumber.length - 1));\r\n                }\r\n            } else {\r\n                if (unit) {\r\n                    return (isNaN(inumber.substring(0, inumber.length - 1))) ? error.num : inumber.substring(0, inumber.length - 1);\r\n                } else {\r\n                    return (isNaN(inumber)) ? error.num : 0;\r\n                }\r\n            }\r\n        };\r\n\r\n        exports.IMARGUMENT = function(inumber) {\r\n            // Lookup real and imaginary coefficients using exports.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n\r\n            // Return error if either coefficient is not a number\r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return error if inumber is equal to zero\r\n            if (x === 0 && y === 0) {\r\n                return error.div0;\r\n            }\r\n\r\n            // Return PI/2 if x is equal to zero and y is positive\r\n            if (x === 0 && y > 0) {\r\n                return Math.PI / 2;\r\n            }\r\n\r\n            // Return -PI/2 if x is equal to zero and y is negative\r\n            if (x === 0 && y < 0) {\r\n                return -Math.PI / 2;\r\n            }\r\n\r\n            // Return zero if x is negative and y is equal to zero\r\n            if (y === 0 && x > 0) {\r\n                return 0;\r\n            }\r\n\r\n            // Return zero if x is negative and y is equal to zero\r\n            if (y === 0 && x < 0) {\r\n                return -Math.PI;\r\n            }\r\n\r\n            // Return argument of complex number\r\n            if (x > 0) {\r\n                return Math.atan(y / x);\r\n            } else if (x < 0 && y >= 0) {\r\n                return Math.atan(y / x) + Math.PI;\r\n            } else {\r\n                return Math.atan(y / x) - Math.PI;\r\n            }\r\n        };\r\n\r\n        exports.IMCONJUGATE = function(inumber) {\r\n            // Lookup real and imaginary coefficients using exports.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n\r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Lookup imaginary unit\r\n            var unit = inumber.substring(inumber.length - 1);\r\n            unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n            // Return conjugate of complex number\r\n            return (y !== 0) ? exports.COMPLEX(x, -y, unit) : inumber;\r\n        };\r\n\r\n        exports.IMCOS = function(inumber) {\r\n            // Lookup real and imaginary coefficients using exports.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n\r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Lookup imaginary unit\r\n            var unit = inumber.substring(inumber.length - 1);\r\n            unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n            // Return cosine of complex number\r\n            return exports.COMPLEX(Math.cos(x) * (Math.exp(y) + Math.exp(-y)) / 2, -Math.sin(x) * (Math.exp(y) - Math.exp(-y)) / 2, unit);\r\n        };\r\n\r\n        exports.IMCOSH = function(inumber) {\r\n            // Lookup real and imaginary coefficients using exports.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n\r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Lookup imaginary unit\r\n            var unit = inumber.substring(inumber.length - 1);\r\n            unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n            // Return hyperbolic cosine of complex number\r\n            return exports.COMPLEX(Math.cos(y) * (Math.exp(x) + Math.exp(-x)) / 2, Math.sin(y) * (Math.exp(x) - Math.exp(-x)) / 2, unit);\r\n        };\r\n\r\n        exports.IMCOT = function(inumber) {\r\n            // Lookup real and imaginary coefficients using Formula.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n\r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return cotangent of complex number\r\n            return exports.IMDIV(exports.IMCOS(inumber), exports.IMSIN(inumber));\r\n        };\r\n\r\n        exports.IMDIV = function(inumber1, inumber2) {\r\n            // Lookup real and imaginary coefficients using Formula.js\r\n            // [http://formulajs.org]\r\n            var a = exports.IMREAL(inumber1);\r\n            var b = exports.IMAGINARY(inumber1);\r\n            var c = exports.IMREAL(inumber2);\r\n            var d = exports.IMAGINARY(inumber2);\r\n\r\n            if (utils.anyIsError(a, b, c, d)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Lookup imaginary unit\r\n            var unit1 = inumber1.substring(inumber1.length - 1);\r\n            var unit2 = inumber2.substring(inumber2.length - 1);\r\n            var unit = 'i';\r\n            if (unit1 === 'j') {\r\n                unit = 'j';\r\n            } else if (unit2 === 'j') {\r\n                unit = 'j';\r\n            }\r\n\r\n            // Return error if inumber2 is null\r\n            if (c === 0 && d === 0) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return exponential of complex number\r\n            var den = c * c + d * d;\r\n            return exports.COMPLEX((a * c + b * d) / den, (b * c - a * d) / den, unit);\r\n        };\r\n\r\n        exports.IMEXP = function(inumber) {\r\n            // Lookup real and imaginary coefficients using Formula.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n\r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Lookup imaginary unit\r\n            var unit = inumber.substring(inumber.length - 1);\r\n            unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n            // Return exponential of complex number\r\n            var e = Math.exp(x);\r\n            return exports.COMPLEX(e * Math.cos(y), e * Math.sin(y), unit);\r\n        };\r\n\r\n        exports.IMLN = function(inumber) {\r\n            // Lookup real and imaginary coefficients using Formula.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n\r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Lookup imaginary unit\r\n            var unit = inumber.substring(inumber.length - 1);\r\n            unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n            // Return exponential of complex number\r\n            return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)), Math.atan(y / x), unit);\r\n        };\r\n\r\n        exports.IMLOG10 = function(inumber) {\r\n            // Lookup real and imaginary coefficients using Formula.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n\r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Lookup imaginary unit\r\n            var unit = inumber.substring(inumber.length - 1);\r\n            unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n            // Return exponential of complex number\r\n            return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)) / Math.log(10), Math.atan(y / x) / Math.log(10), unit);\r\n        };\r\n\r\n        exports.IMLOG2 = function(inumber) {\r\n            // Lookup real and imaginary coefficients using Formula.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n\r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Lookup imaginary unit\r\n            var unit = inumber.substring(inumber.length - 1);\r\n            unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n            // Return exponential of complex number\r\n            return exports.COMPLEX(Math.log(Math.sqrt(x * x + y * y)) / Math.log(2), Math.atan(y / x) / Math.log(2), unit);\r\n        };\r\n\r\n        exports.IMPOWER = function(inumber, number) {\r\n            number = utils.parseNumber(number);\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n            if (utils.anyIsError(number, x, y)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Lookup imaginary unit\r\n            var unit = inumber.substring(inumber.length - 1);\r\n            unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n            // Calculate power of modulus\r\n            var p = Math.pow(exports.IMABS(inumber), number);\r\n\r\n            // Calculate argument\r\n            var t = exports.IMARGUMENT(inumber);\r\n\r\n            // Return exponential of complex number\r\n            return exports.COMPLEX(p * Math.cos(number * t), p * Math.sin(number * t), unit);\r\n        };\r\n\r\n        exports.IMPRODUCT = function() {\r\n            // Initialize result\r\n            var result = arguments[0];\r\n\r\n            // Loop on all numbers\r\n            for (var i = 1; i < arguments.length; i++) {\r\n                // Lookup coefficients of two complex numbers\r\n                var a = exports.IMREAL(result);\r\n                var b = exports.IMAGINARY(result);\r\n                var c = exports.IMREAL(arguments[i]);\r\n                var d = exports.IMAGINARY(arguments[i]);\r\n\r\n                if (utils.anyIsError(a, b, c, d)) {\r\n                    return error.value;\r\n                }\r\n\r\n                // Complute product of two complex numbers\r\n                result = exports.COMPLEX(a * c - b * d, a * d + b * c);\r\n            }\r\n\r\n            // Return product of complex numbers\r\n            return result;\r\n        };\r\n\r\n        exports.IMREAL = function(inumber) {\r\n            if (inumber === undefined || inumber === true || inumber === false) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return 0 if inumber is equal to 0\r\n            if (inumber === 0 || inumber === '0') {\r\n                return 0;\r\n            }\r\n\r\n            // Handle special cases\r\n            if (['i', '+i', '1i', '+1i', '-i', '-1i', 'j', '+j', '1j', '+1j', '-j', '-1j'].indexOf(inumber) >= 0) {\r\n                return 0;\r\n            }\r\n\r\n            // Lookup sign\r\n            var plus = inumber.indexOf('+');\r\n            var minus = inumber.indexOf('-');\r\n            if (plus === 0) {\r\n                plus = inumber.indexOf('+', 1);\r\n            }\r\n            if (minus === 0) {\r\n                minus = inumber.indexOf('-', 1);\r\n            }\r\n\r\n            // Lookup imaginary unit\r\n            var last = inumber.substring(inumber.length - 1, inumber.length);\r\n            var unit = (last === 'i' || last === 'j');\r\n\r\n            if (plus >= 0 || minus >= 0) {\r\n                // Return error if imaginary unit is neither i nor j\r\n                if (!unit) {\r\n                    return error.num;\r\n                }\r\n\r\n                // Return real coefficient of complex number\r\n                if (plus >= 0) {\r\n                    return (isNaN(inumber.substring(0, plus)) || isNaN(inumber.substring(plus + 1, inumber.length - 1))) ?\r\n                        error.num :\r\n                        Number(inumber.substring(0, plus));\r\n                } else {\r\n                    return (isNaN(inumber.substring(0, minus)) || isNaN(inumber.substring(minus + 1, inumber.length - 1))) ?\r\n                        error.num :\r\n                        Number(inumber.substring(0, minus));\r\n                }\r\n            } else {\r\n                if (unit) {\r\n                    return (isNaN(inumber.substring(0, inumber.length - 1))) ? error.num : 0;\r\n                } else {\r\n                    return (isNaN(inumber)) ? error.num : inumber;\r\n                }\r\n            }\r\n        };\r\n\r\n        exports.IMSEC = function(inumber) {\r\n            // Return error if inumber is a logical value\r\n            if (inumber === true || inumber === false) {\r\n                return error.value;\r\n            }\r\n\r\n            // Lookup real and imaginary coefficients using Formula.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n\r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return secant of complex number\r\n            return exports.IMDIV('1', exports.IMCOS(inumber));\r\n        };\r\n\r\n        exports.IMSECH = function(inumber) {\r\n            // Lookup real and imaginary coefficients using Formula.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n\r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return hyperbolic secant of complex number\r\n            return exports.IMDIV('1', exports.IMCOSH(inumber));\r\n        };\r\n\r\n        exports.IMSIN = function(inumber) {\r\n            // Lookup real and imaginary coefficients using Formula.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n\r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Lookup imaginary unit\r\n            var unit = inumber.substring(inumber.length - 1);\r\n            unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n            // Return sine of complex number\r\n            return exports.COMPLEX(Math.sin(x) * (Math.exp(y) + Math.exp(-y)) / 2, Math.cos(x) * (Math.exp(y) - Math.exp(-y)) / 2, unit);\r\n        };\r\n\r\n        exports.IMSINH = function(inumber) {\r\n            // Lookup real and imaginary coefficients using Formula.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n\r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Lookup imaginary unit\r\n            var unit = inumber.substring(inumber.length - 1);\r\n            unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n            // Return hyperbolic sine of complex number\r\n            return exports.COMPLEX(Math.cos(y) * (Math.exp(x) - Math.exp(-x)) / 2, Math.sin(y) * (Math.exp(x) + Math.exp(-x)) / 2, unit);\r\n        };\r\n\r\n        exports.IMSQRT = function(inumber) {\r\n            // Lookup real and imaginary coefficients using Formula.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n\r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Lookup imaginary unit\r\n            var unit = inumber.substring(inumber.length - 1);\r\n            unit = (unit === 'i' || unit === 'j') ? unit : 'i';\r\n\r\n            // Calculate power of modulus\r\n            var s = Math.sqrt(exports.IMABS(inumber));\r\n\r\n            // Calculate argument\r\n            var t = exports.IMARGUMENT(inumber);\r\n\r\n            // Return exponential of complex number\r\n            return exports.COMPLEX(s * Math.cos(t / 2), s * Math.sin(t / 2), unit);\r\n        };\r\n\r\n        exports.IMCSC = function (inumber) {\r\n            // Return error if inumber is a logical value\r\n            if (inumber === true || inumber === false) {\r\n                return error.value;\r\n            }\r\n\r\n            // Lookup real and imaginary coefficients using Formula.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n\r\n            // Return error if either coefficient is not a number\r\n            if (utils.anyIsError(x, y)) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return cosecant of complex number\r\n            return exports.IMDIV('1', exports.IMSIN(inumber));\r\n        };\r\n\r\n        exports.IMCSCH = function (inumber) {\r\n            // Return error if inumber is a logical value\r\n            if (inumber === true || inumber === false) {\r\n                return error.value;\r\n            }\r\n\r\n            // Lookup real and imaginary coefficients using Formula.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n\r\n            // Return error if either coefficient is not a number\r\n            if (utils.anyIsError(x, y)) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return hyperbolic cosecant of complex number\r\n            return exports.IMDIV('1', exports.IMSINH(inumber));\r\n        };\r\n\r\n        exports.IMSUB = function(inumber1, inumber2) {\r\n            // Lookup real and imaginary coefficients using Formula.js\r\n            // [http://formulajs.org]\r\n            var a = this.IMREAL(inumber1);\r\n            var b = this.IMAGINARY(inumber1);\r\n            var c = this.IMREAL(inumber2);\r\n            var d = this.IMAGINARY(inumber2);\r\n\r\n            if (utils.anyIsError(a, b, c, d)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Lookup imaginary unit\r\n            var unit1 = inumber1.substring(inumber1.length - 1);\r\n            var unit2 = inumber2.substring(inumber2.length - 1);\r\n            var unit = 'i';\r\n            if (unit1 === 'j') {\r\n                unit = 'j';\r\n            } else if (unit2 === 'j') {\r\n                unit = 'j';\r\n            }\r\n\r\n            // Return _ of two complex numbers\r\n            return this.COMPLEX(a - c, b - d, unit);\r\n        };\r\n\r\n        exports.IMSUM = function() {\r\n            var args = utils.flatten(arguments);\r\n\r\n            // Initialize result\r\n            var result = args[0];\r\n\r\n            // Loop on all numbers\r\n            for (var i = 1; i < args.length; i++) {\r\n                // Lookup coefficients of two complex numbers\r\n                var a = this.IMREAL(result);\r\n                var b = this.IMAGINARY(result);\r\n                var c = this.IMREAL(args[i]);\r\n                var d = this.IMAGINARY(args[i]);\r\n\r\n                if (utils.anyIsError(a, b, c, d)) {\r\n                    return error.value;\r\n                }\r\n\r\n                // Complute product of two complex numbers\r\n                result = this.COMPLEX(a + c, b + d);\r\n            }\r\n\r\n            // Return sum of complex numbers\r\n            return result;\r\n        };\r\n\r\n        exports.IMTAN = function(inumber) {\r\n            // Return error if inumber is a logical value\r\n            if (inumber === true || inumber === false) {\r\n                return error.value;\r\n            }\r\n\r\n            // Lookup real and imaginary coefficients using Formula.js\r\n            // [http://formulajs.org]\r\n            var x = exports.IMREAL(inumber);\r\n            var y = exports.IMAGINARY(inumber);\r\n\r\n            if (utils.anyIsError(x, y)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return tangent of complex number\r\n            return this.IMDIV(this.IMSIN(inumber), this.IMCOS(inumber));\r\n        };\r\n\r\n        exports.OCT2BIN = function(number, places) {\r\n            // Return error if number is not hexadecimal or contains more than ten\r\n            // characters (10 digits)\r\n            if (!/^[0-7]{1,10}$/.test(number)) {\r\n                return error.num;\r\n            }\r\n\r\n            // Check if number is negative\r\n            var negative = (number.length === 10 && number.substring(0, 1) === '7') ? true : false;\r\n\r\n            // Convert octal number to decimal\r\n            var decimal = (negative) ? parseInt(number, 8) - 1073741824 : parseInt(number, 8);\r\n\r\n            // Return error if number is lower than -512 or greater than 511\r\n            if (decimal < -512 || decimal > 511) {\r\n                return error.num;\r\n            }\r\n\r\n            // Ignore places and return a 10-character binary number if number is\r\n            // negative\r\n            if (negative) {\r\n                return '1' + REPT('0', 9 - (512 + decimal).toString(2).length) + (512 + decimal).toString(2);\r\n            }\r\n\r\n            // Convert decimal number to binary\r\n            var result = decimal.toString(2);\r\n\r\n            // Return binary number using the minimum number of characters necessary\r\n            // if places is undefined\r\n            if (typeof places === 'undefined') {\r\n                return result;\r\n            } else {\r\n                // Return error if places is nonnumeric\r\n                if (isNaN(places)) {\r\n                    return error.value;\r\n                }\r\n\r\n                // Return error if places is negative\r\n                if (places < 0) {\r\n                    return error.num;\r\n                }\r\n\r\n                // Truncate places in case it is not an integer\r\n                places = Math.floor(places);\r\n\r\n                // Pad return value with leading 0s (zeros) if necessary (using\r\n                // Underscore.string)\r\n                return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n            }\r\n        };\r\n\r\n        exports.OCT2DEC = function(number) {\r\n            // Return error if number is not octal or contains more than ten\r\n            // characters (10 digits)\r\n            if (!/^[0-7]{1,10}$/.test(number)) {\r\n                return error.num;\r\n            }\r\n\r\n            // Convert octal number to decimal\r\n            var decimal = parseInt(number, 8);\r\n\r\n            // Return decimal number\r\n            return (decimal >= 536870912) ? decimal - 1073741824 : decimal;\r\n        };\r\n\r\n        exports.OCT2HEX = function(number, places) {\r\n            // Return error if number is not octal or contains more than ten\r\n            // characters (10 digits)\r\n            if (!/^[0-7]{1,10}$/.test(number)) {\r\n                return error.num;\r\n            }\r\n\r\n            // Convert octal number to decimal\r\n            var decimal = parseInt(number, 8);\r\n\r\n            // Ignore places and return a 10-character octal number if number is\r\n            // negative\r\n            if (decimal >= 536870912) {\r\n                return 'ff' + (decimal + 3221225472).toString(16);\r\n            }\r\n\r\n            // Convert decimal number to hexadecimal\r\n            var result = decimal.toString(16);\r\n\r\n            // Return hexadecimal number using the minimum number of characters\r\n            // necessary if places is undefined\r\n            if (places === undefined) {\r\n                return result;\r\n            } else {\r\n                // Return error if places is nonnumeric\r\n                if (isNaN(places)) {\r\n                    return error.value;\r\n                }\r\n\r\n                // Return error if places is negative\r\n                if (places < 0) {\r\n                    return error.num;\r\n                }\r\n\r\n                // Truncate places in case it is not an integer\r\n                places = Math.floor(places);\r\n\r\n                // Pad return value with leading 0s (zeros) if necessary (using\r\n                // Underscore.string)\r\n                return (places >= result.length) ? REPT('0', places - result.length) + result : error.num;\r\n            }\r\n        };\r\n\r\n        return exports;\r\n    })();\r\n\r\n    met.financial = (function() {\r\n        var exports = {};\r\n\r\n        function validDate(d) {\r\n            return d && d.getTime && !isNaN(d.getTime());\r\n        }\r\n\r\n        function ensureDate(d) {\r\n            return (d instanceof Date)?d:new Date(d);\r\n        }\r\n\r\n        exports.ACCRINT = function(issue, first, settlement, rate, par, frequency, basis) {\r\n            // Return error if either date is invalid\r\n            issue        = ensureDate(issue);\r\n            first        = ensureDate(first);\r\n            settlement = ensureDate(settlement);\r\n            if (!validDate(issue) || !validDate(first) || !validDate(settlement)) {\r\n                return '#VALUE!';\r\n            }\r\n\r\n            // Return error if either rate or par are lower than or equal to zero\r\n            if (rate <= 0 || par <= 0) {\r\n                return '#NUM!';\r\n            }\r\n\r\n            // Return error if frequency is neither 1, 2, or 4\r\n            if ([1, 2, 4].indexOf(frequency) === -1) {\r\n                return '#NUM!';\r\n            }\r\n\r\n            // Return error if basis is neither 0, 1, 2, 3, or 4\r\n            if ([0, 1, 2, 3, 4].indexOf(basis) === -1) {\r\n                return '#NUM!';\r\n            }\r\n\r\n            // Return error if settlement is before or equal to issue\r\n            if (settlement <= issue) {\r\n                return '#NUM!';\r\n            }\r\n\r\n            // Set default values\r\n            par   = par   || 0;\r\n            basis = basis || 0;\r\n\r\n            // Compute accrued interest\r\n            return par * rate * YEARFRAC(issue, settlement, basis);\r\n        };\r\n\r\n        exports.ACCRINTM = null;\r\n\r\n        exports.AMORDEGRC = null;\r\n\r\n        exports.AMORLINC = null;\r\n\r\n        exports.COUPDAYBS = null;\r\n\r\n        exports.COUPDAYS = null;\r\n\r\n        exports.COUPDAYSNC = null;\r\n\r\n        exports.COUPNCD = null;\r\n\r\n        exports.COUPNUM = null;\r\n\r\n        exports.COUPPCD = null;\r\n\r\n        exports.CUMIPMT = function(rate, periods, value, start, end, type) {\r\n            // Credits: algorithm inspired by Apache OpenOffice\r\n            // Credits: Hannes Stiebitzhofer for the translations of function and\r\n            // variable names\r\n            // Requires exports.FV() and exports.PMT() from exports.js\r\n            // [http://stoic.com/exports/]\r\n\r\n            rate = utils.parseNumber(rate);\r\n            periods = utils.parseNumber(periods);\r\n            value = utils.parseNumber(value);\r\n            if (utils.anyIsError(rate, periods, value)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return error if either rate, periods, or value are lower than or\r\n            // equal to zero\r\n            if (rate <= 0 || periods <= 0 || value <= 0) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return error if start < 1, end < 1, or start > end\r\n            if (start < 1 || end < 1 || start > end) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return error if type is neither 0 nor 1\r\n            if (type !== 0 && type !== 1) {\r\n                return error.num;\r\n            }\r\n\r\n            // Compute cumulative interest\r\n            var payment = exports.PMT(rate, periods, value, 0, type);\r\n            var interest = 0;\r\n\r\n            if (start === 1) {\r\n                if (type === 0) {\r\n                    interest = -value;\r\n                    start++;\r\n                }\r\n            }\r\n\r\n            for (var i = start; i <= end; i++) {\r\n                if (type === 1) {\r\n                    interest += exports.FV(rate, i - 2, payment, value, 1) - payment;\r\n                } else {\r\n                    interest += exports.FV(rate, i - 1, payment, value, 0);\r\n                }\r\n            }\r\n            interest *= rate;\r\n\r\n            // Return cumulative interest\r\n            return interest;\r\n        };\r\n\r\n        exports.CUMPRINC = function(rate, periods, value, start, end, type) {\r\n            // Credits: algorithm inspired by Apache OpenOffice\r\n            // Credits: Hannes Stiebitzhofer for the translations of function and\r\n            // variable names\r\n\r\n            rate = utils.parseNumber(rate);\r\n            periods = utils.parseNumber(periods);\r\n            value = utils.parseNumber(value);\r\n            if (utils.anyIsError(rate, periods, value)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return error if either rate, periods, or value are lower than or\r\n            // equal to zero\r\n            if (rate <= 0 || periods <= 0 || value <= 0) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return error if start < 1, end < 1, or start > end\r\n            if (start < 1 || end < 1 || start > end) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return error if type is neither 0 nor 1\r\n            if (type !== 0 && type !== 1) {\r\n                return error.num;\r\n            }\r\n\r\n            // Compute cumulative principal\r\n            var payment = exports.PMT(rate, periods, value, 0, type);\r\n            var principal = 0;\r\n            if (start === 1) {\r\n                if (type === 0) {\r\n                    principal = payment + value * rate;\r\n                } else {\r\n                    principal = payment;\r\n                }\r\n                start++;\r\n            }\r\n            for (var i = start; i <= end; i++) {\r\n                if (type > 0) {\r\n                    principal += payment - (exports.FV(rate, i - 2, payment, value, 1) - payment) * rate;\r\n                } else {\r\n                    principal += payment - exports.FV(rate, i - 1, payment, value, 0) * rate;\r\n                }\r\n            }\r\n\r\n            // Return cumulative principal\r\n            return principal;\r\n        };\r\n\r\n        exports.DB = function(cost, salvage, life, period, month) {\r\n            // Initialize month\r\n            month = (month === undefined) ? 12 : month;\r\n\r\n            cost = utils.parseNumber(cost);\r\n            salvage = utils.parseNumber(salvage);\r\n            life = utils.parseNumber(life);\r\n            period = utils.parseNumber(period);\r\n            month = utils.parseNumber(month);\r\n            if (utils.anyIsError(cost, salvage, life, period, month)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return error if any of the parameters is negative\r\n            if (cost < 0 || salvage < 0 || life < 0 || period < 0) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return error if month is not an integer between 1 and 12\r\n            if ([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12].indexOf(month) === -1) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return error if period is greater than life\r\n            if (period > life) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return 0 (zero) if salvage is greater than or equal to cost\r\n            if (salvage >= cost) {\r\n                return 0;\r\n            }\r\n\r\n            // Rate is rounded to three decimals places\r\n            var rate = (1 - Math.pow(salvage / cost, 1 / life)).toFixed(3);\r\n\r\n            // Compute initial depreciation\r\n            var initial = cost * rate * month / 12;\r\n\r\n            // Compute total depreciation\r\n            var total = initial;\r\n            var current = 0;\r\n            var ceiling = (period === life) ? life - 1 : period;\r\n            for (var i = 2; i <= ceiling; i++) {\r\n                current = (cost - total) * rate;\r\n                total += current;\r\n            }\r\n\r\n            // Depreciation for the first and last periods are special cases\r\n            if (period === 1) {\r\n                // First period\r\n                return initial;\r\n            } else if (period === life) {\r\n                // Last period\r\n                return (cost - total) * rate;\r\n            } else {\r\n                return current;\r\n            }\r\n        };\r\n\r\n        exports.DDB = function(cost, salvage, life, period, factor) {\r\n            // Initialize factor\r\n            factor = (factor === undefined) ? 2 : factor;\r\n\r\n            cost = utils.parseNumber(cost);\r\n            salvage = utils.parseNumber(salvage);\r\n            life = utils.parseNumber(life);\r\n            period = utils.parseNumber(period);\r\n            factor = utils.parseNumber(factor);\r\n            if (utils.anyIsError(cost, salvage, life, period, factor)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return error if any of the parameters is negative or if factor is\r\n            // null\r\n            if (cost < 0 || salvage < 0 || life < 0 || period < 0 || factor <= 0) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return error if period is greater than life\r\n            if (period > life) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return 0 (zero) if salvage is greater than or equal to cost\r\n            if (salvage >= cost) {\r\n                return 0;\r\n            }\r\n\r\n            // Compute depreciation\r\n            var total = 0;\r\n            var current = 0;\r\n            for (var i = 1; i <= period; i++) {\r\n                current = Math.min((cost - total) * (factor / life), (cost - salvage - total));\r\n                total += current;\r\n            }\r\n\r\n            // Return depreciation\r\n            return current;\r\n        };\r\n\r\n        exports.DISC = null;\r\n\r\n        exports.DOLLARDE = function(dollar, fraction) {\r\n            // Credits: algorithm inspired by Apache OpenOffice\r\n\r\n            dollar = utils.parseNumber(dollar);\r\n            fraction = utils.parseNumber(fraction);\r\n            if (utils.anyIsError(dollar, fraction)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return error if fraction is negative\r\n            if (fraction < 0) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return error if fraction is greater than or equal to 0 and less than\r\n            // 1\r\n            if (fraction >= 0 && fraction < 1) {\r\n                return error.div0;\r\n            }\r\n\r\n            // Truncate fraction if it is not an integer\r\n            fraction = parseInt(fraction, 10);\r\n\r\n            // Compute integer part\r\n            var result = parseInt(dollar, 10);\r\n\r\n            // Add decimal part\r\n            result += (dollar % 1) * Math.pow(10, Math.ceil(Math.log(fraction) / Math.LN10)) / fraction;\r\n\r\n            // Round result\r\n            var power = Math.pow(10, Math.ceil(Math.log(fraction) / Math.LN2) + 1);\r\n            result = Math.round(result * power) / power;\r\n\r\n            // Return converted dollar price\r\n            return result;\r\n        };\r\n\r\n        exports.DOLLARFR = function(dollar, fraction) {\r\n            // Credits: algorithm inspired by Apache OpenOffice\r\n\r\n            dollar = utils.parseNumber(dollar);\r\n            fraction = utils.parseNumber(fraction);\r\n            if (utils.anyIsError(dollar, fraction)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return error if fraction is negative\r\n            if (fraction < 0) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return error if fraction is greater than or equal to 0 and less than\r\n            // 1\r\n            if (fraction >= 0 && fraction < 1) {\r\n                return error.div0;\r\n            }\r\n\r\n            // Truncate fraction if it is not an integer\r\n            fraction = parseInt(fraction, 10);\r\n\r\n            // Compute integer part\r\n            var result = parseInt(dollar, 10);\r\n\r\n            // Add decimal part\r\n            result += (dollar % 1) * Math.pow(10, -Math.ceil(Math.log(fraction) / Math.LN10)) * fraction;\r\n\r\n            // Return converted dollar price\r\n            return result;\r\n        };\r\n\r\n        exports.DURATION = null;\r\n\r\n        exports.EFFECT = function(rate, periods) {\r\n            rate = utils.parseNumber(rate);\r\n            periods = utils.parseNumber(periods);\r\n            if (utils.anyIsError(rate, periods)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return error if rate <=0 or periods < 1\r\n            if (rate <= 0 || periods < 1) {\r\n                return error.num;\r\n            }\r\n\r\n            // Truncate periods if it is not an integer\r\n            periods = parseInt(periods, 10);\r\n\r\n            // Return effective annual interest rate\r\n            return Math.pow(1 + rate / periods, periods) - 1;\r\n        };\r\n\r\n        exports.FV = function(rate, periods, payment, value, type) {\r\n            // Credits: algorithm inspired by Apache OpenOffice\r\n\r\n            value = value || 0;\r\n            type = type || 0;\r\n\r\n            rate = utils.parseNumber(rate);\r\n            periods = utils.parseNumber(periods);\r\n            payment = utils.parseNumber(payment);\r\n            value = utils.parseNumber(value);\r\n            type = utils.parseNumber(type);\r\n            if (utils.anyIsError(rate, periods, payment, value, type)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return future value\r\n            var result;\r\n            if (rate === 0) {\r\n                result = value + payment * periods;\r\n            } else {\r\n                var term = Math.pow(1 + rate, periods);\r\n                if (type === 1) {\r\n                    result = value * term + payment * (1 + rate) * (term - 1) / rate;\r\n                } else {\r\n                    result = value * term + payment * (term - 1) / rate;\r\n                }\r\n            }\r\n            return -result;\r\n        };\r\n\r\n        exports.FVSCHEDULE = function(principal, schedule) {\r\n            principal = utils.parseNumber(principal);\r\n            schedule = utils.parseNumberArray(utils.flatten(schedule));\r\n            if (utils.anyIsError(principal, schedule)) {\r\n                return error.value;\r\n            }\r\n\r\n            var n = schedule.length;\r\n            var future = principal;\r\n\r\n            // Apply all interests in schedule\r\n            for (var i = 0; i < n; i++) {\r\n                // Apply scheduled interest\r\n                future *= 1 + schedule[i];\r\n            }\r\n\r\n            // Return future value\r\n            return future;\r\n        };\r\n\r\n        exports.INTRATE = null;\r\n\r\n        exports.IPMT = function(rate, period, periods, present, future, type) {\r\n            // Credits: algorithm inspired by Apache OpenOffice\r\n\r\n            future = future || 0;\r\n            type = type || 0;\r\n\r\n            rate = utils.parseNumber(rate);\r\n            period = utils.parseNumber(period);\r\n            periods = utils.parseNumber(periods);\r\n            present = utils.parseNumber(present);\r\n            future = utils.parseNumber(future);\r\n            type = utils.parseNumber(type);\r\n            if (utils.anyIsError(rate, period, periods, present, future, type)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Compute payment\r\n            var payment = exports.PMT(rate, periods, present, future, type);\r\n\r\n            // Compute interest\r\n            var interest;\r\n            if (period === 1) {\r\n                if (type === 1) {\r\n                    interest = 0;\r\n                } else {\r\n                    interest = -present;\r\n                }\r\n            } else {\r\n                if (type === 1) {\r\n                    interest = exports.FV(rate, period - 2, payment, present, 1) - payment;\r\n                } else {\r\n                    interest = exports.FV(rate, period - 1, payment, present, 0);\r\n                }\r\n            }\r\n\r\n            // Return interest\r\n            return interest * rate;\r\n        };\r\n\r\n        exports.IRR = function(values, guess) {\r\n            // Credits: algorithm inspired by Apache OpenOffice\r\n\r\n            guess = guess || 0;\r\n\r\n            values = utils.parseNumberArray(utils.flatten(values));\r\n            guess = utils.parseNumber(guess);\r\n            if (utils.anyIsError(values, guess)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Calculates the resulting amount\r\n            var irrResult = function(values, dates, rate) {\r\n                var r = rate + 1;\r\n                var result = values[0];\r\n                for (var i = 1; i < values.length; i++) {\r\n                    result += values[i] / Math.pow(r, (dates[i] - dates[0]) / 365);\r\n                }\r\n                return result;\r\n            };\r\n\r\n            // Calculates the first derivation\r\n            var irrResultDeriv = function(values, dates, rate) {\r\n                var r = rate + 1;\r\n                var result = 0;\r\n                for (var i = 1; i < values.length; i++) {\r\n                    var frac = (dates[i] - dates[0]) / 365;\r\n                    result -= frac * values[i] / Math.pow(r, frac + 1);\r\n                }\r\n                return result;\r\n            };\r\n\r\n            // Initialize dates and check that values contains at least one positive\r\n            // value and one negative value\r\n            var dates = [];\r\n            var positive = false;\r\n            var negative = false;\r\n            for (var i = 0; i < values.length; i++) {\r\n                dates[i] = (i === 0) ? 0 : dates[i - 1] + 365;\r\n                if (values[i] > 0) {\r\n                    positive = true;\r\n                }\r\n                if (values[i] < 0) {\r\n                    negative = true;\r\n                }\r\n            }\r\n\r\n            // Return error if values does not contain at least one positive value\r\n            // and one negative value\r\n            if (!positive || !negative) {\r\n                return error.num;\r\n            }\r\n\r\n            // Initialize guess and resultRate\r\n            guess = (guess === undefined) ? 0.1 : guess;\r\n            var resultRate = guess;\r\n\r\n            // Set maximum epsilon for end of iteration\r\n            var epsMax = 1e-10;\r\n\r\n            // Implement Newton's method\r\n            var newRate, epsRate, resultValue;\r\n            var contLoop = true;\r\n            do {\r\n                resultValue = irrResult(values, dates, resultRate);\r\n                newRate = resultRate - resultValue / irrResultDeriv(values, dates, resultRate);\r\n                epsRate = Math.abs(newRate - resultRate);\r\n                resultRate = newRate;\r\n                contLoop = (epsRate > epsMax) && (Math.abs(resultValue) > epsMax);\r\n            } while (contLoop);\r\n\r\n            // Return internal rate of return\r\n            return resultRate;\r\n        };\r\n\r\n        exports.ISPMT = function(rate, period, periods, value) {\r\n            rate = utils.parseNumber(rate);\r\n            period = utils.parseNumber(period);\r\n            periods = utils.parseNumber(periods);\r\n            value = utils.parseNumber(value);\r\n            if (utils.anyIsError(rate, period, periods, value)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return interest\r\n            return value * rate * (period / periods - 1);\r\n        };\r\n\r\n        exports.MDURATION = null;\r\n\r\n        exports.MIRR = function(values, finance_rate, reinvest_rate) {\r\n            values = utils.parseNumberArray(utils.flatten(values));\r\n            finance_rate = utils.parseNumber(finance_rate);\r\n            reinvest_rate = utils.parseNumber(reinvest_rate);\r\n            if (utils.anyIsError(values, finance_rate, reinvest_rate)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Initialize number of values\r\n            var n = values.length;\r\n\r\n            // Lookup payments (negative values) and incomes (positive values)\r\n            var payments = [];\r\n            var incomes = [];\r\n            for (var i = 0; i < n; i++) {\r\n                if (values[i] < 0) {\r\n                    payments.push(values[i]);\r\n                } else {\r\n                    incomes.push(values[i]);\r\n                }\r\n            }\r\n\r\n            // Return modified internal rate of return\r\n            var num = -exports.NPV(reinvest_rate, incomes) * Math.pow(1 + reinvest_rate, n - 1);\r\n            var den = exports.NPV(finance_rate, payments) * (1 + finance_rate);\r\n            return Math.pow(num / den, 1 / (n - 1)) - 1;\r\n        };\r\n\r\n        exports.NOMINAL = function(rate, periods) {\r\n            rate = utils.parseNumber(rate);\r\n            periods = utils.parseNumber(periods);\r\n            if (utils.anyIsError(rate, periods)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return error if rate <=0 or periods < 1\r\n            if (rate <= 0 || periods < 1) {\r\n                return error.num;\r\n            }\r\n\r\n            // Truncate periods if it is not an integer\r\n            periods = parseInt(periods, 10);\r\n\r\n            // Return nominal annual interest rate\r\n            return (Math.pow(rate + 1, 1 / periods) - 1) * periods;\r\n        };\r\n\r\n        exports.NPER = function(rate, payment, present, future, type) {\r\n            type = (type === undefined) ? 0 : type;\r\n            future = (future === undefined) ? 0 : future;\r\n\r\n            rate = utils.parseNumber(rate);\r\n            payment = utils.parseNumber(payment);\r\n            present = utils.parseNumber(present);\r\n            future = utils.parseNumber(future);\r\n            type = utils.parseNumber(type);\r\n            if (utils.anyIsError(rate, payment, present, future, type)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return number of periods\r\n            var num = payment * (1 + rate * type) - future * rate;\r\n            var den = (present * rate + payment * (1 + rate * type));\r\n            return Math.log(num / den) / Math.log(1 + rate);\r\n        };\r\n\r\n        exports.NPV = function() {\r\n            var args = utils.parseNumberArray(utils.flatten(arguments));\r\n            if (args instanceof Error) {\r\n                return args;\r\n            }\r\n\r\n            // Lookup rate\r\n            var rate = args[0];\r\n\r\n            // Initialize net present value\r\n            var value = 0;\r\n\r\n            // Loop on all values\r\n            for (var j = 1; j < args.length; j++) {\r\n                value += args[j] / Math.pow(1 + rate, j);\r\n            }\r\n\r\n            // Return net present value\r\n            return value;\r\n        };\r\n\r\n        exports.ODDFPRICE = null;\r\n\r\n        exports.ODDFYIELD = null;\r\n\r\n        exports.ODDLPRICE = null;\r\n\r\n        exports.ODDLYIELD = null;\r\n\r\n        exports.PDURATION = function(rate, present, future) {\r\n            rate = utils.parseNumber(rate);\r\n            present = utils.parseNumber(present);\r\n            future = utils.parseNumber(future);\r\n            if (utils.anyIsError(rate, present, future)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return error if rate <=0\r\n            if (rate <= 0) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return number of periods\r\n            return (Math.log(future) - Math.log(present)) / Math.log(1 + rate);\r\n        };\r\n\r\n        exports.PMT = function(rate, periods, present, future, type) {\r\n            // Credits: algorithm inspired by Apache OpenOffice\r\n\r\n            future = future || 0;\r\n            type = type || 0;\r\n\r\n            rate = utils.parseNumber(rate);\r\n            periods = utils.parseNumber(periods);\r\n            present = utils.parseNumber(present);\r\n            future = utils.parseNumber(future);\r\n            type = utils.parseNumber(type);\r\n            if (utils.anyIsError(rate, periods, present, future, type)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return payment\r\n            var result;\r\n            if (rate === 0) {\r\n                result = (present + future) / periods;\r\n            } else {\r\n                var term = Math.pow(1 + rate, periods);\r\n                if (type === 1) {\r\n                    result = (future * rate / (term - 1) + present * rate / (1 - 1 / term)) / (1 + rate);\r\n                } else {\r\n                    result = future * rate / (term - 1) + present * rate / (1 - 1 / term);\r\n                }\r\n            }\r\n            return -result;\r\n        };\r\n\r\n        exports.PPMT = function(rate, period, periods, present, future, type) {\r\n            future = future || 0;\r\n            type = type || 0;\r\n\r\n            rate = utils.parseNumber(rate);\r\n            periods = utils.parseNumber(periods);\r\n            present = utils.parseNumber(present);\r\n            future = utils.parseNumber(future);\r\n            type = utils.parseNumber(type);\r\n            if (utils.anyIsError(rate, periods, present, future, type)) {\r\n                return error.value;\r\n            }\r\n\r\n            return exports.PMT(rate, periods, present, future, type) - exports.IPMT(rate, period, periods, present, future, type);\r\n        };\r\n\r\n        exports.PRICE = null;\r\n\r\n        exports.PRICEDISC = null;\r\n\r\n        exports.PRICEMAT = null;\r\n\r\n        exports.PV = function(rate, periods, payment, future, type) {\r\n            future = future || 0;\r\n            type = type || 0;\r\n\r\n            rate = utils.parseNumber(rate);\r\n            periods = utils.parseNumber(periods);\r\n            payment = utils.parseNumber(payment);\r\n            future = utils.parseNumber(future);\r\n            type = utils.parseNumber(type);\r\n            if (utils.anyIsError(rate, periods, payment, future, type)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return present value\r\n            if (rate === 0) {\r\n                return -payment * periods - future;\r\n            } else {\r\n                return (((1 - Math.pow(1 + rate, periods)) / rate) * payment * (1 + rate * type) - future) / Math.pow(1 + rate, periods);\r\n            }\r\n        };\r\n\r\n        exports.RATE = function(periods, payment, present, future, type, guess) {\r\n            // Credits: rabugento\r\n\r\n            guess = (guess === undefined) ? 0.01 : guess;\r\n            future = (future === undefined) ? 0 : future;\r\n            type = (type === undefined) ? 0 : type;\r\n\r\n            periods = utils.parseNumber(periods);\r\n            payment = utils.parseNumber(payment);\r\n            present = utils.parseNumber(present);\r\n            future = utils.parseNumber(future);\r\n            type = utils.parseNumber(type);\r\n            guess = utils.parseNumber(guess);\r\n            if (utils.anyIsError(periods, payment, present, future, type, guess)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Set maximum epsilon for end of iteration\r\n            var epsMax = 1e-6;\r\n\r\n            // Set maximum number of iterations\r\n            var iterMax = 100;\r\n            var iter = 0;\r\n            var close = false;\r\n            var rate = guess;\r\n\r\n            while (iter < iterMax && !close) {\r\n                var t1 = Math.pow(rate + 1, periods);\r\n                var t2 = Math.pow(rate + 1, periods - 1);\r\n\r\n                var f1 = future + t1 * present + payment * (t1 - 1) * (rate * type + 1) / rate;\r\n                var f2 = periods * t2 * present - payment * (t1 - 1) *(rate * type + 1) / Math.pow(rate,2);\r\n                var f3 = periods * payment * t2 * (rate * type + 1) / rate + payment * (t1 - 1) * type / rate;\r\n\r\n                var newRate = rate - f1 / (f2 + f3);\r\n\r\n                if (Math.abs(newRate - rate) < epsMax) close = true;\r\n                iter++\r\n                rate = newRate;\r\n            }\r\n\r\n            if (!close) return Number.NaN + rate;\r\n            return rate;\r\n        };\r\n\r\n        // TODO\r\n        exports.RECEIVED = null;\r\n\r\n        exports.RRI = function(periods, present, future) {\r\n            periods = utils.parseNumber(periods);\r\n            present = utils.parseNumber(present);\r\n            future = utils.parseNumber(future);\r\n            if (utils.anyIsError(periods, present, future)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return error if periods or present is equal to 0 (zero)\r\n            if (periods === 0 || present === 0) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return equivalent interest rate\r\n            return Math.pow(future / present, 1 / periods) - 1;\r\n        };\r\n\r\n        exports.SLN = function(cost, salvage, life) {\r\n            cost = utils.parseNumber(cost);\r\n            salvage = utils.parseNumber(salvage);\r\n            life = utils.parseNumber(life);\r\n            if (utils.anyIsError(cost, salvage, life)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return error if life equal to 0 (zero)\r\n            if (life === 0) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return straight-line depreciation\r\n            return (cost - salvage) / life;\r\n        };\r\n\r\n        exports.SYD = function(cost, salvage, life, period) {\r\n            // Return error if any of the parameters is not a number\r\n            cost = utils.parseNumber(cost);\r\n            salvage = utils.parseNumber(salvage);\r\n            life = utils.parseNumber(life);\r\n            period = utils.parseNumber(period);\r\n            if (utils.anyIsError(cost, salvage, life, period)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return error if life equal to 0 (zero)\r\n            if (life === 0) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return error if period is lower than 1 or greater than life\r\n            if (period < 1 || period > life) {\r\n                return error.num;\r\n            }\r\n\r\n            // Truncate period if it is not an integer\r\n            period = parseInt(period, 10);\r\n\r\n            // Return straight-line depreciation\r\n            return ((cost - salvage) * (life - period + 1) * 2) / (life * (life + 1));\r\n        };\r\n\r\n        exports.TBILLEQ = function(settlement, maturity, discount) {\r\n            settlement = utils.parseDate(settlement);\r\n            maturity = utils.parseDate(maturity);\r\n            discount = utils.parseNumber(discount);\r\n            if (utils.anyIsError(settlement, maturity, discount)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return error if discount is lower than or equal to zero\r\n            if (discount <= 0) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return error if settlement is greater than maturity\r\n            if (settlement > maturity) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return error if maturity is more than one year after settlement\r\n            if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return bond-equivalent yield\r\n            return (365 * discount) / (360 - discount * DAYS360(settlement, maturity, false));\r\n        };\r\n\r\n        exports.TBILLPRICE = function(settlement, maturity, discount) {\r\n            settlement = utils.parseDate(settlement);\r\n            maturity = utils.parseDate(maturity);\r\n            discount = utils.parseNumber(discount);\r\n            if (utils.anyIsError(settlement, maturity, discount)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return error if discount is lower than or equal to zero\r\n            if (discount <= 0) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return error if settlement is greater than maturity\r\n            if (settlement > maturity) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return error if maturity is more than one year after settlement\r\n            if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return bond-equivalent yield\r\n            return 100 * (1 - discount * DAYS360(settlement, maturity, false) / 360);\r\n        };\r\n\r\n        exports.TBILLYIELD = function(settlement, maturity, price) {\r\n            settlement = utils.parseDate(settlement);\r\n            maturity = utils.parseDate(maturity);\r\n            price = utils.parseNumber(price);\r\n            if (utils.anyIsError(settlement, maturity, price)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Return error if price is lower than or equal to zero\r\n            if (price <= 0) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return error if settlement is greater than maturity\r\n            if (settlement > maturity) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return error if maturity is more than one year after settlement\r\n            if (maturity - settlement > 365 * 24 * 60 * 60 * 1000) {\r\n                return error.num;\r\n            }\r\n\r\n            // Return bond-equivalent yield\r\n            return (100 - price) * 360 / (price * DAYS360(settlement, maturity, false));\r\n        };\r\n\r\n        exports.VDB = null;\r\n\r\n        exports.XIRR = function(values, dates, guess) {\r\n            // Credits: algorithm inspired by Apache OpenOffice\r\n\r\n            values = utils.parseNumberArray(utils.flatten(values));\r\n            dates = utils.parseDateArray(utils.flatten(dates));\r\n            guess = utils.parseNumber(guess);\r\n            if (utils.anyIsError(values, dates, guess)) {\r\n                return error.value;\r\n            }\r\n\r\n            // Calculates the resulting amount\r\n            var irrResult = function(values, dates, rate) {\r\n                var r = rate + 1;\r\n                var result = values[0];\r\n                for (var i = 1; i < values.length; i++) {\r\n                    result += values[i] / Math.pow(r, DAYS(dates[i], dates[0]) / 365);\r\n                }\r\n                return result;\r\n            };\r\n\r\n            // Calculates the first derivation\r\n            var irrResultDeriv = function(values, dates, rate) {\r\n                var r = rate + 1;\r\n                var result = 0;\r\n                for (var i = 1; i < values.length; i++) {\r\n                    var frac = DAYS(dates[i], dates[0]) / 365;\r\n                    result -= frac * values[i] / Math.pow(r, frac + 1);\r\n                }\r\n                return result;\r\n            };\r\n\r\n            // Check that values contains at least one positive value and one\r\n            // negative value\r\n            var positive = false;\r\n            var negative = false;\r\n            for (var i = 0; i < values.length; i++) {\r\n                if (values[i] > 0) {\r\n                    positive = true;\r\n                }\r\n                if (values[i] < 0) {\r\n                    negative = true;\r\n                }\r\n            }\r\n\r\n            // Return error if values does not contain at least one positive value\r\n            // and one negative value\r\n            if (!positive || !negative) {\r\n                return error.num;\r\n            }\r\n\r\n            // Initialize guess and resultRate\r\n            guess = guess || 0.1;\r\n            var resultRate = guess;\r\n\r\n            // Set maximum epsilon for end of iteration\r\n            var epsMax = 1e-10;\r\n\r\n            // Implement Newton's method\r\n            var newRate, epsRate, resultValue;\r\n            var contLoop = true;\r\n            do {\r\n                resultValue = irrResult(values, dates, resultRate);\r\n                newRate = resultRate - resultValue / irrResultDeriv(values, dates, resultRate);\r\n                epsRate = Math.abs(newRate - resultRate);\r\n                resultRate = newRate;\r\n                contLoop = (epsRate > epsMax) && (Math.abs(resultValue) > epsMax);\r\n            } while (contLoop);\r\n\r\n            // Return internal rate of return\r\n            return resultRate;\r\n        };\r\n\r\n        exports.XNPV = function(rate, values, dates) {\r\n            rate = utils.parseNumber(rate);\r\n            values = utils.parseNumberArray(utils.flatten(values));\r\n            dates = utils.parseDateArray(utils.flatten(dates));\r\n            if (utils.anyIsError(rate, values, dates)) {\r\n                return error.value;\r\n            }\r\n\r\n            var result = 0;\r\n            for (var i = 0; i < values.length; i++) {\r\n                result += values[i] / Math.pow(1 + rate, DAYS(dates[i], dates[0]) / 365);\r\n            }\r\n            return result;\r\n        };\r\n\r\n        exports.YIELD = null;\r\n\r\n        exports.YIELDDISC = null;\r\n\r\n        exports.YIELDMAT = null;\r\n\r\n        return exports;\r\n    })();\r\n\r\n    met.information = (function() {\r\n        var exports = {};\r\n        exports.CELL = null;\r\n\r\n        exports.ERROR = {};\r\n        exports.ERROR.TYPE = function(error_val) {\r\n            switch (error_val) {\r\n                case error.nil: return 1;\r\n                case error.div0: return 2;\r\n                case error.value: return 3;\r\n                case error.ref: return 4;\r\n                case error.name: return 5;\r\n                case error.num: return 6;\r\n                case error.na: return 7;\r\n                case error.data: return 8;\r\n            }\r\n            return error.na;\r\n        };\r\n\r\n        exports.INFO = null;\r\n\r\n        exports.ISBLANK = function(value) {\r\n            return value === null;\r\n        };\r\n\r\n        exports.ISBINARY = function (number) {\r\n            return (/^[01]{1,10}$/).test(number);\r\n        };\r\n\r\n        exports.ISERR = function(value) {\r\n            return ([error.value, error.ref, error.div0, error.num, error.name, error.nil]).indexOf(value) >= 0 ||\r\n                (typeof value === 'number' && (isNaN(value) || !isFinite(value)));\r\n        };\r\n\r\n        exports.ISERROR = function(value) {\r\n            return exports.ISERR(value) || value === error.na;\r\n        };\r\n\r\n        exports.ISEVEN = function(number) {\r\n            return (Math.floor(Math.abs(number)) & 1) ? false : true;\r\n        };\r\n\r\n        // TODO\r\n        exports.ISFORMULA = null;\r\n\r\n        exports.ISLOGICAL = function(value) {\r\n            return value === true || value === false;\r\n        };\r\n\r\n        exports.ISNA = function(value) {\r\n            return value === error.na;\r\n        };\r\n\r\n        exports.ISNONTEXT = function(value) {\r\n            return typeof(value) !== 'string';\r\n        };\r\n\r\n        exports.ISNUMBER = function(value) {\r\n            return typeof(value) === 'number' && !isNaN(value) && isFinite(value);\r\n        };\r\n\r\n        exports.ISODD = function(number) {\r\n            return (Math.floor(Math.abs(number)) & 1) ? true : false;\r\n        };\r\n\r\n        exports.ISREF = null;\r\n\r\n        exports.ISTEXT = function(value) {\r\n            return typeof(value) === 'string';\r\n        };\r\n\r\n        exports.N = function(value) {\r\n            if (this.ISNUMBER(value)) {\r\n                return value;\r\n            }\r\n            if (value instanceof Date) {\r\n                return value.getTime();\r\n            }\r\n            if (value === true) {\r\n                return 1;\r\n            }\r\n            if (value === false) {\r\n                return 0;\r\n            }\r\n            if (this.ISERROR(value)) {\r\n                return value;\r\n            }\r\n            return 0;\r\n        };\r\n\r\n        exports.NA = function() {\r\n            return error.na;\r\n        };\r\n\r\n        exports.SHEET = null;\r\n\r\n        exports.SHEETS = null;\r\n\r\n        exports.TYPE = function(value) {\r\n            if (this.ISNUMBER(value)) {\r\n                return 1;\r\n            }\r\n            if (this.ISTEXT(value)) {\r\n                return 2;\r\n            }\r\n            if (this.ISLOGICAL(value)) {\r\n                return 4;\r\n            }\r\n            if (this.ISERROR(value)) {\r\n                return 16;\r\n            }\r\n            if (Array.isArray(value)) {\r\n                return 64;\r\n            }\r\n        };\r\n\r\n        return exports;\r\n    })();\r\n\r\n    met.logical = (function() {\r\n        var exports = {};\r\n\r\n        exports.AND = function() {\r\n            var args = utils.flatten(arguments);\r\n            var result = true;\r\n            for (var i = 0; i < args.length; i++) {\r\n                if (!args[i]) {\r\n                    result = false;\r\n                }\r\n            }\r\n            return result;\r\n        };\r\n\r\n        exports.CHOOSE = function() {\r\n            if (arguments.length < 2) {\r\n                return error.na;\r\n            }\r\n\r\n            var index = arguments[0];\r\n            if (index < 1 || index > 254) {\r\n                return error.value;\r\n            }\r\n\r\n            if (arguments.length < index + 1) {\r\n                return error.value;\r\n            }\r\n\r\n            return arguments[index];\r\n        };\r\n\r\n        exports.FALSE = function() {\r\n            return false;\r\n        };\r\n\r\n        exports.IF = function(test, then_value, otherwise_value) {\r\n            return test ? then_value : otherwise_value;\r\n        };\r\n\r\n        exports.IFERROR = function(value, valueIfError) {\r\n            if (ISERROR(value)) {\r\n                return valueIfError;\r\n            }\r\n            return value;\r\n        };\r\n\r\n        exports.IFNA = function(value, value_if_na) {\r\n            return value === error.na ? value_if_na : value;\r\n        };\r\n\r\n        exports.NOT = function(logical) {\r\n            return !logical;\r\n        };\r\n\r\n        exports.OR = function() {\r\n            var args = utils.flatten(arguments);\r\n            var result = false;\r\n            for (var i = 0; i < args.length; i++) {\r\n                if (args[i]) {\r\n                    result = true;\r\n                }\r\n            }\r\n            return result;\r\n        };\r\n\r\n        exports.TRUE = function() {\r\n            return true;\r\n        };\r\n\r\n        exports.XOR = function() {\r\n            var args = utils.flatten(arguments);\r\n            var result = 0;\r\n            for (var i = 0; i < args.length; i++) {\r\n                if (args[i]) {\r\n                    result++;\r\n                }\r\n            }\r\n            return (Math.floor(Math.abs(result)) & 1) ? true : false;\r\n        };\r\n\r\n        exports.SWITCH = function() {\r\n            var result;\r\n            if (arguments.length > 0)  {\r\n                var targetValue = arguments[0];\r\n                var argc = arguments.length - 1;\r\n                var switchCount = Math.floor(argc / 2);\r\n                var switchSatisfied = false;\r\n                var defaultClause = argc % 2 === 0 ? null : arguments[arguments.length - 1];\r\n\r\n                if (switchCount) {\r\n                    for (var index = 0; index < switchCount; index++) {\r\n                        if (targetValue === arguments[index * 2 + 1]) {\r\n                            result = arguments[index * 2 + 2];\r\n                            switchSatisfied = true;\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if (!switchSatisfied && defaultClause) {\r\n                    result = defaultClause;\r\n                }\r\n            }\r\n\r\n            return result;\r\n        };\r\n\r\n        return exports;\r\n    })();\r\n\r\n    met.math = (function() {\r\n        var exports = {};\r\n\r\n        exports.ABS = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return Math.abs(utils.parseNumber(number));\r\n        };\r\n\r\n        exports.ACOS = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return Math.acos(number);\r\n        };\r\n\r\n        exports.ACOSH = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return Math.log(number + Math.sqrt(number * number - 1));\r\n        };\r\n\r\n        exports.ACOT = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return Math.atan(1 / number);\r\n        };\r\n\r\n        exports.ACOTH = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return 0.5 * Math.log((number + 1) / (number - 1));\r\n        };\r\n\r\n        exports.AGGREGATE = null\r\n\r\n        exports.ARABIC = function(text) {\r\n            // Credits: Rafa? Kukawski\r\n            if (!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(text)) {\r\n                return error.value;\r\n            }\r\n            var r = 0;\r\n            text.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g, function(i) {\r\n                r += {\r\n                    M: 1000,\r\n                    CM: 900,\r\n                    D: 500,\r\n                    CD: 400,\r\n                    C: 100,\r\n                    XC: 90,\r\n                    L: 50,\r\n                    XL: 40,\r\n                    X: 10,\r\n                    IX: 9,\r\n                    V: 5,\r\n                    IV: 4,\r\n                    I: 1\r\n                }[i];\r\n            });\r\n            return r;\r\n        };\r\n\r\n        exports.ASIN = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return Math.asin(number);\r\n        };\r\n\r\n        exports.ASINH = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return Math.log(number + Math.sqrt(number * number + 1));\r\n        };\r\n\r\n        exports.ATAN = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return Math.atan(number);\r\n        };\r\n\r\n        exports.ATAN2 = function(number_x, number_y) {\r\n            number_x = utils.parseNumber(number_x);\r\n            number_y = utils.parseNumber(number_y);\r\n            if (utils.anyIsError(number_x, number_y)) {\r\n                return error.value;\r\n            }\r\n            return Math.atan2(number_x, number_y);\r\n        };\r\n\r\n        exports.ATANH = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return Math.log((1 + number) / (1 - number)) / 2;\r\n        };\r\n\r\n        exports.BASE = function(number, radix, min_length) {\r\n            min_length = min_length || 0;\r\n\r\n            number = utils.parseNumber(number);\r\n            radix = utils.parseNumber(radix);\r\n            min_length = utils.parseNumber(min_length);\r\n            if (utils.anyIsError(number, radix, min_length)) {\r\n                return error.value;\r\n            }\r\n            min_length = (min_length === undefined) ? 0 : min_length;\r\n            var result = number.toString(radix);\r\n            return new Array(Math.max(min_length + 1 - result.length, 0)).join('0') + result;\r\n        };\r\n\r\n        exports.CEILING = function(number, significance, mode) {\r\n            significance = (significance === undefined) ? 1 : significance;\r\n            mode = (mode === undefined) ? 0 : mode;\r\n\r\n            number = utils.parseNumber(number);\r\n            significance = utils.parseNumber(significance);\r\n            mode = utils.parseNumber(mode);\r\n            if (utils.anyIsError(number, significance, mode)) {\r\n                return error.value;\r\n            }\r\n            if (significance === 0) {\r\n                return 0;\r\n            }\r\n\r\n            significance = Math.abs(significance);\r\n            if (number >= 0) {\r\n                return Math.ceil(number / significance) * significance;\r\n            } else {\r\n                if (mode === 0) {\r\n                    return -1 * Math.floor(Math.abs(number) / significance) * significance;\r\n                } else {\r\n                    return -1 * Math.ceil(Math.abs(number) / significance) * significance;\r\n                }\r\n            }\r\n        };\r\n\r\n        exports.CEILING.MATH = exports.CEILING;\r\n\r\n        exports.CEILING.PRECISE = exports.CEILING;\r\n\r\n        exports.COMBIN = function(number, number_chosen) {\r\n            number = utils.parseNumber(number);\r\n            number_chosen = utils.parseNumber(number_chosen);\r\n            if (utils.anyIsError(number, number_chosen)) {\r\n                return error.value;\r\n            }\r\n            return exports.FACT(number) / (exports.FACT(number_chosen) * exports.FACT(number - number_chosen));\r\n        };\r\n\r\n        exports.COMBINA = function(number, number_chosen) {\r\n            number = utils.parseNumber(number);\r\n            number_chosen = utils.parseNumber(number_chosen);\r\n            if (utils.anyIsError(number, number_chosen)) {\r\n                return error.value;\r\n            }\r\n            return (number === 0 && number_chosen === 0) ? 1 : exports.COMBIN(number + number_chosen - 1, number - 1);\r\n        };\r\n\r\n        exports.COS = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return Math.cos(number);\r\n        };\r\n\r\n        exports.COSH = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return (Math.exp(number) + Math.exp(-number)) / 2;\r\n        };\r\n\r\n        exports.COT = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return 1 / Math.tan(number);\r\n        };\r\n\r\n        exports.COTH = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            var e2 = Math.exp(2 * number);\r\n            return (e2 + 1) / (e2 - 1);\r\n        };\r\n\r\n        exports.CSC = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return 1 / Math.sin(number);\r\n        };\r\n\r\n        exports.CSCH = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return 2 / (Math.exp(number) - Math.exp(-number));\r\n        };\r\n\r\n        exports.DECIMAL = function(number, radix) {\r\n            if (arguments.length < 1) {\r\n                return error.value;\r\n            }\r\n\r\n\r\n            return parseInt(number, radix);\r\n        };\r\n\r\n        exports.DEGREES = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return number * 180 / Math.PI;\r\n        };\r\n\r\n        exports.EVEN = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return exports.CEILING(number, -2, -1);\r\n        };\r\n\r\n        exports.EXP = Math.exp;\r\n\r\n        var MEMOIZED_FACT = [];\r\n        exports.FACT = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            var n = Math.floor(number);\r\n            if (n === 0 || n === 1) {\r\n                return 1;\r\n            } else if (MEMOIZED_FACT[n] > 0) {\r\n                return MEMOIZED_FACT[n];\r\n            } else {\r\n                MEMOIZED_FACT[n] = exports.FACT(n - 1) * n;\r\n                return MEMOIZED_FACT[n];\r\n            }\r\n        };\r\n\r\n        exports.FACTDOUBLE = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            var n = Math.floor(number);\r\n            if (n <= 0) {\r\n                return 1;\r\n            } else {\r\n                return n * exports.FACTDOUBLE(n - 2);\r\n            }\r\n        };\r\n\r\n        exports.FLOOR = function(number, significance, mode) {\r\n            significance = (significance === undefined) ? 1 : significance;\r\n            mode = (mode === undefined) ? 0 : mode;\r\n\r\n            number = utils.parseNumber(number);\r\n            significance = utils.parseNumber(significance);\r\n            mode = utils.parseNumber(mode);\r\n            if (utils.anyIsError(number, significance, mode)) {\r\n                return error.value;\r\n            }\r\n            if (significance === 0) {\r\n                return 0;\r\n            }\r\n\r\n            significance = Math.abs(significance);\r\n            if (number >= 0) {\r\n                return Math.floor(number / significance) * significance;\r\n            } else {\r\n                if (mode === 0) {\r\n                    return -1 * Math.ceil(Math.abs(number) / significance) * significance;\r\n                } else {\r\n                    return -1 * Math.floor(Math.abs(number) / significance) * significance;\r\n                }\r\n            }\r\n        };\r\n\r\n        exports.FLOOR.MATH = exports.FLOOR;\r\n\r\n        exports.GCD = null;\r\n\r\n        exports.INT = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return Math.floor(number);\r\n        };\r\n\r\n        exports.LCM = function() {\r\n            // Credits: Jonas Raoni Soares Silva\r\n            var o = utils.parseNumberArray(utils.flatten(arguments));\r\n            if (o instanceof Error) {\r\n                return o;\r\n            }\r\n            for (var i, j, n, d, r = 1;\r\n                 (n = o.pop()) !== undefined;) {\r\n                while (n > 1) {\r\n                    if (n % 2) {\r\n                        for (i = 3, j = Math.floor(Math.sqrt(n)); i <= j && n % i; i += 2) {\r\n                            // empty\r\n                        }\r\n                        d = (i <= j) ? i : n;\r\n                    } else {\r\n                        d = 2;\r\n                    }\r\n                    for (n /= d, r *= d, i = o.length; i;\r\n                         (o[--i] % d) === 0 && (o[i] /= d) === 1 && o.splice(i, 1)) {\r\n                        // empty\r\n                    }\r\n                }\r\n            }\r\n            return r;\r\n        };\r\n\r\n        exports.LN = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return Math.log(number);\r\n        };\r\n\r\n        exports.LOG = function(number, base) {\r\n            number = utils.parseNumber(number);\r\n            base = (base === undefined) ? 10 : utils.parseNumber(base);\r\n\r\n            if (utils.anyIsError(number, base)) {\r\n                return error.value;\r\n            }\r\n\r\n            return Math.log(number) / Math.log(base);\r\n        };\r\n\r\n        exports.LOG10 = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return Math.log(number) / Math.log(10);\r\n        };\r\n\r\n        exports.MDETERM = null;\r\n\r\n        exports.MINVERSE = null;\r\n\r\n        exports.MMULT = null;\r\n\r\n        exports.MOD = function(dividend, divisor) {\r\n            dividend = utils.parseNumber(dividend);\r\n            divisor = utils.parseNumber(divisor);\r\n            if (utils.anyIsError(dividend, divisor)) {\r\n                return error.value;\r\n            }\r\n            if (divisor === 0) {\r\n                return error.div0;\r\n            }\r\n            var modulus = Math.abs(dividend % divisor);\r\n            return (divisor > 0) ? modulus : -modulus;\r\n        };\r\n\r\n        exports.MROUND = function(number, multiple) {\r\n            number = utils.parseNumber(number);\r\n            multiple = utils.parseNumber(multiple);\r\n            if (utils.anyIsError(number, multiple)) {\r\n                return error.value;\r\n            }\r\n            if (number * multiple < 0) {\r\n                return error.num;\r\n            }\r\n\r\n            return Math.round(number / multiple) * multiple;\r\n        };\r\n\r\n        exports.MULTINOMIAL = function() {\r\n            var args = utils.parseNumberArray(utils.flatten(arguments));\r\n            if (args instanceof Error) {\r\n                return args;\r\n            }\r\n            var sum = 0;\r\n            var divisor = 1;\r\n            for (var i = 0; i < args.length; i++) {\r\n                sum += args[i];\r\n                divisor *= exports.FACT(args[i]);\r\n            }\r\n            return exports.FACT(sum) / divisor;\r\n        };\r\n\r\n        exports.MUNIT = null;\r\n\r\n        exports.ODD = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            var temp = Math.ceil(Math.abs(number));\r\n            temp = (temp & 1) ? temp : temp + 1;\r\n            return (number > 0) ? temp : -temp;\r\n        };\r\n\r\n        exports.PI = function() {\r\n            return Math.PI;\r\n        };\r\n\r\n        exports.POWER = function(number, power) {\r\n            number = utils.parseNumber(number);\r\n            power = utils.parseNumber(power);\r\n            if (utils.anyIsError(number, power)) {\r\n                return error.value;\r\n            }\r\n            var result = Math.pow(number, power);\r\n            if (isNaN(result)) {\r\n                return error.num;\r\n            }\r\n\r\n            return result;\r\n        };\r\n\r\n        exports.PRODUCT = function() {\r\n            var args = utils.parseNumberArray(utils.flatten(arguments));\r\n            if (args instanceof Error) {\r\n                return args;\r\n            }\r\n            var result = 1;\r\n            for (var i = 0; i < args.length; i++) {\r\n                result *= args[i];\r\n            }\r\n            return result;\r\n        };\r\n\r\n        exports.QUOTIENT = function(numerator, denominator) {\r\n            numerator = utils.parseNumber(numerator);\r\n            denominator = utils.parseNumber(denominator);\r\n            if (utils.anyIsError(numerator, denominator)) {\r\n                return error.value;\r\n            }\r\n            return parseInt(numerator / denominator, 10);\r\n        };\r\n\r\n        exports.RADIANS = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return number * Math.PI / 180;\r\n        };\r\n\r\n        exports.RAND = function() {\r\n            return Math.random();\r\n        };\r\n\r\n        exports.RANDBETWEEN = function(bottom, top) {\r\n            bottom = utils.parseNumber(bottom);\r\n            top = utils.parseNumber(top);\r\n            if (utils.anyIsError(bottom, top)) {\r\n                return error.value;\r\n            }\r\n            // Creative Commons Attribution 3.0 License\r\n            // Copyright (c) 2012 eqcode\r\n            return bottom + Math.ceil((top - bottom + 1) * Math.random()) - 1;\r\n        };\r\n\r\n        exports.ROMAN = null;\r\n\r\n        exports.ROUND = function(number, digits) {\r\n            number = utils.parseNumber(number);\r\n            digits = utils.parseNumber(digits);\r\n            if (utils.anyIsError(number, digits)) {\r\n                return error.value;\r\n            }\r\n            return Math.round(number * Math.pow(10, digits)) / Math.pow(10, digits);\r\n        };\r\n\r\n        exports.ROUNDDOWN = function(number, digits) {\r\n            number = utils.parseNumber(number);\r\n            digits = utils.parseNumber(digits);\r\n            if (utils.anyIsError(number, digits)) {\r\n                return error.value;\r\n            }\r\n            var sign = (number > 0) ? 1 : -1;\r\n            return sign * (Math.floor(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);\r\n        };\r\n\r\n        exports.ROUNDUP = function(number, digits) {\r\n            number = utils.parseNumber(number);\r\n            digits = utils.parseNumber(digits);\r\n            if (utils.anyIsError(number, digits)) {\r\n                return error.value;\r\n            }\r\n            var sign = (number > 0) ? 1 : -1;\r\n            return sign * (Math.ceil(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);\r\n        };\r\n\r\n        exports.SEC = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return 1 / Math.cos(number);\r\n        };\r\n\r\n        exports.SECH = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return 2 / (Math.exp(number) + Math.exp(-number));\r\n        };\r\n\r\n        exports.SERIESSUM = function(x, n, m, coefficients) {\r\n            x = utils.parseNumber(x);\r\n            n = utils.parseNumber(n);\r\n            m = utils.parseNumber(m);\r\n            coefficients = utils.parseNumberArray(coefficients);\r\n            if (utils.anyIsError(x, n, m, coefficients)) {\r\n                return error.value;\r\n            }\r\n            var result = coefficients[0] * Math.pow(x, n);\r\n            for (var i = 1; i < coefficients.length; i++) {\r\n                result += coefficients[i] * Math.pow(x, n + i * m);\r\n            }\r\n            return result;\r\n        };\r\n\r\n        exports.SIGN = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            if (number < 0) {\r\n                return -1;\r\n            } else if (number === 0) {\r\n                return 0;\r\n            } else {\r\n                return 1;\r\n            }\r\n        };\r\n\r\n        exports.SIN = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return Math.sin(number);\r\n        };\r\n\r\n        exports.SINH = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return (Math.exp(number) - Math.exp(-number)) / 2;\r\n        };\r\n\r\n        exports.SQRT = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            if (number < 0) {\r\n                return error.num;\r\n            }\r\n            return Math.sqrt(number);\r\n        };\r\n\r\n        exports.SQRTPI = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return Math.sqrt(number * Math.PI);\r\n        };\r\n\r\n        exports.SUBTOTAL = null;\r\n\r\n        exports.ADD = function (num1, num2) {\r\n            if (arguments.length !== 2) {\r\n                return error.na;\r\n            }\r\n\r\n            num1 = utils.parseNumber(num1);\r\n            num2 = utils.parseNumber(num2);\r\n            if (utils.anyIsError(num1, num2)) {\r\n                return error.value;\r\n            }\r\n\r\n            return num1 + num2;\r\n        };\r\n\r\n        exports.MINUS = function (num1, num2) {\r\n            if (arguments.length !== 2) {\r\n                return error.na;\r\n            }\r\n\r\n            num1 = utils.parseNumber(num1);\r\n            num2 = utils.parseNumber(num2);\r\n            if (utils.anyIsError(num1, num2)) {\r\n                return error.value;\r\n            }\r\n\r\n            return num1 - num2;\r\n        };\r\n\r\n        exports.DIVIDE = function (dividend, divisor) {\r\n            if (arguments.length !== 2) {\r\n                return error.na;\r\n            }\r\n\r\n            dividend = utils.parseNumber(dividend);\r\n            divisor = utils.parseNumber(divisor);\r\n            if (utils.anyIsError(dividend, divisor)) {\r\n                return error.value;\r\n            }\r\n\r\n            if (divisor === 0) {\r\n                return error.div0;\r\n            }\r\n\r\n            return dividend / divisor;\r\n        };\r\n\r\n        exports.MULTIPLY = function (factor1, factor2) {\r\n            if (arguments.length !== 2) {\r\n                return error.na;\r\n            }\r\n\r\n            factor1 = utils.parseNumber(factor1);\r\n            factor2 = utils.parseNumber(factor2);\r\n            if (utils.anyIsError(factor1, factor2)) {\r\n                return error.value;\r\n            }\r\n\r\n            return factor1 * factor2;\r\n        };\r\n\r\n        exports.GTE = function (num1, num2) {\r\n            if (arguments.length !== 2) {\r\n                return error.na;\r\n            }\r\n\r\n            num1 = utils.parseNumber(num1);\r\n            num2 = utils.parseNumber(num2);\r\n            if (utils.anyIsError(num1, num2)) {\r\n                return error.error;\r\n            }\r\n\r\n            return num1 >= num2;\r\n        };\r\n\r\n        exports.LT = function (num1, num2) {\r\n            if (arguments.length !== 2) {\r\n                return error.na;\r\n            }\r\n\r\n            num1 = utils.parseNumber(num1);\r\n            num2 = utils.parseNumber(num2);\r\n            if (utils.anyIsError(num1, num2)) {\r\n                return error.error;\r\n            }\r\n\r\n            return num1 < num2;\r\n        };\r\n\r\n        exports.LTE = function (num1, num2) {\r\n            if (arguments.length !== 2) {\r\n                return error.na;\r\n            }\r\n\r\n            num1 = utils.parseNumber(num1);\r\n            num2 = utils.parseNumber(num2);\r\n            if (utils.anyIsError(num1, num2)) {\r\n                return error.error;\r\n            }\r\n\r\n            return num1 <= num2;\r\n        };\r\n\r\n        exports.EQ = function (value1, value2) {\r\n            if (arguments.length !== 2) {\r\n                return error.na;\r\n            }\r\n\r\n            return value1 === value2;\r\n        };\r\n\r\n        exports.NE = function (value1, value2) {\r\n            if (arguments.length !== 2) {\r\n                return error.na;\r\n            }\r\n\r\n            return value1 !== value2;\r\n        };\r\n\r\n        exports.POW = function (base, exponent) {\r\n            if (arguments.length !== 2) {\r\n                return error.na;\r\n            }\r\n\r\n            base = utils.parseNumber(base);\r\n            exponent = utils.parseNumber(exponent);\r\n            if (utils.anyIsError(base, exponent)) {\r\n                return error.error;\r\n            }\r\n\r\n            return exports.POWER(base, exponent);\r\n        };\r\n\r\n        exports.SUM = function() {\r\n            var result = 0;\r\n            var argsKeys = Object.keys(arguments);\r\n            for (var i = 0; i < argsKeys.length; ++i) {\r\n                var elt = arguments[argsKeys[i]];\r\n                if (typeof elt === 'number') {\r\n                    result += elt;\r\n                } else if (typeof elt === 'string') {\r\n                    var parsed = parseFloat(elt);\r\n                    !isNaN(parsed) && (result += parsed);\r\n                } else if (Array.isArray(elt)) {\r\n                    result += exports.SUM.apply(null, elt);\r\n                }\r\n            }\r\n            return result;\r\n        };\r\n\r\n        exports.SUMIF = function() {\r\n            var args = utils.argsToArray(arguments);\r\n            var criteria = args.pop();\r\n            var range = utils.parseNumberArray(utils.flatten(args));\r\n            if (range instanceof Error) {\r\n                return range;\r\n            }\r\n            var result = 0;\r\n            for (var i = 0; i < range.length; i++) {\r\n                result += (eval(range[i] + criteria)) ? range[i] : 0; // jshint ignore:line\r\n            }\r\n            return result;\r\n        };\r\n\r\n        exports.SUMIFS = function () {\r\n            var args = utils.argsToArray(arguments);\r\n            var range = utils.parseNumberArray(utils.flatten(args.shift()));\r\n            if (range instanceof Error) {\r\n                return range;\r\n            }\r\n            var criteria = args;\r\n\r\n            var n_range_elements = range.length;\r\n            var n_criterias = criteria.length;\r\n\r\n            var result = 0;\r\n\r\n            for (var i = 0; i < n_range_elements; i++) {\r\n                var el = range[i];\r\n                var condition = '';\r\n                for (var c = 0; c < n_criterias; c+=2) {\r\n                    if(isNaN(criteria[c][i])){\r\n                        condition += '\"' + criteria[c][i] + '\"' + criteria[c+1];\r\n                    }\r\n                    else {\r\n                        condition += criteria[c][i] + criteria[c + 1];\r\n                    }\r\n                    if (c !== n_criterias - 1) {\r\n                        condition += ' && ';\r\n                    }\r\n                }\r\n                condition = condition.slice(0,-4)\r\n                if (eval(condition)) { // jshint ignore:line\r\n                    result += el;\r\n                }\r\n            }\r\n            return result;\r\n        };\r\n\r\n        exports.SUMPRODUCT = null;\r\n\r\n        exports.SUMSQ = function() {\r\n            var numbers = utils.parseNumberArray(utils.flatten(arguments));\r\n            if (numbers instanceof Error) {\r\n                return numbers;\r\n            }\r\n            var result = 0;\r\n            var length = numbers.length;\r\n            for (var i = 0; i < length; i++) {\r\n                result += (ISNUMBER(numbers[i])) ? numbers[i] * numbers[i] : 0;\r\n            }\r\n            return result;\r\n        };\r\n\r\n        exports.SUMX2MY2 = function(array_x, array_y) {\r\n            array_x = utils.parseNumberArray(utils.flatten(array_x));\r\n            array_y = utils.parseNumberArray(utils.flatten(array_y));\r\n            if (utils.anyIsError(array_x, array_y)) {\r\n                return error.value;\r\n            }\r\n            var result = 0;\r\n            for (var i = 0; i < array_x.length; i++) {\r\n                result += array_x[i] * array_x[i] - array_y[i] * array_y[i];\r\n            }\r\n            return result;\r\n        };\r\n\r\n        exports.SUMX2PY2 = function(array_x, array_y) {\r\n            array_x = utils.parseNumberArray(utils.flatten(array_x));\r\n            array_y = utils.parseNumberArray(utils.flatten(array_y));\r\n            if (utils.anyIsError(array_x, array_y)) {\r\n                return error.value;\r\n            }\r\n            var result = 0;\r\n            array_x = utils.parseNumberArray(utils.flatten(array_x));\r\n            array_y = utils.parseNumberArray(utils.flatten(array_y));\r\n            for (var i = 0; i < array_x.length; i++) {\r\n                result += array_x[i] * array_x[i] + array_y[i] * array_y[i];\r\n            }\r\n            return result;\r\n        };\r\n\r\n        exports.SUMXMY2 = function(array_x, array_y) {\r\n            array_x = utils.parseNumberArray(utils.flatten(array_x));\r\n            array_y = utils.parseNumberArray(utils.flatten(array_y));\r\n            if (utils.anyIsError(array_x, array_y)) {\r\n                return error.value;\r\n            }\r\n            var result = 0;\r\n            array_x = utils.flatten(array_x);\r\n            array_y = utils.flatten(array_y);\r\n            for (var i = 0; i < array_x.length; i++) {\r\n                result += Math.pow(array_x[i] - array_y[i], 2);\r\n            }\r\n            return result;\r\n        };\r\n\r\n        exports.TAN = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return Math.tan(number);\r\n        };\r\n\r\n        exports.TANH = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            var e2 = Math.exp(2 * number);\r\n            return (e2 - 1) / (e2 + 1);\r\n        };\r\n\r\n        exports.TRUNC = function(number, digits) {\r\n            digits = (digits === undefined) ? 0 : digits;\r\n            number = utils.parseNumber(number);\r\n            digits = utils.parseNumber(digits);\r\n            if (utils.anyIsError(number, digits)) {\r\n                return error.value;\r\n            }\r\n            var sign = (number > 0) ? 1 : -1;\r\n            return sign * (Math.floor(Math.abs(number) * Math.pow(10, digits))) / Math.pow(10, digits);\r\n        };\r\n\r\n        return exports;\r\n    })();\r\n\r\n    met.misc = (function() {\r\n        var exports = {};\r\n\r\n        exports.UNIQUE = function () {\r\n            var result = [];\r\n            for (var i = 0; i < arguments.length; ++i) {\r\n                var hasElement = false;\r\n                var element = arguments[i];\r\n\r\n                // Check if we've already seen this element.\r\n                for (var j = 0; j < result.length; ++j) {\r\n                    hasElement = result[j] === element;\r\n                    if (hasElement) { break; }\r\n                }\r\n\r\n                // If we did not find it, add it to the result.\r\n                if (!hasElement) {\r\n                    result.push(element);\r\n                }\r\n            }\r\n            return result;\r\n        };\r\n\r\n        exports.FLATTEN = utils.flatten;\r\n\r\n        exports.ARGS2ARRAY = function () {\r\n            return Array.prototype.slice.call(arguments, 0);\r\n        };\r\n\r\n        exports.REFERENCE = function (context, reference) {\r\n            try {\r\n                var path = reference.split('.');\r\n                var result = context;\r\n                for (var i = 0; i < path.length; ++i) {\r\n                    var step = path[i];\r\n                    if (step[step.length - 1] === ']') {\r\n                        var opening = step.indexOf('[');\r\n                        var index = step.substring(opening + 1, step.length - 1);\r\n                        result = result[step.substring(0, opening)][index];\r\n                    } else {\r\n                        result = result[step];\r\n                    }\r\n                }\r\n                return result;\r\n            } catch (error) {}\r\n        };\r\n\r\n        exports.JOIN = function (array, separator) {\r\n            return array.join(separator);\r\n        };\r\n\r\n        exports.NUMBERS = function () {\r\n            var possibleNumbers = utils.flatten(arguments);\r\n            return possibleNumbers.filter(function (el) {\r\n                return typeof el === 'number';\r\n            });\r\n        };\r\n\r\n        exports.NUMERAL = null;\r\n\r\n        return exports;\r\n    })();\r\n\r\n    met.text = (function() {\r\n        var exports = {};\r\n\r\n        exports.ASC = null;\r\n\r\n        exports.BAHTTEXT = null;\r\n\r\n        exports.CHAR = function(number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return String.fromCharCode(number);\r\n        };\r\n\r\n        exports.CLEAN = function(text) {\r\n            text = text || '';\r\n            var re = /[\\0-\\x1F]/g;\r\n            return text.replace(re, \"\");\r\n        };\r\n\r\n        exports.CODE = function(text) {\r\n            text = text || '';\r\n            return text.charCodeAt(0);\r\n        };\r\n\r\n        exports.CONCATENATE = function() {\r\n            var args = utils.flatten(arguments);\r\n\r\n            var trueFound = 0;\r\n            while ((trueFound = args.indexOf(true)) > -1) {\r\n                args[trueFound] = 'TRUE';\r\n            }\r\n\r\n            var falseFound = 0;\r\n            while ((falseFound = args.indexOf(false)) > -1) {\r\n                args[falseFound] = 'FALSE';\r\n            }\r\n\r\n            return args.join('');\r\n        };\r\n\r\n        exports.DBCS = null;\r\n\r\n        exports.DOLLAR = null;\r\n\r\n        exports.EXACT = function(text1, text2) {\r\n            return text1 === text2;\r\n        };\r\n\r\n        exports.FIND = function(find_text, within_text, position) {\r\n            position = (position === undefined) ? 0 : position;\r\n            return within_text ? within_text.indexOf(find_text, position - 1) + 1 : null;\r\n        };\r\n\r\n        exports.FIXED = null;\r\n\r\n        exports.HTML2TEXT = function (value) {\r\n            var result = '';\r\n\r\n            if (value) {\r\n                if (value instanceof Array) {\r\n                    value.forEach(function (line) {\r\n                        if (result !== '') {\r\n                            result += '\\n';\r\n                        }\r\n                        result += (line.replace(/<(?:.|\\n)*?>/gm, ''));\r\n                    });\r\n                } else {\r\n                    result = value.replace(/<(?:.|\\n)*?>/gm, '');\r\n                }\r\n            }\r\n\r\n            return result;\r\n        };\r\n\r\n        exports.LEFT = function(text, number) {\r\n            number = (number === undefined) ? 1 : number;\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error || typeof text !== 'string') {\r\n                return error.value;\r\n            }\r\n            return text ? text.substring(0, number) : null;\r\n        };\r\n\r\n        exports.LEN = function(text) {\r\n            if (arguments.length === 0) {\r\n                return error.error;\r\n            }\r\n\r\n            if (typeof text === 'string') {\r\n                return text ? text.length : 0;\r\n            }\r\n\r\n            if (text.length) {\r\n                return text.length;\r\n            }\r\n\r\n            return error.value;\r\n        };\r\n\r\n        exports.LOWER = function(text) {\r\n            if (typeof text !== 'string') {\r\n                return error.value;\r\n            }\r\n            return text ? text.toLowerCase() : text;\r\n        };\r\n\r\n        exports.MID = function(text, start, number) {\r\n            start = utils.parseNumber(start);\r\n            number = utils.parseNumber(number);\r\n            if (utils.anyIsError(start, number) || typeof text !== 'string') {\r\n                return number;\r\n            }\r\n\r\n            var begin = start - 1;\r\n            var end = begin + number;\r\n\r\n            return text.substring(begin, end);\r\n        };\r\n\r\n        exports.NUMBERVALUE = null;\r\n\r\n        exports.PRONETIC = null;\r\n\r\n        exports.PROPER = function(text) {\r\n            if (text === undefined || text.length === 0) {\r\n                return error.value;\r\n            }\r\n            if (text === true) {\r\n                text = 'TRUE';\r\n            }\r\n            if (text === false) {\r\n                text = 'FALSE';\r\n            }\r\n            if (isNaN(text) && typeof text === 'number') {\r\n                return error.value;\r\n            }\r\n            if (typeof text === 'number') {\r\n                text = '' + text;\r\n            }\r\n\r\n            return text.replace(/\\w\\S*/g, function(txt) {\r\n                return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\r\n            });\r\n        };\r\n\r\n        exports.REGEXEXTRACT = function (text, regular_expression) {\r\n            var match = text.match(new RegExp(regular_expression));\r\n            return match ? (match[match.length > 1 ? match.length - 1 : 0]) : null;\r\n        };\r\n\r\n        exports.REGEXMATCH = function (text, regular_expression, full) {\r\n            var match = text.match(new RegExp(regular_expression));\r\n            return full ? match : !!match;\r\n        };\r\n\r\n        exports.REGEXREPLACE = function (text, regular_expression, replacement) {\r\n            return text.replace(new RegExp(regular_expression), replacement);\r\n        };\r\n\r\n        exports.REPLACE = function(text, position, length, new_text) {\r\n            position = utils.parseNumber(position);\r\n            length = utils.parseNumber(length);\r\n            if (utils.anyIsError(position, length) ||\r\n                typeof text !== 'string' ||\r\n                typeof new_text !== 'string') {\r\n                return error.value;\r\n            }\r\n            return text.substr(0, position - 1) + new_text + text.substr(position - 1 + length);\r\n        };\r\n\r\n        exports.REPT = function(text, number) {\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return new Array(number + 1).join(text);\r\n        };\r\n\r\n        exports.RIGHT = function(text, number) {\r\n            number = (number === undefined) ? 1 : number;\r\n            number = utils.parseNumber(number);\r\n            if (number instanceof Error) {\r\n                return number;\r\n            }\r\n            return text ? text.substring(text.length - number) : null;\r\n        };\r\n\r\n        exports.SEARCH = function(find_text, within_text, position) {\r\n            var foundAt;\r\n            if (typeof find_text !== 'string' || typeof within_text !== 'string') {\r\n                return error.value;\r\n            }\r\n            position = (position === undefined) ? 0 : position;\r\n            foundAt = within_text.toLowerCase().indexOf(find_text.toLowerCase(), position - 1)+1;\r\n            return (foundAt === 0)?error.value:foundAt;\r\n        };\r\n\r\n        exports.SPLIT = function (text, separator) {\r\n            return text.split(separator);\r\n        };\r\n\r\n        exports.SUBSTITUTE = function(text, old_text, new_text, occurrence) {\r\n            if (!text || !old_text || !new_text) {\r\n                return text;\r\n            } else if (occurrence === undefined) {\r\n                return text.replace(new RegExp(old_text, 'g'), new_text);\r\n            } else {\r\n                var index = 0;\r\n                var i = 0;\r\n                while (text.indexOf(old_text, index) > 0) {\r\n                    index = text.indexOf(old_text, index + 1);\r\n                    i++;\r\n                    if (i === occurrence) {\r\n                        return text.substring(0, index) + new_text + text.substring(index + old_text.length);\r\n                    }\r\n                }\r\n            }\r\n        };\r\n\r\n        exports.T = function(value) {\r\n            return (typeof value === \"string\") ? value : '';\r\n        };\r\n\r\n        exports.TEXT = null;\r\n\r\n        exports.TRIM = function(text) {\r\n            if (typeof text !== 'string') {\r\n                return error.value;\r\n            }\r\n            return text.replace(/ +/g, ' ').trim();\r\n        };\r\n\r\n        exports.UNICHAR = exports.CHAR;\r\n\r\n        exports.UNICODE = exports.CODE;\r\n\r\n        exports.UPPER = function(text) {\r\n            if (typeof text !== 'string') {\r\n                return error.value;\r\n            }\r\n            return text.toUpperCase();\r\n        };\r\n\r\n        exports.VALUE = null;\r\n\r\n        return exports;\r\n    })();\r\n\r\n    met.stats = (function() {\r\n        var exports = {};\r\n\r\n        var SQRT2PI = 2.5066282746310002;\r\n\r\n        exports.AVEDEV = null;\r\n\r\n        exports.AVERAGE = function() {\r\n            var range = utils.numbers(utils.flatten(arguments));\r\n            var n = range.length;\r\n            var sum = 0;\r\n            var count = 0;\r\n            for (var i = 0; i < n; i++) {\r\n                sum += range[i];\r\n                count += 1;\r\n            }\r\n            return sum / count;\r\n        };\r\n\r\n        exports.AVERAGEA = function() {\r\n            var range = utils.flatten(arguments);\r\n            var n = range.length;\r\n            var sum = 0;\r\n            var count = 0;\r\n            for (var i = 0; i < n; i++) {\r\n                var el = range[i];\r\n                if (typeof el === 'number') {\r\n                    sum += el;\r\n                }\r\n                if (el === true) {\r\n                    sum++;\r\n                }\r\n                if (el !== null) {\r\n                    count++;\r\n                }\r\n            }\r\n            return sum / count;\r\n        };\r\n\r\n        exports.AVERAGEIF = function(range, criteria, average_range) {\r\n            average_range = average_range || range;\r\n            range = utils.flatten(range);\r\n            average_range = utils.parseNumberArray(utils.flatten(average_range));\r\n            if (average_range instanceof Error) {\r\n                return average_range;\r\n            }\r\n            var average_count = 0;\r\n            var result = 0;\r\n            for (var i = 0; i < range.length; i++) {\r\n                if (eval(range[i] + criteria)) { // jshint ignore:line\r\n                    result += average_range[i];\r\n                    average_count++;\r\n                }\r\n            }\r\n            return result / average_count;\r\n        };\r\n\r\n        exports.AVERAGEIFS = null;\r\n\r\n        exports.COUNT = function() {\r\n            return utils.numbers(utils.flatten(arguments)).length;\r\n        };\r\n\r\n        exports.COUNTA = function() {\r\n            var range = utils.flatten(arguments);\r\n            return range.length - exports.COUNTBLANK(range);\r\n        };\r\n\r\n        exports.COUNTIN = function (range, value) {\r\n            var result = 0;\r\n            for (var i = 0; i < range.length; i++) {\r\n                if (range[i] === value) {\r\n                    result++;\r\n                }\r\n            }\r\n            return result;\r\n        };\r\n\r\n        exports.COUNTBLANK = function() {\r\n            var range = utils.flatten(arguments);\r\n            var blanks = 0;\r\n            var element;\r\n            for (var i = 0; i < range.length; i++) {\r\n                element = range[i];\r\n                if (element === null || element === '') {\r\n                    blanks++;\r\n                }\r\n            }\r\n            return blanks;\r\n        };\r\n\r\n        exports.COUNTIF = function() {\r\n            var args = utils.argsToArray(arguments);\r\n            var criteria = args.pop();\r\n            var range = utils.flatten(args);\r\n            if (!/[<>=!]/.test(criteria)) {\r\n                criteria = '==\"' + criteria + '\"';\r\n            }\r\n            var matches = 0;\r\n            for (var i = 0; i < range.length; i++) {\r\n                if (typeof range[i] !== 'string') {\r\n                    if (eval(range[i] + criteria)) { // jshint ignore:line\r\n                        matches++;\r\n                    }\r\n                } else {\r\n                    if (eval('\"' + range[i] + '\"' + criteria)) { // jshint ignore:line\r\n                        matches++;\r\n                    }\r\n                }\r\n            }\r\n            return matches;\r\n        };\r\n\r\n        exports.COUNTIFS = function() {\r\n            var args = utils.argsToArray(arguments);\r\n            var results = new Array(utils.flatten(args[0]).length);\r\n            for (var i = 0; i < results.length; i++) {\r\n                results[i] = true;\r\n            }\r\n            for (i = 0; i < args.length; i += 2) {\r\n                var range = utils.flatten(args[i]);\r\n                var criteria = args[i + 1];\r\n                if (!/[<>=!]/.test(criteria)) {\r\n                    criteria = '==\"' + criteria + '\"';\r\n                }\r\n                for (var j = 0; j < range.length; j++) {\r\n                    if (typeof range[j] !== 'string') {\r\n                        results[j] = results[j] && eval(range[j] + criteria); // jshint ignore:line\r\n                    } else {\r\n                        results[j] = results[j] && eval('\"' + range[j] + '\"' + criteria); // jshint ignore:line\r\n                    }\r\n                }\r\n            }\r\n            var result = 0;\r\n            for (i = 0; i < results.length; i++) {\r\n                if (results[i]) {\r\n                    result++;\r\n                }\r\n            }\r\n            return result;\r\n        };\r\n\r\n        exports.COUNTUNIQUE = function () {\r\n            return UNIQUE.apply(null, utils.flatten(arguments)).length;\r\n        };\r\n\r\n        exports.FISHER = function(x) {\r\n            x = utils.parseNumber(x);\r\n            if (x instanceof Error) {\r\n                return x;\r\n            }\r\n            return Math.log((1 + x) / (1 - x)) / 2;\r\n        };\r\n\r\n        exports.FISHERINV = function(y) {\r\n            y = utils.parseNumber(y);\r\n            if (y instanceof Error) {\r\n                return y;\r\n            }\r\n            var e2y = Math.exp(2 * y);\r\n            return (e2y - 1) / (e2y + 1);\r\n        };\r\n\r\n        exports.FREQUENCY = function(data, bins) {\r\n            data = utils.parseNumberArray(utils.flatten(data));\r\n            bins = utils.parseNumberArray(utils.flatten(bins));\r\n            if (utils.anyIsError(data, bins)) {\r\n                return error.value;\r\n            }\r\n            var n = data.length;\r\n            var b = bins.length;\r\n            var r = [];\r\n            for (var i = 0; i <= b; i++) {\r\n                r[i] = 0;\r\n                for (var j = 0; j < n; j++) {\r\n                    if (i === 0) {\r\n                        if (data[j] <= bins[0]) {\r\n                            r[0] += 1;\r\n                        }\r\n                    } else if (i < b) {\r\n                        if (data[j] > bins[i - 1] && data[j] <= bins[i]) {\r\n                            r[i] += 1;\r\n                        }\r\n                    } else if (i === b) {\r\n                        if (data[j] > bins[b - 1]) {\r\n                            r[b] += 1;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return r;\r\n        };\r\n\r\n        exports.LARGE = function(range, k) {\r\n            range = utils.parseNumberArray(utils.flatten(range));\r\n            k = utils.parseNumber(k);\r\n            if (utils.anyIsError(range, k)) {\r\n                return range;\r\n            }\r\n            return range.sort(function(a, b) {\r\n                return b - a;\r\n            })[k - 1];\r\n        };\r\n\r\n        exports.MAX = function() {\r\n            var range = utils.numbers(utils.flatten(arguments));\r\n            return (range.length === 0) ? 0 : Math.max.apply(Math, range);\r\n        };\r\n\r\n        exports.MAXA = function() {\r\n            var range = utils.arrayValuesToNumbers(utils.flatten(arguments));\r\n            return (range.length === 0) ? 0 : Math.max.apply(Math, range);\r\n        };\r\n\r\n        exports.MIN = function() {\r\n            var range = utils.numbers(utils.flatten(arguments));\r\n            return (range.length === 0) ? 0 : Math.min.apply(Math, range);\r\n        };\r\n\r\n        exports.MINA = function() {\r\n            var range = utils.arrayValuesToNumbers(utils.flatten(arguments));\r\n            return (range.length === 0) ? 0 : Math.min.apply(Math, range);\r\n        };\r\n\r\n        exports.MODE = {};\r\n\r\n        exports.MODE.MULT = function() {\r\n            // Credits: Roönaän\r\n            var range = utils.parseNumberArray(utils.flatten(arguments));\r\n            if (range instanceof Error) {\r\n                return range;\r\n            }\r\n            var n = range.length;\r\n            var count = {};\r\n            var maxItems = [];\r\n            var max = 0;\r\n            var currentItem;\r\n\r\n            for (var i = 0; i < n; i++) {\r\n                currentItem = range[i];\r\n                count[currentItem] = count[currentItem] ? count[currentItem] + 1 : 1;\r\n                if (count[currentItem] > max) {\r\n                    max = count[currentItem];\r\n                    maxItems = [];\r\n                }\r\n                if (count[currentItem] === max) {\r\n                    maxItems[maxItems.length] = currentItem;\r\n                }\r\n            }\r\n            return maxItems;\r\n        };\r\n\r\n        exports.MODE.SNGL = function() {\r\n            var range = utils.parseNumberArray(utils.flatten(arguments));\r\n            if (range instanceof Error) {\r\n                return range;\r\n            }\r\n            return exports.MODE.MULT(range).sort(function(a, b) {\r\n                return a - b;\r\n            })[0];\r\n        };\r\n\r\n        exports.PERCENTILE = {};\r\n\r\n        exports.PERCENTILE.EXC = function(array, k) {\r\n            array = utils.parseNumberArray(utils.flatten(array));\r\n            k = utils.parseNumber(k);\r\n            if (utils.anyIsError(array, k)) {\r\n                return error.value;\r\n            }\r\n            array = array.sort(function(a, b) {\r\n                {\r\n                    return a - b;\r\n                }\r\n            });\r\n            var n = array.length;\r\n            if (k < 1 / (n + 1) || k > 1 - 1 / (n + 1)) {\r\n                return error.num;\r\n            }\r\n            var l = k * (n + 1) - 1;\r\n            var fl = Math.floor(l);\r\n            return utils.cleanFloat((l === fl) ? array[l] : array[fl] + (l - fl) * (array[fl + 1] - array[fl]));\r\n        };\r\n\r\n        exports.PERCENTILE.INC = function(array, k) {\r\n            array = utils.parseNumberArray(utils.flatten(array));\r\n            k = utils.parseNumber(k);\r\n            if (utils.anyIsError(array, k)) {\r\n                return error.value;\r\n            }\r\n            array = array.sort(function(a, b) {\r\n                return a - b;\r\n            });\r\n            var n = array.length;\r\n            var l = k * (n - 1);\r\n            var fl = Math.floor(l);\r\n            return utils.cleanFloat((l === fl) ? array[l] : array[fl] + (l - fl) * (array[fl + 1] - array[fl]));\r\n        };\r\n\r\n        exports.PERCENTRANK = {};\r\n\r\n        exports.PERCENTRANK.EXC = function(array, x, significance) {\r\n            significance = (significance === undefined) ? 3 : significance;\r\n            array = utils.parseNumberArray(utils.flatten(array));\r\n            x = utils.parseNumber(x);\r\n            significance = utils.parseNumber(significance);\r\n            if (utils.anyIsError(array, x, significance)) {\r\n                return error.value;\r\n            }\r\n            array = array.sort(function(a, b) {\r\n                return a - b;\r\n            });\r\n            var uniques = UNIQUE.apply(null, array);\r\n            var n = array.length;\r\n            var m = uniques.length;\r\n            var power = Math.pow(10, significance);\r\n            var result = 0;\r\n            var match = false;\r\n            var i = 0;\r\n            while (!match && i < m) {\r\n                if (x === uniques[i]) {\r\n                    result = (array.indexOf(uniques[i]) + 1) / (n + 1);\r\n                    match = true;\r\n                } else if (x >= uniques[i] && (x < uniques[i + 1] || i === m - 1)) {\r\n                    result = (array.indexOf(uniques[i]) + 1 + (x - uniques[i]) / (uniques[i + 1] - uniques[i])) / (n + 1);\r\n                    match = true;\r\n                }\r\n                i++;\r\n            }\r\n            return Math.floor(result * power) / power;\r\n        };\r\n\r\n        exports.PERCENTRANK.INC = function(array, x, significance) {\r\n            significance = (significance === undefined) ? 3 : significance;\r\n            array = utils.parseNumberArray(utils.flatten(array));\r\n            x = utils.parseNumber(x);\r\n            significance = utils.parseNumber(significance);\r\n            if (utils.anyIsError(array, x, significance)) {\r\n                return error.value;\r\n            }\r\n            array = array.sort(function(a, b) {\r\n                return a - b;\r\n            });\r\n            var uniques = UNIQUE.apply(null, array);\r\n            var n = array.length;\r\n            var m = uniques.length;\r\n            var power = Math.pow(10, significance);\r\n            var result = 0;\r\n            var match = false;\r\n            var i = 0;\r\n            while (!match && i < m) {\r\n                if (x === uniques[i]) {\r\n                    result = array.indexOf(uniques[i]) / (n - 1);\r\n                    match = true;\r\n                } else if (x >= uniques[i] && (x < uniques[i + 1] || i === m - 1)) {\r\n                    result = (array.indexOf(uniques[i]) + (x - uniques[i]) / (uniques[i + 1] - uniques[i])) / (n - 1);\r\n                    match = true;\r\n                }\r\n                i++;\r\n            }\r\n            return Math.floor(result * power) / power;\r\n        };\r\n\r\n        exports.PERMUT = function(number, number_chosen) {\r\n            number = utils.parseNumber(number);\r\n            number_chosen = utils.parseNumber(number_chosen);\r\n            if (utils.anyIsError(number, number_chosen)) {\r\n                return error.value;\r\n            }\r\n            return FACT(number) / FACT(number - number_chosen);\r\n        };\r\n\r\n        exports.PERMUTATIONA = function(number, number_chosen) {\r\n            number = utils.parseNumber(number);\r\n            number_chosen = utils.parseNumber(number_chosen);\r\n            if (utils.anyIsError(number, number_chosen)) {\r\n                return error.value;\r\n            }\r\n            return Math.pow(number, number_chosen);\r\n        };\r\n\r\n        exports.PHI = function(x) {\r\n            x = utils.parseNumber(x);\r\n            if (x instanceof Error) {\r\n                return error.value;\r\n            }\r\n            return Math.exp(-0.5 * x * x) / SQRT2PI;\r\n        };\r\n\r\n        exports.PROB = function(range, probability, lower, upper) {\r\n            if (lower === undefined) {\r\n                return 0;\r\n            }\r\n            upper = (upper === undefined) ? lower : upper;\r\n\r\n            range = utils.parseNumberArray(utils.flatten(range));\r\n            probability = utils.parseNumberArray(utils.flatten(probability));\r\n            lower = utils.parseNumber(lower);\r\n            upper = utils.parseNumber(upper);\r\n            if (utils.anyIsError(range, probability, lower, upper)) {\r\n                return error.value;\r\n            }\r\n\r\n            if (lower === upper) {\r\n                return (range.indexOf(lower) >= 0) ? probability[range.indexOf(lower)] : 0;\r\n            }\r\n\r\n            var sorted = range.sort(function(a, b) {\r\n                return a - b;\r\n            });\r\n            var n = sorted.length;\r\n            var result = 0;\r\n            for (var i = 0; i < n; i++) {\r\n                if (sorted[i] >= lower && sorted[i] <= upper) {\r\n                    result += probability[range.indexOf(sorted[i])];\r\n                }\r\n            }\r\n            return result;\r\n        };\r\n\r\n        exports.QUARTILE = {};\r\n\r\n        exports.QUARTILE.EXC = function(range, quart) {\r\n            range = utils.parseNumberArray(utils.flatten(range));\r\n            quart = utils.parseNumber(quart);\r\n            if (utils.anyIsError(range, quart)) {\r\n                return error.value;\r\n            }\r\n            switch (quart) {\r\n                case 1:\r\n                    return exports.PERCENTILE.EXC(range, 0.25);\r\n                case 2:\r\n                    return exports.PERCENTILE.EXC(range, 0.5);\r\n                case 3:\r\n                    return exports.PERCENTILE.EXC(range, 0.75);\r\n                default:\r\n                    return error.num;\r\n            }\r\n        };\r\n\r\n        exports.QUARTILE.INC = function(range, quart) {\r\n            range = utils.parseNumberArray(utils.flatten(range));\r\n            quart = utils.parseNumber(quart);\r\n            if (utils.anyIsError(range, quart)) {\r\n                return error.value;\r\n            }\r\n            switch (quart) {\r\n                case 1:\r\n                    return exports.PERCENTILE.INC(range, 0.25);\r\n                case 2:\r\n                    return exports.PERCENTILE.INC(range, 0.5);\r\n                case 3:\r\n                    return exports.PERCENTILE.INC(range, 0.75);\r\n                default:\r\n                    return error.num;\r\n            }\r\n        };\r\n\r\n        exports.RANK = {};\r\n\r\n        exports.RANK.AVG = function(number, range, order) {\r\n            number = utils.parseNumber(number);\r\n            range = utils.parseNumberArray(utils.flatten(range));\r\n            if (utils.anyIsError(number, range)) {\r\n                return error.value;\r\n            }\r\n            range = utils.flatten(range);\r\n            order = order || false;\r\n            var sort = (order) ? function(a, b) {\r\n                return a - b;\r\n            } : function(a, b) {\r\n                return b - a;\r\n            };\r\n            range = range.sort(sort);\r\n\r\n            var length = range.length;\r\n            var count = 0;\r\n            for (var i = 0; i < length; i++) {\r\n                if (range[i] === number) {\r\n                    count++;\r\n                }\r\n            }\r\n\r\n            return (count > 1) ? (2 * range.indexOf(number) + count + 1) / 2 : range.indexOf(number) + 1;\r\n        };\r\n\r\n        exports.RANK.EQ = function(number, range, order) {\r\n            number = utils.parseNumber(number);\r\n            range = utils.parseNumberArray(utils.flatten(range));\r\n            if (utils.anyIsError(number, range)) {\r\n                return error.value;\r\n            }\r\n            order = order || false;\r\n            var sort = (order) ? function(a, b) {\r\n                return a - b;\r\n            } : function(a, b) {\r\n                return b - a;\r\n            };\r\n            range = range.sort(sort);\r\n            return range.indexOf(number) + 1;\r\n        };\r\n\r\n        exports.RSQ = function(data_x, data_y) { // no need to flatten here, PEARSON will take care of that\r\n            data_x = utils.parseNumberArray(utils.flatten(data_x));\r\n            data_y = utils.parseNumberArray(utils.flatten(data_y));\r\n            if (utils.anyIsError(data_x, data_y)) {\r\n                return error.value;\r\n            }\r\n            return Math.pow(exports.PEARSON(data_x, data_y), 2);\r\n        };\r\n\r\n        exports.SMALL = function(range, k) {\r\n            range = utils.parseNumberArray(utils.flatten(range));\r\n            k = utils.parseNumber(k);\r\n            if (utils.anyIsError(range, k)) {\r\n                return range;\r\n            }\r\n            return range.sort(function(a, b) {\r\n                return a - b;\r\n            })[k - 1];\r\n        };\r\n\r\n        exports.STANDARDIZE = function(x, mean, sd) {\r\n            x = utils.parseNumber(x);\r\n            mean = utils.parseNumber(mean);\r\n            sd = utils.parseNumber(sd);\r\n            if (utils.anyIsError(x, mean, sd)) {\r\n                return error.value;\r\n            }\r\n            return (x - mean) / sd;\r\n        };\r\n\r\n        exports.STDEV = {};\r\n\r\n        exports.STDEV.P = function() {\r\n            var v = exports.VAR.P.apply(this, arguments);\r\n            return Math.sqrt(v);\r\n        };\r\n\r\n        exports.STDEV.S = function() {\r\n            var v = exports.VAR.S.apply(this, arguments);\r\n            return Math.sqrt(v);\r\n        };\r\n\r\n        exports.STDEVA = function() {\r\n            var v = exports.VARA.apply(this, arguments);\r\n            return Math.sqrt(v);\r\n        };\r\n\r\n        exports.STDEVPA = function() {\r\n            var v = exports.VARPA.apply(this, arguments);\r\n            return Math.sqrt(v);\r\n        };\r\n\r\n        exports.VAR = {};\r\n\r\n        exports.VAR.P = function() {\r\n            var range = utils.numbers(utils.flatten(arguments));\r\n            var n = range.length;\r\n            var sigma = 0;\r\n            var mean = exports.AVERAGE(range);\r\n            for (var i = 0; i < n; i++) {\r\n                sigma += Math.pow(range[i] - mean, 2);\r\n            }\r\n            return sigma / n;\r\n        };\r\n\r\n        exports.VAR.S = function() {\r\n            var range = utils.numbers(utils.flatten(arguments));\r\n            var n = range.length;\r\n            var sigma = 0;\r\n            var mean = exports.AVERAGE(range);\r\n            for (var i = 0; i < n; i++) {\r\n                sigma += Math.pow(range[i] - mean, 2);\r\n            }\r\n            return sigma / (n - 1);\r\n        };\r\n\r\n        exports.VARA = function() {\r\n            var range = utils.flatten(arguments);\r\n            var n = range.length;\r\n            var sigma = 0;\r\n            var count = 0;\r\n            var mean = exports.AVERAGEA(range);\r\n            for (var i = 0; i < n; i++) {\r\n                var el = range[i];\r\n                if (typeof el === 'number') {\r\n                    sigma += Math.pow(el - mean, 2);\r\n                } else if (el === true) {\r\n                    sigma += Math.pow(1 - mean, 2);\r\n                } else {\r\n                    sigma += Math.pow(0 - mean, 2);\r\n                }\r\n\r\n                if (el !== null) {\r\n                    count++;\r\n                }\r\n            }\r\n            return sigma / (count - 1);\r\n        };\r\n\r\n        exports.VARPA = function() {\r\n            var range = utils.flatten(arguments);\r\n            var n = range.length;\r\n            var sigma = 0;\r\n            var count = 0;\r\n            var mean = exports.AVERAGEA(range);\r\n            for (var i = 0; i < n; i++) {\r\n                var el = range[i];\r\n                if (typeof el === 'number') {\r\n                    sigma += Math.pow(el - mean, 2);\r\n                } else if (el === true) {\r\n                    sigma += Math.pow(1 - mean, 2);\r\n                } else {\r\n                    sigma += Math.pow(0 - mean, 2);\r\n                }\r\n\r\n                if (el !== null) {\r\n                    count++;\r\n                }\r\n            }\r\n            return sigma / count;\r\n        };\r\n\r\n        exports.WEIBULL = {};\r\n\r\n        exports.WEIBULL.DIST = function(x, alpha, beta, cumulative) {\r\n            x = utils.parseNumber(x);\r\n            alpha = utils.parseNumber(alpha);\r\n            beta = utils.parseNumber(beta);\r\n            if (utils.anyIsError(x, alpha, beta)) {\r\n                return error.value;\r\n            }\r\n            return (cumulative) ? 1 - Math.exp(-Math.pow(x / beta, alpha)) : Math.pow(x, alpha - 1) * Math.exp(-Math.pow(x / beta, alpha)) * alpha / Math.pow(beta, alpha);\r\n        };\r\n\r\n        exports.Z = {};\r\n\r\n        exports.Z.TEST = function(range, x, sd) {\r\n            range = utils.parseNumberArray(utils.flatten(range));\r\n            x = utils.parseNumber(x);\r\n            if (utils.anyIsError(range, x)) {\r\n                return error.value;\r\n            }\r\n\r\n            sd = sd || exports.STDEV.S(range);\r\n            var n = range.length;\r\n            return 1 - exports.NORM.S.DIST((exports.AVERAGE(range) - x) / (sd / Math.sqrt(n)), true);\r\n        };\r\n\r\n        return exports;\r\n    })();\r\n\r\n    met.utils = (function() {\r\n        var exports = {};\r\n\r\n        exports.PROGRESS = function(p, c) {\r\n            var color = c ? c : 'red';\r\n            var value = p ? p : '0';\r\n\r\n            return '<div style=\"width:' + value + '%;height:4px;background-color:' + color + ';margin-top:1px;\"></div>';\r\n        };\r\n\r\n        exports.RATING = function(v) {\r\n            var html = '<div class=\"jrating\">';\r\n            for (var i = 0; i < 5; i++) {\r\n                if (i < v) {\r\n                    html += '<div class=\"jrating-selected\"></div>';\r\n                } else {\r\n                    html += '<div></div>';\r\n                }\r\n            }\r\n            html += '</div>';\r\n            return html;\r\n        }\r\n\r\n        return exports;\r\n    })();\r\n\r\n    for (var i = 0; i < Object.keys(met).length; i++) {\r\n        var methods = met[Object.keys(met)[i]];\r\n        var keys = Object.keys(methods);\r\n        for (var j = 0; j < keys.length; j++) {\r\n            if (! methods[keys[j]]) {\r\n                window[keys[j]] = function() {\r\n                    return keys[j] + 'Not implemented';\r\n                }\r\n            } else if (typeof(methods[keys[j]]) == 'function' || typeof(methods[keys[j]]) == 'object') {\r\n                window[keys[j]] = methods[keys[j]];\r\n                window[keys[j]].toString = function() { return '#ERROR' };\r\n\r\n                if (typeof(methods[keys[j]]) == 'object') {\r\n                    var tmp = Object.keys(methods[keys[j]]);\r\n                    for (var z = 0; z < tmp.length; z++) {\r\n                        window[keys[j]][tmp[z]].toString = function() { return '#ERROR' };\r\n                    }\r\n                }\r\n            } else {\r\n                window[keys[j]] = function() {\r\n                    return keys[j] + 'Not implemented';\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Instance execution helpers\r\n     */\r\n    var x = null;\r\n    var y = null;\r\n    var instance = null;\r\n\r\n    window['TABLE'] = function() {\r\n        return instance;\r\n    }\r\n    window['COLUMN'] = window['COL'] = function () {\r\n        return parseInt(x) + 1;\r\n    }\r\n    window['ROW'] =  function() {\r\n        return parseInt(y) + 1;\r\n    }\r\n    window['CELL'] =  function() {\r\n        return F.getColumnNameFromCoords(x, y);\r\n    }\r\n    window['VALUE'] = function(col, row, processed) {\r\n        return instance.getValueFromCoords(parseInt(col) - 1, parseInt(row) - 1, processed);\r\n    }\r\n    window['THISROWCELL'] = function(col) {\r\n        return instance.getValueFromCoords(parseInt(col) - 1, parseInt(y));\r\n    }\r\n\r\n    // Secure formula\r\n    var secureFormula = function(oldValue, runtime) {\r\n        var newValue = '';\r\n        var inside = 0;\r\n\r\n        var special = [ '=', '!', '>', '<'];\r\n\r\n        for (var i = 0; i < oldValue.length; i++) {\r\n            if (oldValue[i] == '\"') {\r\n                if (inside == 0) {\r\n                    inside = 1;\r\n                } else {\r\n                    inside = 0;\r\n                }\r\n            }\r\n\r\n            if (inside == 1) {\r\n                newValue += oldValue[i];\r\n            } else {\r\n                newValue += oldValue[i].toUpperCase();\r\n\r\n                if (runtime == true) {\r\n                    if (i > 0 && oldValue[i] == '=' && special.indexOf(oldValue[i-1]) == -1 && special.indexOf(oldValue[i+1]) == -1) {\r\n                        newValue += '='\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Adapt to JS\r\n        newValue = newValue.replace(/\\^/g, '**');\r\n        newValue = newValue.replace(/\\<\\>/g, '!=');\r\n        newValue = newValue.replace(/\\&/g, '+');\r\n        newValue = newValue.replace(/\\$/g, '');\r\n\r\n        return newValue;\r\n    }\r\n\r\n    // Convert range tokens\r\n    var tokensUpdate = function(tokens, e) {\r\n        for (var index = 0; index < tokens.length; index++) {\r\n            var f = F.getTokensFromRange(tokens[index])\r\n            e = e.replace(tokens[index], \"[\" + f.join(',') + \"]\");\r\n        }\r\n        return e;\r\n    }\r\n\r\n    var F = function(expression, variables, i, j, obj) {\r\n        // Global helpers\r\n        instance = obj;\r\n        x = i\r\n        y = j;\r\n        // String\r\n        var s = '';\r\n        var keys = Object.keys(variables);\r\n        if (keys.length) {\r\n            for (var i = 0; i < keys.length; i++) {\r\n                if (keys[i].indexOf('.') == -1 && keys[i].indexOf('!') == -1) {\r\n                    s += 'var ' + keys[i] + ' = ' + variables[keys[i]] + ';\\n';\r\n                } else {\r\n                    s += keys[i] + ' = ' + variables[keys[i]] + ';\\n';\r\n                }\r\n            }\r\n        }\r\n        // Remove $\r\n        expression = expression.replace(/\\$/g, '');\r\n        // Replace ! per dot\r\n        expression = expression.replace(/\\!/g, '.');\r\n        // Adapt to JS\r\n        expression = secureFormula(expression, true);\r\n        // Update range\r\n        var tokens = expression.match(/([A-Z]+[0-9]*\\.)?(\\$?[A-Z]+\\$?[0-9]+):(\\$?[A-Z]+\\$?[0-9]+)?/g);\r\n        if (tokens && tokens.length) {\r\n            expression = tokensUpdate(tokens, expression);\r\n        }\r\n\r\n        // Calculate\r\n        return new Function(s + '; return ' + expression)();\r\n    }\r\n\r\n    /**\r\n     * Get letter based on a number\r\n     * @param {number} i\r\n     * @return {string}\r\n     */\r\n    var getColumnName = function(i) {\r\n        var letter = '';\r\n        if (i > 701) {\r\n            letter += String.fromCharCode(64 + parseInt(i / 676));\r\n            letter += String.fromCharCode(64 + parseInt((i % 676) / 26));\r\n        } else if (i > 25) {\r\n            letter += String.fromCharCode(64 + parseInt(i / 26));\r\n        }\r\n        letter += String.fromCharCode(65 + (i % 26));\r\n\r\n        return letter;\r\n    }\r\n\r\n    /**\r\n     * Get column name from coords\r\n     */\r\n    F.getColumnNameFromCoords = function(x, y) {\r\n        return getColumnName(parseInt(x)) + (parseInt(y) + 1);\r\n    }\r\n\r\n    F.getCoordsFromColumnName = function(columnName) {\r\n        // Get the letters\r\n        var t = /^[a-zA-Z]+/.exec(columnName);\r\n\r\n        if (t) {\r\n            // Base 26 calculation\r\n            var code = 0;\r\n            for (var i = 0; i < t[0].length; i++) {\r\n                code += parseInt(t[0].charCodeAt(i) - 64) * Math.pow(26, (t[0].length - 1 - i));\r\n            }\r\n            code--;\r\n            // Make sure jspreadsheet starts on zero\r\n            if (code < 0) {\r\n                code = 0;\r\n            }\r\n\r\n            // Number\r\n            var number = parseInt(/[0-9]+$/.exec(columnName)) || null;\r\n            if (number > 0) {\r\n                number--;\r\n            }\r\n\r\n            return [ code, number ];\r\n        }\r\n    }\r\n\r\n    F.getRangeFromTokens = function(tokens) {\r\n        tokens = tokens.filter(function(v) {\r\n            return v != '#REF!';\r\n        });\r\n\r\n        var d = '';\r\n        var t = '';\r\n        for (var i = 0; i < tokens.length; i++) {\r\n            if (tokens[i].indexOf('.') >= 0) {\r\n                d = '.';\r\n            } else if (tokens[i].indexOf('!') >= 0) {\r\n                d = '!';\r\n            }\r\n            if (d) {\r\n                t = tokens[i].split(d);\r\n                tokens[i] = t[1];\r\n                t = t[0] + d\r\n            }\r\n        }\r\n\r\n        tokens.sort(function(a, b) {\r\n            var t1 = Helpers.getCoordsFromColumnName(a);\r\n            var t2 = Helpers.getCoordsFromColumnName(b);\r\n            if (t1[1] > t2[1]) {\r\n                return 1;\r\n            } else if (t1[1] < t2[1]) {\r\n                return -1;\r\n            } else {\r\n                if (t1[0] > t2[0]) {\r\n                    return 1;\r\n                } else if (t1[0] < t2[0]) {\r\n                    return -1;\r\n                } else {\r\n                    return 0;\r\n                }\r\n            }\r\n        });\r\n\r\n        if (! tokens.length) {\r\n            return '#REF!';\r\n        } else {\r\n            return t+(tokens[0] + ':' + tokens[tokens.length - 1]);\r\n        }\r\n    }\r\n\r\n    F.getTokensFromRange = function(range) {\r\n        if (range.indexOf('.') > 0) {\r\n            var t = range.split('.');\r\n            range = t[1];\r\n            t = t[0] + '.';\r\n        } else if (range.indexOf('!') > 0) {\r\n            var t = range.split('!');\r\n            range = t[1];\r\n            t = t[0] + '!';\r\n        } else {\r\n            var t = '';\r\n        }\r\n\r\n        var range = range.split(':');\r\n        var e1 = F.getCoordsFromColumnName(range[0]);\r\n        var e2 = F.getCoordsFromColumnName(range[1]);\r\n\r\n        if (e1[0] <= e2[0]) {\r\n            var x1 = e1[0];\r\n            var x2 = e2[0];\r\n        } else {\r\n            var x1 = e2[0];\r\n            var x2 = e1[0];\r\n        }\r\n\r\n        if (e1[1] === null && e2[1] == null) {\r\n            var y1 = null;\r\n            var y2 = null;\r\n\r\n            var k = Object.keys(vars);\r\n            for (var i = 0; i < k.length; i++) {\r\n                var tmp = F.getCoordsFromColumnName(k[i]);\r\n                if (tmp[0] === e1[0]) {\r\n                    if (y1 === null || tmp[1] < y1) {\r\n                        y1 = tmp[1]\r\n                    }\r\n                }\r\n                if (tmp[0] === e2[0]) {\r\n                    if (y2 === null || tmp[1] > y2) {\r\n                        y2 = tmp[1]\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            if (e1[1] <= e2[1]) {\r\n                var y1 = e1[1];\r\n                var y2 = e2[1];\r\n            } else {\r\n                var y1 = e2[1];\r\n                var y2 = e1[1];\r\n            }\r\n        }\r\n\r\n        var f = [];\r\n        for (var j = y1; j <= y2; j++) {\r\n            var line = [];\r\n            for (var i = x1; i <= x2; i++) {\r\n                line.push(t + F.getColumnNameFromCoords(i, j));\r\n            }\r\n            f.push(line);\r\n        }\r\n\r\n        return f;\r\n    }\r\n\r\n    F.setFormula = function(o) {\r\n        var k = Object.keys(o);\r\n        for (var i = 0; i < k.length; i++) {\r\n            if (typeof(o[k[i]]) == 'function') {\r\n                window[k[i]] = o[k[i]];\r\n            }\r\n        }\r\n    }\r\n\r\n    return F;\r\n})();\r\n\r\nif (! jSuites && typeof(require) === 'function') {\r\n    var jSuites = require('jsuites');\r\n}\r\n\r\n;(function (global, factory) {\r\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\r\n    typeof define === 'function' && define.amd ? define(factory) :\r\n    global.jspreadsheet = global.jexcel = factory();\r\n}(this, (function () {\r\n\r\n    'use strict';\r\n\r\n    // Basic version information\r\n    var Version = function() {\r\n        // Information\r\n        var info = {\r\n            title: 'Jspreadsheet',\r\n            version: '4.9.6',\r\n            type: 'CE',\r\n            host: 'https://bossanova.uk/jspreadsheet',\r\n            license: 'MIT',\r\n            print: function() {\r\n                return [ this.title + ' ' + this.type + ' ' + this.version, this.host, this.license ].join('\\r\\n'); \r\n            }\r\n        }\r\n\r\n        return function() {\r\n            return info;\r\n        };\r\n    }();\r\n\r\n    /**\r\n     * The value is a formula\r\n     */\r\n    var isFormula = function(value) {\r\n        var v = (''+value)[0];\r\n        return v == '=' || v == '#' ? true : false;\r\n    }\r\n\r\n    /**\r\n     * Get the mask in the jSuites.mask format\r\n     */\r\n    var getMask = function(o) {\r\n        if (o.format || o.mask || o.locale) {\r\n            var opt = {};\r\n            if (o.mask) {\r\n                opt.mask = o.mask;\r\n            } else if (o.format) {\r\n                opt.mask = o.format;\r\n            } else {\r\n                opt.locale = o.locale;\r\n                opt.options = o.options;\r\n            }\r\n\r\n            if (o.decimal) {\r\n                if (! opt.options) {\r\n                    opt.options = {};\r\n                }\r\n                opt.options = { decimal: o.decimal };\r\n            }\r\n            return opt;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    // Jspreadsheet core object\r\n    var jexcel = (function(el, options) {\r\n        // Create jspreadsheet object\r\n        var obj = {};\r\n        obj.options = {};\r\n\r\n        if (! (el instanceof Element || el instanceof HTMLDocument)) {\r\n            console.error('Jspreadsheet: el is not a valid DOM element');\r\n            return false;\r\n        } else if (el.tagName == 'TABLE') {\r\n            if (options = jexcel.createFromTable(el, options)) {\r\n                var div = document.createElement('div');\r\n                el.parentNode.insertBefore(div, el);\r\n                el.remove();\r\n                el = div;\r\n            } else {\r\n                console.error('Jspreadsheet: el is not a valid DOM element');\r\n                return false;\r\n            }\r\n        }\r\n\r\n        // Loading default configuration\r\n        var defaults = {\r\n            // External data\r\n            url:null,\r\n            // Ajax options\r\n            method: 'GET',\r\n            requestVariables: null,\r\n            // Data\r\n            data:null,\r\n            // Custom sorting handler\r\n            sorting:null,\r\n            // Copy behavior\r\n            copyCompatibility:false,\r\n            root:null,\r\n            // Rows and columns definitions\r\n            rows:[],\r\n            columns:[],\r\n            // Deprected legacy options\r\n            colHeaders:[],\r\n            colWidths:[],\r\n            colAlignments:[],\r\n            nestedHeaders:null,\r\n            // Column width that is used by default\r\n            defaultColWidth:50,\r\n            defaultColAlign:'center',\r\n            // Rows height default\r\n            defaultRowHeight: null,\r\n            // Spare rows and columns\r\n            minSpareRows:0,\r\n            minSpareCols:0,\r\n            // Minimal table dimensions\r\n            minDimensions:[0,0],\r\n            // Allow Export\r\n            allowExport:true,\r\n            // @type {boolean} - Include the header titles on download\r\n            includeHeadersOnDownload:false,\r\n            // @type {boolean} - Include the header titles on copy\r\n            includeHeadersOnCopy:false,\r\n            // Allow column sorting\r\n            columnSorting:true,\r\n            // Allow column dragging\r\n            columnDrag:false,\r\n            // Allow column resizing\r\n            columnResize:true,\r\n            // Allow row resizing\r\n            rowResize:false,\r\n            // Allow row dragging\r\n            rowDrag:true,\r\n            // Allow table edition\r\n            editable:true,\r\n            // Allow new rows\r\n            allowInsertRow:true,\r\n            // Allow new rows\r\n            allowManualInsertRow:true,\r\n            // Allow new columns\r\n            allowInsertColumn:true,\r\n            // Allow new rows\r\n            allowManualInsertColumn:true,\r\n            // Allow row delete\r\n            allowDeleteRow:true,\r\n            // Allow deleting of all rows\r\n            allowDeletingAllRows:false,\r\n            // Allow column delete\r\n            allowDeleteColumn:true,\r\n            // Allow rename column\r\n            allowRenameColumn:true,\r\n            // Allow comments\r\n            allowComments:false,\r\n            // Global wrap\r\n            wordWrap:false,\r\n            // Image options\r\n            imageOptions: null,\r\n            // CSV source\r\n            csv:null,\r\n            // Filename\r\n            csvFileName:'jspreadsheet',\r\n            // Consider first line as header\r\n            csvHeaders:true,\r\n            // Delimiters\r\n            csvDelimiter:',',\r\n            // First row as header\r\n            parseTableFirstRowAsHeader:false,\r\n            parseTableAutoCellType:false,\r\n            // Disable corner selection\r\n            selectionCopy:true,\r\n            // Merged cells\r\n            mergeCells:{},\r\n            // Create toolbar\r\n            toolbar:null,\r\n            // Allow search\r\n            search:false,\r\n            // Create pagination\r\n            pagination:false,\r\n            paginationOptions:null,\r\n            // Full screen\r\n            fullscreen:false,\r\n            // Lazy loading\r\n            lazyLoading:false,\r\n            loadingSpin:false,\r\n            // Table overflow\r\n            tableOverflow:false,\r\n            tableHeight:'300px',\r\n            tableWidth:null,\r\n            textOverflow:false,\r\n            // Meta\r\n            meta: null,\r\n            // Style\r\n            style:null,\r\n            classes:null,\r\n            // Execute formulas\r\n            parseFormulas:true,\r\n            autoIncrement:true,\r\n            autoCasting:true,\r\n            // Security\r\n            secureFormulas:true,\r\n            stripHTML:true,\r\n            stripHTMLOnCopy:false,\r\n            // Filters\r\n            filters:false,\r\n            footers:null,\r\n            // Event handles\r\n            onundo:null,\r\n            onredo:null,\r\n            onload:null,\r\n            onchange:null,\r\n            oncomments:null,\r\n            onbeforechange:null,\r\n            onafterchanges:null,\r\n            onbeforeinsertrow: null,\r\n            oninsertrow:null,\r\n            onbeforeinsertcolumn: null,\r\n            oninsertcolumn:null,\r\n            onbeforedeleterow:null,\r\n            ondeleterow:null,\r\n            onbeforedeletecolumn:null,\r\n            ondeletecolumn:null,\r\n            onmoverow:null,\r\n            onmovecolumn:null,\r\n            onresizerow:null,\r\n            onresizecolumn:null,\r\n            onsort:null,\r\n            onselection:null,\r\n            oncopy:null,\r\n            onpaste:null,\r\n            onbeforepaste:null,\r\n            onmerge:null,\r\n            onfocus:null,\r\n            onblur:null,\r\n            onchangeheader:null,\r\n            oncreateeditor:null,\r\n            oneditionstart:null,\r\n            oneditionend:null,\r\n            onchangestyle:null,\r\n            onchangemeta:null,\r\n            onchangepage:null,\r\n            onbeforesave:null,\r\n            onsave:null,\r\n            // Global event dispatcher\r\n            onevent:null,\r\n            // Persistance\r\n            persistance:false,\r\n            // Customize any cell behavior\r\n            updateTable:null,\r\n            // Detach the HTML table when calling updateTable\r\n            detachForUpdates: false,\r\n            freezeColumns:null,\r\n            // Texts\r\n            text:{\r\n                noRecordsFound: 'No records found',\r\n                showingPage: 'Showing page {0} of {1} entries',\r\n                show: 'Show ',\r\n                search: 'Search',\r\n                entries: ' entries',\r\n                columnName: 'Column name',\r\n                insertANewColumnBefore: 'Insert a new column before',\r\n                insertANewColumnAfter: 'Insert a new column after',\r\n                deleteSelectedColumns: 'Delete selected columns',\r\n                renameThisColumn: 'Rename this column',\r\n                orderAscending: 'Order ascending',\r\n                orderDescending: 'Order descending',\r\n                insertANewRowBefore: 'Insert a new row before',\r\n                insertANewRowAfter: 'Insert a new row after',\r\n                deleteSelectedRows: 'Delete selected rows',\r\n                editComments: 'Edit comments',\r\n                addComments: 'Add comments',\r\n                comments: 'Comments',\r\n                clearComments: 'Clear comments',\r\n                copy: 'Copy...',\r\n                paste: 'Paste...',\r\n                saveAs: 'Save as...',\r\n                about: 'About',\r\n                areYouSureToDeleteTheSelectedRows: 'Are you sure to delete the selected rows?',\r\n                areYouSureToDeleteTheSelectedColumns: 'Are you sure to delete the selected columns?',\r\n                thisActionWillDestroyAnyExistingMergedCellsAreYouSure: 'This action will destroy any existing merged cells. Are you sure?',\r\n                thisActionWillClearYourSearchResultsAreYouSure: 'This action will clear your search results. Are you sure?',\r\n                thereIsAConflictWithAnotherMergedCell: 'There is a conflict with another merged cell',\r\n                invalidMergeProperties: 'Invalid merged properties',\r\n                cellAlreadyMerged: 'Cell already merged',\r\n                noCellsSelected: 'No cells selected',\r\n            },\r\n            // About message\r\n            about: true,\r\n        };\r\n    \r\n        // Loading initial configuration from user\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                if (property === 'text') {\r\n                    obj.options[property] = defaults[property];\r\n                    for (var textKey in options[property]) {\r\n                        if (options[property].hasOwnProperty(textKey)){\r\n                            obj.options[property][textKey] = options[property][textKey];\r\n                        }\r\n                    }\r\n                } else {\r\n                    obj.options[property] = options[property];\r\n                }\r\n            } else {\r\n                obj.options[property] = defaults[property];\r\n            }\r\n        }\r\n\r\n        // Global elements\r\n        obj.el = el;\r\n        obj.corner = null;\r\n        obj.contextMenu = null;\r\n        obj.textarea = null;\r\n        obj.ads = null;\r\n        obj.content = null;\r\n        obj.table = null;\r\n        obj.thead = null;\r\n        obj.tbody = null;\r\n        obj.rows = [];\r\n        obj.results = null;\r\n        obj.searchInput = null;\r\n        obj.toolbar = null;\r\n        obj.pagination = null;\r\n        obj.pageNumber = null;\r\n        obj.headerContainer = null;\r\n        obj.colgroupContainer = null;\r\n    \r\n        // Containers\r\n        obj.headers = [];\r\n        obj.records = [];\r\n        obj.history = [];\r\n        obj.formula = [];\r\n        obj.colgroup = [];\r\n        obj.selection = [];\r\n        obj.highlighted  = [];\r\n        obj.selectedCell = null;\r\n        obj.selectedContainer = null;\r\n        obj.style = [];\r\n        obj.data = null;\r\n        obj.filter = null;\r\n        obj.filters = [];\r\n\r\n        // Internal controllers\r\n        obj.cursor = null;\r\n        obj.historyIndex = -1;\r\n        obj.ignoreEvents = false;\r\n        obj.ignoreHistory = false;\r\n        obj.edition = null;\r\n        obj.hashString = null;\r\n        obj.resizing = null;\r\n        obj.dragging = null;\r\n    \r\n        // Lazy loading\r\n        if (obj.options.lazyLoading == true && (obj.options.tableOverflow == false && obj.options.fullscreen == false)) {\r\n            console.error('Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes');\r\n            obj.options.lazyLoading = false;\r\n        }\r\n        \r\n        /**\r\n         * Activate/Disable fullscreen \r\n         * use programmatically : table.fullscreen(); or table.fullscreen(true); or table.fullscreen(false);\r\n         * @Param {boolean} activate\r\n         */\r\n        obj.fullscreen = function(activate) {\r\n            // If activate not defined, get reverse options.fullscreen\r\n            if (activate == null) {\r\n                activate = ! obj.options.fullscreen;\r\n            }\r\n    \r\n            // If change\r\n            if (obj.options.fullscreen != activate) {\r\n                obj.options.fullscreen = activate;\r\n    \r\n                // Test LazyLoading conflict\r\n                if (activate == true) {\r\n                    el.classList.add('fullscreen');\r\n                } else {\r\n                    el.classList.remove('fullscreen');\r\n                }\r\n            } \r\n        }\r\n\r\n        /**\r\n         * Trigger events\r\n         */\r\n        obj.dispatch = function(event) {\r\n            // Dispatch events\r\n            if (! obj.ignoreEvents) {\r\n                // Call global event\r\n                if (typeof(obj.options.onevent) == 'function') {\r\n                    var ret = obj.options.onevent.apply(this, arguments);\r\n                }\r\n                // Call specific events\r\n                if (typeof(obj.options[event]) == 'function') {\r\n                    var ret = obj.options[event].apply(this, Array.prototype.slice.call(arguments, 1));\r\n                }\r\n            }\r\n\r\n            // Persistance\r\n            if (event == 'onafterchanges' && obj.options.persistance) {\r\n                var url = obj.options.persistance == true ? obj.options.url : obj.options.persistance;\r\n                var data = obj.prepareJson(arguments[2]);\r\n                obj.save(url, data);\r\n            }\r\n\r\n            return ret;\r\n        }\r\n\r\n        /**\r\n         * Prepare the jspreadsheet table\r\n         * \r\n         * @Param config\r\n         */\r\n        obj.prepareTable = function() {\r\n            // Loading initial data from remote sources\r\n            var results = [];\r\n    \r\n            // Number of columns\r\n            var size = obj.options.columns.length;\r\n    \r\n            if (obj.options.data && typeof(obj.options.data[0]) !== 'undefined') {\r\n                // Data keys\r\n                var keys = Object.keys(obj.options.data[0]);\r\n    \r\n                if (keys.length > size) {\r\n                    size = keys.length;\r\n                }\r\n            }\r\n    \r\n            // Minimal dimensions\r\n            if (obj.options.minDimensions[0] > size) {\r\n                size = obj.options.minDimensions[0];\r\n            }\r\n    \r\n            // Requests\r\n            var multiple = [];\r\n    \r\n            // Preparations\r\n            for (var i = 0; i < size; i++) {\r\n                // Deprected options. You should use only columns\r\n                if (! obj.options.colHeaders[i]) {\r\n                    obj.options.colHeaders[i] = '';\r\n                }\r\n                if (! obj.options.colWidths[i]) {\r\n                    obj.options.colWidths[i] = obj.options.defaultColWidth;\r\n                }\r\n                if (! obj.options.colAlignments[i]) {\r\n                    obj.options.colAlignments[i] = obj.options.defaultColAlign;\r\n                }\r\n    \r\n                // Default column description\r\n                if (! obj.options.columns[i]) {\r\n                    obj.options.columns[i] = { type:'text' };\r\n                } else if (! obj.options.columns[i].type) {\r\n                    obj.options.columns[i].type = 'text';\r\n                }\r\n                if (! obj.options.columns[i].name) {\r\n                    obj.options.columns[i].name = keys && keys[i] ? keys[i] : i;\r\n                }\r\n                if (! obj.options.columns[i].source) {\r\n                    obj.options.columns[i].source = [];\r\n                }\r\n                if (! obj.options.columns[i].options) {\r\n                    obj.options.columns[i].options = [];\r\n                }\r\n                if (! obj.options.columns[i].editor) {\r\n                    obj.options.columns[i].editor = null;\r\n                }\r\n                if (! obj.options.columns[i].allowEmpty) {\r\n                    obj.options.columns[i].allowEmpty = false;\r\n                }\r\n                if (! obj.options.columns[i].title) {\r\n                    obj.options.columns[i].title = obj.options.colHeaders[i] ? obj.options.colHeaders[i] : '';\r\n                }\r\n                if (! obj.options.columns[i].width) {\r\n                    obj.options.columns[i].width = obj.options.colWidths[i] ? obj.options.colWidths[i] : obj.options.defaultColWidth;\r\n                }\r\n                if (! obj.options.columns[i].align) {\r\n                    obj.options.columns[i].align = obj.options.colAlignments[i] ? obj.options.colAlignments[i] : 'center';\r\n                }\r\n    \r\n                // Pre-load initial source for json autocomplete\r\n                if (obj.options.columns[i].type == 'autocomplete' || obj.options.columns[i].type == 'dropdown') {\r\n                    // if remote content\r\n                    if (obj.options.columns[i].url) {\r\n                        multiple.push({\r\n                            url: obj.options.columns[i].url,\r\n                            index: i,\r\n                            method: 'GET',\r\n                            dataType: 'json',\r\n                            success: function(data) {\r\n                                var source = [];\r\n                                for (var i = 0; i < data.length; i++) {\r\n                                    obj.options.columns[this.index].source.push(data[i]);\r\n                                }\r\n                            }\r\n                        });\r\n                    }\r\n                } else if (obj.options.columns[i].type == 'calendar') {\r\n                    // Default format for date columns\r\n                    if (! obj.options.columns[i].options.format) {\r\n                        obj.options.columns[i].options.format = 'DD/MM/YYYY';\r\n                    }\r\n                }\r\n            }\r\n            // Create the table when is ready\r\n            if (! multiple.length) {\r\n                obj.createTable();\r\n            } else {\r\n                jSuites.ajax(multiple, function() {\r\n                    obj.createTable();\r\n                });\r\n            }\r\n        }\r\n    \r\n        obj.createTable = function() {\r\n            // Elements\r\n            obj.table = document.createElement('table');\r\n            obj.thead = document.createElement('thead');\r\n            obj.tbody = document.createElement('tbody');\r\n\r\n            // Create headers controllers\r\n            obj.headers = [];\r\n            obj.colgroup = [];\r\n    \r\n            // Create table container\r\n            obj.content = document.createElement('div');\r\n            obj.content.classList.add('jexcel_content');\r\n            obj.content.onscroll = function(e) {\r\n                obj.scrollControls(e);\r\n            }\r\n            obj.content.onwheel = function(e) {\r\n                obj.wheelControls(e);\r\n            }\r\n\r\n            // Create toolbar object\r\n            obj.toolbar = document.createElement('div');\r\n            obj.toolbar.classList.add('jexcel_toolbar');\r\n    \r\n            // Search\r\n            var searchContainer = document.createElement('div');\r\n            var searchText = document.createTextNode((obj.options.text.search) + ': ');\r\n            obj.searchInput = document.createElement('input');\r\n            obj.searchInput.classList.add('jexcel_search');\r\n            searchContainer.appendChild(searchText);\r\n            searchContainer.appendChild(obj.searchInput);\r\n            obj.searchInput.onfocus = function() {\r\n                obj.resetSelection();\r\n            }\r\n    \r\n            // Pagination select option\r\n            var paginationUpdateContainer = document.createElement('div');\r\n    \r\n            if (obj.options.pagination > 0 && obj.options.paginationOptions && obj.options.paginationOptions.length > 0) {\r\n                obj.paginationDropdown = document.createElement('select');\r\n                obj.paginationDropdown.classList.add('jexcel_pagination_dropdown');\r\n                obj.paginationDropdown.onchange = function() {\r\n                    obj.options.pagination = parseInt(this.value);\r\n                    obj.page(0);\r\n                }\r\n    \r\n                for (var i = 0; i < obj.options.paginationOptions.length; i++) {\r\n                    var temp = document.createElement('option');\r\n                    temp.value = obj.options.paginationOptions[i];\r\n                    temp.innerHTML = obj.options.paginationOptions[i];\r\n                    obj.paginationDropdown.appendChild(temp);\r\n                }\r\n    \r\n                // Set initial pagination value\r\n                obj.paginationDropdown.value = obj.options.pagination;\r\n\r\n                paginationUpdateContainer.appendChild(document.createTextNode(obj.options.text.show));\r\n                paginationUpdateContainer.appendChild(obj.paginationDropdown);\r\n                paginationUpdateContainer.appendChild(document.createTextNode(obj.options.text.entries));\r\n            }\r\n    \r\n            // Filter and pagination container\r\n            var filter = document.createElement('div');\r\n            filter.classList.add('jexcel_filter');\r\n            filter.appendChild(paginationUpdateContainer);\r\n            filter.appendChild(searchContainer);\r\n    \r\n            // Colsgroup\r\n            obj.colgroupContainer = document.createElement('colgroup');\r\n            var tempCol = document.createElement('col');\r\n            tempCol.setAttribute('width', '50');\r\n            obj.colgroupContainer.appendChild(tempCol);\r\n    \r\n            // Nested\r\n            if (obj.options.nestedHeaders && obj.options.nestedHeaders.length > 0) {\r\n                // Flexible way to handle nestedheaders\r\n                if (obj.options.nestedHeaders[0] && obj.options.nestedHeaders[0][0]) {\r\n                    for (var j = 0; j < obj.options.nestedHeaders.length; j++) {\r\n                        obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[j]));\r\n                    }\r\n                } else {\r\n                    obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));\r\n                }\r\n            }\r\n    \r\n            // Row\r\n            obj.headerContainer = document.createElement('tr');\r\n            var tempCol = document.createElement('td');\r\n            tempCol.classList.add('jexcel_selectall');\r\n            obj.headerContainer.appendChild(tempCol);\r\n    \r\n            for (var i = 0; i < obj.options.columns.length; i++) {\r\n                // Create header\r\n                obj.createCellHeader(i);\r\n                // Append cell to the container\r\n                obj.headerContainer.appendChild(obj.headers[i]);\r\n                obj.colgroupContainer.appendChild(obj.colgroup[i]);\r\n            }\r\n\r\n            obj.thead.appendChild(obj.headerContainer);\r\n\r\n            // Filters\r\n            if (obj.options.filters == true) {\r\n                obj.filter = document.createElement('tr');\r\n                var td = document.createElement('td');\r\n                obj.filter.appendChild(td);\r\n\r\n                for (var i = 0; i < obj.options.columns.length; i++) {\r\n                    var td = document.createElement('td');\r\n                    td.innerHTML = '&nbsp;';\r\n                    td.setAttribute('data-x', i);\r\n                    td.className = 'jexcel_column_filter';\r\n                    if (obj.options.columns[i].type == 'hidden') {\r\n                        td.style.display = 'none';\r\n                    }\r\n                    obj.filter.appendChild(td);\r\n                }\r\n\r\n                obj.thead.appendChild(obj.filter);\r\n            }\r\n\r\n            // Content table\r\n            obj.table = document.createElement('table');\r\n            obj.table.classList.add('jexcel');\r\n            obj.table.setAttribute('cellpadding', '0');\r\n            obj.table.setAttribute('cellspacing', '0');\r\n            obj.table.setAttribute('unselectable', 'yes');\r\n            //obj.table.setAttribute('onselectstart', 'return false');\r\n            obj.table.appendChild(obj.colgroupContainer);\r\n            obj.table.appendChild(obj.thead);\r\n            obj.table.appendChild(obj.tbody);\r\n\r\n            if (! obj.options.textOverflow) {\r\n                obj.table.classList.add('jexcel_overflow');\r\n            }\r\n\r\n            // Spreadsheet corner\r\n            obj.corner = document.createElement('div');\r\n            obj.corner.className = 'jexcel_corner';\r\n            obj.corner.setAttribute('unselectable', 'on');\r\n            obj.corner.setAttribute('onselectstart', 'return false');\r\n    \r\n            if (obj.options.selectionCopy == false) {\r\n                obj.corner.style.display = 'none';\r\n            }\r\n    \r\n            // Textarea helper\r\n            obj.textarea = document.createElement('textarea');\r\n            obj.textarea.className = 'jexcel_textarea';\r\n            obj.textarea.id = 'jexcel_textarea';\r\n            obj.textarea.tabIndex = '-1';\r\n\r\n            // Contextmenu container\r\n            obj.contextMenu = document.createElement('div');\r\n            obj.contextMenu.className = 'jexcel_contextmenu';\r\n    \r\n            // Create element\r\n            jSuites.contextmenu(obj.contextMenu, {\r\n                onclick:function() {\r\n                    obj.contextMenu.contextmenu.close(false);\r\n                }\r\n            });\r\n    \r\n            // Powered by Jspreadsheet\r\n            var ads = document.createElement('a');\r\n            ads.setAttribute('href', 'https://bossanova.uk/jspreadsheet/');\r\n            obj.ads = document.createElement('div');\r\n            obj.ads.className = 'jexcel_about';\r\n            try {\r\n                if (typeof(sessionStorage) !== \"undefined\" && ! sessionStorage.getItem('jexcel')) {\r\n                    sessionStorage.setItem('jexcel', true);\r\n                    var img = document.createElement('img');\r\n                    img.src = '//bossanova.uk/jspreadsheet/logo.png';\r\n                    ads.appendChild(img);\r\n                }\r\n            } catch (exception) {\r\n            }\r\n            var span = document.createElement('span');\r\n            span.innerHTML = 'Jspreadsheet CE';\r\n            ads.appendChild(span);\r\n            obj.ads.appendChild(ads);\r\n\r\n            // Create table container TODO: frozen columns\r\n            var container = document.createElement('div');\r\n            container.classList.add('jexcel_table');\r\n    \r\n            // Pagination\r\n            obj.pagination = document.createElement('div');\r\n            obj.pagination.classList.add('jexcel_pagination');\r\n            var paginationInfo = document.createElement('div');\r\n            var paginationPages = document.createElement('div');\r\n            obj.pagination.appendChild(paginationInfo);\r\n            obj.pagination.appendChild(paginationPages);\r\n\r\n            // Hide pagination if not in use\r\n            if (! obj.options.pagination) {\r\n                obj.pagination.style.display = 'none';\r\n            }\r\n\r\n            // Append containers to the table\r\n            if (obj.options.search == true) {\r\n                el.appendChild(filter);\r\n            }\r\n    \r\n            // Elements\r\n            obj.content.appendChild(obj.table);\r\n            obj.content.appendChild(obj.corner);\r\n            obj.content.appendChild(obj.textarea);\r\n    \r\n            el.appendChild(obj.toolbar);\r\n            el.appendChild(obj.content);\r\n            el.appendChild(obj.pagination);\r\n            el.appendChild(obj.contextMenu);\r\n            el.appendChild(obj.ads);\r\n            el.classList.add('jexcel_container');\r\n    \r\n            // Create toolbar\r\n            if (obj.options.toolbar && obj.options.toolbar.length) {\r\n                obj.createToolbar();\r\n            }\r\n    \r\n            // Fullscreen\r\n            if (obj.options.fullscreen == true) {\r\n                el.classList.add('fullscreen');\r\n            } else {\r\n                // Overflow\r\n                if (obj.options.tableOverflow == true) {\r\n                    if (obj.options.tableHeight) {\r\n                        obj.content.style['overflow-y'] = 'auto';\r\n                        obj.content.style['box-shadow'] = 'rgb(221 221 221) 2px 2px 5px 0.1px';\r\n                        obj.content.style.maxHeight = obj.options.tableHeight;\r\n                    }\r\n                    if (obj.options.tableWidth) {\r\n                        obj.content.style['overflow-x'] = 'auto';\r\n                        obj.content.style.width = obj.options.tableWidth;\r\n                    }\r\n                }\r\n            }\r\n    \r\n            // With toolbars\r\n            if (obj.options.tableOverflow != true && obj.options.toolbar) {\r\n                el.classList.add('with-toolbar');\r\n            }\r\n    \r\n            // Actions\r\n            if (obj.options.columnDrag == true) {\r\n                obj.thead.classList.add('draggable');\r\n            }\r\n            if (obj.options.columnResize == true) {\r\n                obj.thead.classList.add('resizable');\r\n            }\r\n            if (obj.options.rowDrag == true) {\r\n                obj.tbody.classList.add('draggable');\r\n            }\r\n            if (obj.options.rowResize == true) {\r\n                obj.tbody.classList.add('resizable');\r\n            }\r\n    \r\n            // Load data\r\n            obj.setData();\r\n    \r\n            // Style\r\n            if (obj.options.style) {\r\n                obj.setStyle(obj.options.style, null, null, 1, 1);\r\n            }\r\n\r\n            // Classes\r\n            if (obj.options.classes) {\r\n                var k = Object.keys(obj.options.classes);\r\n                for (var i = 0; i < k.length; i++) {\r\n                    var cell = jexcel.getIdFromColumnName(k[i], true);\r\n                    obj.records[cell[1]][cell[0]].classList.add(obj.options.classes[k[i]]);\r\n                }\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Refresh the data\r\n         * \r\n         * @return void\r\n         */\r\n        obj.refresh = function() {\r\n            if (obj.options.url) {\r\n                // Loading\r\n                if (obj.options.loadingSpin == true) {\r\n                    jSuites.loading.show();\r\n                }\r\n    \r\n                jSuites.ajax({\r\n                    url: obj.options.url,\r\n                    method: obj.options.method,\r\n                    data: obj.options.requestVariables,\r\n                    dataType: 'json',\r\n                    success: function(result) {\r\n                        // Data\r\n                        obj.options.data = (result.data) ? result.data : result;\r\n                        // Prepare table\r\n                        obj.setData();\r\n                        // Hide spin\r\n                        if (obj.options.loadingSpin == true) {\r\n                            jSuites.loading.hide();\r\n                        }\r\n                    }\r\n                });\r\n            } else {\r\n                obj.setData();\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Set data\r\n         * \r\n         * @param array data In case no data is sent, default is reloaded\r\n         * @return void\r\n         */\r\n        obj.setData = function(data) {\r\n            // Update data\r\n            if (data) {\r\n                if (typeof(data) == 'string') {\r\n                    data = JSON.parse(data);\r\n                }\r\n    \r\n                obj.options.data = data;\r\n            }\r\n    \r\n            // Data\r\n            if (! obj.options.data) {\r\n                obj.options.data = [];\r\n            }\r\n    \r\n            // Prepare data\r\n            if (obj.options.data && obj.options.data[0]) {\r\n                if (! Array.isArray(obj.options.data[0])) {\r\n                    var data = [];\r\n                    for (var j = 0; j < obj.options.data.length; j++) {\r\n                        var row = [];\r\n                        for (var i = 0; i < obj.options.columns.length; i++) {\r\n                            row[i] = obj.options.data[j][obj.options.columns[i].name];\r\n                        }\r\n                        data.push(row);\r\n                    }\r\n\r\n                    obj.options.data = data;\r\n                }\r\n            }\r\n\r\n            // Adjust minimal dimensions\r\n            var j = 0;\r\n            var i = 0;\r\n            var size_i = obj.options.columns.length;\r\n            var size_j = obj.options.data.length;\r\n            var min_i = obj.options.minDimensions[0];\r\n            var min_j = obj.options.minDimensions[1];\r\n            var max_i = min_i > size_i ? min_i : size_i;\r\n            var max_j = min_j > size_j ? min_j : size_j;\r\n    \r\n            for (j = 0; j < max_j; j++) {\r\n                for (i = 0; i < max_i; i++) {\r\n                    if (obj.options.data[j] == undefined) {\r\n                        obj.options.data[j] = [];\r\n                    }\r\n    \r\n                    if (obj.options.data[j][i] == undefined) {\r\n                        obj.options.data[j][i] = '';\r\n                    }\r\n                }\r\n            }\r\n    \r\n            // Reset containers\r\n            obj.rows = [];\r\n            obj.results = null;\r\n            obj.records = [];\r\n            obj.history = [];\r\n    \r\n            // Reset internal controllers\r\n            obj.historyIndex = -1;\r\n    \r\n            // Reset data\r\n            obj.tbody.innerHTML = '';\r\n    \r\n            // Lazy loading\r\n            if (obj.options.lazyLoading == true) {\r\n                // Load only 100 records\r\n                var startNumber = 0\r\n                var finalNumber = obj.options.data.length < 100 ? obj.options.data.length : 100;\r\n    \r\n                if (obj.options.pagination) {\r\n                    obj.options.pagination = false;\r\n                    console.error('Jspreadsheet: Pagination will be disable due the lazyLoading');\r\n                }\r\n            } else if (obj.options.pagination) {\r\n                // Pagination\r\n                if (! obj.pageNumber) {\r\n                    obj.pageNumber = 0;\r\n                }\r\n                var quantityPerPage = obj.options.pagination;\r\n                startNumber = (obj.options.pagination * obj.pageNumber);\r\n                finalNumber = (obj.options.pagination * obj.pageNumber) + obj.options.pagination;\r\n    \r\n                if (obj.options.data.length < finalNumber) {\r\n                    finalNumber = obj.options.data.length;\r\n                }\r\n            } else {\r\n                var startNumber = 0;\r\n                var finalNumber = obj.options.data.length;\r\n            }\r\n    \r\n            // Append nodes to the HTML\r\n            for (j = 0; j < obj.options.data.length; j++) {\r\n                // Create row\r\n                var tr = obj.createRow(j, obj.options.data[j]);\r\n                // Append line to the table\r\n                if (j >= startNumber && j < finalNumber) {\r\n                    obj.tbody.appendChild(tr);\r\n                }\r\n            }\r\n    \r\n            if (obj.options.lazyLoading == true) {\r\n                // Do not create pagination with lazyloading activated\r\n            } else if (obj.options.pagination) {\r\n                obj.updatePagination();\r\n            }\r\n    \r\n            // Merge cells\r\n            if (obj.options.mergeCells) {\r\n                var keys = Object.keys(obj.options.mergeCells);\r\n                for (var i = 0; i < keys.length; i++) {\r\n                    var num = obj.options.mergeCells[keys[i]];\r\n                    obj.setMerge(keys[i], num[0], num[1], 1);\r\n                }\r\n            }\r\n\r\n            // Updata table with custom configurations if applicable\r\n            obj.updateTable();\r\n\r\n            // Onload\r\n            obj.dispatch('onload', el, obj);\r\n        }\r\n\r\n        /**\r\n         * Get the whole table data\r\n         * \r\n         * @param bool get highlighted cells only\r\n         * @return array data\r\n         */\r\n        obj.getData = function(highlighted, dataOnly) {\r\n            // Control vars\r\n            var dataset = [];\r\n            var px = 0;\r\n            var py = 0;\r\n\r\n            // Data type\r\n            var dataType = dataOnly == true || obj.options.copyCompatibility == false ? true : false;\r\n\r\n            // Column and row length\r\n            var x = obj.options.columns.length\r\n            var y = obj.options.data.length\r\n    \r\n            // Go through the columns to get the data\r\n            for (var j = 0; j < y; j++) {\r\n                px = 0;\r\n                for (var i = 0; i < x; i++) {\r\n                    // Cell selected or fullset\r\n                    if (! highlighted || obj.records[j][i].classList.contains('highlight')) {\r\n                        // Get value\r\n                        if (! dataset[py]) {\r\n                            dataset[py] = [];\r\n                        }\r\n                        if (! dataType) {\r\n                            dataset[py][px] = obj.records[j][i].innerHTML;\r\n                        } else {\r\n                            dataset[py][px] = obj.options.data[j][i];\r\n                        }\r\n                        px++;\r\n                    }\r\n                }\r\n                if (px > 0) {\r\n                    py++;\r\n                }\r\n           }\r\n    \r\n           return dataset;\r\n        }\r\n\r\n        /**\r\n        * Get json data by row number\r\n        *\r\n        * @param integer row number\r\n        * @return object\r\n        */\r\n        obj.getJsonRow = function(rowNumber) {\r\n            var rowData = obj.options.data[rowNumber];\r\n            var x = obj.options.columns.length\r\n\r\n            var row = {};\r\n            for (var i = 0; i < x; i++) {\r\n                if (! obj.options.columns[i].name) {\r\n                    obj.options.columns[i].name = i;\r\n                }\r\n                row[obj.options.columns[i].name] = rowData[i];\r\n            }\r\n\r\n            return row;\r\n        }\r\n\r\n        /**\r\n         * Get the whole table data\r\n         * \r\n         * @param bool highlighted cells only\r\n         * @return string value\r\n         */\r\n        obj.getJson = function(highlighted) {\r\n            // Control vars\r\n            var data = [];\r\n    \r\n            // Column and row length\r\n            var x = obj.options.columns.length\r\n            var y = obj.options.data.length\r\n    \r\n            // Go through the columns to get the data\r\n            for (var j = 0; j < y; j++) {\r\n                var row = null;\r\n                for (var i = 0; i < x; i++) {\r\n                    if (! highlighted || obj.records[j][i].classList.contains('highlight')) {\r\n                        if (row == null) {\r\n                            row = {};\r\n                        }\r\n                        if (! obj.options.columns[i].name) {\r\n                            obj.options.columns[i].name = i;\r\n                        }\r\n                        row[obj.options.columns[i].name] = obj.options.data[j][i];\r\n                    }\r\n                }\r\n    \r\n                if (row != null) {\r\n                    data.push(row);\r\n                }\r\n           }\r\n    \r\n           return data;\r\n        }\r\n\r\n        /**\r\n         * Prepare JSON in the correct format\r\n         */\r\n        obj.prepareJson = function(data) {\r\n            var rows = [];\r\n            for (var i = 0; i < data.length; i++) {\r\n                var x = data[i].x;\r\n                var y = data[i].y;\r\n                var k = obj.options.columns[x].name ? obj.options.columns[x].name : x;\r\n\r\n                // Create row\r\n                if (! rows[y]) {\r\n                    rows[y] = {\r\n                        row: y,\r\n                        data: {},\r\n                    };\r\n                }\r\n                rows[y].data[k] = data[i].newValue;\r\n            }\r\n\r\n            // Filter rows\r\n            return rows.filter(function (el) {\r\n                return el != null;\r\n            });\r\n        }\r\n\r\n        /**\r\n         * Post json to a remote server\r\n         */\r\n        obj.save = function(url, data) {\r\n            // Parse anything in the data before sending to the server\r\n            var ret = obj.dispatch('onbeforesave', el, obj, data);\r\n            if (ret) {\r\n                var data = ret;\r\n            } else {\r\n                if (ret === false) {\r\n                    return false;\r\n                }\r\n            }\r\n\r\n            // Remove update\r\n            jSuites.ajax({\r\n                url: url,\r\n                method: 'POST',\r\n                dataType: 'json',\r\n                data: { data: JSON.stringify(data) },\r\n                success: function(result) {\r\n                    // Event\r\n                    obj.dispatch('onsave', el, obj, data);\r\n                }\r\n            });\r\n        }\r\n\r\n        /**\r\n         * Get a row data by rowNumber\r\n         */\r\n        obj.getRowData = function(rowNumber) {\r\n            return obj.options.data[rowNumber];\r\n        }\r\n    \r\n        /**\r\n         * Set a row data by rowNumber\r\n         */\r\n        obj.setRowData = function(rowNumber, data) {\r\n            for (var i = 0; i < obj.headers.length; i++) {\r\n                // Update cell\r\n                var columnName = jexcel.getColumnNameFromId([ i, rowNumber ]);\r\n                // Set value\r\n                if (data[i] != null) {\r\n                    obj.setValue(columnName, data[i]);\r\n                }\r\n            }\r\n        }\r\n    \r\n        /**\r\n         * Get a column data by columnNumber\r\n         */\r\n        obj.getColumnData = function(columnNumber) {\r\n            var dataset = [];\r\n            // Go through the rows to get the data\r\n            for (var j = 0; j < obj.options.data.length; j++) {\r\n                dataset.push(obj.options.data[j][columnNumber]);\r\n            }\r\n            return dataset;\r\n        }\r\n    \r\n        /**\r\n         * Set a column data by colNumber\r\n         */\r\n        obj.setColumnData = function(colNumber, data) {\r\n            for (var j = 0; j < obj.rows.length; j++) {\r\n                // Update cell\r\n                var columnName = jexcel.getColumnNameFromId([ colNumber, j ]);\r\n                // Set value\r\n                if (data[j] != null) {\r\n                    obj.setValue(columnName, data[j]);\r\n                }\r\n            }\r\n        }\r\n    \r\n        /**\r\n         * Create row\r\n         */\r\n        obj.createRow = function(j, data) {\r\n            // Create container\r\n            if (! obj.records[j]) {\r\n                obj.records[j] = [];\r\n            }\r\n            // Default data\r\n            if (! data) {\r\n                var data = obj.options.data[j];\r\n            }\r\n            // New line of data to be append in the table\r\n            obj.rows[j] = document.createElement('tr');\r\n            obj.rows[j].setAttribute('data-y', j);\r\n            // Index\r\n            var index = null;\r\n\r\n            // Set default row height\r\n            if (obj.options.defaultRowHeight) {\r\n                obj.rows[j].style.height = obj.options.defaultRowHeight + 'px'\r\n            }\r\n\r\n            // Definitions\r\n            if (obj.options.rows[j]) {\r\n                if (obj.options.rows[j].height) {\r\n                    obj.rows[j].style.height = obj.options.rows[j].height;\r\n                }\r\n                if (obj.options.rows[j].title) {\r\n                    index = obj.options.rows[j].title;\r\n                }\r\n            }\r\n            if (! index) {\r\n                index = parseInt(j + 1);\r\n            }\r\n            // Row number label\r\n            var td = document.createElement('td');\r\n            td.innerHTML = index;\r\n            td.setAttribute('data-y', j);\r\n            td.className = 'jexcel_row';\r\n            obj.rows[j].appendChild(td);\r\n    \r\n            // Data columns\r\n            for (var i = 0; i < obj.options.columns.length; i++) {\r\n                // New column of data to be append in the line\r\n                obj.records[j][i] = obj.createCell(i, j, data[i]);\r\n                // Add column to the row\r\n                obj.rows[j].appendChild(obj.records[j][i]);\r\n            }\r\n    \r\n            // Add row to the table body\r\n            return obj.rows[j];\r\n        }\r\n    \r\n        obj.parseValue = function(i, j, value, cell) {\r\n            if ((''+value).substr(0,1) == '=' && obj.options.parseFormulas == true) {\r\n                value = obj.executeFormula(value, i, j)\r\n            }\r\n\r\n            // Column options\r\n            var options = obj.options.columns[i];\r\n            if (options && ! isFormula(value)) {\r\n                // Mask options\r\n                var opt = null;\r\n                if (opt = getMask(options)) {\r\n                    if (value && value == Number(value)) {\r\n                        value = Number(value);\r\n                    }\r\n                    // Process the decimals to match the mask\r\n                    var masked = jSuites.mask.render(value, opt, true);\r\n                    // Negative indication\r\n                    if (cell) {\r\n                        if (opt.mask) {\r\n                            var t = opt.mask.split(';');\r\n                            if (t[1]) {\r\n                                var t1 = t[1].match(new RegExp('\\\\[Red\\\\]', 'gi'));\r\n                                if (t1) {\r\n                                    if (value < 0) {\r\n                                        cell.classList.add('red');\r\n                                    } else {\r\n                                        cell.classList.remove('red');\r\n                                    }\r\n                                }\r\n                                var t2 = t[1].match(new RegExp('\\\\(', 'gi'));\r\n                                if (t2) {\r\n                                    if (value < 0) {\r\n                                        masked = '(' + masked + ')';\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    if (masked) {\r\n                        value = masked;\r\n                    }\r\n                }\r\n            }\r\n\r\n            return value;\r\n        }\r\n\r\n        var validDate = function(date) {\r\n            date = ''+date;\r\n            if (date.substr(4,1) == '-' && date.substr(7,1) == '-') {\r\n                return true;\r\n            } else {\r\n                date = date.split('-');\r\n                if ((date[0].length == 4 && date[0] == Number(date[0]) && date[1].length == 2 && date[1] == Number(date[1]))) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        }\r\n\r\n        /**\r\n         * Create cell\r\n         */\r\n        obj.createCell = function(i, j, value) {\r\n            // Create cell and properties\r\n            var td = document.createElement('td');\r\n            td.setAttribute('data-x', i);\r\n            td.setAttribute('data-y', j);\r\n\r\n            // Security\r\n            if ((''+value).substr(0,1) == '=' && obj.options.secureFormulas == true) {\r\n                var val = secureFormula(value);\r\n                if (val != value) {\r\n                    // Update the data container\r\n                    value = val;\r\n                }\r\n            }\r\n\r\n            // Custom column\r\n            if (obj.options.columns[i].editor) {\r\n                if (obj.options.stripHTML === false || obj.options.columns[i].stripHTML === false) {\r\n                    td.innerHTML = value;\r\n                } else {\r\n                    td.innerText = value;\r\n                }\r\n                if (typeof(obj.options.columns[i].editor.createCell) == 'function') {\r\n                    td = obj.options.columns[i].editor.createCell(td);\r\n                }\r\n            } else {\r\n                // Hidden column\r\n                if (obj.options.columns[i].type == 'hidden') {\r\n                    td.style.display = 'none';\r\n                    td.innerText = value;\r\n                } else if (obj.options.columns[i].type == 'checkbox' || obj.options.columns[i].type == 'radio') {\r\n                    // Create input\r\n                    var element = document.createElement('input');\r\n                    element.type = obj.options.columns[i].type;\r\n                    element.name = 'c' + i;\r\n                    element.checked = (value == 1 || value == true || value == 'true') ? true : false;\r\n                    element.onclick = function() {\r\n                        obj.setValue(td, this.checked);\r\n                    }\r\n\r\n                    if (obj.options.columns[i].readOnly == true || obj.options.editable == false) {\r\n                        element.setAttribute('disabled', 'disabled');\r\n                    }\r\n\r\n                    // Append to the table\r\n                    td.appendChild(element);\r\n                    // Make sure the values are correct\r\n                    obj.options.data[j][i] = element.checked;\r\n                } else if (obj.options.columns[i].type == 'calendar') {\r\n                    // Try formatted date\r\n                    var formatted = null;\r\n                    if (! validDate(value)) {\r\n                        var tmp = jSuites.calendar.extractDateFromString(value, obj.options.columns[i].options.format);\r\n                        if (tmp) {\r\n                            formatted = tmp;\r\n                        }\r\n                    }\r\n                    // Create calendar cell\r\n                    td.innerText = jSuites.calendar.getDateString(formatted ? formatted : value, obj.options.columns[i].options.format);\r\n                } else if (obj.options.columns[i].type == 'dropdown' || obj.options.columns[i].type == 'autocomplete') {\r\n                    // Create dropdown cell\r\n                    td.classList.add('jexcel_dropdown');\r\n                    td.innerText = obj.getDropDownValue(i, value);\r\n                } else if (obj.options.columns[i].type == 'color') {\r\n                    if (obj.options.columns[i].render == 'square') {\r\n                        var color = document.createElement('div');\r\n                        color.className = 'color';\r\n                        color.style.backgroundColor = value;\r\n                        td.appendChild(color);\r\n                    } else {\r\n                        td.style.color = value;\r\n                        td.innerText = value;\r\n                    }\r\n                } else if (obj.options.columns[i].type == 'image') {\r\n                    if (value && value.substr(0, 10) == 'data:image') {\r\n                        var img = document.createElement('img');\r\n                        img.src = value;\r\n                        td.appendChild(img);\r\n                    }\r\n                } else {\r\n                    if (obj.options.columns[i].type == 'html') {\r\n                        td.innerHTML = stripScript(obj.parseValue(i, j, value, td));\r\n                    } else {\r\n                        if (obj.options.stripHTML === false || obj.options.columns[i].stripHTML === false) {\r\n                            td.innerHTML = stripScript(obj.parseValue(i, j, value, td));\r\n                        } else {\r\n                            td.innerText = obj.parseValue(i, j, value, td);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n    \r\n            // Readonly\r\n            if (obj.options.columns[i].readOnly == true) {\r\n                td.className = 'readonly';\r\n            }\r\n    \r\n            // Text align\r\n            var colAlign = obj.options.columns[i].align ? obj.options.columns[i].align : 'center';\r\n            td.style.textAlign = colAlign;\r\n    \r\n            // Wrap option\r\n            if (obj.options.columns[i].wordWrap != false && (obj.options.wordWrap == true || obj.options.columns[i].wordWrap == true || td.innerHTML.length > 200)) {\r\n                td.style.whiteSpace = 'pre-wrap';\r\n            }\r\n    \r\n            // Overflow\r\n            if (i > 0) {\r\n                if (this.options.textOverflow == true) {\r\n                    if (value || td.innerHTML) {\r\n                        obj.records[j][i-1].style.overflow = 'hidden';\r\n                    } else {\r\n                        if (i == obj.options.columns.length - 1) {\r\n                            td.style.overflow = 'hidden';\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return td;\r\n        }\r\n    \r\n        obj.createCellHeader = function(colNumber) {\r\n            // Create col global control\r\n            var colWidth = obj.options.columns[colNumber].width ? obj.options.columns[colNumber].width : obj.options.defaultColWidth;\r\n            var colAlign = obj.options.columns[colNumber].align ? obj.options.columns[colNumber].align : obj.options.defaultColAlign;\r\n    \r\n            // Create header cell\r\n            obj.headers[colNumber] = document.createElement('td');\r\n            if (obj.options.stripHTML) {\r\n                obj.headers[colNumber].innerText = obj.options.columns[colNumber].title ? obj.options.columns[colNumber].title : jexcel.getColumnName(colNumber);\r\n            } else {\r\n                obj.headers[colNumber].innerHTML = obj.options.columns[colNumber].title ? obj.options.columns[colNumber].title : jexcel.getColumnName(colNumber);\r\n            }\r\n            obj.headers[colNumber].setAttribute('data-x', colNumber);\r\n            obj.headers[colNumber].style.textAlign = colAlign;\r\n            if (obj.options.columns[colNumber].title) {\r\n                obj.headers[colNumber].setAttribute('title', obj.options.columns[colNumber].title);\r\n            }\r\n            if (obj.options.columns[colNumber].id) {\r\n                obj.headers[colNumber].setAttribute('id', obj.options.columns[colNumber].id);\r\n            }\r\n    \r\n            // Width control\r\n            obj.colgroup[colNumber] = document.createElement('col');\r\n            obj.colgroup[colNumber].setAttribute('width', colWidth);\r\n    \r\n            // Hidden column\r\n            if (obj.options.columns[colNumber].type == 'hidden') {\r\n                obj.headers[colNumber].style.display = 'none';\r\n                obj.colgroup[colNumber].style.display = 'none';\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Update a nested header title\r\n         */\r\n        obj.updateNestedHeader = function(x, y, title) {\r\n            if (obj.options.nestedHeaders[y][x].title) {\r\n                obj.options.nestedHeaders[y][x].title = title;\r\n                obj.options.nestedHeaders[y].element.children[x+1].innerText = title;\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Create a nested header object\r\n         */\r\n        obj.createNestedHeader = function(nestedInformation) {\r\n            var tr = document.createElement('tr');\r\n            tr.classList.add('jexcel_nested');\r\n            var td = document.createElement('td');\r\n            tr.appendChild(td);\r\n            // Element\r\n            nestedInformation.element = tr;\r\n    \r\n            var headerIndex = 0;\r\n            for (var i = 0; i < nestedInformation.length; i++) {\r\n                // Default values\r\n                if (! nestedInformation[i].colspan) {\r\n                    nestedInformation[i].colspan = 1;\r\n                }\r\n                if (! nestedInformation[i].align) {\r\n                    nestedInformation[i].align = 'center';\r\n                }\r\n                if (! nestedInformation[i].title) {\r\n                    nestedInformation[i].title = '';\r\n                }\r\n    \r\n                // Number of columns\r\n                var numberOfColumns = nestedInformation[i].colspan;\r\n    \r\n                // Classes container\r\n                var column = [];\r\n                // Header classes for this cell\r\n                for (var x = 0; x < numberOfColumns; x++) {\r\n                    if (obj.options.columns[headerIndex] && obj.options.columns[headerIndex].type == 'hidden') {\r\n                        numberOfColumns++;\r\n                    }\r\n                    column.push(headerIndex);\r\n                    headerIndex++;\r\n                }\r\n    \r\n                // Created the nested cell\r\n                var td = document.createElement('td');\r\n                td.setAttribute('data-column', column.join(','));\r\n                td.setAttribute('colspan', nestedInformation[i].colspan);\r\n                td.setAttribute('align', nestedInformation[i].align);\r\n                td.innerText = nestedInformation[i].title;\r\n                tr.appendChild(td);\r\n            }\r\n    \r\n            return tr;\r\n        }\r\n    \r\n        /**\r\n         * Create toolbar\r\n         */\r\n        obj.createToolbar = function(toolbar) {\r\n            if (toolbar) {\r\n                obj.options.toolbar = toolbar;\r\n            } else {\r\n                var toolbar = obj.options.toolbar;\r\n            }\r\n            for (var i = 0; i < toolbar.length; i++) {\r\n                if (toolbar[i].type == 'i') {\r\n                    var toolbarItem = document.createElement('i');\r\n                    toolbarItem.classList.add('jexcel_toolbar_item');\r\n                    toolbarItem.classList.add('material-icons');\r\n                    toolbarItem.setAttribute('data-k', toolbar[i].k);\r\n                    toolbarItem.setAttribute('data-v', toolbar[i].v);\r\n                    toolbarItem.setAttribute('id', toolbar[i].id);\r\n\r\n                    // Tooltip\r\n                    if (toolbar[i].tooltip) {\r\n                        toolbarItem.setAttribute('title', toolbar[i].tooltip);\r\n                    }\r\n                    // Handle click\r\n                    if (toolbar[i].onclick && typeof(toolbar[i].onclick)) {\r\n                        toolbarItem.onclick = (function (a) {\r\n                            var b = a;\r\n                            return function () {\r\n                                toolbar[b].onclick(el, obj, this);\r\n                            };\r\n                        })(i);\r\n                    } else {\r\n                        toolbarItem.onclick = function() {\r\n                            var k = this.getAttribute('data-k');\r\n                            var v = this.getAttribute('data-v');\r\n                            obj.setStyle(obj.highlighted, k, v);\r\n                        }\r\n                    }\r\n                    // Append element\r\n                    toolbarItem.innerText = toolbar[i].content;\r\n                    obj.toolbar.appendChild(toolbarItem);\r\n                } else if (toolbar[i].type == 'select') {\r\n                   var toolbarItem = document.createElement('select');\r\n                   toolbarItem.classList.add('jexcel_toolbar_item');\r\n                   toolbarItem.setAttribute('data-k', toolbar[i].k);\r\n                   // Tooltip\r\n                   if (toolbar[i].tooltip) {\r\n                       toolbarItem.setAttribute('title', toolbar[i].tooltip);\r\n                   }\r\n                   // Handle onchange\r\n                   if (toolbar[i].onchange && typeof(toolbar[i].onchange)) {\r\n                       toolbarItem.onchange = toolbar[i].onchange;\r\n                   } else {\r\n                       toolbarItem.onchange = function() {\r\n                           var k = this.getAttribute('data-k');\r\n                           obj.setStyle(obj.highlighted, k, this.value);\r\n                       }\r\n                   }\r\n                   // Add options to the dropdown\r\n                   for(var j = 0; j < toolbar[i].v.length; j++) {\r\n                        var toolbarDropdownOption = document.createElement('option');\r\n                        toolbarDropdownOption.value = toolbar[i].v[j];\r\n                        toolbarDropdownOption.innerText = toolbar[i].v[j];\r\n                        toolbarItem.appendChild(toolbarDropdownOption);\r\n                   }\r\n                   obj.toolbar.appendChild(toolbarItem);\r\n                } else if (toolbar[i].type == 'color') {\r\n                     var toolbarItem = document.createElement('i');\r\n                     toolbarItem.classList.add('jexcel_toolbar_item');\r\n                     toolbarItem.classList.add('material-icons');\r\n                     toolbarItem.setAttribute('data-k', toolbar[i].k);\r\n                     toolbarItem.setAttribute('data-v', '');\r\n                     // Tooltip\r\n                     if (toolbar[i].tooltip) {\r\n                         toolbarItem.setAttribute('title', toolbar[i].tooltip);\r\n                     }\r\n                     obj.toolbar.appendChild(toolbarItem);\r\n                     toolbarItem.innerText = toolbar[i].content;\r\n                     jSuites.color(toolbarItem, {\r\n                         onchange:function(o, v) {\r\n                             var k = o.getAttribute('data-k');\r\n                             obj.setStyle(obj.highlighted, k, v);\r\n                         }\r\n                     });\r\n                }\r\n            }\r\n        }\r\n    \r\n        /**\r\n         * Merge cells\r\n         * @param cellName\r\n         * @param colspan\r\n         * @param rowspan\r\n         * @param ignoreHistoryAndEvents\r\n         */\r\n        obj.setMerge = function(cellName, colspan, rowspan, ignoreHistoryAndEvents) {\r\n            var test = false;\r\n    \r\n            if (! cellName) {\r\n                if (! obj.highlighted.length) {\r\n                    alert(obj.options.text.noCellsSelected);\r\n                    return null;\r\n                } else {\r\n                    var x1 = parseInt(obj.highlighted[0].getAttribute('data-x'));\r\n                    var y1 = parseInt(obj.highlighted[0].getAttribute('data-y'));\r\n                    var x2 = parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute('data-x'));\r\n                    var y2 = parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute('data-y'));\r\n                    var cellName = jexcel.getColumnNameFromId([ x1, y1 ]);\r\n                    var colspan = (x2 - x1) + 1;\r\n                    var rowspan = (y2 - y1) + 1;\r\n                }\r\n            }\r\n    \r\n            var cell = jexcel.getIdFromColumnName(cellName, true);\r\n    \r\n            if (obj.options.mergeCells[cellName]) {\r\n                if (obj.records[cell[1]][cell[0]].getAttribute('data-merged')) {\r\n                    test = obj.options.text.cellAlreadyMerged;\r\n                }\r\n            } else if ((! colspan || colspan < 2) && (! rowspan || rowspan < 2)) {\r\n                test = obj.options.text.invalidMergeProperties;\r\n            } else {\r\n                var cells = [];\r\n                for (var j = cell[1]; j < cell[1] + rowspan; j++) {\r\n                    for (var i = cell[0]; i < cell[0] + colspan; i++) {\r\n                        var columnName = jexcel.getColumnNameFromId([i, j]);\r\n                        if (obj.records[j][i].getAttribute('data-merged')) {\r\n                            test = obj.options.text.thereIsAConflictWithAnotherMergedCell;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n    \r\n            if (test) {\r\n                alert(test);\r\n            } else {\r\n                // Add property\r\n                if (colspan > 1) {\r\n                    obj.records[cell[1]][cell[0]].setAttribute('colspan', colspan);\r\n                } else {\r\n                    colspan = 1;\r\n                }\r\n                if (rowspan > 1) {\r\n                    obj.records[cell[1]][cell[0]].setAttribute('rowspan', rowspan);\r\n                } else {\r\n                    rowspan = 1;\r\n                }\r\n                // Keep links to the existing nodes\r\n                obj.options.mergeCells[cellName] = [ colspan, rowspan, [] ];\r\n                // Mark cell as merged\r\n                obj.records[cell[1]][cell[0]].setAttribute('data-merged', 'true');\r\n                // Overflow\r\n                obj.records[cell[1]][cell[0]].style.overflow = 'hidden';\r\n                // History data\r\n                var data = [];\r\n                // Adjust the nodes\r\n                for (var y = cell[1]; y < cell[1] + rowspan; y++) {\r\n                    for (var x = cell[0]; x < cell[0] + colspan; x++) {\r\n                        if (! (cell[0] == x && cell[1] == y)) {\r\n                            data.push(obj.options.data[y][x]);\r\n                            obj.updateCell(x, y, '', true);\r\n                            obj.options.mergeCells[cellName][2].push(obj.records[y][x]);\r\n                            obj.records[y][x].style.display = 'none';\r\n                            obj.records[y][x] = obj.records[cell[1]][cell[0]];\r\n                        }\r\n                    }\r\n                }\r\n                // In the initialization is not necessary keep the history\r\n                obj.updateSelection(obj.records[cell[1]][cell[0]]);\r\n    \r\n                if (! ignoreHistoryAndEvents) {\r\n                    obj.setHistory({\r\n                        action:'setMerge',\r\n                        column:cellName,\r\n                        colspan:colspan,\r\n                        rowspan:rowspan,\r\n                        data:data,\r\n                    });\r\n    \r\n                    obj.dispatch('onmerge', el, cellName, colspan, rowspan);\r\n                }\r\n            }\r\n        }\r\n    \r\n        /**\r\n         * Merge cells\r\n         * @param cellName\r\n         * @param colspan\r\n         * @param rowspan\r\n         * @param ignoreHistoryAndEvents\r\n         */\r\n        obj.getMerge = function(cellName) {\r\n            var data = {};\r\n            if (cellName) {\r\n                if (obj.options.mergeCells[cellName]) {\r\n                    data = [ obj.options.mergeCells[cellName][0], obj.options.mergeCells[cellName][1] ];\r\n                } else {\r\n                    data = null;\r\n                }\r\n            } else {\r\n                if (obj.options.mergeCells) {\r\n                    var mergedCells = obj.options.mergeCells;\r\n                    var keys = Object.keys(obj.options.mergeCells);\r\n                    for (var i = 0; i < keys.length; i++) {\r\n                        data[keys[i]] = [ obj.options.mergeCells[keys[i]][0], obj.options.mergeCells[keys[i]][1] ];\r\n                    }\r\n                }\r\n            }\r\n    \r\n            return data;\r\n        }\r\n    \r\n        /**\r\n         * Remove merge by cellname\r\n         * @param cellName\r\n         */\r\n        obj.removeMerge = function(cellName, data, keepOptions) {\r\n            if (obj.options.mergeCells[cellName]) {\r\n                var cell = jexcel.getIdFromColumnName(cellName, true);\r\n                obj.records[cell[1]][cell[0]].removeAttribute('colspan');\r\n                obj.records[cell[1]][cell[0]].removeAttribute('rowspan');\r\n                obj.records[cell[1]][cell[0]].removeAttribute('data-merged');\r\n                var info = obj.options.mergeCells[cellName];\r\n    \r\n                var index = 0;\r\n                for (var j = 0; j < info[1]; j++) {\r\n                    for (var i = 0; i < info[0]; i++) {\r\n                        if (j > 0 || i > 0) {\r\n                            obj.records[cell[1]+j][cell[0]+i] = info[2][index];\r\n                            obj.records[cell[1]+j][cell[0]+i].style.display = '';\r\n                            // Recover data\r\n                            if (data && data[index]) {\r\n                                obj.updateCell(cell[0]+i, cell[1]+j, data[index]);\r\n                            }\r\n                            index++;\r\n                        }\r\n                    }\r\n                }\r\n    \r\n                // Update selection\r\n                obj.updateSelection(obj.records[cell[1]][cell[0]], obj.records[cell[1]+j-1][cell[0]+i-1]);\r\n    \r\n                if (! keepOptions) {\r\n                    delete(obj.options.mergeCells[cellName]);\r\n                }\r\n            }\r\n        }\r\n    \r\n        /**\r\n         * Remove all merged cells\r\n         */\r\n        obj.destroyMerged = function(keepOptions) {\r\n            // Remove any merged cells\r\n            if (obj.options.mergeCells) {\r\n                var mergedCells = obj.options.mergeCells;\r\n                var keys = Object.keys(obj.options.mergeCells);\r\n                for (var i = 0; i < keys.length; i++) {\r\n                    obj.removeMerge(keys[i], null, keepOptions);\r\n                }\r\n            }\r\n        }\r\n    \r\n        /**\r\n         * Is column merged\r\n         */\r\n        obj.isColMerged = function(x, insertBefore) {\r\n            var cols = [];\r\n            // Remove any merged cells\r\n            if (obj.options.mergeCells) {\r\n                var keys = Object.keys(obj.options.mergeCells);\r\n                for (var i = 0; i < keys.length; i++) {\r\n                    var info = jexcel.getIdFromColumnName(keys[i], true);\r\n                    var colspan = obj.options.mergeCells[keys[i]][0];\r\n                    var x1 = info[0];\r\n                    var x2 = info[0] + (colspan > 1 ? colspan - 1 : 0);\r\n    \r\n                    if (insertBefore == null) {\r\n                        if ((x1 <= x && x2 >= x)) {\r\n                            cols.push(keys[i]);\r\n                        }\r\n                    } else {\r\n                        if (insertBefore) {\r\n                            if ((x1 < x && x2 >= x)) {\r\n                                cols.push(keys[i]);\r\n                            }\r\n                        } else {\r\n                            if ((x1 <= x && x2 > x)) {\r\n                                cols.push(keys[i]);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n    \r\n            return cols;\r\n        }\r\n    \r\n        /**\r\n         * Is rows merged\r\n         */\r\n        obj.isRowMerged = function(y, insertBefore) {\r\n            var rows = [];\r\n            // Remove any merged cells\r\n            if (obj.options.mergeCells) {\r\n                var keys = Object.keys(obj.options.mergeCells);\r\n                for (var i = 0; i < keys.length; i++) {\r\n                    var info = jexcel.getIdFromColumnName(keys[i], true);\r\n                    var rowspan = obj.options.mergeCells[keys[i]][1];\r\n                    var y1 = info[1];\r\n                    var y2 = info[1] + (rowspan > 1 ? rowspan - 1 : 0);\r\n    \r\n                    if (insertBefore == null) {\r\n                        if ((y1 <= y && y2 >= y)) {\r\n                            rows.push(keys[i]);\r\n                        }\r\n                    } else {\r\n                        if (insertBefore) {\r\n                            if ((y1 < y && y2 >= y)) {\r\n                                rows.push(keys[i]);\r\n                            }\r\n                        } else {\r\n                            if ((y1 <= y && y2 > y)) {\r\n                                rows.push(keys[i]);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n    \r\n            return rows;\r\n        }\r\n\r\n        /**\r\n         * Open the column filter\r\n         */\r\n        obj.openFilter = function(columnId) {\r\n            if (! obj.options.filters) {\r\n                console.log('Jspreadsheet: filters not enabled.');\r\n            } else {\r\n                // Make sure is integer\r\n                columnId = parseInt(columnId);\r\n                // Reset selection\r\n                obj.resetSelection();\r\n                // Load options\r\n                var optionsFiltered = [];\r\n                if (obj.options.columns[columnId].type == 'checkbox') {\r\n                    optionsFiltered.push({ id: 'true', name: 'True' });\r\n                    optionsFiltered.push({ id: 'false', name: 'False' });\r\n                } else {\r\n                    var options = [];\r\n                    var hasBlanks = false;\r\n                    for (var j = 0; j < obj.options.data.length; j++) {\r\n                        var k = obj.options.data[j][columnId];\r\n                        var v = obj.records[j][columnId].innerHTML;\r\n                        if (k && v) {\r\n                            options[k] = v;\r\n                        } else {\r\n                            var hasBlanks = true;\r\n                        }\r\n                    }\r\n                    var keys = Object.keys(options);\r\n                    var optionsFiltered = [];\r\n                    for (var j = 0; j < keys.length; j++) {\r\n                        optionsFiltered.push({ id: keys[j], name: options[keys[j]] });\r\n                    }\r\n                    // Has blank options\r\n                    if (hasBlanks) {\r\n                        optionsFiltered.push({ value: '', id: '', name: '(Blanks)' });\r\n                    }\r\n                }\r\n\r\n                // Create dropdown\r\n                var div = document.createElement('div');\r\n                obj.filter.children[columnId + 1].innerHTML = '';\r\n                obj.filter.children[columnId + 1].appendChild(div);\r\n                obj.filter.children[columnId + 1].style.paddingLeft = '0px';\r\n                obj.filter.children[columnId + 1].style.paddingRight = '0px';\r\n                obj.filter.children[columnId + 1].style.overflow = 'initial';\r\n\r\n                var opt = {\r\n                    data: optionsFiltered,\r\n                    multiple: true,\r\n                    autocomplete: true,\r\n                    opened: true,\r\n                    value: obj.filters[columnId] !== undefined ? obj.filters[columnId] : null,\r\n                    width:'100%',\r\n                    position: (obj.options.tableOverflow == true || obj.options.fullscreen == true) ? true : false,\r\n                    onclose: function(o) {\r\n                        obj.resetFilters();\r\n                        obj.filters[columnId] = o.dropdown.getValue(true);\r\n                        obj.filter.children[columnId + 1].innerHTML = o.dropdown.getText();\r\n                        obj.filter.children[columnId + 1].style.paddingLeft = '';\r\n                        obj.filter.children[columnId + 1].style.paddingRight = '';\r\n                        obj.filter.children[columnId + 1].style.overflow = '';\r\n                        obj.closeFilter(columnId);\r\n                        obj.refreshSelection();\r\n                    }\r\n                };\r\n\r\n                // Dynamic dropdown\r\n                jSuites.dropdown(div, opt);\r\n            }\r\n        }\r\n\r\n        obj.resetFilters = function() {\r\n            if (obj.options.filters) {\r\n                for (var i = 0; i < obj.filter.children.length; i++) {\r\n                    obj.filter.children[i].innerHTML = '&nbsp;';\r\n                    obj.filters[i] = null;\r\n                }\r\n            }\r\n        }\r\n\r\n        obj.closeFilter = function(columnId) {\r\n            if (! columnId) {\r\n                for (var i = 0; i < obj.filter.children.length; i++) {\r\n                    if (obj.filters[i]) {\r\n                        columnId = i;\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Search filter\r\n            var search = function(query, x, y) {\r\n                for (var i = 0; i < query.length; i++) {\r\n                    if ((query[i] == '' && // Blank matching\r\n                        ((obj.options.data[y][x] === false) || // Unchecked checkbox\r\n                        (''+obj.options.data[y][x]) == '')) || // Blank non-checkbox value\r\n                        ((query[i] != '' && // Normal non-blank filtering\r\n                        ((''+obj.options.data[y][x]).search(query[i]) >= 0 ||\r\n                        (''+obj.records[y][x].innerHTML).search(query[i]) >= 0)))) {\r\n                        return true;\r\n                    }\r\n                }\r\n                return false;\r\n            }\r\n\r\n            var query = obj.filters[columnId];\r\n            obj.results = [];\r\n            for (var j = 0; j < obj.options.data.length; j++) {\r\n                if (search(query, columnId, j)) {\r\n                    obj.results.push(j);\r\n                }\r\n            }\r\n            if (! obj.results.length) {\r\n                obj.results = null;\r\n            }\r\n\r\n            obj.updateResult();\r\n        }\r\n\r\n        /**\r\n         * Open the editor\r\n         * \r\n         * @param object cell\r\n         * @return void\r\n         */\r\n        obj.openEditor = function(cell, empty, e) {\r\n            // Get cell position\r\n            var y = cell.getAttribute('data-y');\r\n            var x = cell.getAttribute('data-x');\r\n    \r\n            // On edition start\r\n            obj.dispatch('oneditionstart', el, cell, x, y);\r\n    \r\n            // Overflow\r\n            if (x > 0) {\r\n                obj.records[y][x-1].style.overflow = 'hidden';\r\n            }\r\n    \r\n            // Create editor\r\n            var createEditor = function(type) {\r\n                // Cell information\r\n                var info = cell.getBoundingClientRect();\r\n    \r\n                // Create dropdown\r\n                var editor = document.createElement(type);\r\n                editor.style.width = (info.width) + 'px';\r\n                editor.style.height = (info.height - 2) + 'px';\r\n                editor.style.minHeight = (info.height - 2) + 'px';\r\n    \r\n                // Edit cell\r\n                cell.classList.add('editor');\r\n                cell.innerHTML = '';\r\n                cell.appendChild(editor);\r\n    \r\n                // On edition start\r\n                obj.dispatch('oncreateeditor', el, cell, x, y, editor);\r\n\r\n                return editor;\r\n            }\r\n    \r\n            // Readonly\r\n            if (cell.classList.contains('readonly') == true) {\r\n                // Do nothing\r\n            } else {\r\n                // Holder\r\n                obj.edition = [ obj.records[y][x], obj.records[y][x].innerHTML, x, y ];\r\n    \r\n                // If there is a custom editor for it\r\n                if (obj.options.columns[x].editor) {\r\n                    // Custom editors\r\n                    obj.options.columns[x].editor.openEditor(cell, el, empty, e);\r\n                } else {\r\n                    // Native functions\r\n                    if (obj.options.columns[x].type == 'hidden') {\r\n                        // Do nothing\r\n                    } else if (obj.options.columns[x].type == 'checkbox' || obj.options.columns[x].type == 'radio') {\r\n                        // Get value\r\n                        var value = cell.children[0].checked ? false : true;\r\n                        // Toogle value\r\n                        obj.setValue(cell, value);\r\n                        // Do not keep edition open\r\n                        obj.edition = null;\r\n                    } else if (obj.options.columns[x].type == 'dropdown' || obj.options.columns[x].type == 'autocomplete') {\r\n                        // Get current value\r\n                        var value = obj.options.data[y][x];\r\n                        if (obj.options.columns[x].multiple && !Array.isArray(value)) {\r\n                            value = value.split(';');\r\n                        }\r\n    \r\n                        // Create dropdown\r\n                        if (typeof(obj.options.columns[x].filter) == 'function') {\r\n                            var source = obj.options.columns[x].filter(el, cell, x, y, obj.options.columns[x].source);\r\n                        } else {\r\n                            var source = obj.options.columns[x].source;\r\n                        }\r\n    \r\n                        // Do not change the original source\r\n                        var data = [];\r\n                        for (var j = 0; j < source.length; j++) {\r\n                            data.push(source[j]);\r\n                        }\r\n\r\n                        // Create editor\r\n                        var editor = createEditor('div');\r\n                        var options = {\r\n                            data: data,\r\n                            multiple: obj.options.columns[x].multiple ? true : false,\r\n                            autocomplete: obj.options.columns[x].autocomplete || obj.options.columns[x].type == 'autocomplete' ? true : false,\r\n                            opened:true,\r\n                            value: value,\r\n                            width:'100%',\r\n                            height:editor.style.minHeight,\r\n                            position: (obj.options.tableOverflow == true || obj.options.fullscreen == true) ? true : false,\r\n                            onclose:function() {\r\n                                obj.closeEditor(cell, true);\r\n                            }\r\n                        };\r\n                        if (obj.options.columns[x].options && obj.options.columns[x].options.type) {\r\n                            options.type = obj.options.columns[x].options.type;\r\n                        }\r\n                        jSuites.dropdown(editor, options);\r\n                    } else if (obj.options.columns[x].type == 'calendar' || obj.options.columns[x].type == 'color') {\r\n                        // Value\r\n                        var value = obj.options.data[y][x];\r\n                        // Create editor\r\n                        var editor = createEditor('input');\r\n                        editor.value = value;\r\n    \r\n                        if (obj.options.tableOverflow == true || obj.options.fullscreen == true) {\r\n                            obj.options.columns[x].options.position = true;\r\n                        }\r\n                        obj.options.columns[x].options.value = obj.options.data[y][x];\r\n                        obj.options.columns[x].options.opened = true;\r\n                        obj.options.columns[x].options.onclose = function(el, value) {\r\n                            obj.closeEditor(cell, true);\r\n                        }\r\n                        // Current value\r\n                        if (obj.options.columns[x].type == 'color') {\r\n                            jSuites.color(editor, obj.options.columns[x].options);\r\n                        } else {\r\n                            jSuites.calendar(editor, obj.options.columns[x].options);\r\n                        }\r\n                        // Focus on editor\r\n                        editor.focus();\r\n                    } else if (obj.options.columns[x].type == 'html') {\r\n                        var value = obj.options.data[y][x];\r\n                        // Create editor\r\n                        var editor = createEditor('div');\r\n                        editor.style.position = 'relative';\r\n                        var div = document.createElement('div');\r\n                        div.classList.add('jexcel_richtext');\r\n                        editor.appendChild(div);\r\n                        jSuites.editor(div, {\r\n                            focus: true,\r\n                            value: value,\r\n                        });\r\n                        var rect = cell.getBoundingClientRect();\r\n                        var rectContent = div.getBoundingClientRect();\r\n                        if (window.innerHeight < rect.bottom + rectContent.height) {\r\n                            div.style.top = (rect.top - (rectContent.height + 2)) + 'px';\r\n                        } else {\r\n                            div.style.top = (rect.top) + 'px';\r\n                        }\r\n                    } else if (obj.options.columns[x].type == 'image') {\r\n                        // Value\r\n                        var img = cell.children[0];\r\n                        // Create editor\r\n                        var editor = createEditor('div');\r\n                        editor.style.position = 'relative';\r\n                        var div = document.createElement('div');\r\n                        div.classList.add('jclose');\r\n                        if (img && img.src) {\r\n                            div.appendChild(img);\r\n                        }\r\n                        editor.appendChild(div);\r\n                        jSuites.image(div, obj.options.imageOptions);\r\n                        var rect = cell.getBoundingClientRect();\r\n                        var rectContent = div.getBoundingClientRect();\r\n                        if (window.innerHeight < rect.bottom + rectContent.height) {\r\n                            div.style.top = (rect.top - (rectContent.height + 2)) + 'px';\r\n                        } else {\r\n                            div.style.top = (rect.top) + 'px';\r\n                        }\r\n                    } else {\r\n                        // Value\r\n                        var value = empty == true ? '' : obj.options.data[y][x];\r\n\r\n                        // Basic editor\r\n                        if (obj.options.columns[x].wordWrap != false && (obj.options.wordWrap == true || obj.options.columns[x].wordWrap == true)) {\r\n                            var editor = createEditor('textarea');\r\n                        } else {\r\n                            var editor = createEditor('input');\r\n                        }\r\n\r\n                        editor.focus();\r\n                        editor.value = value;\r\n\r\n                        // Column options\r\n                        var options = obj.options.columns[x];\r\n                        // Format\r\n                        var opt = null;\r\n\r\n                        // Apply format when is not a formula\r\n                        if (! isFormula(value)) {\r\n                            // Format\r\n                            if (opt = getMask(options)) {\r\n                                // Masking\r\n                                if (! options.disabledMaskOnEdition) {\r\n                                    if (options.mask) {\r\n                                        var m = options.mask.split(';')\r\n                                        editor.setAttribute('data-mask', m[0]);\r\n                                    } else if (options.locale) {\r\n                                        editor.setAttribute('data-locale', options.locale);\r\n                                    }\r\n                                }\r\n                                // Input\r\n                                opt.input = editor;\r\n                                // Configuration\r\n                                editor.mask = opt;\r\n                                // Do not treat the decimals\r\n                                jSuites.mask.render(value, opt, false);\r\n                            }\r\n                        }\r\n\r\n                        editor.onblur = function() {\r\n                            obj.closeEditor(cell, true);\r\n                        };\r\n                        editor.scrollLeft = editor.scrollWidth;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    \r\n        /**\r\n         * Close the editor and save the information\r\n         * \r\n         * @param object cell\r\n         * @param boolean save\r\n         * @return void\r\n         */\r\n        obj.closeEditor = function(cell, save) {\r\n            var x = parseInt(cell.getAttribute('data-x'));\r\n            var y = parseInt(cell.getAttribute('data-y'));\r\n\r\n            // Get cell properties\r\n            if (save == true) {\r\n                // If custom editor\r\n                if (obj.options.columns[x].editor) {\r\n                    // Custom editor\r\n                    var value = obj.options.columns[x].editor.closeEditor(cell, save);\r\n                } else {\r\n                    // Native functions\r\n                    if (obj.options.columns[x].type == 'checkbox' || obj.options.columns[x].type == 'radio' || obj.options.columns[x].type == 'hidden') {\r\n                        // Do nothing\r\n                    } else if (obj.options.columns[x].type == 'dropdown' || obj.options.columns[x].type == 'autocomplete') {\r\n                        var value = cell.children[0].dropdown.close(true);\r\n                    } else if (obj.options.columns[x].type == 'calendar') {\r\n                        var value = cell.children[0].calendar.close(true);\r\n                    } else if (obj.options.columns[x].type == 'color') {\r\n                        var value = cell.children[0].color.close(true);\r\n                    } else if (obj.options.columns[x].type == 'html') {\r\n                        var value = cell.children[0].children[0].editor.getData();\r\n                    } else if (obj.options.columns[x].type == 'image') {\r\n                        var img = cell.children[0].children[0].children[0];\r\n                        var value = img && img.tagName == 'IMG' ? img.src : '';\r\n                    } else if (obj.options.columns[x].type == 'numeric') {\r\n                        var value = cell.children[0].value;\r\n                        if ((''+value).substr(0,1) != '=') {\r\n                            if (value == '') {\r\n                                value = obj.options.columns[x].allowEmpty ? '' : 0;\r\n                            }\r\n                        }\r\n                        cell.children[0].onblur = null;\r\n                    } else {\r\n                        var value = cell.children[0].value;\r\n                        cell.children[0].onblur = null;\r\n\r\n                        // Column options\r\n                        var options = obj.options.columns[x];\r\n                        // Format\r\n                        var opt = null;\r\n                        if (opt = getMask(options)) {\r\n                            // Keep numeric in the raw data\r\n                            if (value !== '' && ! isFormula(value) && typeof(value) !== 'number') {\r\n                                var t = jSuites.mask.extract(value, opt, true);\r\n                                if (t && t.value !== '') {\r\n                                    value = t.value;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // Ignore changes if the value is the same\r\n                if (obj.options.data[y][x] == value) {\r\n                    cell.innerHTML = obj.edition[1];\r\n                } else {\r\n                    obj.setValue(cell, value);\r\n                }\r\n            } else {\r\n                if (obj.options.columns[x].editor) {\r\n                    // Custom editor\r\n                    obj.options.columns[x].editor.closeEditor(cell, save);\r\n                } else {\r\n                    if (obj.options.columns[x].type == 'dropdown' || obj.options.columns[x].type == 'autocomplete') {\r\n                        cell.children[0].dropdown.close(true);\r\n                    } else if (obj.options.columns[x].type == 'calendar') {\r\n                        cell.children[0].calendar.close(true);\r\n                    } else if (obj.options.columns[x].type == 'color') {\r\n                        cell.children[0].color.close(true);\r\n                    } else {\r\n                        cell.children[0].onblur = null;\r\n                    }\r\n                }\r\n    \r\n                // Restore value\r\n                cell.innerHTML = obj.edition && obj.edition[1] ? obj.edition[1] : '';\r\n            }\r\n    \r\n            // On edition end\r\n            obj.dispatch('oneditionend', el, cell, x, y, value, save);\r\n\r\n            // Remove editor class\r\n            cell.classList.remove('editor');\r\n    \r\n            // Finish edition\r\n            obj.edition = null;\r\n        }\r\n    \r\n        /**\r\n         * Get the cell object\r\n         * \r\n         * @param object cell\r\n         * @return string value\r\n         */\r\n        obj.getCell = function(cell) {\r\n            // Convert in case name is excel liked ex. A10, BB92\r\n            cell = jexcel.getIdFromColumnName(cell, true);\r\n            var x = cell[0];\r\n            var y = cell[1];\r\n    \r\n            return obj.records[y][x];\r\n        }\r\n\r\n        /**\r\n         * Get the column options\r\n         * @param x\r\n         * @param y\r\n         * @returns {{type: string}}\r\n         */\r\n        obj.getColumnOptions = function(x, y) {\r\n            // Type\r\n            var options = obj.options.columns[x];\r\n\r\n            // Cell type\r\n            if (! options) {\r\n                options = { type: 'text' };\r\n            }\r\n\r\n            return options;\r\n        }\r\n\r\n        /**\r\n         * Get the cell object from coords\r\n         * \r\n         * @param object cell\r\n         * @return string value\r\n         */\r\n        obj.getCellFromCoords = function(x, y) {\r\n            return obj.records[y][x];\r\n        }\r\n    \r\n        /**\r\n         * Get label\r\n         * \r\n         * @param object cell\r\n         * @return string value\r\n         */\r\n        obj.getLabel = function(cell) {\r\n            // Convert in case name is excel liked ex. A10, BB92\r\n            cell = jexcel.getIdFromColumnName(cell, true);\r\n            var x = cell[0];\r\n            var y = cell[1];\r\n    \r\n            return obj.records[y][x].innerHTML;\r\n        }\r\n    \r\n        /**\r\n         * Get labelfrom coords\r\n         * \r\n         * @param object cell\r\n         * @return string value\r\n         */\r\n        obj.getLabelFromCoords = function(x, y) {\r\n            return obj.records[y][x].innerHTML;\r\n        }\r\n    \r\n        /**\r\n         * Get the value from a cell\r\n         * \r\n         * @param object cell\r\n         * @return string value\r\n         */\r\n        obj.getValue = function(cell, processedValue) {\r\n            if (typeof(cell) == 'object') {\r\n                var x = cell.getAttribute('data-x');\r\n                var y = cell.getAttribute('data-y');\r\n            } else {\r\n                cell = jexcel.getIdFromColumnName(cell, true);\r\n                var x = cell[0];\r\n                var y = cell[1];\r\n            }\r\n    \r\n            var value = null;\r\n    \r\n            if (x != null && y != null) {\r\n                if (obj.records[y] && obj.records[y][x] && (processedValue || obj.options.copyCompatibility == true)) {\r\n                    value = obj.records[y][x].innerHTML;\r\n                } else {\r\n                    if (obj.options.data[y] && obj.options.data[y][x] != 'undefined') {\r\n                        value = obj.options.data[y][x];\r\n                    }\r\n                }\r\n            }\r\n    \r\n            return value;\r\n        }\r\n    \r\n        /**\r\n         * Get the value from a coords\r\n         * \r\n         * @param int x\r\n         * @param int y\r\n         * @return string value\r\n         */\r\n        obj.getValueFromCoords = function(x, y, processedValue) {\r\n            var value = null;\r\n    \r\n            if (x != null && y != null) {\r\n                if ((obj.records[y] && obj.records[y][x]) && processedValue || obj.options.copyCompatibility == true) {\r\n                    value = obj.records[y][x].innerHTML;\r\n                } else {\r\n                    if (obj.options.data[y] && obj.options.data[y][x] != 'undefined') {\r\n                        value = obj.options.data[y][x];\r\n                    }\r\n                }\r\n            }\r\n    \r\n            return value;\r\n        }\r\n    \r\n        /**\r\n         * Set a cell value\r\n         * \r\n         * @param mixed cell destination cell\r\n         * @param string value value\r\n         * @return void\r\n         */\r\n        obj.setValue = function(cell, value, force) {\r\n            var records = [];\r\n    \r\n            if (typeof(cell) == 'string') {\r\n                var columnId = jexcel.getIdFromColumnName(cell, true);\r\n                var x = columnId[0];\r\n                var y = columnId[1];\r\n    \r\n                // Update cell\r\n                records.push(obj.updateCell(x, y, value, force));\r\n    \r\n                // Update all formulas in the chain\r\n                obj.updateFormulaChain(x, y, records);\r\n            } else {\r\n                var x = null;\r\n                var y = null;\r\n                if (cell && cell.getAttribute) {\r\n                    var x = cell.getAttribute('data-x');\r\n                    var y = cell.getAttribute('data-y');\r\n                }\r\n    \r\n                // Update cell\r\n                if (x != null && y != null) {\r\n                    records.push(obj.updateCell(x, y, value, force));\r\n    \r\n                    // Update all formulas in the chain\r\n                    obj.updateFormulaChain(x, y, records);\r\n                } else {\r\n                    var keys = Object.keys(cell);\r\n                    if (keys.length > 0) {\r\n                        for (var i = 0; i < keys.length; i++) {\r\n                            if (typeof(cell[i]) == 'string') {\r\n                                var columnId = jexcel.getIdFromColumnName(cell[i], true);\r\n                                var x = columnId[0];\r\n                                var y = columnId[1];\r\n                            } else {\r\n                                if (cell[i].x != null && cell[i].y != null) {\r\n                                    var x = cell[i].x;\r\n                                    var y = cell[i].y;\r\n                                    // Flexible setup\r\n                                    if (cell[i].newValue != null) {\r\n                                        value = cell[i].newValue;\r\n                                    } else if (cell[i].value != null) {\r\n                                        value = cell[i].value;\r\n                                    }\r\n                                } else {\r\n                                    var x = cell[i].getAttribute('data-x');\r\n                                    var y = cell[i].getAttribute('data-y');\r\n                                }\r\n                            }\r\n    \r\n                             // Update cell\r\n                            if (x != null && y != null) {\r\n                                records.push(obj.updateCell(x, y, value, force));\r\n    \r\n                                // Update all formulas in the chain\r\n                                obj.updateFormulaChain(x, y, records);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n    \r\n            // Update history\r\n            obj.setHistory({\r\n                action:'setValue',\r\n                records:records,\r\n                selection:obj.selectedCell,\r\n            });\r\n    \r\n            // Update table with custom configurations if applicable\r\n            obj.updateTable();\r\n    \r\n            // On after changes\r\n            obj.onafterchanges(el, records);\r\n        }\r\n    \r\n        /**\r\n         * Set a cell value based on coordinates\r\n         * \r\n         * @param int x destination cell\r\n         * @param int y destination cell\r\n         * @param string value\r\n         * @return void\r\n         */\r\n        obj.setValueFromCoords = function(x, y, value, force) {\r\n            var records = [];\r\n            records.push(obj.updateCell(x, y, value, force));\r\n    \r\n            // Update all formulas in the chain\r\n            obj.updateFormulaChain(x, y, records);\r\n    \r\n            // Update history\r\n            obj.setHistory({\r\n                action:'setValue',\r\n                records:records,\r\n                selection:obj.selectedCell,\r\n            });\r\n    \r\n            // Update table with custom configurations if applicable\r\n            obj.updateTable();\r\n    \r\n            // On after changes\r\n            obj.onafterchanges(el, records);\r\n        }\r\n    \r\n        /**\r\n         * Toogle\r\n         */\r\n        obj.setCheckRadioValue = function() {\r\n            var records = [];\r\n            var keys = Object.keys(obj.highlighted);\r\n            for (var i = 0; i < keys.length; i++) {\r\n                var x = obj.highlighted[i].getAttribute('data-x');\r\n                var y = obj.highlighted[i].getAttribute('data-y');\r\n    \r\n                if (obj.options.columns[x].type == 'checkbox' || obj.options.columns[x].type == 'radio') {\r\n                    // Update cell\r\n                    records.push(obj.updateCell(x, y, ! obj.options.data[y][x]));\r\n                }\r\n            }\r\n    \r\n            if (records.length) {\r\n                // Update history\r\n                obj.setHistory({\r\n                    action:'setValue',\r\n                    records:records,\r\n                    selection:obj.selectedCell,\r\n                });\r\n    \r\n                // On after changes\r\n                obj.onafterchanges(el, records);\r\n            }\r\n        }\r\n        /**\r\n         * Strip tags\r\n         */\r\n        var stripScript = function(a) {\r\n            var b = new Option;\r\n            b.innerHTML = a;\r\n            var c = null;\r\n            for (a = b.getElementsByTagName('script'); c=a[0];) c.parentNode.removeChild(c);\r\n            return b.innerHTML;\r\n        }\r\n\r\n        /**\r\n         * Update cell content\r\n         * \r\n         * @param object cell\r\n         * @return void\r\n         */\r\n        obj.updateCell = function(x, y, value, force) {\r\n            // Changing value depending on the column type\r\n            if (obj.records[y][x].classList.contains('readonly') == true && ! force) {\r\n                // Do nothing\r\n                var record = {\r\n                    x: x,\r\n                    y: y,\r\n                    col: x,\r\n                    row: y\r\n                }\r\n            } else {\r\n                // Security\r\n                if ((''+value).substr(0,1) == '=' && obj.options.secureFormulas == true) {\r\n                    var val = secureFormula(value);\r\n                    if (val != value) {\r\n                        // Update the data container\r\n                        value = val;\r\n                    }\r\n                }\r\n\r\n                // On change\r\n                var val = obj.dispatch('onbeforechange', el, obj.records[y][x], x, y, value);\r\n\r\n                // If you return something this will overwrite the value\r\n                if (val != undefined) {\r\n                    value = val;\r\n                }\r\n\r\n                if (obj.options.columns[x].editor && typeof(obj.options.columns[x].editor.updateCell) == 'function') {\r\n                    value = obj.options.columns[x].editor.updateCell(obj.records[y][x], value, force);\r\n                }\r\n\r\n                // History format\r\n                var record = {\r\n                    x: x,\r\n                    y: y,\r\n                    col: x,\r\n                    row: y,\r\n                    newValue: value,\r\n                    oldValue: obj.options.data[y][x],\r\n                }\r\n\r\n                if (obj.options.columns[x].editor) {\r\n                    // Update data and cell\r\n                    obj.options.data[y][x] = value;\r\n                } else {\r\n                    // Native functions\r\n                    if (obj.options.columns[x].type == 'checkbox' || obj.options.columns[x].type == 'radio') {\r\n                        // Unchecked all options\r\n                        if (obj.options.columns[x].type == 'radio') {\r\n                            for (var j = 0; j < obj.options.data.length; j++) {\r\n                                obj.options.data[j][x] = false;\r\n                            }\r\n                        }\r\n\r\n                        // Update data and cell\r\n                        obj.records[y][x].children[0].checked = (value == 1 || value == true || value == 'true' || value == 'TRUE') ? true : false;\r\n                        obj.options.data[y][x] = obj.records[y][x].children[0].checked;\r\n                    } else if (obj.options.columns[x].type == 'dropdown' || obj.options.columns[x].type == 'autocomplete') {\r\n                        // Update data and cell\r\n                        obj.options.data[y][x] = value;\r\n                        obj.records[y][x].innerText = obj.getDropDownValue(x, value);\r\n                    } else if (obj.options.columns[x].type == 'calendar') {\r\n                        // Try formatted date\r\n                        var formatted = null;\r\n                        if (! validDate(value)) {\r\n                            var tmp = jSuites.calendar.extractDateFromString(value, obj.options.columns[x].options.format);\r\n                            if (tmp) {\r\n                                formatted = tmp;\r\n                            }\r\n                        }\r\n                        // Update data and cell\r\n                        obj.options.data[y][x] = value;\r\n                        obj.records[y][x].innerText = jSuites.calendar.getDateString(formatted ? formatted : value, obj.options.columns[x].options.format);\r\n                    } else if (obj.options.columns[x].type == 'color') {\r\n                        // Update color\r\n                        obj.options.data[y][x] = value;\r\n                        // Render\r\n                        if (obj.options.columns[x].render == 'square') {\r\n                            var color = document.createElement('div');\r\n                            color.className = 'color';\r\n                            color.style.backgroundColor = value;\r\n                            obj.records[y][x].innerText = '';\r\n                            obj.records[y][x].appendChild(color);\r\n                        } else {\r\n                            obj.records[y][x].style.color = value;\r\n                            obj.records[y][x].innerText = value;\r\n                        }\r\n                    } else if (obj.options.columns[x].type == 'image') {\r\n                        value = ''+value;\r\n                        obj.options.data[y][x] = value;\r\n                        obj.records[y][x].innerHTML = '';\r\n                        if (value && value.substr(0, 10) == 'data:image') {\r\n                            var img = document.createElement('img');\r\n                            img.src = value;\r\n                            obj.records[y][x].appendChild(img);\r\n                        }\r\n                    } else {\r\n                        // Update data and cell\r\n                        obj.options.data[y][x] = value;\r\n                        // Label\r\n                        if (obj.options.columns[x].type == 'html') {\r\n                            obj.records[y][x].innerHTML = stripScript(obj.parseValue(x, y, value));\r\n                        } else {\r\n                            if (obj.options.stripHTML === false || obj.options.columns[x].stripHTML === false) {\r\n                                obj.records[y][x].innerHTML = stripScript(obj.parseValue(x, y, value, obj.records[y][x]));\r\n                            } else {\r\n                                obj.records[y][x].innerText = obj.parseValue(x, y, value, obj.records[y][x]);\r\n                            }\r\n                        }\r\n                        // Handle big text inside a cell\r\n                        if (obj.options.columns[x].wordWrap != false && (obj.options.wordWrap == true || obj.options.columns[x].wordWrap == true || obj.records[y][x].innerHTML.length > 200)) {\r\n                            obj.records[y][x].style.whiteSpace = 'pre-wrap';\r\n                        } else {\r\n                            obj.records[y][x].style.whiteSpace = '';\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // Overflow\r\n                if (x > 0) {\r\n                    if (value) {\r\n                        obj.records[y][x-1].style.overflow = 'hidden';\r\n                    } else {\r\n                        obj.records[y][x-1].style.overflow = '';\r\n                    }\r\n                }\r\n\r\n                // On change\r\n                obj.dispatch('onchange', el, (obj.records[y] && obj.records[y][x] ? obj.records[y][x] : null), x, y, value, record.oldValue);\r\n            }\r\n\r\n            return record;\r\n        }\r\n\r\n        /**\r\n         * Helper function to copy data using the corner icon\r\n         */\r\n        obj.copyData = function(o, d) {\r\n            // Get data from all selected cells\r\n            var data = obj.getData(true, true);\r\n\r\n            // Selected cells\r\n            var h = obj.selectedContainer;\r\n\r\n            // Cells\r\n            var x1 = parseInt(o.getAttribute('data-x'));\r\n            var y1 = parseInt(o.getAttribute('data-y'));\r\n            var x2 = parseInt(d.getAttribute('data-x'));\r\n            var y2 = parseInt(d.getAttribute('data-y'));\r\n\r\n            // Records\r\n            var records = [];\r\n            var breakControl = false;\r\n\r\n            if (h[0] == x1) {\r\n                // Vertical copy\r\n                if (y1 < h[1]) {\r\n                    var rowNumber = y1 - h[1];\r\n                } else {\r\n                    var rowNumber = 1;\r\n                }\r\n                var colNumber = 0;\r\n            } else {\r\n                if (x1 < h[0]) {\r\n                    var colNumber = x1 - h[0];\r\n                } else {\r\n                    var colNumber = 1;\r\n                }\r\n                var rowNumber = 0;\r\n            }\r\n\r\n            // Copy data procedure\r\n            var posx = 0;\r\n            var posy = 0;\r\n\r\n            for (var j = y1; j <= y2; j++) {\r\n                // Skip hidden rows\r\n                if (obj.rows[j] && obj.rows[j].style.display == 'none') {\r\n                    continue;\r\n                }\r\n\r\n                // Controls\r\n                if (data[posy] == undefined) {\r\n                    posy = 0;\r\n                }\r\n                posx = 0;\r\n\r\n                // Data columns\r\n                if (h[0] != x1) {\r\n                    if (x1 < h[0]) {\r\n                        var colNumber = x1 - h[0];\r\n                    } else {\r\n                        var colNumber = 1;\r\n                    }\r\n                }\r\n                // Data columns\r\n                for (var i = x1; i <= x2; i++) {\r\n                    // Update non-readonly\r\n                    if (obj.records[j][i] && ! obj.records[j][i].classList.contains('readonly') && obj.records[j][i].style.display != 'none' && breakControl == false) {\r\n                        // Stop if contains value\r\n                        if (! obj.selection.length) {\r\n                            if (obj.options.data[j][i] != '') {\r\n                                breakControl = true;\r\n                                continue;\r\n                            }\r\n                        }\r\n    \r\n                        // Column\r\n                        if (data[posy] == undefined) {\r\n                            posx = 0;\r\n                        } else if (data[posy][posx] == undefined) {\r\n                            posx = 0;\r\n                        }\r\n\r\n                        // Value\r\n                        var value = data[posy][posx];\r\n    \r\n                        if (value && ! data[1] && obj.options.autoIncrement == true) {\r\n                            if (obj.options.columns[i].type == 'text' || obj.options.columns[i].type == 'number') {\r\n                                if ((''+value).substr(0,1) == '=') {\r\n                                    var tokens = value.match(/([A-Z]+[0-9]+)/g);\r\n    \r\n                                    if (tokens) {\r\n                                        var affectedTokens = [];\r\n                                        for (var index = 0; index < tokens.length; index++) {\r\n                                            var position = jexcel.getIdFromColumnName(tokens[index], 1);\r\n                                            position[0] += colNumber;\r\n                                            position[1] += rowNumber;\r\n                                            if (position[1] < 0) {\r\n                                                position[1] = 0;\r\n                                            }\r\n                                            var token = jexcel.getColumnNameFromId([position[0], position[1]]);\r\n    \r\n                                            if (token != tokens[index]) {\r\n                                                affectedTokens[tokens[index]] = token;\r\n                                            }\r\n                                        }\r\n                                        // Update formula\r\n                                        if (affectedTokens) {\r\n                                            value = obj.updateFormula(value, affectedTokens)\r\n                                        }\r\n                                    }\r\n                                } else {\r\n                                    if (value == Number(value)) {\r\n                                        value = Number(value) + rowNumber;\r\n                                    }\r\n                                }\r\n                            } else if (obj.options.columns[i].type == 'calendar') {\r\n                                var date = new Date(value);\r\n                                date.setDate(date.getDate() + rowNumber);\r\n                                value = date.getFullYear() + '-' + jexcel.doubleDigitFormat(parseInt(date.getMonth() + 1)) + '-' + jexcel.doubleDigitFormat(date.getDate()) + ' ' + '00:00:00';\r\n                            }\r\n                        }\r\n    \r\n                        records.push(obj.updateCell(i, j, value));\r\n    \r\n                        // Update all formulas in the chain\r\n                        obj.updateFormulaChain(i, j, records);\r\n                    }\r\n                    posx++;\r\n                    if (h[0] != x1) {\r\n                        colNumber++;\r\n                    }\r\n                }\r\n                posy++;\r\n                rowNumber++;\r\n            }\r\n    \r\n            // Update history\r\n            obj.setHistory({\r\n                action:'setValue',\r\n                records:records,\r\n                selection:obj.selectedCell,\r\n            });\r\n    \r\n            // Update table with custom configuration if applicable\r\n            obj.updateTable();\r\n    \r\n            // On after changes\r\n            obj.onafterchanges(el, records);\r\n        }\r\n    \r\n        /**\r\n         * Refresh current selection\r\n         */\r\n        obj.refreshSelection = function() {\r\n            if (obj.selectedCell) {\r\n                obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\r\n            }\r\n        }\r\n    \r\n        /**\r\n         * Move coords to A1 in case ovelaps with an excluded cell\r\n         */\r\n        obj.conditionalSelectionUpdate = function(type, o, d) {\r\n            if (type == 1) {\r\n                if (obj.selectedCell && ((o >= obj.selectedCell[1] && o <= obj.selectedCell[3]) || (d >= obj.selectedCell[1] && d <= obj.selectedCell[3]))) {\r\n                    obj.resetSelection();\r\n                    return;\r\n                }\r\n            } else {\r\n                if (obj.selectedCell && ((o >= obj.selectedCell[0] && o <= obj.selectedCell[2]) || (d >= obj.selectedCell[0] && d <= obj.selectedCell[2]))) {\r\n                    obj.resetSelection();\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n    \r\n        /**\r\n         * Clear table selection\r\n         */\r\n        obj.resetSelection = function(blur) {\r\n            // Remove style\r\n            if (! obj.highlighted.length) {\r\n                var previousStatus = 0;\r\n            } else {\r\n                var previousStatus = 1;\r\n    \r\n                for (var i = 0; i < obj.highlighted.length; i++) {\r\n                    obj.highlighted[i].classList.remove('highlight');\r\n                    obj.highlighted[i].classList.remove('highlight-left');\r\n                    obj.highlighted[i].classList.remove('highlight-right');\r\n                    obj.highlighted[i].classList.remove('highlight-top');\r\n                    obj.highlighted[i].classList.remove('highlight-bottom');\r\n                    obj.highlighted[i].classList.remove('highlight-selected');\r\n    \r\n                    var px = parseInt(obj.highlighted[i].getAttribute('data-x'));\r\n                    var py = parseInt(obj.highlighted[i].getAttribute('data-y'));\r\n    \r\n                    // Check for merged cells\r\n                    if (obj.highlighted[i].getAttribute('data-merged')) {\r\n                        var colspan = parseInt(obj.highlighted[i].getAttribute('colspan'));\r\n                        var rowspan = parseInt(obj.highlighted[i].getAttribute('rowspan'));\r\n                        var ux = colspan > 0 ? px + (colspan - 1) : px;\r\n                        var uy = rowspan > 0 ? py + (rowspan - 1): py;\r\n                    } else {\r\n                        var ux = px;\r\n                        var uy = py;\r\n                    }\r\n    \r\n                    // Remove selected from headers\r\n                    for (var j = px; j <= ux; j++) {\r\n                        if (obj.headers[j]) {\r\n                            obj.headers[j].classList.remove('selected');\r\n                        }\r\n                    }\r\n    \r\n                    // Remove selected from rows\r\n                    for (var j = py; j <= uy; j++) {\r\n                        if (obj.rows[j]) {\r\n                            obj.rows[j].classList.remove('selected');\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n    \r\n            // Reset highlighed cells\r\n            obj.highlighted = [];\r\n    \r\n            // Reset\r\n            obj.selectedCell = null;\r\n    \r\n            // Hide corner\r\n            obj.corner.style.top = '-2000px';\r\n            obj.corner.style.left = '-2000px';\r\n    \r\n            if (blur == true && previousStatus == 1) {\r\n                obj.dispatch('onblur', el);\r\n            }\r\n    \r\n            return previousStatus;\r\n        }\r\n    \r\n        /**\r\n         * Update selection based on two cells\r\n         */\r\n        obj.updateSelection = function(el1, el2, origin) {\r\n            var x1 = el1.getAttribute('data-x');\r\n            var y1 = el1.getAttribute('data-y');\r\n            if (el2) {\r\n                var x2 = el2.getAttribute('data-x');\r\n                var y2 = el2.getAttribute('data-y');\r\n            } else {\r\n                var x2 = x1;\r\n                var y2 = y1;\r\n            }\r\n    \r\n            obj.updateSelectionFromCoords(x1, y1, x2, y2, origin);\r\n        }\r\n    \r\n        /**\r\n         * Update selection from coords\r\n         */\r\n        obj.updateSelectionFromCoords = function(x1, y1, x2, y2, origin) {\r\n            // Reset Selection\r\n            var updated = null;\r\n            var previousState = obj.resetSelection();\r\n    \r\n            // select column\r\n            if (y1 == null) {\r\n                y1 = 0;\r\n                y2 = obj.rows.length - 1; \r\n            }\r\n\r\n            // Same element\r\n            if (x2 == null) {\r\n                x2 = x1;\r\n            }\r\n            if (y2 == null) {\r\n                y2 = y1;\r\n            }\r\n    \r\n            // Selection must be within the existing data\r\n            if (x1 >= obj.headers.length) {\r\n                x1 = obj.headers.length - 1;\r\n            }\r\n            if (y1 >= obj.rows.length) {\r\n                y1 = obj.rows.length - 1;\r\n            }\r\n            if (x2 >= obj.headers.length) {\r\n                x2 = obj.headers.length - 1;\r\n            }\r\n            if (y2 >= obj.rows.length) {\r\n                y2 = obj.rows.length - 1;\r\n            }\r\n    \r\n            // Keep selected cell\r\n            obj.selectedCell = [x1, y1, x2, y2];\r\n    \r\n            // Select cells\r\n            if (x1 != null) {\r\n                // Add selected cell\r\n                if (obj.records[y1][x1]) {\r\n                    obj.records[y1][x1].classList.add('highlight-selected');\r\n                }\r\n    \r\n                // Origin & Destination\r\n                if (parseInt(x1) < parseInt(x2)) {\r\n                    var px = parseInt(x1);\r\n                    var ux = parseInt(x2);\r\n                } else {\r\n                    var px = parseInt(x2);\r\n                    var ux = parseInt(x1);\r\n                }\r\n    \r\n                if (parseInt(y1) < parseInt(y2)) {\r\n                    var py = parseInt(y1);\r\n                    var uy = parseInt(y2);\r\n                } else {\r\n                    var py = parseInt(y2);\r\n                    var uy = parseInt(y1);\r\n                }\r\n    \r\n                // Verify merged columns\r\n                for (var i = px; i <= ux; i++) {\r\n                    for (var j = py; j <= uy; j++) {\r\n                        if (obj.records[j][i] && obj.records[j][i].getAttribute('data-merged')) {\r\n                            var x = parseInt(obj.records[j][i].getAttribute('data-x'));\r\n                            var y = parseInt(obj.records[j][i].getAttribute('data-y'));\r\n                            var colspan = parseInt(obj.records[j][i].getAttribute('colspan'));\r\n                            var rowspan = parseInt(obj.records[j][i].getAttribute('rowspan'));\r\n    \r\n                            if (colspan > 1) {\r\n                                if (x < px) {\r\n                                    px = x;\r\n                                }\r\n                                if (x + colspan > ux) {\r\n                                    ux = x + colspan - 1;\r\n                                }\r\n                            }\r\n    \r\n                            if (rowspan) {\r\n                                if (y < py) {\r\n                                    py = y;\r\n    \r\n                                }\r\n                                if (y + rowspan > uy) {\r\n                                    uy = y + rowspan - 1;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n    \r\n                // Limits\r\n                var borderLeft = null;\r\n                var borderRight = null;\r\n                var borderTop = null;\r\n                var borderBottom = null;\r\n    \r\n                // Vertical limits\r\n                for (var j = py; j <= uy; j++) {\r\n                    if (obj.rows[j].style.display != 'none') {\r\n                        if (borderTop == null) {\r\n                            borderTop = j;\r\n                        }\r\n                        borderBottom = j;\r\n                    }\r\n                }\r\n    \r\n                // Redefining styles\r\n                for (var i = px; i <= ux; i++) {\r\n                    for (var j = py; j <= uy; j++) {\r\n                        if (obj.rows[j].style.display != 'none' && obj.records[j][i].style.display != 'none') {\r\n                            obj.records[j][i].classList.add('highlight');\r\n                            obj.highlighted.push(obj.records[j][i]);\r\n                        }\r\n                    }\r\n    \r\n                    // Horizontal limits\r\n                    if (obj.options.columns[i].type != 'hidden') {\r\n                        if (borderLeft == null) {\r\n                            borderLeft = i;\r\n                        }\r\n                        borderRight = i;\r\n                    }\r\n                }\r\n    \r\n                // Create borders\r\n                if (! borderLeft) {\r\n                    borderLeft = 0;\r\n                }\r\n                if (! borderRight) {\r\n                    borderRight = 0;\r\n                }\r\n                for (var i = borderLeft; i <= borderRight; i++) {\r\n                    if (obj.options.columns[i].type != 'hidden') {\r\n                        // Top border\r\n                        if (obj.records[borderTop] && obj.records[borderTop][i]) {\r\n                            obj.records[borderTop][i].classList.add('highlight-top');\r\n                        }\r\n                        // Bottom border\r\n                        if (obj.records[borderBottom] && obj.records[borderBottom][i]) {\r\n                            obj.records[borderBottom][i].classList.add('highlight-bottom');\r\n                        }\r\n                        // Add selected from headers\r\n                        obj.headers[i].classList.add('selected');\r\n                    }\r\n                }\r\n    \r\n                for (var j = borderTop; j <= borderBottom; j++) {\r\n                    if (obj.rows[j] && obj.rows[j].style.display != 'none') {\r\n                        // Left border\r\n                        obj.records[j][borderLeft].classList.add('highlight-left');\r\n                        // Right border\r\n                        obj.records[j][borderRight].classList.add('highlight-right');\r\n                        // Add selected from rows\r\n                        obj.rows[j].classList.add('selected');\r\n                    }\r\n                }\r\n    \r\n                obj.selectedContainer = [ borderLeft, borderTop, borderRight, borderBottom ];\r\n            }\r\n    \r\n            // Handle events\r\n            if (previousState == 0) {\r\n                obj.dispatch('onfocus', el);\r\n\r\n                obj.removeCopyingSelection();\r\n            }\r\n\r\n            obj.dispatch('onselection', el, borderLeft, borderTop, borderRight, borderBottom, origin);\r\n\r\n            // Find corner cell\r\n            obj.updateCornerPosition();\r\n        }\r\n    \r\n        /**\r\n         * Remove copy selection\r\n         * \r\n         * @return void\r\n         */\r\n        obj.removeCopySelection = function() {\r\n            // Remove current selection\r\n            for (var i = 0; i < obj.selection.length; i++) {\r\n                obj.selection[i].classList.remove('selection');\r\n                obj.selection[i].classList.remove('selection-left');\r\n                obj.selection[i].classList.remove('selection-right');\r\n                obj.selection[i].classList.remove('selection-top');\r\n                obj.selection[i].classList.remove('selection-bottom');\r\n            }\r\n    \r\n            obj.selection = [];\r\n        }\r\n    \r\n        /**\r\n         * Update copy selection\r\n         * \r\n         * @param int x, y\r\n         * @return void\r\n         */\r\n        obj.updateCopySelection = function(x3, y3) {\r\n            // Remove selection\r\n            obj.removeCopySelection();\r\n    \r\n            // Get elements first and last\r\n            var x1 = obj.selectedContainer[0];\r\n            var y1 = obj.selectedContainer[1];\r\n            var x2 = obj.selectedContainer[2];\r\n            var y2 = obj.selectedContainer[3];\r\n    \r\n            if (x3 != null && y3 != null) {\r\n                if (x3 - x2 > 0) {\r\n                    var px = parseInt(x2) + 1;\r\n                    var ux = parseInt(x3);\r\n                } else {\r\n                    var px = parseInt(x3);\r\n                    var ux = parseInt(x1) - 1;\r\n                }\r\n    \r\n                if (y3 - y2 > 0) {\r\n                    var py = parseInt(y2) + 1;\r\n                    var uy = parseInt(y3);\r\n                } else {\r\n                    var py = parseInt(y3);\r\n                    var uy = parseInt(y1) - 1;\r\n                }\r\n    \r\n                if (ux - px <= uy - py) {\r\n                    var px = parseInt(x1);\r\n                    var ux = parseInt(x2);\r\n                } else {\r\n                    var py = parseInt(y1);\r\n                    var uy = parseInt(y2);\r\n                }\r\n    \r\n                for (var j = py; j <= uy; j++) {\r\n                    for (var i = px; i <= ux; i++) {\r\n                        if (obj.records[j][i] && obj.rows[j].style.display != 'none' && obj.records[j][i].style.display != 'none') {\r\n                            obj.records[j][i].classList.add('selection');\r\n                            obj.records[py][i].classList.add('selection-top');\r\n                            obj.records[uy][i].classList.add('selection-bottom');\r\n                            obj.records[j][px].classList.add('selection-left');\r\n                            obj.records[j][ux].classList.add('selection-right');\r\n    \r\n                            // Persist selected elements\r\n                            obj.selection.push(obj.records[j][i]);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    \r\n        /**\r\n         * Update corner position\r\n         * \r\n         * @return void\r\n         */\r\n        obj.updateCornerPosition = function() {\r\n            // If any selected cells\r\n            if (! obj.highlighted.length) {\r\n                obj.corner.style.top = '-2000px';\r\n                obj.corner.style.left = '-2000px';\r\n            } else {\r\n                // Get last cell\r\n                var last = obj.highlighted[obj.highlighted.length-1];\r\n\r\n                var contentRect = obj.content.getBoundingClientRect();\r\n                var x1 = contentRect.left;\r\n                var y1 = contentRect.top;\r\n\r\n                var lastRect = last.getBoundingClientRect();\r\n                var x2 = lastRect.left;\r\n                var y2 = lastRect.top;\r\n                var w2 = lastRect.width;\r\n                var h2 = lastRect.height;\r\n\r\n                var x = (x2 - x1) + obj.content.scrollLeft + w2 - 4;\r\n                var y = (y2 - y1) + obj.content.scrollTop + h2 - 4;\r\n\r\n                // Place the corner in the correct place\r\n                obj.corner.style.top = y + 'px';\r\n                obj.corner.style.left = x + 'px';\r\n\r\n                if (obj.options.freezeColumns) {\r\n                    var width = obj.getFreezeWidth();\r\n                    if (x2 - x1 + w2 < width) {\r\n                        obj.corner.style.display = 'none';\r\n                    } else {\r\n                        if (obj.options.selectionCopy == true) {\r\n                            obj.corner.style.display = '';\r\n                        }\r\n                    }\r\n                } else {\r\n                    if (obj.options.selectionCopy == true) {\r\n                        obj.corner.style.display = '';\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    \r\n        /**\r\n         * Update scroll position based on the selection\r\n         */\r\n        obj.updateScroll = function(direction) {\r\n            // Jspreadsheet Container information\r\n            var contentRect = obj.content.getBoundingClientRect();\r\n            var x1 = contentRect.left;\r\n            var y1 = contentRect.top;\r\n            var w1 = contentRect.width;\r\n            var h1 = contentRect.height;\r\n\r\n            // Direction Left or Up\r\n            var reference = obj.records[obj.selectedCell[3]][obj.selectedCell[2]];\r\n    \r\n            // Reference\r\n            var referenceRect = reference.getBoundingClientRect();\r\n            var x2 = referenceRect.left;\r\n            var y2 = referenceRect.top;\r\n            var w2 = referenceRect.width;\r\n            var h2 = referenceRect.height;\r\n    \r\n            // Direction\r\n            if (direction == 0 || direction == 1) {\r\n                var x = (x2 - x1) + obj.content.scrollLeft;\r\n                var y = (y2 - y1) + obj.content.scrollTop - 2;\r\n            } else {\r\n                var x = (x2 - x1) + obj.content.scrollLeft + w2;\r\n                var y = (y2 - y1) + obj.content.scrollTop + h2;\r\n            }\r\n    \r\n            // Top position check\r\n            if (y > (obj.content.scrollTop + 30) && y < (obj.content.scrollTop + h1)) {\r\n                // In the viewport\r\n            } else {\r\n                // Out of viewport\r\n                if (y < obj.content.scrollTop + 30) {\r\n                    obj.content.scrollTop = y - h2;\r\n                } else {\r\n                    obj.content.scrollTop = y - (h1 - 2);\r\n                }\r\n            }\r\n    \r\n            // Freeze columns? \r\n            var freezed = obj.getFreezeWidth();\r\n\r\n            // Left position check - TODO: change that to the bottom border of the element\r\n            if (x > (obj.content.scrollLeft + freezed) && x < (obj.content.scrollLeft + w1)) {\r\n                // In the viewport\r\n            } else {\r\n                // Out of viewport\r\n                if (x < obj.content.scrollLeft + 30) {\r\n                    obj.content.scrollLeft = x;\r\n                    if (obj.content.scrollLeft < 50) {\r\n                        obj.content.scrollLeft = 0;\r\n                    }\r\n                } else if (x < obj.content.scrollLeft + freezed) {\r\n                    obj.content.scrollLeft = x - freezed - 1;\r\n                } else {\r\n                    obj.content.scrollLeft = x - (w1 - 20);\r\n                }\r\n            }\r\n        }\r\n    \r\n        /**\r\n         * Get the column width\r\n         * \r\n         * @param int column column number (first column is: 0)\r\n         * @return int current width\r\n         */\r\n        obj.getWidth = function(column) {\r\n            if (! column) {\r\n                // Get all headers\r\n                var data = [];\r\n                for (var i = 0; i < obj.headers.length; i++) {\r\n                    data.push(obj.options.columns[i].width);\r\n                }\r\n            } else {\r\n                // In case the column is an object\r\n                if (typeof(column) == 'object') {\r\n                    column = $(column).getAttribute('data-x');\r\n                }\r\n    \r\n                data = obj.colgroup[column].getAttribute('width')\r\n            }\r\n    \r\n            return data;\r\n        }\r\n\r\n\r\n        /**\r\n         * Set the column width\r\n         * \r\n         * @param int column number (first column is: 0)\r\n         * @param int new column width\r\n         * @param int old column width\r\n         */\r\n        obj.setWidth = function (column, width, oldWidth) {\r\n            if (width) {\r\n                if (Array.isArray(column)) {\r\n                    // Oldwidth\r\n                    if (! oldWidth) {\r\n                        var oldWidth = [];\r\n                    }\r\n                    // Set width\r\n                    for (var i = 0; i < column.length; i++) {\r\n                        if (! oldWidth[i]) {\r\n                            oldWidth[i] = obj.colgroup[column[i]].getAttribute('width');\r\n                        }\r\n                        var w = Array.isArray(width) && width[i] ? width[i] : width;\r\n                        obj.colgroup[column[i]].setAttribute('width', w);\r\n                        obj.options.columns[column[i]].width = w;\r\n                    }\r\n                } else {\r\n                    // Oldwidth\r\n                    if (! oldWidth) {\r\n                        oldWidth = obj.colgroup[column].getAttribute('width');\r\n                    }\r\n                    // Set width\r\n                    obj.colgroup[column].setAttribute('width', width);\r\n                    obj.options.columns[column].width = width;\r\n                }\r\n\r\n                // Keeping history of changes\r\n                obj.setHistory({\r\n                    action:'setWidth',\r\n                    column:column,\r\n                    oldValue:oldWidth,\r\n                    newValue:width,\r\n                });\r\n\r\n                // On resize column\r\n                obj.dispatch('onresizecolumn', el, column, width, oldWidth);\r\n\r\n                // Update corner position\r\n                obj.updateCornerPosition();\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Set the row height\r\n         * \r\n         * @param row - row number (first row is: 0)\r\n         * @param height - new row height\r\n         * @param oldHeight - old row height\r\n         */\r\n        obj.setHeight = function (row, height, oldHeight) {\r\n            if (height > 0) {\r\n                // In case the column is an object\r\n                if (typeof(row) == 'object') {\r\n                    row = row.getAttribute('data-y');\r\n                }\r\n    \r\n                // Oldwidth\r\n                if (! oldHeight) {\r\n                    oldHeight = obj.rows[row].getAttribute('height');\r\n\r\n                    if (! oldHeight) {\r\n                        var rect = obj.rows[row].getBoundingClientRect();\r\n                        oldHeight = rect.height;\r\n                    }\r\n                }\r\n\r\n                // Integer\r\n                height = parseInt(height);\r\n\r\n                // Set width\r\n                obj.rows[row].style.height = height + 'px';\r\n    \r\n                // Keep options updated\r\n                if (! obj.options.rows[row]) {\r\n                    obj.options.rows[row] = {};\r\n                }\r\n                obj.options.rows[row].height = height;\r\n    \r\n                // Keeping history of changes\r\n                obj.setHistory({\r\n                    action:'setHeight',\r\n                    row:row,\r\n                    oldValue:oldHeight,\r\n                    newValue:height,\r\n                });\r\n\r\n                // On resize column\r\n                obj.dispatch('onresizerow', el, row, height, oldHeight);\r\n\r\n                // Update corner position\r\n                obj.updateCornerPosition();\r\n            }\r\n        }\r\n    \r\n        /**\r\n         * Get the row height\r\n         * \r\n         * @param row - row number (first row is: 0)\r\n         * @return height - current row height\r\n         */\r\n        obj.getHeight = function(row) {\r\n            if (! row) {\r\n                // Get height of all rows\r\n                var data = [];\r\n                for (var j = 0; j < obj.rows.length; j++) {\r\n                    var h = obj.rows[j].style.height;\r\n                    if (h) {\r\n                        data[j] = h;\r\n                    }\r\n                }\r\n            } else {\r\n                // In case the row is an object\r\n                if (typeof(row) == 'object') {\r\n                    row = $(row).getAttribute('data-y');\r\n                }\r\n    \r\n                var data = obj.rows[row].style.height;\r\n            }\r\n    \r\n            return data;\r\n        }\r\n    \r\n        obj.setFooter = function(data) {\r\n            if (data) {\r\n                obj.options.footers = data;\r\n            }\r\n\r\n            if (obj.options.footers) {\r\n                if (! obj.tfoot) {\r\n                    obj.tfoot = document.createElement('tfoot');\r\n                    obj.table.appendChild(obj.tfoot);\r\n                } \r\n\r\n                for (var j = 0; j < obj.options.footers.length; j++) {\r\n                    if (obj.tfoot.children[j]) {\r\n                        var tr = obj.tfoot.children[j];\r\n                    } else {\r\n                        var tr = document.createElement('tr');\r\n                        var td = document.createElement('td');\r\n                        tr.appendChild(td);\r\n                        obj.tfoot.appendChild(tr);\r\n                    }\r\n                    for (var i = 0; i < obj.headers.length; i++) {\r\n                        if (! obj.options.footers[j][i]) {\r\n                            obj.options.footers[j][i] = '';\r\n                        }\r\n                        if (obj.tfoot.children[j].children[i+1]) {\r\n                            var td = obj.tfoot.children[j].children[i+1];\r\n                        } else {\r\n                            var td = document.createElement('td');\r\n                            tr.appendChild(td);\r\n\r\n                            // Text align\r\n                            var colAlign = obj.options.columns[i].align ? obj.options.columns[i].align : 'center';\r\n                            td.style.textAlign = colAlign;\r\n                        }\r\n                        td.innerText = obj.parseValue(i, j, obj.options.footers[j][i]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Get the column title\r\n         * \r\n         * @param column - column number (first column is: 0)\r\n         * @param title - new column title\r\n         */\r\n        obj.getHeader = function(column) {\r\n            return obj.headers[column].innerText;\r\n        }\r\n    \r\n        /**\r\n         * Set the column title\r\n         * \r\n         * @param column - column number (first column is: 0)\r\n         * @param title - new column title\r\n         */\r\n        obj.setHeader = function(column, newValue) {\r\n            if (obj.headers[column]) {\r\n                var oldValue = obj.headers[column].innerText;\r\n    \r\n                if (! newValue) {\r\n                    newValue = prompt(obj.options.text.columnName, oldValue)\r\n                }\r\n    \r\n                if (newValue) {\r\n                    obj.headers[column].innerText = newValue;\r\n                    // Keep the title property\r\n                    obj.headers[column].setAttribute('title', newValue);\r\n                    // Update title\r\n                    obj.options.columns[column].title = newValue;\r\n                }\r\n    \r\n                obj.setHistory({\r\n                    action: 'setHeader',\r\n                    column: column,\r\n                    oldValue: oldValue,\r\n                    newValue: newValue\r\n                });\r\n    \r\n                // On onchange header\r\n                obj.dispatch('onchangeheader', el, column, oldValue, newValue);\r\n            }\r\n        }\r\n    \r\n        /**\r\n         * Get the headers\r\n         * \r\n         * @param asArray\r\n         * @return mixed\r\n         */\r\n        obj.getHeaders = function (asArray) {\r\n            var title = [];\r\n    \r\n            for (var i = 0; i < obj.headers.length; i++) {\r\n                title.push(obj.getHeader(i));\r\n            }\r\n    \r\n            return asArray ? title : title.join(obj.options.csvDelimiter);\r\n        }\r\n    \r\n        /**\r\n         * Get meta information from cell(s)\r\n         * \r\n         * @return integer\r\n         */\r\n        obj.getMeta = function(cell, key) {\r\n            if (! cell) {\r\n                return obj.options.meta;\r\n            } else {\r\n                if (key) {\r\n                    return obj.options.meta[cell] && obj.options.meta[cell][key] ? obj.options.meta[cell][key] : null;\r\n                } else {\r\n                    return obj.options.meta[cell] ? obj.options.meta[cell] : null;\r\n                }\r\n            }\r\n        }\r\n    \r\n        /**\r\n         * Set meta information to cell(s)\r\n         * \r\n         * @return integer\r\n         */\r\n        obj.setMeta = function(o, k, v) {\r\n            if (! obj.options.meta) {\r\n                obj.options.meta = {}\r\n            }\r\n    \r\n            if (k && v) {\r\n                // Set data value\r\n                if (! obj.options.meta[o]) {\r\n                    obj.options.meta[o] = {};\r\n                }\r\n                obj.options.meta[o][k] = v;\r\n            } else {\r\n                // Apply that for all cells\r\n                var keys = Object.keys(o);\r\n                for (var i = 0; i < keys.length; i++) {\r\n                    if (! obj.options.meta[keys[i]]) {\r\n                        obj.options.meta[keys[i]] = {};\r\n                    }\r\n    \r\n                    var prop = Object.keys(o[keys[i]]);\r\n                    for (var j = 0; j < prop.length; j++) {\r\n                        obj.options.meta[keys[i]][prop[j]] = o[keys[i]][prop[j]];\r\n                    }\r\n                }\r\n            }\r\n    \r\n            obj.dispatch('onchangemeta', el, o, k, v);\r\n        }\r\n    \r\n        /**\r\n         * Update meta information\r\n         * \r\n         * @return integer\r\n         */\r\n        obj.updateMeta = function(affectedCells) {\r\n            if (obj.options.meta) {\r\n                var newMeta = {};\r\n                var keys = Object.keys(obj.options.meta);\r\n                for (var i = 0; i < keys.length; i++) {\r\n                    if (affectedCells[keys[i]]) {\r\n                        newMeta[affectedCells[keys[i]]] = obj.options.meta[keys[i]];\r\n                    } else {\r\n                        newMeta[keys[i]] = obj.options.meta[keys[i]];\r\n                    }\r\n                }\r\n                // Update meta information\r\n                obj.options.meta = newMeta;\r\n            }\r\n        }\r\n    \r\n        /**\r\n         * Get style information from cell(s)\r\n         * \r\n         * @return integer\r\n         */\r\n        obj.getStyle = function(cell, key) {\r\n            // Cell\r\n            if (! cell) {\r\n                // Control vars\r\n                var data = {};\r\n    \r\n                // Column and row length\r\n                var x = obj.options.data[0].length;\r\n                var y = obj.options.data.length;\r\n    \r\n                // Go through the columns to get the data\r\n                for (var j = 0; j < y; j++) {\r\n                    for (var i = 0; i < x; i++) {\r\n                        // Value\r\n                        var v = key ? obj.records[j][i].style[key] : obj.records[j][i].getAttribute('style');\r\n    \r\n                        // Any meta data for this column?\r\n                        if (v) {\r\n                            // Column name\r\n                            var k = jexcel.getColumnNameFromId([i, j]);\r\n                            // Value\r\n                            data[k] = v;\r\n                        }\r\n                    }\r\n                }\r\n    \r\n               return data;\r\n            } else {\r\n                cell = jexcel.getIdFromColumnName(cell, true);\r\n    \r\n                return key ? obj.records[cell[1]][cell[0]].style[key] : obj.records[cell[1]][cell[0]].getAttribute('style');\r\n            }\r\n        },\r\n    \r\n        obj.resetStyle = function(o, ignoreHistoryAndEvents) {\r\n            var keys = Object.keys(o);\r\n            for (var i = 0; i < keys.length; i++) {\r\n                // Position\r\n                var cell = jexcel.getIdFromColumnName(keys[i], true);\r\n                if (obj.records[cell[1]] && obj.records[cell[1]][cell[0]]) {\r\n                    obj.records[cell[1]][cell[0]].setAttribute('style', '');\r\n                }\r\n            }\r\n            obj.setStyle(o, null, null, null, ignoreHistoryAndEvents);\r\n        }\r\n    \r\n        /**\r\n         * Set meta information to cell(s)\r\n         * \r\n         * @return integer\r\n         */\r\n        obj.setStyle = function(o, k, v, force, ignoreHistoryAndEvents) {\r\n            var newValue = {};\r\n            var oldValue = {};\r\n    \r\n            // Apply style\r\n            var applyStyle = function(cellId, key, value) {\r\n                // Position\r\n                var cell = jexcel.getIdFromColumnName(cellId, true);\r\n    \r\n                if (obj.records[cell[1]] && obj.records[cell[1]][cell[0]] && (obj.records[cell[1]][cell[0]].classList.contains('readonly')==false || force)) {\r\n                    // Current value\r\n                    var currentValue = obj.records[cell[1]][cell[0]].style[key];\r\n    \r\n                    // Change layout\r\n                    if (currentValue == value && ! force) {\r\n                        value = '';\r\n                        obj.records[cell[1]][cell[0]].style[key] = '';\r\n                    } else {\r\n                        obj.records[cell[1]][cell[0]].style[key] = value;\r\n                    }\r\n    \r\n                    // History\r\n                    if (! oldValue[cellId]) {\r\n                        oldValue[cellId] = [];\r\n                    }\r\n                    if (! newValue[cellId]) {\r\n                        newValue[cellId] = [];\r\n                    }\r\n    \r\n                    oldValue[cellId].push([key + ':' + currentValue]);\r\n                    newValue[cellId].push([key + ':' + value]);\r\n                }\r\n            }\r\n    \r\n            if (k && v) {\r\n                // Get object from string\r\n                if (typeof(o) == 'string') {\r\n                    applyStyle(o, k, v);\r\n                } else {\r\n                    // Avoid duplications\r\n                    var oneApplication = [];\r\n                    // Apply that for all cells\r\n                    for (var i = 0; i < o.length; i++) {\r\n                        var x = o[i].getAttribute('data-x');\r\n                        var y = o[i].getAttribute('data-y');\r\n                        var cellName = jexcel.getColumnNameFromId([x, y]);\r\n                        // This happens when is a merged cell\r\n                        if (! oneApplication[cellName]) {\r\n                            applyStyle(cellName, k, v);\r\n                            oneApplication[cellName] = true;\r\n                        }\r\n                    }\r\n                }\r\n            } else {\r\n                var keys = Object.keys(o);\r\n                for (var i = 0; i < keys.length; i++) {\r\n                    var style = o[keys[i]];\r\n                    if (typeof(style) == 'string') {\r\n                        style = style.split(';');\r\n                    }\r\n                    for (var j = 0; j < style.length; j++) {\r\n                        if (typeof(style[j]) == 'string') {\r\n                            style[j] = style[j].split(':');\r\n                        }\r\n                        // Apply value\r\n                        if (style[j][0].trim()) {\r\n                            applyStyle(keys[i], style[j][0].trim(), style[j][1]);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n    \r\n            var keys = Object.keys(oldValue);\r\n            for (var i = 0; i < keys.length; i++) {\r\n                oldValue[keys[i]] = oldValue[keys[i]].join(';');\r\n            }\r\n            var keys = Object.keys(newValue);\r\n            for (var i = 0; i < keys.length; i++) {\r\n                newValue[keys[i]] = newValue[keys[i]].join(';');\r\n            }\r\n    \r\n            if (! ignoreHistoryAndEvents) {\r\n                // Keeping history of changes\r\n                obj.setHistory({\r\n                    action: 'setStyle',\r\n                    oldValue: oldValue,\r\n                    newValue: newValue,\r\n                });\r\n            }\r\n\r\n            obj.dispatch('onchangestyle', el, o, k, v);\r\n        }\r\n\r\n        /**\r\n         * Get cell comments, null cell for all\r\n         */\r\n        obj.getComments = function(cell, withAuthor) {\r\n            if (cell) {\r\n                if (typeof(cell) == 'string') {\r\n                    var cell = jexcel.getIdFromColumnName(cell, true);\r\n                }\r\n\r\n                if (withAuthor) {\r\n                    return [obj.records[cell[1]][cell[0]].getAttribute('title'), obj.records[cell[1]][cell[0]].getAttribute('author')];\r\n                } else {\r\n                    return obj.records[cell[1]][cell[0]].getAttribute('title') || '';\r\n                }\r\n            } else {\r\n                var data = {};\r\n                for (var j = 0; j < obj.options.data.length; j++) {\r\n                    for (var i = 0; i < obj.options.columns.length; i++) {\r\n                        var comments = obj.records[j][i].getAttribute('title');\r\n                        if (comments) {\r\n                            var cell = jexcel.getColumnNameFromId([i, j]);\r\n                            data[cell] = comments;\r\n                        }\r\n                    }\r\n                }\r\n                return data;\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Set cell comments\r\n         */\r\n        obj.setComments = function(cellId, comments, author) {\r\n            if (typeof(cellId) == 'string') {\r\n                var cell = jexcel.getIdFromColumnName(cellId, true);\r\n            } else {\r\n                var cell = cellId;\r\n            }\r\n    \r\n            // Keep old value\r\n            var title = obj.records[cell[1]][cell[0]].getAttribute('title');\r\n            var author = obj.records[cell[1]][cell[0]].getAttribute('data-author');\r\n            var oldValue = [ title, author ];\r\n    \r\n            // Set new values\r\n            obj.records[cell[1]][cell[0]].setAttribute('title', comments ? comments : '');\r\n            obj.records[cell[1]][cell[0]].setAttribute('data-author', author ? author : '');\r\n    \r\n            // Remove class if there is no comment\r\n            if (comments) {\r\n                obj.records[cell[1]][cell[0]].classList.add('jexcel_comments');\r\n            } else {\r\n                obj.records[cell[1]][cell[0]].classList.remove('jexcel_comments');\r\n            }\r\n    \r\n            // Save history\r\n            obj.setHistory({\r\n                action:'setComments',\r\n                column: cellId,\r\n                newValue: [ comments, author ],\r\n                oldValue: oldValue,\r\n            });\r\n            // Set comments\r\n            obj.dispatch('oncomments', el, comments, title, cell, cell[0], cell[1]);\r\n        }\r\n    \r\n        /**\r\n         * Get table config information\r\n         */\r\n        obj.getConfig = function() {\r\n            var options = obj.options;\r\n            options.style = obj.getStyle();\r\n            options.mergeCells = obj.getMerge();\r\n            options.comments = obj.getComments();\r\n    \r\n            return options;\r\n        }\r\n    \r\n        /**\r\n         * Sort data and reload table\r\n         */\r\n        obj.orderBy = function(column, order) {\r\n            if (column >= 0) {\r\n                // Merged cells\r\n                if (Object.keys(obj.options.mergeCells).length > 0) {\r\n                    if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\r\n                        return false;\r\n                    } else {\r\n                        // Remove merged cells\r\n                        obj.destroyMerged();\r\n                    }\r\n                }\r\n    \r\n                // Direction\r\n                if (order == null) {\r\n                    order = obj.headers[column].classList.contains('arrow-down') ? 1 : 0;\r\n                } else {\r\n                    order = order ? 1 : 0;\r\n                }\r\n    \r\n                // Test order\r\n                var temp = [];\r\n                if (obj.options.columns[column].type == 'number' || obj.options.columns[column].type == 'percentage' || obj.options.columns[column].type == 'autonumber' || obj.options.columns[column].type == 'color') {\r\n                    for (var j = 0; j < obj.options.data.length; j++) {\r\n                        temp[j] = [ j, Number(obj.options.data[j][column]) ];\r\n                    }\r\n                } else if (obj.options.columns[column].type == 'calendar' || obj.options.columns[column].type == 'checkbox' || obj.options.columns[column].type == 'radio') {\r\n                    for (var j = 0; j < obj.options.data.length; j++) {\r\n                        temp[j] = [ j, obj.options.data[j][column] ];\r\n                    }\r\n                } else {\r\n                    for (var j = 0; j < obj.options.data.length; j++) {\r\n                        temp[j] = [ j, obj.records[j][column].innerText.toLowerCase() ];\r\n                    }\r\n                }\r\n    \r\n                // Default sorting method\r\n                if (typeof(obj.options.sorting) !== 'function') {\r\n                    obj.options.sorting = function(direction) {\r\n                        return function(a, b) {\r\n                            var valueA = a[1];\r\n                            var valueB = b[1];\r\n\r\n                            if (! direction) {\r\n                                return (valueA === '' && valueB !== '') ? 1 : (valueA !== '' && valueB === '') ? -1 : (valueA > valueB) ? 1 : (valueA < valueB) ? -1 :  0;\r\n                            } else {\r\n                                return (valueA === '' && valueB !== '') ? 1 : (valueA !== '' && valueB === '') ? -1 : (valueA > valueB) ? -1 : (valueA < valueB) ? 1 :  0;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n                temp = temp.sort(obj.options.sorting(order));\r\n    \r\n                // Save history\r\n                var newValue = [];\r\n                for (var j = 0; j < temp.length; j++) {\r\n                    newValue[j] = temp[j][0];\r\n                }\r\n    \r\n                // Save history\r\n                obj.setHistory({\r\n                    action: 'orderBy',\r\n                    rows: newValue,\r\n                    column: column,\r\n                    order: order,\r\n                });\r\n    \r\n                // Update order\r\n                obj.updateOrderArrow(column, order);\r\n                obj.updateOrder(newValue);\r\n    \r\n                // On sort event\r\n                obj.dispatch('onsort', el, column, order);\r\n    \r\n                return true;\r\n            }\r\n        }\r\n    \r\n        /**\r\n         * Update order arrow\r\n         */\r\n        obj.updateOrderArrow = function(column, order) {\r\n            // Remove order\r\n            for (var i = 0; i < obj.headers.length; i++) {\r\n                obj.headers[i].classList.remove('arrow-up');\r\n                obj.headers[i].classList.remove('arrow-down');\r\n            }\r\n    \r\n            // No order specified then toggle order\r\n            if (order) {\r\n                obj.headers[column].classList.add('arrow-up');\r\n            } else {\r\n                obj.headers[column].classList.add('arrow-down');\r\n            }\r\n        }\r\n    \r\n        /**\r\n         * Update rows position\r\n         */\r\n        obj.updateOrder = function(rows) {\r\n            // History\r\n            var data = []\r\n            for (var j = 0; j < rows.length; j++) {\r\n                data[j] = obj.options.data[rows[j]];\r\n            }\r\n            obj.options.data = data;\r\n    \r\n            var data = []\r\n            for (var j = 0; j < rows.length; j++) {\r\n                data[j] = obj.records[rows[j]];\r\n            }\r\n            obj.records = data;\r\n    \r\n            var data = []\r\n            for (var j = 0; j < rows.length; j++) {\r\n                data[j] = obj.rows[rows[j]];\r\n            }\r\n            obj.rows = data;\r\n    \r\n            // Update references\r\n            obj.updateTableReferences();\r\n    \r\n            // Redo search\r\n            if (obj.results && obj.results.length) {\r\n                if (obj.searchInput.value) {\r\n                    obj.search(obj.searchInput.value);\r\n                } else {\r\n                    obj.closeFilter();\r\n                }\r\n            } else {\r\n                // Create page\r\n                obj.results = null;\r\n                obj.pageNumber = 0;\r\n    \r\n                if (obj.options.pagination > 0) {\r\n                    obj.page(0);\r\n                } else if (obj.options.lazyLoading == true) {\r\n                    obj.loadPage(0);\r\n                } else {\r\n                    for (var j = 0; j < obj.rows.length; j++) {\r\n                        obj.tbody.appendChild(obj.rows[j]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    \r\n        /**\r\n         * Move row\r\n         * \r\n         * @return void\r\n         */\r\n        obj.moveRow = function(o, d, ignoreDom) {\r\n            if (Object.keys(obj.options.mergeCells).length > 0) {\r\n                if (o > d) {\r\n                    var insertBefore = 1;\r\n                } else {\r\n                    var insertBefore = 0;\r\n                }\r\n\r\n                if (obj.isRowMerged(o).length || obj.isRowMerged(d, insertBefore).length) {\r\n                    if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\r\n                        return false;\r\n                    } else {\r\n                        obj.destroyMerged();\r\n                    }\r\n                }\r\n            }\r\n    \r\n            if (obj.options.search == true) {\r\n                if (obj.results && obj.results.length != obj.rows.length) {\r\n                    if (confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure)) {\r\n                        obj.resetSearch();\r\n                    } else {\r\n                        return false;\r\n                    }\r\n                }\r\n    \r\n                obj.results = null;\r\n            }\r\n    \r\n            if (! ignoreDom) {\r\n                if (Array.prototype.indexOf.call(obj.tbody.children, obj.rows[d]) >= 0) {\r\n                    if (o > d) {\r\n                        obj.tbody.insertBefore(obj.rows[o], obj.rows[d]);\r\n                    } else {\r\n                        obj.tbody.insertBefore(obj.rows[o], obj.rows[d].nextSibling);\r\n                    }\r\n                } else {\r\n                    obj.tbody.removeChild(obj.rows[o]);\r\n                }\r\n            }\r\n    \r\n            // Place references in the correct position\r\n            obj.rows.splice(d, 0, obj.rows.splice(o, 1)[0]);\r\n            obj.records.splice(d, 0, obj.records.splice(o, 1)[0]);\r\n            obj.options.data.splice(d, 0, obj.options.data.splice(o, 1)[0]);\r\n    \r\n            // Respect pagination\r\n            if (obj.options.pagination > 0 && obj.tbody.children.length != obj.options.pagination) {\r\n                obj.page(obj.pageNumber);\r\n            }\r\n    \r\n            // Keeping history of changes\r\n            obj.setHistory({\r\n                action:'moveRow',\r\n                oldValue: o,\r\n                newValue: d,\r\n            });\r\n    \r\n            // Update table references\r\n            obj.updateTableReferences();\r\n    \r\n            // Events\r\n            obj.dispatch('onmoverow', el, o, d);\r\n        }\r\n\r\n        /**\r\n         * Insert a new row\r\n         * \r\n         * @param mixed - number of blank lines to be insert or a single array with the data of the new row\r\n         * @param rowNumber\r\n         * @param insertBefore\r\n         * @return void\r\n         */\r\n        obj.insertRow = function(mixed, rowNumber, insertBefore) {\r\n            // Configuration\r\n            if (obj.options.allowInsertRow == true) {\r\n                // Records\r\n                var records = [];\r\n    \r\n                // Data to be insert\r\n                var data = [];\r\n    \r\n                // The insert could be lead by number of rows or the array of data\r\n                if (mixed > 0) {\r\n                    var numOfRows = mixed;\r\n                } else {\r\n                    var numOfRows = 1;\r\n    \r\n                    if (mixed) {\r\n                        data = mixed;\r\n                    }\r\n                }\r\n    \r\n                // Direction\r\n                var insertBefore = insertBefore ? true : false;\r\n    \r\n                // Current column number\r\n                var lastRow = obj.options.data.length - 1;\r\n    \r\n                if (rowNumber == undefined || rowNumber >= parseInt(lastRow) || rowNumber < 0) {\r\n                    rowNumber = lastRow;\r\n                }\r\n    \r\n                // Onbeforeinsertrow\r\n                if (obj.dispatch('onbeforeinsertrow', el, rowNumber, numOfRows, insertBefore) === false) {\r\n                    return false;\r\n                }\r\n    \r\n                // Merged cells\r\n                if (Object.keys(obj.options.mergeCells).length > 0) {\r\n                    if (obj.isRowMerged(rowNumber, insertBefore).length) {\r\n                        if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\r\n                            return false;\r\n                        } else {\r\n                            obj.destroyMerged();\r\n                        }\r\n                    }\r\n                }\r\n    \r\n                // Clear any search\r\n                if (obj.options.search == true) {\r\n                    if (obj.results && obj.results.length != obj.rows.length) {\r\n                        if (confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure)) {\r\n                            obj.resetSearch();\r\n                        } else {\r\n                            return false;\r\n                        }\r\n                    }\r\n    \r\n                    obj.results = null;\r\n                }\r\n    \r\n                // Insertbefore\r\n                var rowIndex = (! insertBefore) ? rowNumber + 1 : rowNumber;\r\n\r\n                // Keep the current data\r\n                var currentRecords = obj.records.splice(rowIndex);\r\n                var currentData = obj.options.data.splice(rowIndex);\r\n                var currentRows = obj.rows.splice(rowIndex);\r\n    \r\n                // Adding lines\r\n                var rowRecords = [];\r\n                var rowData = [];\r\n                var rowNode = [];\r\n\r\n                for (var row = rowIndex; row < (numOfRows + rowIndex); row++) {\r\n                    // Push data to the data container\r\n                    obj.options.data[row] = [];\r\n                    for (var col = 0; col < obj.options.columns.length; col++) {\r\n                        obj.options.data[row][col]  = data[col] ? data[col] : '';\r\n                    }\r\n                    // Create row\r\n                    var tr = obj.createRow(row, obj.options.data[row]);\r\n                    // Append node\r\n                    if (currentRows[0]) {\r\n                        if (Array.prototype.indexOf.call(obj.tbody.children, currentRows[0]) >= 0) {\r\n                            obj.tbody.insertBefore(tr, currentRows[0]);\r\n                        }\r\n                    } else {\r\n                        if (Array.prototype.indexOf.call(obj.tbody.children, obj.rows[rowNumber]) >= 0) {\r\n                            obj.tbody.appendChild(tr);\r\n                        }\r\n                    }\r\n                    // Record History\r\n                    rowRecords.push(obj.records[row]);\r\n                    rowData.push(obj.options.data[row]);\r\n                    rowNode.push(tr);\r\n                }\r\n    \r\n                // Copy the data back to the main data\r\n                Array.prototype.push.apply(obj.records, currentRecords);\r\n                Array.prototype.push.apply(obj.options.data, currentData);\r\n                Array.prototype.push.apply(obj.rows, currentRows);\r\n    \r\n                // Respect pagination\r\n                if (obj.options.pagination > 0) {\r\n                    obj.page(obj.pageNumber);\r\n                }\r\n    \r\n                // Keep history\r\n                obj.setHistory({\r\n                    action: 'insertRow',\r\n                    rowNumber: rowNumber,\r\n                    numOfRows: numOfRows,\r\n                    insertBefore: insertBefore,\r\n                    rowRecords: rowRecords,\r\n                    rowData: rowData,\r\n                    rowNode: rowNode,\r\n                });\r\n    \r\n                // Remove table references\r\n                obj.updateTableReferences();\r\n    \r\n                // Events\r\n                obj.dispatch('oninsertrow', el, rowNumber, numOfRows, rowRecords, insertBefore);\r\n            }\r\n        }\r\n    \r\n        /**\r\n         * Delete a row by number\r\n         * \r\n         * @param integer rowNumber - row number to be excluded\r\n         * @param integer numOfRows - number of lines\r\n         * @return void\r\n         */\r\n        obj.deleteRow = function(rowNumber, numOfRows) {\r\n            // Global Configuration\r\n            if (obj.options.allowDeleteRow == true) {\r\n                if (obj.options.allowDeletingAllRows == true || obj.options.data.length > 1) {\r\n                    // Delete row definitions\r\n                    if (rowNumber == undefined) {\r\n                        var number = obj.getSelectedRows();\r\n    \r\n                        if (! number[0]) {\r\n                            rowNumber = obj.options.data.length - 1;\r\n                            numOfRows = 1;\r\n                        } else {\r\n                            rowNumber = parseInt(number[0].getAttribute('data-y'));\r\n                            numOfRows = number.length;\r\n                        }\r\n                    }\r\n    \r\n                    // Last column\r\n                    var lastRow = obj.options.data.length - 1;\r\n    \r\n                    if (rowNumber == undefined || rowNumber > lastRow || rowNumber < 0) {\r\n                        rowNumber = lastRow;\r\n                    }\r\n    \r\n                    if (! numOfRows) {\r\n                        numOfRows = 1;\r\n                    }\r\n    \r\n                    // Do not delete more than the number of recoreds\r\n                    if (rowNumber + numOfRows >= obj.options.data.length) {\r\n                        numOfRows = obj.options.data.length - rowNumber;\r\n                    }\r\n\r\n                    // Onbeforedeleterow\r\n                    if (obj.dispatch('onbeforedeleterow', el, rowNumber, numOfRows) === false) {\r\n                        return false;\r\n                    }\r\n    \r\n                    if (parseInt(rowNumber) > -1) {\r\n                        // Merged cells\r\n                        var mergeExists = false;\r\n                        if (Object.keys(obj.options.mergeCells).length > 0) {\r\n                            for (var row = rowNumber; row < rowNumber + numOfRows; row++) {\r\n                                if (obj.isRowMerged(row, false).length) {\r\n                                    mergeExists = true;\r\n                                }\r\n                            }\r\n                        }\r\n                        if (mergeExists) {\r\n                            if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\r\n                                return false;\r\n                            } else {\r\n                                obj.destroyMerged();\r\n                            }\r\n                        }\r\n    \r\n                        // Clear any search\r\n                        if (obj.options.search == true) {\r\n                            if (obj.results && obj.results.length != obj.rows.length) {\r\n                                if (confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure)) {\r\n                                    obj.resetSearch();\r\n                                } else {\r\n                                    return false;\r\n                                }\r\n                            }\r\n    \r\n                            obj.results = null;\r\n                        }\r\n    \r\n                        // If delete all rows, and set allowDeletingAllRows false, will stay one row\r\n                        if (obj.options.allowDeletingAllRows == false && lastRow + 1 === numOfRows) {\r\n                            numOfRows--;\r\n                            console.error('Jspreadsheet: It is not possible to delete the last row');\r\n                        }\r\n    \r\n                        // Remove node\r\n                        for (var row = rowNumber; row < rowNumber + numOfRows; row++) {\r\n                            if (Array.prototype.indexOf.call(obj.tbody.children, obj.rows[row]) >= 0) {\r\n                                obj.rows[row].className = '';\r\n                                obj.rows[row].parentNode.removeChild(obj.rows[row]);\r\n                            }\r\n                        }\r\n    \r\n                        // Remove data\r\n                        var rowRecords = obj.records.splice(rowNumber, numOfRows);\r\n                        var rowData = obj.options.data.splice(rowNumber, numOfRows);\r\n                        var rowNode = obj.rows.splice(rowNumber, numOfRows);\r\n    \r\n                        // Respect pagination\r\n                        if (obj.options.pagination > 0 && obj.tbody.children.length != obj.options.pagination) {\r\n                            obj.page(obj.pageNumber);\r\n                        }\r\n    \r\n                        // Remove selection\r\n                        obj.conditionalSelectionUpdate(1, rowNumber, (rowNumber + numOfRows) - 1);\r\n    \r\n                        // Keep history\r\n                        obj.setHistory({\r\n                            action: 'deleteRow',\r\n                            rowNumber: rowNumber,\r\n                            numOfRows: numOfRows,\r\n                            insertBefore: 1,\r\n                            rowRecords: rowRecords,\r\n                            rowData: rowData,\r\n                            rowNode: rowNode\r\n                        });\r\n    \r\n                        // Remove table references\r\n                        obj.updateTableReferences();\r\n    \r\n                        // Events\r\n                        obj.dispatch('ondeleterow', el, rowNumber, numOfRows, rowRecords);\r\n                    }\r\n                } else {\r\n                    console.error('Jspreadsheet: It is not possible to delete the last row');\r\n                }\r\n            }\r\n        }\r\n    \r\n    \r\n        /**\r\n         * Move column\r\n         * \r\n         * @return void\r\n         */\r\n        obj.moveColumn = function(o, d) {\r\n            if (Object.keys(obj.options.mergeCells).length > 0) {\r\n                if (o > d) {\r\n                    var insertBefore = 1;\r\n                } else {\r\n                    var insertBefore = 0;\r\n                }\r\n\r\n                if (obj.isColMerged(o).length || obj.isColMerged(d, insertBefore).length) {\r\n                    if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\r\n                        return false;\r\n                    } else {\r\n                        obj.destroyMerged();\r\n                    }\r\n                }\r\n            }\r\n    \r\n            var o = parseInt(o);\r\n            var d = parseInt(d);\r\n    \r\n            if (o > d) {\r\n                obj.headerContainer.insertBefore(obj.headers[o], obj.headers[d]);\r\n                obj.colgroupContainer.insertBefore(obj.colgroup[o], obj.colgroup[d]);\r\n    \r\n                for (var j = 0; j < obj.rows.length; j++) {\r\n                    obj.rows[j].insertBefore(obj.records[j][o], obj.records[j][d]);\r\n                }\r\n            } else {\r\n                obj.headerContainer.insertBefore(obj.headers[o], obj.headers[d].nextSibling);\r\n                obj.colgroupContainer.insertBefore(obj.colgroup[o], obj.colgroup[d].nextSibling);\r\n    \r\n                for (var j = 0; j < obj.rows.length; j++) {\r\n                    obj.rows[j].insertBefore(obj.records[j][o], obj.records[j][d].nextSibling);\r\n                }\r\n            }\r\n    \r\n            obj.options.columns.splice(d, 0, obj.options.columns.splice(o, 1)[0]);\r\n            obj.headers.splice(d, 0, obj.headers.splice(o, 1)[0]);\r\n            obj.colgroup.splice(d, 0, obj.colgroup.splice(o, 1)[0]);\r\n    \r\n            for (var j = 0; j < obj.rows.length; j++) {\r\n                obj.options.data[j].splice(d, 0, obj.options.data[j].splice(o, 1)[0]);\r\n                obj.records[j].splice(d, 0, obj.records[j].splice(o, 1)[0]);\r\n            }\r\n    \r\n            // Update footers position\r\n            if (obj.options.footers) {\r\n                for (var j = 0; j < obj.options.footers.length; j++) {\r\n                    obj.options.footers[j].splice(d, 0, obj.options.footers[j].splice(o, 1)[0]);\r\n                }\r\n            }\r\n\r\n            // Keeping history of changes\r\n            obj.setHistory({\r\n                action:'moveColumn',\r\n                oldValue: o,\r\n                newValue: d,\r\n            });\r\n    \r\n            // Update table references\r\n            obj.updateTableReferences();\r\n    \r\n            // Events\r\n            obj.dispatch('onmovecolumn', el, o, d);\r\n        }\r\n\r\n        /**\r\n         * Insert a new column\r\n         * \r\n         * @param mixed - num of columns to be added or data to be added in one single column\r\n         * @param int columnNumber - number of columns to be created\r\n         * @param bool insertBefore\r\n         * @param object properties - column properties\r\n         * @return void\r\n         */\r\n        obj.insertColumn = function(mixed, columnNumber, insertBefore, properties) {\r\n            // Configuration\r\n            if (obj.options.allowInsertColumn == true) {\r\n                // Records\r\n                var records = [];\r\n    \r\n                // Data to be insert\r\n                var data = [];\r\n    \r\n                // The insert could be lead by number of rows or the array of data\r\n                if (mixed > 0) {\r\n                    var numOfColumns = mixed;\r\n                } else {\r\n                    var numOfColumns = 1;\r\n    \r\n                    if (mixed) {\r\n                        data = mixed;\r\n                    }\r\n                }\r\n    \r\n                // Direction\r\n                var insertBefore = insertBefore ? true : false;\r\n    \r\n                // Current column number\r\n                var lastColumn = obj.options.columns.length - 1;\r\n    \r\n                // Confirm position\r\n                if (columnNumber == undefined || columnNumber >= parseInt(lastColumn) || columnNumber < 0) {\r\n                    columnNumber = lastColumn;\r\n                }\r\n    \r\n                // Onbeforeinsertcolumn\r\n                if (obj.dispatch('onbeforeinsertcolumn', el, columnNumber, numOfColumns, insertBefore) === false) {\r\n                    return false;\r\n                }\r\n    \r\n                // Merged cells\r\n                if (Object.keys(obj.options.mergeCells).length > 0) {\r\n                    if (obj.isColMerged(columnNumber, insertBefore).length) {\r\n                        if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\r\n                            return false;\r\n                        } else {\r\n                            obj.destroyMerged();\r\n                        }\r\n                    }\r\n                }\r\n    \r\n                // Create default properties\r\n                if (! properties) {\r\n                    properties = [];\r\n                }\r\n    \r\n                for (var i = 0; i < numOfColumns; i++) {\r\n                    if (! properties[i]) {\r\n                        properties[i] = { type:'text', source:[], options:[], width:obj.options.defaultColWidth, align:obj.options.defaultColAlign };\r\n                    }\r\n                }\r\n    \r\n                // Insert before\r\n                var columnIndex = (! insertBefore) ? columnNumber + 1 : columnNumber;\r\n                obj.options.columns = jexcel.injectArray(obj.options.columns, columnIndex, properties);\r\n    \r\n                // Open space in the containers\r\n                var currentHeaders = obj.headers.splice(columnIndex);\r\n                var currentColgroup = obj.colgroup.splice(columnIndex);\r\n    \r\n                // History\r\n                var historyHeaders = [];\r\n                var historyColgroup = [];\r\n                var historyRecords = [];\r\n                var historyData = [];\r\n                var historyFooters = [];\r\n    \r\n                // Add new headers\r\n                for (var col = columnIndex; col < (numOfColumns + columnIndex); col++) {\r\n                    obj.createCellHeader(col);\r\n                    obj.headerContainer.insertBefore(obj.headers[col], obj.headerContainer.children[col+1]);\r\n                    obj.colgroupContainer.insertBefore(obj.colgroup[col], obj.colgroupContainer.children[col+1]);\r\n    \r\n                    historyHeaders.push(obj.headers[col]);\r\n                    historyColgroup.push(obj.colgroup[col]);\r\n                }\r\n    \r\n                // Add new footer cells\r\n                if (obj.options.footers) {\r\n                    for (var j = 0; j < obj.options.footers.length; j++) {\r\n                        historyFooters[j] = [];\r\n                        for (var i = 0; i < numOfColumns; i++) {\r\n                            historyFooters[j].push('');\r\n                        }\r\n                        obj.options.footers[j].splice(columnIndex, 0, historyFooters[j]);\r\n                    }\r\n                }\r\n\r\n                // Adding visual columns\r\n                for (var row = 0; row < obj.options.data.length; row++) {\r\n                    // Keep the current data\r\n                    var currentData = obj.options.data[row].splice(columnIndex);\r\n                    var currentRecord = obj.records[row].splice(columnIndex);\r\n    \r\n                    // History\r\n                    historyData[row] = [];\r\n                    historyRecords[row] = [];\r\n    \r\n                    for (var col = columnIndex; col < (numOfColumns + columnIndex); col++) {\r\n                        // New value\r\n                        var value = data[row] ? data[row] : '';\r\n                        obj.options.data[row][col] = value;\r\n                        // New cell\r\n                        var td = obj.createCell(col, row, obj.options.data[row][col]);\r\n                        obj.records[row][col] = td;\r\n                        // Add cell to the row\r\n                        if (obj.rows[row]) {\r\n                            obj.rows[row].insertBefore(td, obj.rows[row].children[col+1]);\r\n                        }\r\n    \r\n                        // Record History\r\n                        historyData[row].push(value);\r\n                        historyRecords[row].push(td);\r\n                    }\r\n    \r\n                    // Copy the data back to the main data\r\n                    Array.prototype.push.apply(obj.options.data[row], currentData);\r\n                    Array.prototype.push.apply(obj.records[row], currentRecord);\r\n                }\r\n    \r\n                Array.prototype.push.apply(obj.headers, currentHeaders);\r\n                Array.prototype.push.apply(obj.colgroup, currentColgroup);\r\n    \r\n                // Adjust nested headers\r\n                if (obj.options.nestedHeaders && obj.options.nestedHeaders.length > 0) {\r\n                    // Flexible way to handle nestedheaders\r\n                    if (obj.options.nestedHeaders[0] && obj.options.nestedHeaders[0][0]) {\r\n                        for (var j = 0; j < obj.options.nestedHeaders.length; j++) {\r\n                            var colspan = parseInt(obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan) + numOfColumns;\r\n                            obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan = colspan;\r\n                            obj.thead.children[j].children[obj.thead.children[j].children.length-1].setAttribute('colspan', colspan);\r\n                            var o = obj.thead.children[j].children[obj.thead.children[j].children.length-1].getAttribute('data-column');\r\n                            o = o.split(',');\r\n                            for (var col = columnIndex; col < (numOfColumns + columnIndex); col++) {\r\n                                o.push(col);\r\n                            }\r\n                            obj.thead.children[j].children[obj.thead.children[j].children.length-1].setAttribute('data-column', o);\r\n                        }\r\n                    } else {\r\n                        var colspan = parseInt(obj.options.nestedHeaders[0].colspan) + numOfColumns;\r\n                        obj.options.nestedHeaders[0].colspan = colspan;\r\n                        obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute('colspan', colspan);\r\n                    }\r\n                }\r\n    \r\n                // Keep history\r\n                obj.setHistory({\r\n                    action: 'insertColumn',\r\n                    columnNumber:columnNumber,\r\n                    numOfColumns:numOfColumns,\r\n                    insertBefore:insertBefore,\r\n                    columns:properties,\r\n                    headers:historyHeaders,\r\n                    colgroup:historyColgroup,\r\n                    records:historyRecords,\r\n                    footers:historyFooters,\r\n                    data:historyData,\r\n                });\r\n    \r\n                // Remove table references\r\n                obj.updateTableReferences();\r\n    \r\n                // Events\r\n                obj.dispatch('oninsertcolumn', el, columnNumber, numOfColumns, historyRecords, insertBefore);\r\n            }\r\n        }\r\n    \r\n        /**\r\n         * Delete a column by number\r\n         * \r\n         * @param integer columnNumber - reference column to be excluded\r\n         * @param integer numOfColumns - number of columns to be excluded from the reference column\r\n         * @return void\r\n         */\r\n        obj.deleteColumn = function(columnNumber, numOfColumns) {\r\n            // Global Configuration\r\n            if (obj.options.allowDeleteColumn == true) {\r\n                if (obj.headers.length > 1) {\r\n                    // Delete column definitions\r\n                    if (columnNumber == undefined) {\r\n                        var number = obj.getSelectedColumns(true);\r\n    \r\n                        if (! number.length) {\r\n                            // Remove last column\r\n                            columnNumber = obj.headers.length - 1;\r\n                            numOfColumns = 1;\r\n                        } else {\r\n                            // Remove selected\r\n                            columnNumber = parseInt(number[0]);\r\n                            numOfColumns = parseInt(number.length);\r\n                        }\r\n                    }\r\n    \r\n                    // Lasat column\r\n                    var lastColumn = obj.options.data[0].length - 1;\r\n    \r\n                    if (columnNumber == undefined || columnNumber > lastColumn || columnNumber < 0) {\r\n                        columnNumber = lastColumn;\r\n                    }\r\n    \r\n                    // Minimum of columns to be delete is 1\r\n                    if (! numOfColumns) {\r\n                        numOfColumns = 1;\r\n                    }\r\n    \r\n                    // Can't delete more than the limit of the table\r\n                    if (numOfColumns > obj.options.data[0].length - columnNumber) {\r\n                        numOfColumns = obj.options.data[0].length - columnNumber;\r\n                    }\r\n    \r\n                    // onbeforedeletecolumn\r\n                   if (obj.dispatch('onbeforedeletecolumn', el, columnNumber, numOfColumns) === false) {\r\n                      return false;\r\n                   }\r\n    \r\n                    // Can't remove the last column\r\n                    if (parseInt(columnNumber) > -1) {\r\n                        // Merged cells\r\n                        var mergeExists = false;\r\n                        if (Object.keys(obj.options.mergeCells).length > 0) {\r\n                            for (var col = columnNumber; col < columnNumber + numOfColumns; col++) {\r\n                                if (obj.isColMerged(col, false).length) {\r\n                                    mergeExists = true;\r\n                                }\r\n                            }\r\n                        }\r\n                        if (mergeExists) {\r\n                            if (! confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure)) {\r\n                                return false;\r\n                            } else {\r\n                                obj.destroyMerged();\r\n                            }\r\n                        }\r\n    \r\n                        // Delete the column properties\r\n                        var columns = obj.options.columns.splice(columnNumber, numOfColumns);\r\n    \r\n                        for (var col = columnNumber; col < columnNumber + numOfColumns; col++) {\r\n                            obj.colgroup[col].className = '';\r\n                            obj.headers[col].className = '';\r\n                            obj.colgroup[col].parentNode.removeChild(obj.colgroup[col]);\r\n                            obj.headers[col].parentNode.removeChild(obj.headers[col]);\r\n                        }\r\n    \r\n                        var historyHeaders = obj.headers.splice(columnNumber, numOfColumns);\r\n                        var historyColgroup = obj.colgroup.splice(columnNumber, numOfColumns);\r\n                        var historyRecords = [];\r\n                        var historyData = [];\r\n                        var historyFooters = [];\r\n\r\n                        for (var row = 0; row < obj.options.data.length; row++) {\r\n                            for (var col = columnNumber; col < columnNumber + numOfColumns; col++) {\r\n                                obj.records[row][col].className = '';\r\n                                obj.records[row][col].parentNode.removeChild(obj.records[row][col]);\r\n                            }\r\n                        }\r\n    \r\n                        // Delete headers\r\n                        for (var row = 0; row < obj.options.data.length; row++) {\r\n                            // History\r\n                            historyData[row] = obj.options.data[row].splice(columnNumber, numOfColumns);\r\n                            historyRecords[row] = obj.records[row].splice(columnNumber, numOfColumns);\r\n                        }\r\n\r\n                        // Delete footers\r\n                        if (obj.options.footers) {\r\n                            for (var row = 0; row < obj.options.footers.length; row++) {\r\n                                historyFooters[row] = obj.options.footers[row].splice(columnNumber, numOfColumns);\r\n                            }\r\n                        }\r\n\r\n                        // Remove selection\r\n                        obj.conditionalSelectionUpdate(0, columnNumber, (columnNumber + numOfColumns) - 1);\r\n    \r\n                        // Adjust nested headers\r\n                        if (obj.options.nestedHeaders && obj.options.nestedHeaders.length > 0) {\r\n                            // Flexible way to handle nestedheaders\r\n                            if (obj.options.nestedHeaders[0] && obj.options.nestedHeaders[0][0]) {\r\n                                for (var j = 0; j < obj.options.nestedHeaders.length; j++) {\r\n                                    var colspan = parseInt(obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan) - numOfColumns;\r\n                                    obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan = colspan;\r\n                                    obj.thead.children[j].children[obj.thead.children[j].children.length-1].setAttribute('colspan', colspan);\r\n                                }\r\n                            } else {\r\n                                var colspan = parseInt(obj.options.nestedHeaders[0].colspan) - numOfColumns;\r\n                                obj.options.nestedHeaders[0].colspan = colspan;\r\n                                obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute('colspan', colspan);\r\n                            }\r\n                        }\r\n    \r\n                        // Keeping history of changes\r\n                        obj.setHistory({\r\n                            action:'deleteColumn',\r\n                            columnNumber:columnNumber,\r\n                            numOfColumns:numOfColumns,\r\n                            insertBefore: 1,\r\n                            columns:columns,\r\n                            headers:historyHeaders,\r\n                            colgroup:historyColgroup,\r\n                            records:historyRecords,\r\n                            footers:historyFooters,\r\n                            data:historyData,\r\n                        });\r\n    \r\n                        // Update table references\r\n                        obj.updateTableReferences();\r\n    \r\n                        // Delete\r\n                        obj.dispatch('ondeletecolumn', el, columnNumber, numOfColumns, historyRecords);\r\n                    }\r\n                } else {\r\n                    console.error('Jspreadsheet: It is not possible to delete the last column');\r\n                }\r\n            }\r\n        }\r\n    \r\n        /**\r\n         * Get seleted rows numbers\r\n         * \r\n         * @return array\r\n         */\r\n        obj.getSelectedRows = function(asIds) {\r\n            var rows = [];\r\n            // Get all selected rows\r\n            for (var j = 0; j < obj.rows.length; j++) {\r\n                if (obj.rows[j].classList.contains('selected')) {\r\n                    if (asIds) {\r\n                        rows.push(j);\r\n                    } else {\r\n                        rows.push(obj.rows[j]);\r\n                    }\r\n                }\r\n            }\r\n    \r\n            return rows;\r\n        },\r\n    \r\n        /**\r\n         * Get seleted column numbers\r\n         * \r\n         * @return array\r\n         */\r\n        obj.getSelectedColumns = function() {\r\n            var cols = [];\r\n            // Get all selected cols\r\n            for (var i = 0; i < obj.headers.length; i++) {\r\n                if (obj.headers[i].classList.contains('selected')) {\r\n                    cols.push(i);\r\n                }\r\n            }\r\n    \r\n            return cols;\r\n        }\r\n    \r\n        /**\r\n         * Get highlighted\r\n         * \r\n         * @return array\r\n         */\r\n        obj.getHighlighted = function() {\r\n            return obj.highlighted;\r\n        }\r\n    \r\n        /**\r\n         * Update cell references\r\n         * \r\n         * @return void\r\n         */\r\n        obj.updateTableReferences = function() {\r\n            // Update headers\r\n            for (var i = 0; i < obj.headers.length; i++) {\r\n                var x = obj.headers[i].getAttribute('data-x');\r\n    \r\n                if (x != i) {\r\n                    // Update coords\r\n                    obj.headers[i].setAttribute('data-x', i);\r\n                    // Title\r\n                    if (! obj.headers[i].getAttribute('title')) {\r\n                        obj.headers[i].innerHTML = jexcel.getColumnName(i);\r\n                    }\r\n                }\r\n            }\r\n    \r\n            // Update all rows\r\n            for (var j = 0; j < obj.rows.length; j++) {\r\n                if (obj.rows[j]) {\r\n                    var y = obj.rows[j].getAttribute('data-y');\r\n    \r\n                    if (y != j) {\r\n                        // Update coords\r\n                        obj.rows[j].setAttribute('data-y', j);\r\n                        obj.rows[j].children[0].setAttribute('data-y', j);\r\n                        // Row number\r\n                        obj.rows[j].children[0].innerHTML = j + 1;\r\n                    }\r\n                }\r\n            }\r\n    \r\n            // Regular cells affected by this change\r\n            var affectedTokens = [];\r\n            var mergeCellUpdates = [];\r\n    \r\n            // Update cell\r\n            var updatePosition = function(x,y,i,j) {\r\n                if (x != i) {\r\n                    obj.records[j][i].setAttribute('data-x', i);\r\n                }\r\n                if (y != j) {\r\n                    obj.records[j][i].setAttribute('data-y', j);\r\n                }\r\n    \r\n                // Other updates\r\n                if (x != i || y != j) {\r\n                    var columnIdFrom = jexcel.getColumnNameFromId([x, y]);\r\n                    var columnIdTo = jexcel.getColumnNameFromId([i, j]);\r\n                    affectedTokens[columnIdFrom] = columnIdTo;\r\n                }\r\n            }\r\n    \r\n            for (var j = 0; j < obj.records.length; j++) {\r\n                for (var i = 0; i < obj.records[0].length; i++) {\r\n                    if (obj.records[j][i]) {\r\n                        // Current values\r\n                        var x = obj.records[j][i].getAttribute('data-x');\r\n                        var y = obj.records[j][i].getAttribute('data-y');\r\n    \r\n                        // Update column\r\n                        if (obj.records[j][i].getAttribute('data-merged')) {\r\n                            var columnIdFrom = jexcel.getColumnNameFromId([x, y]);\r\n                            var columnIdTo = jexcel.getColumnNameFromId([i, j]);\r\n                            if (mergeCellUpdates[columnIdFrom] == null) {\r\n                                if (columnIdFrom == columnIdTo) {\r\n                                    mergeCellUpdates[columnIdFrom] = false;\r\n                                } else {\r\n                                    var totalX = parseInt(i - x);\r\n                                    var totalY = parseInt(j - y);\r\n                                    mergeCellUpdates[columnIdFrom] = [ columnIdTo, totalX, totalY ];\r\n                                }\r\n                            }\r\n                        } else {\r\n                            updatePosition(x,y,i,j);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n    \r\n            // Update merged if applicable\r\n            var keys = Object.keys(mergeCellUpdates);\r\n            if (keys.length) {\r\n                for (var i = 0; i < keys.length; i++) {\r\n                    if (mergeCellUpdates[keys[i]]) {\r\n                        var info = jexcel.getIdFromColumnName(keys[i], true)\r\n                        var x = info[0];\r\n                        var y = info[1];\r\n                        updatePosition(x,y,x + mergeCellUpdates[keys[i]][1],y + mergeCellUpdates[keys[i]][2]);\r\n    \r\n                        var columnIdFrom = keys[i];\r\n                        var columnIdTo = mergeCellUpdates[keys[i]][0];\r\n                        for (var j = 0; j < obj.options.mergeCells[columnIdFrom][2].length; j++) {\r\n                            var x = parseInt(obj.options.mergeCells[columnIdFrom][2][j].getAttribute('data-x'));\r\n                            var y = parseInt(obj.options.mergeCells[columnIdFrom][2][j].getAttribute('data-y'));\r\n                            obj.options.mergeCells[columnIdFrom][2][j].setAttribute('data-x', x + mergeCellUpdates[keys[i]][1]);\r\n                            obj.options.mergeCells[columnIdFrom][2][j].setAttribute('data-y', y + mergeCellUpdates[keys[i]][2]);\r\n                        }\r\n    \r\n                        obj.options.mergeCells[columnIdTo] = obj.options.mergeCells[columnIdFrom];\r\n                        delete(obj.options.mergeCells[columnIdFrom]);\r\n                    }\r\n                }\r\n            }\r\n    \r\n            // Update formulas\r\n            obj.updateFormulas(affectedTokens);\r\n    \r\n            // Update meta data\r\n            obj.updateMeta(affectedTokens);\r\n    \r\n            // Refresh selection\r\n            obj.refreshSelection();\r\n    \r\n            // Update table with custom configuration if applicable\r\n            obj.updateTable();\r\n        }\r\n    \r\n        /**\r\n         * Custom settings for the cells\r\n         */\r\n        obj.updateTable = function() {\r\n            // Check for spare\r\n            if (obj.options.minSpareRows > 0) {\r\n                var numBlankRows = 0;\r\n                for (var j = obj.rows.length - 1; j >= 0; j--) {\r\n                    var test = false;\r\n                    for (var i = 0; i < obj.headers.length; i++) {\r\n                        if (obj.options.data[j][i]) {\r\n                            test = true;\r\n                        }\r\n                    }\r\n                    if (test) {\r\n                        break;\r\n                    } else {\r\n                        numBlankRows++;\r\n                    }\r\n                }\r\n    \r\n                if (obj.options.minSpareRows - numBlankRows > 0) {\r\n                    obj.insertRow(obj.options.minSpareRows - numBlankRows)\r\n                }\r\n            }\r\n    \r\n            if (obj.options.minSpareCols > 0) {\r\n                var numBlankCols = 0;\r\n                for (var i = obj.headers.length - 1; i >= 0 ; i--) {\r\n                    var test = false;\r\n                    for (var j = 0; j < obj.rows.length; j++) {\r\n                        if (obj.options.data[j][i]) {\r\n                            test = true;\r\n                        }\r\n                    }\r\n                    if (test) {\r\n                        break;\r\n                    } else {\r\n                        numBlankCols++;\r\n                    }\r\n                }\r\n    \r\n                if (obj.options.minSpareCols - numBlankCols > 0) {\r\n                    obj.insertColumn(obj.options.minSpareCols - numBlankCols)\r\n                }\r\n            }\r\n    \r\n            // Customizations by the developer\r\n            if (typeof(obj.options.updateTable) == 'function') {\r\n                if (obj.options.detachForUpdates) {\r\n                    el.removeChild(obj.content);\r\n                }\r\n\r\n                for (var j = 0; j < obj.rows.length; j++) {\r\n                    for (var i = 0; i < obj.headers.length; i++) {\r\n                        obj.options.updateTable(el, obj.records[j][i], i, j, obj.options.data[j][i], obj.records[j][i].innerText, jexcel.getColumnNameFromId([i, j]));\r\n                    }\r\n                }\r\n\r\n                if (obj.options.detachForUpdates) {\r\n                    el.insertBefore(obj.content, obj.pagination);\r\n                }\r\n            }\r\n    \r\n            // Update footers\r\n            if (obj.options.footers) {\r\n                obj.setFooter();\r\n            }\r\n\r\n            // Update corner position\r\n            setTimeout(function() {\r\n                obj.updateCornerPosition();\r\n            },0);\r\n        }\r\n\r\n        /**\r\n         * Readonly\r\n         */\r\n        obj.isReadOnly = function(cell) {\r\n            if (cell = obj.getCell(cell)) {\r\n                return cell.classList.contains('readonly') ? true : false;\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Readonly\r\n         */\r\n        obj.setReadOnly = function(cell, state) {\r\n            if (cell = obj.getCell(cell)) {\r\n                if (state) {\r\n                    cell.classList.add('readonly');\r\n                } else {\r\n                    cell.classList.remove('readonly');\r\n                }\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Show row\r\n         */\r\n        obj.showRow = function(rowNumber) {\r\n            obj.rows[rowNumber].style.display = '';\r\n        }\r\n\r\n        /**\r\n         * Hide row\r\n         */\r\n        obj.hideRow = function(rowNumber) {\r\n            obj.rows[rowNumber].style.display = 'none';\r\n        }\r\n\r\n        /**\r\n         * Show column\r\n         */\r\n        obj.showColumn = function(colNumber) {\r\n            obj.headers[colNumber].style.display = '';\r\n            obj.colgroup[colNumber].style.display = '';\r\n            for (var j = 0; j < obj.options.data.length; j++) {\r\n                obj.records[j][colNumber].style.display = '';\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Hide column\r\n         */\r\n        obj.hideColumn = function(colNumber) {\r\n            obj.headers[colNumber].style.display = 'none';\r\n            obj.colgroup[colNumber].style.display = 'none';\r\n            for (var j = 0; j < obj.options.data.length; j++) {\r\n                obj.records[j][colNumber].style.display = 'none';\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Show index column\r\n         */\r\n        obj.showIndex = function() {\r\n            obj.table.classList.remove('jexcel_hidden_index');\r\n        }\r\n    \r\n        /**\r\n         * Hide index column\r\n         */\r\n        obj.hideIndex = function() {\r\n            obj.table.classList.add('jexcel_hidden_index');\r\n        }\r\n    \r\n        /**\r\n         * Update all related cells in the chain\r\n         */\r\n        var chainLoopProtection = [];\r\n    \r\n        obj.updateFormulaChain = function(x, y, records) {\r\n            var cellId = jexcel.getColumnNameFromId([x, y]);\r\n            if (obj.formula[cellId] && obj.formula[cellId].length > 0) {\r\n                if (chainLoopProtection[cellId]) {\r\n                    obj.records[y][x].innerHTML = '#ERROR';\r\n                    obj.formula[cellId] = '';\r\n                } else {\r\n                    // Protection\r\n                    chainLoopProtection[cellId] = true;\r\n    \r\n                    for (var i = 0; i < obj.formula[cellId].length; i++) {\r\n                        var cell = jexcel.getIdFromColumnName(obj.formula[cellId][i], true);\r\n                        // Update cell\r\n                        var value = ''+obj.options.data[cell[1]][cell[0]];\r\n                        if (value.substr(0,1) == '=') {\r\n                            records.push(obj.updateCell(cell[0], cell[1], value, true));\r\n                        } else {\r\n                            // No longer a formula, remove from the chain\r\n                            Object.keys(obj.formula)[i] = null;\r\n                        }\r\n                        obj.updateFormulaChain(cell[0], cell[1], records);\r\n                    }\r\n                }\r\n            }\r\n    \r\n            chainLoopProtection = [];\r\n        }\r\n    \r\n        /**\r\n         * Update formulas\r\n         */\r\n        obj.updateFormulas = function(referencesToUpdate) {\r\n            // Update formulas\r\n            for (var j = 0; j < obj.options.data.length; j++) {\r\n                for (var i = 0; i < obj.options.data[0].length; i++) {\r\n                    var value = '' + obj.options.data[j][i];\r\n                    // Is formula\r\n                    if (value.substr(0,1) == '=') {\r\n                        // Replace tokens\r\n                        var newFormula = obj.updateFormula(value, referencesToUpdate);\r\n                        if (newFormula != value) {\r\n                            obj.options.data[j][i] = newFormula;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n    \r\n            // Update formula chain\r\n            var formula = [];\r\n            var keys = Object.keys(obj.formula);\r\n            for (var j = 0; j < keys.length; j++) {\r\n                // Current key and values\r\n                var key = keys[j];\r\n                var value = obj.formula[key];\r\n                // Update key\r\n                if (referencesToUpdate[key]) {\r\n                    key = referencesToUpdate[key];\r\n                }\r\n                // Update values\r\n                formula[key] = [];\r\n                for (var i = 0; i < value.length; i++) {\r\n                    var letter = value[i];\r\n                    if (referencesToUpdate[letter]) {\r\n                        letter = referencesToUpdate[letter];\r\n                    }\r\n                    formula[key].push(letter);\r\n                }\r\n            }\r\n            obj.formula = formula;\r\n        }\r\n    \r\n        /**\r\n         * Update formula\r\n         */\r\n        obj.updateFormula = function(formula, referencesToUpdate) {\r\n            var testLetter = /[A-Z]/;\r\n            var testNumber = /[0-9]/;\r\n    \r\n            var newFormula = '';\r\n            var letter = null;\r\n            var number = null;\r\n            var token = '';\r\n    \r\n            for (var index = 0; index < formula.length; index++) {\r\n                if (testLetter.exec(formula[index])) {\r\n                    letter = 1;\r\n                    number = 0;\r\n                    token += formula[index];\r\n                } else if (testNumber.exec(formula[index])) {\r\n                    number = letter ? 1 : 0;\r\n                    token += formula[index];\r\n                } else {\r\n                    if (letter && number) {\r\n                        token = referencesToUpdate[token] ? referencesToUpdate[token] : token;\r\n                    }\r\n                    newFormula += token;\r\n                    newFormula += formula[index];\r\n                    letter = 0;\r\n                    number = 0;\r\n                    token = '';\r\n                }\r\n            }\r\n    \r\n            if (token) {\r\n                if (letter && number) {\r\n                    token = referencesToUpdate[token] ? referencesToUpdate[token] : token;\r\n                }\r\n                newFormula += token;\r\n            }\r\n    \r\n            return newFormula;\r\n        }\r\n    \r\n        /**\r\n         * Secure formula\r\n         */\r\n        var secureFormula = function(oldValue) {\r\n            var newValue = '';\r\n            var inside = 0;\r\n\r\n            for (var i = 0; i < oldValue.length; i++) {\r\n                if (oldValue[i] == '\"') {\r\n                    if (inside == 0) {\r\n                        inside = 1;\r\n                    } else {\r\n                        inside = 0;\r\n                    }\r\n                }\r\n\r\n                if (inside == 1) {\r\n                    newValue += oldValue[i];\r\n                } else {\r\n                    newValue += oldValue[i].toUpperCase();\r\n                }\r\n            }\r\n\r\n            return newValue;\r\n        }\r\n\r\n        /**\r\n         * Parse formulas\r\n         */\r\n        obj.executeFormula = function(expression, x, y) {\r\n    \r\n            var formulaResults = [];\r\n            var formulaLoopProtection = [];\r\n    \r\n            // Execute formula with loop protection\r\n            var execute = function(expression, x, y) {\r\n             // Parent column identification\r\n                var parentId = jexcel.getColumnNameFromId([x, y]);\r\n    \r\n                // Code protection\r\n                if (formulaLoopProtection[parentId]) {\r\n                    console.error('Reference loop detected');\r\n                    return '#ERROR';\r\n                }\r\n    \r\n                formulaLoopProtection[parentId] = true;\r\n    \r\n                // Convert range tokens\r\n                var tokensUpdate = function(tokens) {\r\n                    for (var index = 0; index < tokens.length; index++) {\r\n                        var f = [];\r\n                        var token = tokens[index].split(':');\r\n                        var e1 = jexcel.getIdFromColumnName(token[0], true);\r\n                        var e2 = jexcel.getIdFromColumnName(token[1], true);\r\n    \r\n                        if (e1[0] <= e2[0]) {\r\n                            var x1 = e1[0];\r\n                            var x2 = e2[0];\r\n                        } else {\r\n                            var x1 = e2[0];\r\n                            var x2 = e1[0];\r\n                        }\r\n    \r\n                        if (e1[1] <= e2[1]) {\r\n                            var y1 = e1[1];\r\n                            var y2 = e2[1];\r\n                        } else {\r\n                            var y1 = e2[1];\r\n                            var y2 = e1[1];\r\n                        }\r\n    \r\n                        for (var j = y1; j <= y2; j++) {\r\n                            for (var i = x1; i <= x2; i++) {\r\n                                f.push(jexcel.getColumnNameFromId([i, j]));\r\n                            }\r\n                        }\r\n    \r\n                        expression = expression.replace(tokens[index], f.join(','));\r\n                    }\r\n                }\r\n    \r\n                // Range with $ remove $\r\n                expression = expression.replace(/\\$?([A-Z]+)\\$?([0-9]+)/g, \"$1$2\");\r\n\r\n                var tokens = expression.match(/([A-Z]+[0-9]+)\\:([A-Z]+[0-9]+)/g);\r\n                if (tokens && tokens.length) {\r\n                    tokensUpdate(tokens);\r\n                }\r\n\r\n                // Get tokens\r\n                var tokens = expression.match(/([A-Z]+[0-9]+)/g);\r\n    \r\n                // Direct self-reference protection\r\n                if (tokens && tokens.indexOf(parentId) > -1) {\r\n                    console.error('Self Reference detected');\r\n                    return '#ERROR';\r\n                } else {\r\n                    // Expressions to be used in the parsing\r\n                    var formulaExpressions = {};\r\n\r\n                    if (tokens) {\r\n                        for (var i = 0; i < tokens.length; i++) {\r\n                            // Keep chain\r\n                            if (! obj.formula[tokens[i]]) {\r\n                                obj.formula[tokens[i]] = [];\r\n                            }\r\n                            // Is already in the register\r\n                            if (obj.formula[tokens[i]].indexOf(parentId) < 0) {\r\n                                obj.formula[tokens[i]].push(parentId);\r\n                            }\r\n    \r\n                            // Do not calculate again\r\n                            if (eval('typeof(' + tokens[i] + ') == \"undefined\"')) {\r\n                                // Coords\r\n                                var position = jexcel.getIdFromColumnName(tokens[i], 1);\r\n                                // Get value\r\n                                if (typeof(obj.options.data[position[1]]) != 'undefined' && typeof(obj.options.data[position[1]][position[0]]) != 'undefined') {\r\n                                    var value = obj.options.data[position[1]][position[0]];\r\n                                } else {\r\n                                    var value = '';\r\n                                }\r\n                                // Get column data\r\n                                if ((''+value).substr(0,1) == '=') {\r\n                                    if (formulaResults[tokens[i]]) {\r\n                                        value = formulaResults[tokens[i]];\r\n                                    } else {\r\n                                        value = execute(value, position[0], position[1]);\r\n                                        formulaResults[tokens[i]] = value;\r\n                                    }\r\n                                }\r\n                                // Type!\r\n                                if ((''+value).trim() == '') {\r\n                                    // Null\r\n                                    formulaExpressions[tokens[i]] = null;\r\n                                } else {\r\n                                    if (value == Number(value) && obj.options.autoCasting == true) {\r\n                                        // Number\r\n                                        formulaExpressions[tokens[i]] = Number(value);\r\n                                    } else {\r\n                                        // Trying any formatted number\r\n                                        var number = obj.parseNumber(value, position[0])\r\n                                        if (obj.options.autoCasting == true && number) {\r\n                                            formulaExpressions[tokens[i]] = number;\r\n                                        } else {\r\n                                            formulaExpressions[tokens[i]] = '\"' + value + '\"';\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n    \r\n                    // Convert formula to javascript\r\n                    try {\r\n                        var res = jexcel.formula(expression.substr(1), formulaExpressions, x, y, obj);\r\n                    } catch (e) {\r\n                        var res = '#ERROR';\r\n                        console.log(e)\r\n                    }\r\n    \r\n                    return res;\r\n                }\r\n            }\r\n    \r\n            return execute(expression, x, y);\r\n        }\r\n    \r\n        /**\r\n         * Trying to extract a number from a string\r\n         */\r\n        obj.parseNumber = function(value, columnNumber) {\r\n            // Decimal point\r\n            var decimal = columnNumber && obj.options.columns[columnNumber].decimal ? obj.options.columns[columnNumber].decimal : '.';\r\n    \r\n            // Parse both parts of the number\r\n            var number = ('' + value);\r\n            number = number.split(decimal);\r\n            number[0] = number[0].match(/[+-]?[0-9]/g);\r\n            if (number[0]) {\r\n                number[0] = number[0].join('');\r\n            }\r\n            if (number[1]) {\r\n                number[1] = number[1].match(/[0-9]*/g).join('');\r\n            }\r\n    \r\n            // Is a valid number\r\n            if (number[0] && Number(number[0]) >= 0) {\r\n                if (! number[1]) {\r\n                    var value = Number(number[0] + '.00');\r\n                } else {\r\n                    var value = Number(number[0] + '.' + number[1]);\r\n                }\r\n            } else {\r\n                var value = null;\r\n            }\r\n    \r\n            return value;\r\n        }\r\n    \r\n        /**\r\n         * Get row number\r\n         */\r\n        obj.row = function(cell) {\r\n        }\r\n    \r\n        /**\r\n         * Get col number\r\n         */\r\n        obj.col = function(cell) {\r\n        }\r\n    \r\n        obj.up = function(shiftKey, ctrlKey) {\r\n            if (shiftKey) {\r\n                if (obj.selectedCell[3] > 0) {\r\n                    obj.up.visible(1, ctrlKey ? 0 : 1)\r\n                }\r\n            } else {\r\n                if (obj.selectedCell[1] > 0) {\r\n                    obj.up.visible(0, ctrlKey ? 0 : 1)\r\n                }\r\n                obj.selectedCell[2] = obj.selectedCell[0];\r\n                obj.selectedCell[3] = obj.selectedCell[1];\r\n            }\r\n    \r\n            // Update selection\r\n            obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\r\n    \r\n            // Change page\r\n            if (obj.options.lazyLoading == true) {\r\n                if (obj.selectedCell[1] == 0 || obj.selectedCell[3] == 0) {\r\n                    obj.loadPage(0);\r\n                    obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\r\n                } else {\r\n                    if (obj.loadValidation()) {\r\n                        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\r\n                    } else {\r\n                        var item = parseInt(obj.tbody.firstChild.getAttribute('data-y'));\r\n                        if (obj.selectedCell[1] - item < 30) {\r\n                            obj.loadUp();\r\n                            obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\r\n                        }\r\n                    }\r\n                }\r\n            } else if (obj.options.pagination > 0) {\r\n                var pageNumber = obj.whichPage(obj.selectedCell[3]);\r\n                if (pageNumber != obj.pageNumber) {\r\n                    obj.page(pageNumber);\r\n                }\r\n            }\r\n    \r\n            obj.updateScroll(1);\r\n        }\r\n    \r\n        obj.up.visible = function(group, direction) {\r\n            if (group == 0) {\r\n                var x = parseInt(obj.selectedCell[0]);\r\n                var y = parseInt(obj.selectedCell[1]);\r\n            } else {\r\n                var x = parseInt(obj.selectedCell[2]);\r\n                var y = parseInt(obj.selectedCell[3]);\r\n            }\r\n    \r\n            if (direction == 0) {\r\n                for (var j = 0; j < y; j++) {\r\n                    if (obj.records[j][x].style.display != 'none' && obj.rows[j].style.display != 'none') {\r\n                        y = j;\r\n                        break;\r\n                    }\r\n                }\r\n            } else {\r\n                y = obj.up.get(x, y);\r\n            }\r\n    \r\n            if (group == 0) {\r\n                obj.selectedCell[0] = x;\r\n                obj.selectedCell[1] = y;\r\n            } else {\r\n                obj.selectedCell[2] = x;\r\n                obj.selectedCell[3] = y;\r\n            }\r\n        }\r\n    \r\n        obj.up.get = function(x, y) {\r\n            var x = parseInt(x);\r\n            var y = parseInt(y);\r\n            for (var j = (y - 1); j >= 0; j--) {\r\n                if (obj.records[j][x].style.display != 'none' && obj.rows[j].style.display != 'none') {\r\n                    if (obj.records[j][x].getAttribute('data-merged')) {\r\n                        if (obj.records[j][x] == obj.records[y][x]) {\r\n                            continue;\r\n                        }\r\n                    }\r\n                    y = j;\r\n                    break;\r\n                }\r\n            }\r\n    \r\n            return y;\r\n        }\r\n    \r\n        obj.down = function(shiftKey, ctrlKey) {\r\n            if (shiftKey) {\r\n                if (obj.selectedCell[3] < obj.records.length - 1) {\r\n                    obj.down.visible(1, ctrlKey ? 0 : 1)\r\n                }\r\n            } else {\r\n                if (obj.selectedCell[1] < obj.records.length - 1) {\r\n                    obj.down.visible(0, ctrlKey ? 0 : 1)\r\n                }\r\n                obj.selectedCell[2] = obj.selectedCell[0];\r\n                obj.selectedCell[3] = obj.selectedCell[1];\r\n            }\r\n    \r\n            obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\r\n    \r\n            // Change page\r\n            if (obj.options.lazyLoading == true) {\r\n                if ((obj.selectedCell[1] == obj.records.length - 1 || obj.selectedCell[3] == obj.records.length - 1)) {\r\n                    obj.loadPage(-1);\r\n                    obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\r\n                } else {\r\n                    if (obj.loadValidation()) {\r\n                        obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\r\n                    } else {\r\n                        var item = parseInt(obj.tbody.lastChild.getAttribute('data-y'));\r\n                        if (item - obj.selectedCell[3] < 30) {\r\n                            obj.loadDown();\r\n                            obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\r\n                        }\r\n                    }\r\n                }\r\n            } else if (obj.options.pagination > 0) {\r\n                var pageNumber = obj.whichPage(obj.selectedCell[3]);\r\n                if (pageNumber != obj.pageNumber) {\r\n                    obj.page(pageNumber);\r\n                }\r\n            }\r\n    \r\n            obj.updateScroll(3);\r\n        }\r\n    \r\n        obj.down.visible = function(group, direction) {\r\n            if (group == 0) {\r\n                var x = parseInt(obj.selectedCell[0]);\r\n                var y = parseInt(obj.selectedCell[1]);\r\n            } else {\r\n                var x = parseInt(obj.selectedCell[2]);\r\n                var y = parseInt(obj.selectedCell[3]);\r\n            }\r\n    \r\n            if (direction == 0) {\r\n                for (var j = obj.rows.length - 1; j > y; j--) {\r\n                    if (obj.records[j][x].style.display != 'none' && obj.rows[j].style.display != 'none') {\r\n                        y = j;\r\n                        break;\r\n                    }\r\n                }\r\n            } else {\r\n                y = obj.down.get(x, y);\r\n            }\r\n    \r\n            if (group == 0) {\r\n                obj.selectedCell[0] = x;\r\n                obj.selectedCell[1] = y;\r\n            } else {\r\n                obj.selectedCell[2] = x;\r\n                obj.selectedCell[3] = y;\r\n            }\r\n        }\r\n    \r\n        obj.down.get = function(x, y) {\r\n            var x = parseInt(x);\r\n            var y = parseInt(y);\r\n            for (var j = (y + 1); j < obj.rows.length; j++) {\r\n                if (obj.records[j][x].style.display != 'none' && obj.rows[j].style.display != 'none') {\r\n                    if (obj.records[j][x].getAttribute('data-merged')) {\r\n                        if (obj.records[j][x] == obj.records[y][x]) {\r\n                            continue;\r\n                        }\r\n                    }\r\n                    y = j;\r\n                    break;\r\n                }\r\n            }\r\n    \r\n            return y;\r\n        }\r\n    \r\n        obj.right = function(shiftKey, ctrlKey) {\r\n            if (shiftKey) {\r\n                if (obj.selectedCell[2] < obj.headers.length - 1) {\r\n                    obj.right.visible(1, ctrlKey ? 0 : 1)\r\n                }\r\n            } else {\r\n                if (obj.selectedCell[0] < obj.headers.length - 1) {\r\n                    obj.right.visible(0, ctrlKey ? 0 : 1)\r\n                }\r\n                obj.selectedCell[2] = obj.selectedCell[0];\r\n                obj.selectedCell[3] = obj.selectedCell[1];\r\n            }\r\n    \r\n            obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\r\n            obj.updateScroll(2);\r\n        }\r\n    \r\n        obj.right.visible = function(group, direction) {\r\n            if (group == 0) {\r\n                var x = parseInt(obj.selectedCell[0]);\r\n                var y = parseInt(obj.selectedCell[1]);\r\n            } else {\r\n                var x = parseInt(obj.selectedCell[2]);\r\n                var y = parseInt(obj.selectedCell[3]);\r\n            }\r\n    \r\n            if (direction == 0) {\r\n                for (var i = obj.headers.length - 1; i > x; i--) {\r\n                    if (obj.records[y][i].style.display != 'none') {\r\n                        x = i;\r\n                        break;\r\n                    }\r\n                }\r\n            } else {\r\n                x = obj.right.get(x, y);\r\n            }\r\n    \r\n            if (group == 0) {\r\n                obj.selectedCell[0] = x;\r\n                obj.selectedCell[1] = y;\r\n            } else {\r\n                obj.selectedCell[2] = x;\r\n                obj.selectedCell[3] = y;\r\n            }\r\n        }\r\n    \r\n        obj.right.get = function(x, y) {\r\n            var x = parseInt(x);\r\n            var y = parseInt(y);\r\n    \r\n            for (var i = (x + 1); i < obj.headers.length; i++) {\r\n                if (obj.records[y][i].style.display != 'none') {\r\n                    if (obj.records[y][i].getAttribute('data-merged')) {\r\n                        if (obj.records[y][i] == obj.records[y][x]) {\r\n                            continue;\r\n                        }\r\n                    }\r\n                    x = i;\r\n                    break;\r\n                }\r\n            }\r\n    \r\n            return x;\r\n        }\r\n    \r\n        obj.left = function(shiftKey, ctrlKey) {\r\n            if (shiftKey) {\r\n                if (obj.selectedCell[2] > 0) {\r\n                    obj.left.visible(1, ctrlKey ? 0 : 1)\r\n                }\r\n            } else {\r\n                if (obj.selectedCell[0] > 0) {\r\n                    obj.left.visible(0, ctrlKey ? 0 : 1)\r\n                }\r\n                obj.selectedCell[2] = obj.selectedCell[0];\r\n                obj.selectedCell[3] = obj.selectedCell[1];\r\n            }\r\n    \r\n            obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\r\n            obj.updateScroll(0);\r\n        }\r\n    \r\n        obj.left.visible = function(group, direction) {\r\n            if (group == 0) {\r\n                var x = parseInt(obj.selectedCell[0]);\r\n                var y = parseInt(obj.selectedCell[1]);\r\n            } else {\r\n                var x = parseInt(obj.selectedCell[2]);\r\n                var y = parseInt(obj.selectedCell[3]);\r\n            }\r\n    \r\n            if (direction == 0) {\r\n                for (var i = 0; i < x; i++) {\r\n                    if (obj.records[y][i].style.display != 'none') {\r\n                        x = i;\r\n                        break;\r\n                    }\r\n                }\r\n            } else {\r\n                x = obj.left.get(x, y);\r\n            }\r\n    \r\n            if (group == 0) {\r\n                obj.selectedCell[0] = x;\r\n                obj.selectedCell[1] = y;\r\n            } else {\r\n                obj.selectedCell[2] = x;\r\n                obj.selectedCell[3] = y;\r\n            }\r\n        }\r\n    \r\n        obj.left.get = function(x, y) {\r\n            var x = parseInt(x);\r\n            var y = parseInt(y);\r\n            for (var i = (x - 1); i >= 0; i--) {\r\n                if (obj.records[y][i].style.display != 'none') {\r\n                    if (obj.records[y][i].getAttribute('data-merged')) {\r\n                        if (obj.records[y][i] == obj.records[y][x]) {\r\n                            continue;\r\n                        }\r\n                    }\r\n                    x = i;\r\n                    break;\r\n                }\r\n            }\r\n    \r\n            return x;\r\n        }\r\n    \r\n        obj.first = function(shiftKey, ctrlKey) {\r\n            if (shiftKey) {\r\n                if (ctrlKey) {\r\n                    obj.selectedCell[3] = 0;\r\n                } else {\r\n                    obj.left.visible(1, 0);\r\n                }\r\n            } else {\r\n                if (ctrlKey) {\r\n                    obj.selectedCell[1] = 0;\r\n                } else {\r\n                    obj.left.visible(0, 0);\r\n                }\r\n                obj.selectedCell[2] = obj.selectedCell[0];\r\n                obj.selectedCell[3] = obj.selectedCell[1];\r\n            }\r\n    \r\n            // Change page\r\n            if (obj.options.lazyLoading == true && (obj.selectedCell[1] == 0 || obj.selectedCell[3] == 0)) {\r\n                obj.loadPage(0);\r\n            } else if (obj.options.pagination > 0) {\r\n                var pageNumber = obj.whichPage(obj.selectedCell[3]);\r\n                if (pageNumber != obj.pageNumber) {\r\n                    obj.page(pageNumber);\r\n                }\r\n            }\r\n    \r\n            obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\r\n            obj.updateScroll(1);\r\n        }\r\n    \r\n        obj.last = function(shiftKey, ctrlKey) {\r\n            if (shiftKey) {\r\n                if (ctrlKey) {\r\n                    obj.selectedCell[3] = obj.records.length - 1;\r\n                } else {\r\n                    obj.right.visible(1, 0);\r\n                }\r\n            } else {\r\n                if (ctrlKey) {\r\n                    obj.selectedCell[1] = obj.records.length - 1;\r\n                } else {\r\n                    obj.right.visible(0, 0);\r\n                }\r\n                obj.selectedCell[2] = obj.selectedCell[0];\r\n                obj.selectedCell[3] = obj.selectedCell[1];\r\n            }\r\n    \r\n            // Change page\r\n            if (obj.options.lazyLoading == true && (obj.selectedCell[1] == obj.records.length - 1 || obj.selectedCell[3] == obj.records.length - 1)) {\r\n                obj.loadPage(-1);\r\n            } else if (obj.options.pagination > 0) {\r\n                var pageNumber = obj.whichPage(obj.selectedCell[3]);\r\n                if (pageNumber != obj.pageNumber) {\r\n                    obj.page(pageNumber);\r\n                }\r\n            }\r\n    \r\n            obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\r\n            obj.updateScroll(3);\r\n        }\r\n    \r\n        obj.selectAll = function() {\r\n            if (! obj.selectedCell) {\r\n                obj.selectedCell = [];\r\n            }\r\n    \r\n            obj.selectedCell[0] = 0;\r\n            obj.selectedCell[1] = 0;\r\n            obj.selectedCell[2] = obj.headers.length - 1;\r\n            obj.selectedCell[3] = obj.records.length - 1;\r\n    \r\n            obj.updateSelectionFromCoords(obj.selectedCell[0], obj.selectedCell[1], obj.selectedCell[2], obj.selectedCell[3]);\r\n        }\r\n    \r\n        /**\r\n         * Go to a page in a lazyLoading\r\n         */\r\n        obj.loadPage = function(pageNumber) {\r\n            // Search\r\n            if (obj.options.search == true && obj.results) {\r\n                var results = obj.results;\r\n            } else {\r\n                var results = obj.rows;\r\n            }\r\n    \r\n            // Per page\r\n            var quantityPerPage = 100;\r\n    \r\n            // pageNumber\r\n            if (pageNumber == null || pageNumber == -1) {\r\n                // Last page\r\n                pageNumber = Math.ceil(results.length / quantityPerPage) - 1; \r\n            }\r\n    \r\n            var startRow = (pageNumber * quantityPerPage);\r\n            var finalRow = (pageNumber * quantityPerPage) + quantityPerPage;\r\n            if (finalRow > results.length) {\r\n                finalRow = results.length;\r\n            }\r\n            startRow = finalRow - 100;\r\n            if (startRow < 0) {\r\n                startRow = 0;\r\n            }\r\n    \r\n            // Appeding items\r\n            for (var j = startRow; j < finalRow; j++) {\r\n                if (obj.options.search == true && obj.results) {\r\n                    obj.tbody.appendChild(obj.rows[results[j]]);\r\n                } else {\r\n                    obj.tbody.appendChild(obj.rows[j]);\r\n                }\r\n    \r\n                if (obj.tbody.children.length > quantityPerPage) {\r\n                    obj.tbody.removeChild(obj.tbody.firstChild);\r\n                }\r\n            }\r\n        }\r\n    \r\n        obj.loadUp = function() {\r\n            // Search\r\n            if (obj.options.search == true && obj.results) {\r\n                var results = obj.results;\r\n            } else {\r\n                var results = obj.rows;\r\n            }\r\n            var test = 0;\r\n            if (results.length > 100) {\r\n                // Get the first element in the page\r\n                var item = parseInt(obj.tbody.firstChild.getAttribute('data-y'));\r\n                if (obj.options.search == true && obj.results) {\r\n                    item = results.indexOf(item);\r\n                }\r\n                if (item > 0) {\r\n                    for (var j = 0; j < 30; j++) {\r\n                        item = item - 1;\r\n                        if (item > -1) {\r\n                            if (obj.options.search == true && obj.results) {\r\n                                obj.tbody.insertBefore(obj.rows[results[item]], obj.tbody.firstChild);\r\n                            } else {\r\n                                obj.tbody.insertBefore(obj.rows[item], obj.tbody.firstChild);\r\n                            }\r\n                            if (obj.tbody.children.length > 100) {\r\n                                obj.tbody.removeChild(obj.tbody.lastChild);\r\n                                test = 1;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return test;\r\n        }\r\n    \r\n        obj.loadDown = function() {\r\n            // Search\r\n            if (obj.options.search == true && obj.results) {\r\n                var results = obj.results;\r\n            } else {\r\n                var results = obj.rows;\r\n            }\r\n            var test = 0;\r\n            if (results.length > 100) {\r\n                // Get the last element in the page\r\n                var item = parseInt(obj.tbody.lastChild.getAttribute('data-y'));\r\n                if (obj.options.search == true && obj.results) {\r\n                    item = results.indexOf(item);\r\n                }\r\n                if (item < obj.rows.length - 1) {\r\n                    for (var j = 0; j <= 30; j++) {\r\n                        if (item < results.length) {\r\n                            if (obj.options.search == true && obj.results) {\r\n                                obj.tbody.appendChild(obj.rows[results[item]]);\r\n                            } else {\r\n                                obj.tbody.appendChild(obj.rows[item]);\r\n                            }\r\n                            if (obj.tbody.children.length > 100) {\r\n                                obj.tbody.removeChild(obj.tbody.firstChild);\r\n                                test = 1;\r\n                            }\r\n                        }\r\n                        item = item + 1;\r\n                    }\r\n                }\r\n            }\r\n    \r\n            return test;\r\n        }\r\n    \r\n        obj.loadValidation = function() {\r\n            if (obj.selectedCell) {\r\n                var currentPage = parseInt(obj.tbody.firstChild.getAttribute('data-y')) / 100;\r\n                var selectedPage = parseInt(obj.selectedCell[3] / 100);\r\n                var totalPages = parseInt(obj.rows.length / 100);\r\n    \r\n                if (currentPage != selectedPage && selectedPage <= totalPages) {\r\n                    if (! Array.prototype.indexOf.call(obj.tbody.children, obj.rows[obj.selectedCell[3]])) {\r\n                        obj.loadPage(selectedPage);\r\n                        return true;\r\n                    }\r\n                }\r\n            }\r\n    \r\n            return false;\r\n        }\r\n    \r\n        /**\r\n         * Reset search\r\n         */\r\n        obj.resetSearch = function() {\r\n            obj.searchInput.value = '';\r\n            obj.search('');\r\n            obj.results = null;\r\n        }\r\n\r\n        /**\r\n         * Search\r\n         */\r\n        obj.search = function(query) {\r\n            // Query\r\n            if (query) {\r\n                var query = query.toLowerCase();\r\n            }\r\n    \r\n            // Reset any filter\r\n            if (obj.options.filters) {\r\n                obj.resetFilters();\r\n            }\r\n\r\n            // Reset selection\r\n            obj.resetSelection();\r\n    \r\n            // Total of results\r\n            obj.pageNumber = 0;\r\n            obj.results = [];\r\n    \r\n            if (query) {\r\n                // Search filter\r\n                var search = function(item, query, index) {\r\n                    for (var i = 0; i < item.length; i++) {\r\n                        if ((''+item[i]).toLowerCase().search(query) >= 0 ||\r\n                            (''+obj.records[index][i].innerHTML).toLowerCase().search(query) >= 0) {\r\n                            return true;\r\n                        }\r\n                    }\r\n                    return false;\r\n                }\r\n    \r\n                // Result\r\n                var addToResult = function(k) {\r\n                    if (obj.results.indexOf(k) == -1) {\r\n                        obj.results.push(k);\r\n                    }\r\n                }\r\n    \r\n                // Filter\r\n                var data = obj.options.data.filter(function(v, k) {\r\n                    if (search(v, query, k)) {\r\n                        // Merged rows found\r\n                        var rows = obj.isRowMerged(k);\r\n                        if (rows.length) {\r\n                            for (var i = 0; i < rows.length; i++) {\r\n                                var row = jexcel.getIdFromColumnName(rows[i], true);\r\n                                for (var j = 0; j < obj.options.mergeCells[rows[i]][1]; j++) {\r\n                                    addToResult(row[1]+j);\r\n                                }\r\n                            }\r\n                        } else {\r\n                            // Normal row found\r\n                            addToResult(k);\r\n                        }\r\n                        return true;\r\n                    } else {\r\n                        return false;\r\n                    }\r\n                });\r\n            } else {\r\n                obj.results = null;\r\n            }\r\n\r\n            return obj.updateResult();\r\n        }\r\n    \r\n        obj.updateResult = function() {\r\n            var total = 0;\r\n            var index = 0;\r\n    \r\n            // Page 1\r\n            if (obj.options.lazyLoading == true) {\r\n                total = 100;\r\n            } else if (obj.options.pagination > 0) {\r\n                total = obj.options.pagination;\r\n            } else {\r\n                if (obj.results) {\r\n                    total = obj.results.length;\r\n                } else {\r\n                    total = obj.rows.length;\r\n                }\r\n            }\r\n    \r\n            // Reset current nodes\r\n            while (obj.tbody.firstChild) {\r\n                obj.tbody.removeChild(obj.tbody.firstChild);\r\n            }\r\n    \r\n            // Hide all records from the table\r\n            for (var j = 0; j < obj.rows.length; j++) {\r\n                if (! obj.results || obj.results.indexOf(j) > -1) {\r\n                    if (index < total) {\r\n                        obj.tbody.appendChild(obj.rows[j]);\r\n                        index++;\r\n                    }\r\n                    obj.rows[j].style.display = '';\r\n                } else {\r\n                    obj.rows[j].style.display = 'none';\r\n                }\r\n            }\r\n    \r\n            // Update pagination\r\n            if (obj.options.pagination > 0) {\r\n                obj.updatePagination();\r\n            }\r\n\r\n            obj.updateCornerPosition();\r\n    \r\n            return total;\r\n        }\r\n\r\n        /**\r\n         * Which page the cell is\r\n         */\r\n        obj.whichPage = function(cell) {\r\n            // Search\r\n            if (obj.options.search == true && obj.results) {\r\n                cell = obj.results.indexOf(cell);\r\n            }\r\n    \r\n            return (Math.ceil((parseInt(cell) + 1) / parseInt(obj.options.pagination))) - 1;\r\n        }\r\n    \r\n        /**\r\n         * Go to page\r\n         */\r\n        obj.page = function(pageNumber) {\r\n            var oldPage = obj.pageNumber;\r\n\r\n            // Search\r\n            if (obj.options.search == true && obj.results) {\r\n                var results = obj.results;\r\n            } else {\r\n                var results = obj.rows;\r\n            }\r\n    \r\n            // Per page\r\n            var quantityPerPage = parseInt(obj.options.pagination);\r\n    \r\n            // pageNumber\r\n            if (pageNumber == null || pageNumber == -1) {\r\n                // Last page\r\n                pageNumber = Math.ceil(results.length / quantityPerPage) - 1;\r\n            }\r\n    \r\n            // Page number\r\n            obj.pageNumber = pageNumber;\r\n    \r\n            var startRow = (pageNumber * quantityPerPage);\r\n            var finalRow = (pageNumber * quantityPerPage) + quantityPerPage;\r\n            if (finalRow > results.length) {\r\n                finalRow = results.length;\r\n            }\r\n            if (startRow < 0) {\r\n                startRow = 0;\r\n            }\r\n    \r\n            // Reset container\r\n            while (obj.tbody.firstChild) {\r\n                obj.tbody.removeChild(obj.tbody.firstChild);\r\n            }\r\n    \r\n            // Appeding items\r\n            for (var j = startRow; j < finalRow; j++) {\r\n                if (obj.options.search == true && obj.results) {\r\n                    obj.tbody.appendChild(obj.rows[results[j]]);\r\n                } else {\r\n                    obj.tbody.appendChild(obj.rows[j]);\r\n                }\r\n            }\r\n    \r\n            if (obj.options.pagination > 0) {\r\n                obj.updatePagination();\r\n            }\r\n    \r\n            // Update corner position\r\n            obj.updateCornerPosition();\r\n\r\n            // Events\r\n            obj.dispatch('onchangepage', el, pageNumber, oldPage);\r\n        }\r\n    \r\n        /**\r\n         * Update the pagination\r\n         */\r\n        obj.updatePagination = function() {\r\n            // Reset container\r\n            obj.pagination.children[0].innerHTML = '';\r\n            obj.pagination.children[1].innerHTML = '';\r\n    \r\n            // Start pagination\r\n            if (obj.options.pagination) {\r\n                // Searchable\r\n                if (obj.options.search == true && obj.results) {\r\n                    var results = obj.results.length;\r\n                } else {\r\n                    var results = obj.rows.length;\r\n                }\r\n    \r\n                if (! results) {\r\n                    // No records found\r\n                    obj.pagination.children[0].innerHTML = obj.options.text.noRecordsFound;\r\n                } else {\r\n                    // Pagination container\r\n                    var quantyOfPages = Math.ceil(results / obj.options.pagination);\r\n    \r\n                    if (obj.pageNumber < 6) {\r\n                        var startNumber = 1;\r\n                        var finalNumber = quantyOfPages < 10 ? quantyOfPages : 10;\r\n                    } else if (quantyOfPages - obj.pageNumber < 5) {\r\n                        var startNumber = quantyOfPages - 9;\r\n                        var finalNumber = quantyOfPages;\r\n                        if (startNumber < 1) {\r\n                            startNumber = 1;\r\n                        }\r\n                    } else {\r\n                        var startNumber = obj.pageNumber - 4;\r\n                        var finalNumber = obj.pageNumber + 5;\r\n                    }\r\n    \r\n                    // First\r\n                    if (startNumber > 1) {\r\n                        var paginationItem = document.createElement('div');\r\n                        paginationItem.className = 'jexcel_page';\r\n                        paginationItem.innerHTML = '<';\r\n                        paginationItem.title = 1;\r\n                        obj.pagination.children[1].appendChild(paginationItem);\r\n                    }\r\n    \r\n                    // Get page links\r\n                    for (var i = startNumber; i <= finalNumber; i++) {\r\n                        var paginationItem = document.createElement('div');\r\n                        paginationItem.className = 'jexcel_page';\r\n                        paginationItem.innerHTML = i;\r\n                        obj.pagination.children[1].appendChild(paginationItem);\r\n    \r\n                        if (obj.pageNumber == (i-1)) {\r\n                            paginationItem.classList.add('jexcel_page_selected');\r\n                        }\r\n                    }\r\n    \r\n                    // Last\r\n                    if (finalNumber < quantyOfPages) {\r\n                        var paginationItem = document.createElement('div');\r\n                        paginationItem.className = 'jexcel_page';\r\n                        paginationItem.innerHTML = '>';\r\n                        paginationItem.title = quantyOfPages;\r\n                        obj.pagination.children[1].appendChild(paginationItem);\r\n                    }\r\n    \r\n                    // Text\r\n                    var format = function(format) {\r\n                        var args = Array.prototype.slice.call(arguments, 1);\r\n                        return format.replace(/{(\\d+)}/g, function(match, number) {\r\n                          return typeof args[number] != 'undefined'\r\n                            ? args[number]\r\n                            : match\r\n                          ;\r\n                        });\r\n                    };\r\n    \r\n                    obj.pagination.children[0].innerHTML = format(obj.options.text.showingPage, obj.pageNumber + 1, quantyOfPages)\r\n                }\r\n            }\r\n        }\r\n    \r\n        /**\r\n         * Download CSV table\r\n         * \r\n         * @return null\r\n         */\r\n        obj.download = function(includeHeaders) {\r\n            if (obj.options.allowExport == false) {\r\n                console.error('Export not allowed');\r\n            } else {\r\n                // Data\r\n                var data = '';\r\n\r\n                // Get data\r\n                data += obj.copy(false, obj.options.csvDelimiter, true, includeHeaders, true);\r\n\r\n                // Download element\r\n                var blob = new Blob([\"\\uFEFF\"+data], {type: 'text/csv;charset=utf-8;'});\r\n\r\n                // IE Compatibility\r\n                if (window.navigator && window.navigator.msSaveOrOpenBlob) {\r\n                    window.navigator.msSaveOrOpenBlob(blob, obj.options.csvFileName + '.csv');\r\n                } else {\r\n                    // Download element\r\n                    var pom = document.createElement('a');\r\n                    var url = URL.createObjectURL(blob);\r\n                    pom.href = url;\r\n                    pom.setAttribute('download', obj.options.csvFileName + '.csv');\r\n                    document.body.appendChild(pom);\r\n                    pom.click();\r\n                    pom.parentNode.removeChild(pom);\r\n                }\r\n            }\r\n        }\r\n    \r\n        /**\r\n         * Initializes a new history record for undo/redo\r\n         * \r\n         * @return null\r\n         */\r\n        obj.setHistory = function(changes) {\r\n            if (obj.ignoreHistory != true) {\r\n                // Increment and get the current history index\r\n                var index = ++obj.historyIndex;\r\n    \r\n                // Slice the array to discard undone changes\r\n                obj.history = (obj.history = obj.history.slice(0, index + 1));\r\n    \r\n                // Keep history\r\n                obj.history[index] = changes;\r\n            }\r\n        }\r\n    \r\n        /**\r\n         * Copy method\r\n         * \r\n         * @param bool highlighted - Get only highlighted cells\r\n         * @param delimiter - \\t default to keep compatibility with excel\r\n         * @return string value\r\n         */\r\n        obj.copy = function(highlighted, delimiter, returnData, includeHeaders, download) {\r\n            if (! delimiter) {\r\n                delimiter = \"\\t\";\r\n            }\r\n    \r\n            var div = new RegExp(delimiter, 'ig');\r\n\r\n            // Controls\r\n            var header = [];\r\n            var col = [];\r\n            var colLabel = [];\r\n            var row = [];\r\n            var rowLabel = [];\r\n            var x = obj.options.data[0].length\r\n            var y = obj.options.data.length\r\n            var tmp = '';\r\n            var copyHeader = false;\r\n            var headers = '';\r\n            var nestedHeaders = '';\r\n            var numOfCols = 0;\r\n            var numOfRows = 0;\r\n\r\n            if ((download && obj.options.includeHeadersOnDownload == true) ||\r\n                (! download && obj.options.includeHeadersOnCopy == true) ||\r\n                (includeHeaders)) {\r\n                // Nested headers\r\n                if (obj.options.nestedHeaders && obj.options.nestedHeaders.length > 0) {\r\n                    // Flexible way to handle nestedheaders\r\n                    if (! (obj.options.nestedHeaders[0] && obj.options.nestedHeaders[0][0])) {\r\n                        tmp = [obj.options.nestedHeaders];\r\n                    } else {\r\n                        tmp = obj.options.nestedHeaders;\r\n                    }\r\n\r\n                    for (var j = 0; j < tmp.length; j++) {\r\n                        var nested = [];\r\n                        for (var i = 0; i < tmp[j].length; i++) {\r\n                            var colspan = parseInt(tmp[j][i].colspan);\r\n                            nested.push(tmp[j][i].title);\r\n                            for (var c = 0; c < colspan - 1; c++) {\r\n                                nested.push('');\r\n                            }\r\n                        }\r\n                        nestedHeaders += nested.join(delimiter) + \"\\r\\n\";\r\n                    }\r\n                }\r\n\r\n                copyHeader = true;\r\n            }\r\n\r\n            // Reset container\r\n            obj.style = [];\r\n    \r\n            // Go through the columns to get the data\r\n            for (var j = 0; j < y; j++) {\r\n                col = [];\r\n                colLabel = [];\r\n    \r\n                for (var i = 0; i < x; i++) {\r\n                    // If cell is highlighted\r\n                    if (! highlighted || obj.records[j][i].classList.contains('highlight')) {\r\n                        if (copyHeader == true) {\r\n                            header.push(obj.headers[i].innerText);\r\n                        }\r\n                        // Values\r\n                        var value = obj.options.data[j][i];\r\n                        if (value.match && (value.match(div) || value.match(/,/g) || value.match(/\\n/) || value.match(/\\\"/))) {\r\n                            value = value.replace(new RegExp('\"', 'g'), '\"\"');\r\n                            value = '\"' + value + '\"';\r\n                        }\r\n                        col.push(value);\r\n\r\n                        // Labels\r\n                        if (obj.options.columns[i].type == 'checkbox' || obj.options.columns[i].type == 'radio') {\r\n                            var label = value;\r\n                        } else {\r\n                            if (obj.options.stripHTMLOnCopy == true) {\r\n                                var label = obj.records[j][i].innerText;\r\n                            } else {\r\n                                var label = obj.records[j][i].innerHTML;\r\n                            }\r\n                            if (label.match && (label.match(div) || label.match(/,/g) || label.match(/\\n/) || label.match(/\\\"/))) {\r\n                                // Scape double quotes\r\n                                label = label.replace(new RegExp('\"', 'g'), '\"\"');\r\n                                label = '\"' + label + '\"';\r\n                            }\r\n                        }\r\n                        colLabel.push(label);\r\n    \r\n                        // Get style\r\n                        tmp = obj.records[j][i].getAttribute('style');\r\n                        tmp = tmp.replace('display: none;', '');\r\n                        obj.style.push(tmp ? tmp : '');\r\n                    }\r\n                }\r\n    \r\n                if (col.length) {\r\n                    if (copyHeader) {\r\n                        numOfCols = col.length;\r\n                        row.push(header.join(delimiter));\r\n                    }\r\n                    row.push(col.join(delimiter));\r\n                }\r\n                if (colLabel.length) {\r\n                    numOfRows++;\r\n                    if (copyHeader) {\r\n                        rowLabel.push(header.join(delimiter));\r\n                        copyHeader = false;\r\n                    }\r\n                    rowLabel.push(colLabel.join(delimiter));\r\n                }\r\n            }\r\n\r\n            if (x == numOfCols &&  y == numOfRows) {\r\n                headers = nestedHeaders;\r\n            }\r\n\r\n            // Final string\r\n            var str = headers + row.join(\"\\r\\n\");\r\n            var strLabel = headers + rowLabel.join(\"\\r\\n\");\r\n\r\n            // Create a hidden textarea to copy the values\r\n            if (! returnData) {\r\n                if (obj.options.copyCompatibility == true) {\r\n                    obj.textarea.value = strLabel;\r\n                } else {\r\n                    obj.textarea.value = str;\r\n                }\r\n                obj.textarea.select();\r\n                document.execCommand(\"copy\");\r\n            }\r\n    \r\n            // Keep data\r\n            if (obj.options.copyCompatibility == true) {\r\n                obj.data = strLabel;\r\n            } else {\r\n                obj.data = str;\r\n            }\r\n            // Keep non visible information\r\n            obj.hashString = obj.hash(obj.data);\r\n    \r\n            // Any exiting border should go\r\n            if (! returnData) {\r\n                obj.removeCopyingSelection();\r\n    \r\n                // Border\r\n                if (obj.highlighted) {\r\n                    for (var i = 0; i < obj.highlighted.length; i++) {\r\n                        obj.highlighted[i].classList.add('copying');\r\n                        if (obj.highlighted[i].classList.contains('highlight-left')) {\r\n                            obj.highlighted[i].classList.add('copying-left');\r\n                        }\r\n                        if (obj.highlighted[i].classList.contains('highlight-right')) {\r\n                            obj.highlighted[i].classList.add('copying-right');\r\n                        }\r\n                        if (obj.highlighted[i].classList.contains('highlight-top')) {\r\n                            obj.highlighted[i].classList.add('copying-top');\r\n                        }\r\n                        if (obj.highlighted[i].classList.contains('highlight-bottom')) {\r\n                            obj.highlighted[i].classList.add('copying-bottom');\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // Paste event\r\n                obj.dispatch('oncopy', el, obj.options.copyCompatibility == true ? rowLabel : row, obj.hashString);\r\n            }\r\n\r\n            return obj.data;\r\n        }\r\n    \r\n        /**\r\n         * Jspreadsheet paste method\r\n         * \r\n         * @param integer row number\r\n         * @return string value\r\n         */\r\n        obj.paste = function(x, y, data) {\r\n            // Paste filter\r\n            var ret = obj.dispatch('onbeforepaste', el, data, x, y);\r\n\r\n            if (ret === false) {\r\n                return false;\r\n            } else if (ret) {\r\n                var data = ret;\r\n            }\r\n    \r\n            // Controls\r\n            var hash = obj.hash(data);\r\n            var style = (hash == obj.hashString) ? obj.style : null;\r\n    \r\n            // Depending on the behavior\r\n            if (obj.options.copyCompatibility == true && hash == obj.hashString) {\r\n                var data = obj.data;\r\n            }\r\n    \r\n            // Split new line\r\n            var data = obj.parseCSV(data, \"\\t\");\r\n    \r\n            if (x != null && y != null && data) {\r\n                // Records\r\n                var i = 0;\r\n                var j = 0;\r\n                var records = [];\r\n                var newStyle = {};\r\n                var oldStyle = {};\r\n                var styleIndex = 0;\r\n    \r\n                // Index\r\n                var colIndex = parseInt(x);\r\n                var rowIndex = parseInt(y);\r\n                var row = null;\r\n    \r\n                // Go through the columns to get the data\r\n                while (row = data[j]) {\r\n                    i = 0;\r\n                    colIndex = parseInt(x);\r\n    \r\n                    while (row[i] != null) {\r\n                        // Update and keep history\r\n                        var record = obj.updateCell(colIndex, rowIndex, row[i]);\r\n                        // Keep history\r\n                        records.push(record);\r\n                        // Update all formulas in the chain\r\n                        obj.updateFormulaChain(colIndex, rowIndex, records);\r\n                        // Style\r\n                        if (style && style[styleIndex]) {\r\n                            var columnName = jexcel.getColumnNameFromId([colIndex, rowIndex]);\r\n                            newStyle[columnName] = style[styleIndex];\r\n                            oldStyle[columnName] = obj.getStyle(columnName);\r\n                            obj.records[rowIndex][colIndex].setAttribute('style', style[styleIndex]);\r\n                            styleIndex++\r\n                        }\r\n                        i++;\r\n                        if (row[i] != null) {\r\n                            if (colIndex >= obj.headers.length - 1) {\r\n                                // If the pasted column is out of range, create it if possible\r\n                                if (obj.options.allowInsertColumn == true) {\r\n                                    obj.insertColumn();\r\n                                    // Otherwise skip the pasted data that overflows\r\n                                } else {\r\n                                    break;\r\n                                }\r\n                            }\r\n                            colIndex = obj.right.get(colIndex, rowIndex);\r\n                        }\r\n                    }\r\n    \r\n                    j++;\r\n                    if (data[j]) {\r\n                        if (rowIndex >= obj.rows.length-1) {\r\n                            // If the pasted row is out of range, create it if possible\r\n                            if (obj.options.allowInsertRow == true) {\r\n                                obj.insertRow();\r\n                                // Otherwise skip the pasted data that overflows\r\n                            } else {\r\n                                break;\r\n                            }\r\n                        }\r\n                        rowIndex = obj.down.get(x, rowIndex);\r\n                    }\r\n                }\r\n    \r\n                // Select the new cells\r\n                obj.updateSelectionFromCoords(x, y, colIndex, rowIndex);\r\n    \r\n                // Update history\r\n                obj.setHistory({\r\n                    action:'setValue',\r\n                    records:records,\r\n                    selection:obj.selectedCell,\r\n                    newStyle:newStyle,\r\n                    oldStyle:oldStyle,\r\n                });\r\n    \r\n                // Update table\r\n                obj.updateTable();\r\n    \r\n                // Paste event\r\n                obj.dispatch('onpaste', el, data);\r\n    \r\n                // On after changes\r\n                obj.onafterchanges(el, records);\r\n            }\r\n\r\n            obj.removeCopyingSelection();\r\n        }\r\n\r\n        /**\r\n         * Remove copying border\r\n         */\r\n        obj.removeCopyingSelection = function() {\r\n            var copying = document.querySelectorAll('.jexcel .copying');\r\n            for (var i = 0; i < copying.length; i++) {\r\n                copying[i].classList.remove('copying');\r\n                copying[i].classList.remove('copying-left');\r\n                copying[i].classList.remove('copying-right');\r\n                copying[i].classList.remove('copying-top');\r\n                copying[i].classList.remove('copying-bottom');\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Process row\r\n         */\r\n        obj.historyProcessRow = function(type, historyRecord) {\r\n            var rowIndex = (! historyRecord.insertBefore) ? historyRecord.rowNumber + 1 : +historyRecord.rowNumber;\r\n    \r\n            if (obj.options.search == true) {\r\n                if (obj.results && obj.results.length != obj.rows.length) {\r\n                    obj.resetSearch();\r\n                }\r\n            }\r\n    \r\n            // Remove row\r\n            if (type == 1) {\r\n                var numOfRows = historyRecord.numOfRows;\r\n                // Remove nodes\r\n                for (var j = rowIndex; j < (numOfRows + rowIndex); j++) {\r\n                    obj.rows[j].parentNode.removeChild(obj.rows[j]);\r\n                }\r\n                // Remove references\r\n                obj.records.splice(rowIndex, numOfRows);\r\n                obj.options.data.splice(rowIndex, numOfRows);\r\n                obj.rows.splice(rowIndex, numOfRows);\r\n    \r\n                obj.conditionalSelectionUpdate(1, rowIndex, (numOfRows + rowIndex) - 1);\r\n            } else {\r\n                // Insert data\r\n                obj.records = jexcel.injectArray(obj.records, rowIndex, historyRecord.rowRecords);\r\n                obj.options.data = jexcel.injectArray(obj.options.data, rowIndex, historyRecord.rowData);\r\n                obj.rows = jexcel.injectArray(obj.rows, rowIndex, historyRecord.rowNode);\r\n                // Insert nodes\r\n                var index = 0\r\n                for (var j = rowIndex; j < (historyRecord.numOfRows + rowIndex); j++) {\r\n                    obj.tbody.insertBefore(historyRecord.rowNode[index], obj.tbody.children[j]);\r\n                    index++;\r\n                }\r\n            }\r\n    \r\n            // Respect pagination\r\n            if (obj.options.pagination > 0) {\r\n                obj.page(obj.pageNumber);\r\n            }\r\n    \r\n            obj.updateTableReferences();\r\n        }\r\n    \r\n        /**\r\n         * Process column\r\n         */\r\n        obj.historyProcessColumn = function(type, historyRecord) {\r\n            var columnIndex = (! historyRecord.insertBefore) ? historyRecord.columnNumber + 1 : historyRecord.columnNumber;\r\n    \r\n            // Remove column\r\n            if (type == 1) {\r\n                var numOfColumns = historyRecord.numOfColumns;\r\n    \r\n                obj.options.columns.splice(columnIndex, numOfColumns);\r\n                for (var i = columnIndex; i < (numOfColumns + columnIndex); i++) {\r\n                    obj.headers[i].parentNode.removeChild(obj.headers[i]);\r\n                    obj.colgroup[i].parentNode.removeChild(obj.colgroup[i]);\r\n                }\r\n                obj.headers.splice(columnIndex, numOfColumns);\r\n                obj.colgroup.splice(columnIndex, numOfColumns);\r\n                for (var j = 0; j < historyRecord.data.length; j++) {\r\n                    for (var i = columnIndex; i < (numOfColumns + columnIndex); i++) {\r\n                        obj.records[j][i].parentNode.removeChild(obj.records[j][i]);\r\n                    }\r\n                    obj.records[j].splice(columnIndex, numOfColumns);\r\n                    obj.options.data[j].splice(columnIndex, numOfColumns);\r\n                }\r\n                // Process footers\r\n                if (obj.options.footers) {\r\n                    for (var j = 0; j < obj.options.footers.length; j++) {\r\n                        obj.options.footers[j].splice(columnIndex, numOfColumns);\r\n                    }\r\n                }\r\n            } else {\r\n                // Insert data\r\n                obj.options.columns = jexcel.injectArray(obj.options.columns, columnIndex, historyRecord.columns);\r\n                obj.headers = jexcel.injectArray(obj.headers, columnIndex, historyRecord.headers);\r\n                obj.colgroup = jexcel.injectArray(obj.colgroup, columnIndex, historyRecord.colgroup);\r\n    \r\n                var index = 0\r\n                for (var i = columnIndex; i < (historyRecord.numOfColumns + columnIndex); i++) {\r\n                    obj.headerContainer.insertBefore(historyRecord.headers[index], obj.headerContainer.children[i+1]);\r\n                    obj.colgroupContainer.insertBefore(historyRecord.colgroup[index], obj.colgroupContainer.children[i+1]);\r\n                    index++;\r\n                }\r\n    \r\n                for (var j = 0; j < historyRecord.data.length; j++) {\r\n                    obj.options.data[j] = jexcel.injectArray(obj.options.data[j], columnIndex, historyRecord.data[j]);\r\n                    obj.records[j] = jexcel.injectArray(obj.records[j], columnIndex, historyRecord.records[j]);\r\n                    var index = 0\r\n                    for (var i = columnIndex; i < (historyRecord.numOfColumns + columnIndex); i++) {\r\n                        obj.rows[j].insertBefore(historyRecord.records[j][index], obj.rows[j].children[i+1]);\r\n                        index++;\r\n                    }\r\n                }\r\n                // Process footers\r\n                if (obj.options.footers) {\r\n                    for (var j = 0; j < obj.options.footers.length; j++) {\r\n                        obj.options.footers[j] = jexcel.injectArray(obj.options.footers[j], columnIndex, historyRecord.footers[j]);\r\n                    }\r\n                }\r\n            }\r\n    \r\n            // Adjust nested headers\r\n            if (obj.options.nestedHeaders && obj.options.nestedHeaders.length > 0) {\r\n                // Flexible way to handle nestedheaders\r\n                if (obj.options.nestedHeaders[0] && obj.options.nestedHeaders[0][0]) {\r\n                    for (var j = 0; j < obj.options.nestedHeaders.length; j++) {\r\n                        if (type == 1) {\r\n                            var colspan = parseInt(obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan) - historyRecord.numOfColumns;\r\n                        } else {\r\n                            var colspan = parseInt(obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan) + historyRecord.numOfColumns;\r\n                        }\r\n                        obj.options.nestedHeaders[j][obj.options.nestedHeaders[j].length-1].colspan = colspan;\r\n                        obj.thead.children[j].children[obj.thead.children[j].children.length-1].setAttribute('colspan', colspan);\r\n                    }\r\n                } else {\r\n                    if (type == 1) {\r\n                        var colspan = parseInt(obj.options.nestedHeaders[0].colspan) - historyRecord.numOfColumns;\r\n                    } else {\r\n                        var colspan = parseInt(obj.options.nestedHeaders[0].colspan) + historyRecord.numOfColumns;\r\n                    }\r\n                    obj.options.nestedHeaders[0].colspan = colspan;\r\n                    obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute('colspan', colspan);\r\n                }\r\n            }\r\n    \r\n            obj.updateTableReferences();\r\n        }\r\n    \r\n        /**\r\n         * Undo last action\r\n         */\r\n        obj.undo = function() {\r\n            // Ignore events and history\r\n            var ignoreEvents = obj.ignoreEvents ? true : false;\r\n            var ignoreHistory = obj.ignoreHistory ? true : false;\r\n    \r\n            obj.ignoreEvents = true;\r\n            obj.ignoreHistory = true;\r\n    \r\n            // Records\r\n            var records = [];\r\n    \r\n            // Update cells\r\n            if (obj.historyIndex >= 0) {\r\n                // History\r\n                var historyRecord = obj.history[obj.historyIndex--];\r\n    \r\n                if (historyRecord.action == 'insertRow') {\r\n                    obj.historyProcessRow(1, historyRecord);\r\n                } else if (historyRecord.action == 'deleteRow') {\r\n                    obj.historyProcessRow(0, historyRecord);\r\n                } else if (historyRecord.action == 'insertColumn') {\r\n                    obj.historyProcessColumn(1, historyRecord);\r\n                } else if (historyRecord.action == 'deleteColumn') {\r\n                    obj.historyProcessColumn(0, historyRecord);\r\n                } else if (historyRecord.action == 'moveRow') {\r\n                    obj.moveRow(historyRecord.newValue, historyRecord.oldValue);\r\n                } else if (historyRecord.action == 'moveColumn') {\r\n                    obj.moveColumn(historyRecord.newValue, historyRecord.oldValue);\r\n                } else if (historyRecord.action == 'setMerge') {\r\n                    obj.removeMerge(historyRecord.column, historyRecord.data);\r\n                } else if (historyRecord.action == 'setStyle') {\r\n                    obj.setStyle(historyRecord.oldValue, null, null, 1);\r\n                } else if (historyRecord.action == 'setWidth') {\r\n                    obj.setWidth(historyRecord.column, historyRecord.oldValue);\r\n                } else if (historyRecord.action == 'setHeight') {\r\n                    obj.setHeight(historyRecord.row, historyRecord.oldValue);\r\n                } else if (historyRecord.action == 'setHeader') {\r\n                    obj.setHeader(historyRecord.column, historyRecord.oldValue);\r\n                } else if (historyRecord.action == 'setComments') {\r\n                    obj.setComments(historyRecord.column, historyRecord.oldValue[0], historyRecord.oldValue[1]);\r\n                } else if (historyRecord.action == 'orderBy') {\r\n                    var rows = [];\r\n                    for (var j = 0; j < historyRecord.rows.length; j++) {\r\n                        rows[historyRecord.rows[j]] = j;\r\n                    }\r\n                    obj.updateOrderArrow(historyRecord.column, historyRecord.order ? 0 : 1);\r\n                    obj.updateOrder(rows);\r\n                } else if (historyRecord.action == 'setValue') {\r\n                    // Redo for changes in cells\r\n                    for (var i = 0; i < historyRecord.records.length; i++) {\r\n                        records.push({\r\n                            x: historyRecord.records[i].x,\r\n                            y: historyRecord.records[i].y,\r\n                            newValue: historyRecord.records[i].oldValue,\r\n                        });\r\n\r\n                        if (historyRecord.oldStyle) {\r\n                            obj.resetStyle(historyRecord.oldStyle);\r\n                        }\r\n                    }\r\n                    // Update records\r\n                    obj.setValue(records);\r\n\r\n                    // Update selection\r\n                    if (historyRecord.selection) {\r\n                        obj.updateSelectionFromCoords(historyRecord.selection[0], historyRecord.selection[1], historyRecord.selection[2], historyRecord.selection[3]);\r\n                    }\r\n                }\r\n            }\r\n            obj.ignoreEvents = ignoreEvents;\r\n            obj.ignoreHistory = ignoreHistory;\r\n    \r\n            // Events\r\n            obj.dispatch('onundo', el, historyRecord);\r\n        }\r\n    \r\n        /**\r\n         * Redo previously undone action\r\n         */\r\n        obj.redo = function() {\r\n            // Ignore events and history\r\n            var ignoreEvents = obj.ignoreEvents ? true : false;\r\n            var ignoreHistory = obj.ignoreHistory ? true : false;\r\n    \r\n            obj.ignoreEvents = true;\r\n            obj.ignoreHistory = true;\r\n    \r\n            // Records\r\n            var records = [];\r\n    \r\n            // Update cells\r\n            if (obj.historyIndex < obj.history.length - 1) {\r\n                // History\r\n                var historyRecord = obj.history[++obj.historyIndex];\r\n    \r\n                if (historyRecord.action == 'insertRow') {\r\n                    obj.historyProcessRow(0, historyRecord);\r\n                } else if (historyRecord.action == 'deleteRow') {\r\n                    obj.historyProcessRow(1, historyRecord);\r\n                } else if (historyRecord.action == 'insertColumn') {\r\n                    obj.historyProcessColumn(0, historyRecord);\r\n                } else if (historyRecord.action == 'deleteColumn') {\r\n                    obj.historyProcessColumn(1, historyRecord);\r\n                } else if (historyRecord.action == 'moveRow') {\r\n                    obj.moveRow(historyRecord.oldValue, historyRecord.newValue);\r\n                } else if (historyRecord.action == 'moveColumn') {\r\n                    obj.moveColumn(historyRecord.oldValue, historyRecord.newValue);\r\n                } else if (historyRecord.action == 'setMerge') {\r\n                    obj.setMerge(historyRecord.column, historyRecord.colspan, historyRecord.rowspan, 1);\r\n                } else if (historyRecord.action == 'setStyle') {\r\n                    obj.setStyle(historyRecord.newValue, null, null, 1);\r\n                } else if (historyRecord.action == 'setWidth') {\r\n                    obj.setWidth(historyRecord.column, historyRecord.newValue);\r\n                } else if (historyRecord.action == 'setHeight') {\r\n                    obj.setHeight(historyRecord.row, historyRecord.newValue);\r\n                } else if (historyRecord.action == 'setHeader') {\r\n                    obj.setHeader(historyRecord.column, historyRecord.newValue);\r\n                } else if (historyRecord.action == 'setComments') {\r\n                    obj.setComments(historyRecord.column, historyRecord.newValue[0], historyRecord.newValue[1]);\r\n                } else if (historyRecord.action == 'orderBy') {\r\n                    obj.updateOrderArrow(historyRecord.column, historyRecord.order);\r\n                    obj.updateOrder(historyRecord.rows);\r\n                } else if (historyRecord.action == 'setValue') {\r\n                    obj.setValue(historyRecord.records);\r\n                    // Redo for changes in cells\r\n                    for (var i = 0; i < historyRecord.records.length; i++) {\r\n                        if (historyRecord.oldStyle) {\r\n                            obj.resetStyle(historyRecord.newStyle);\r\n                        }\r\n                    }\r\n                    // Update selection\r\n                    if (historyRecord.selection) {\r\n                        obj.updateSelectionFromCoords(historyRecord.selection[0], historyRecord.selection[1], historyRecord.selection[2], historyRecord.selection[3]);\r\n                    }\r\n                }\r\n            }\r\n            obj.ignoreEvents = ignoreEvents;\r\n            obj.ignoreHistory = ignoreHistory;\r\n    \r\n            // Events\r\n            obj.dispatch('onredo', el, historyRecord);\r\n        }\r\n    \r\n        /**\r\n         * Get dropdown value from key\r\n         */\r\n        obj.getDropDownValue = function(column, key) {\r\n            var value = [];\r\n    \r\n            if (obj.options.columns[column] && obj.options.columns[column].source) {\r\n                // Create array from source\r\n                var combo = [];\r\n                var source = obj.options.columns[column].source;\r\n    \r\n                for (var i = 0; i < source.length; i++) {\r\n                    if (typeof(source[i]) == 'object') {\r\n                        combo[source[i].id] = source[i].name;\r\n                    } else {\r\n                        combo[source[i]] = source[i];\r\n                    }\r\n                }\r\n    \r\n                // Guarantee single multiple compatibility\r\n                var keys = Array.isArray(key) ? key : ('' + key).split(';');\r\n    \r\n                for (var i = 0; i < keys.length; i++) {\r\n                    if (typeof(keys[i]) === 'object') {\r\n                        value.push(combo[keys[i].id]);\r\n                    } else {\r\n                        if (combo[keys[i]]) {\r\n                            value.push(combo[keys[i]]);\r\n                        }\r\n                    }\r\n                }\r\n            } else {\r\n                console.error('Invalid column');\r\n            }\r\n    \r\n            return (value.length > 0) ? value.join('; ') : '';\r\n        }\r\n    \r\n        /**\r\n         * From starckoverflow contributions\r\n         */\r\n        obj.parseCSV = function(str, delimiter) {\r\n            // Remove last line break\r\n            str = str.replace(/\\r?\\n$|\\r$|\\n$/g, \"\");\r\n            // Last caracter is the delimiter\r\n            if (str.charCodeAt(str.length-1) == 9) {\r\n                str += \"\\0\";\r\n            }\r\n            // user-supplied delimeter or default comma\r\n            delimiter = (delimiter || \",\");\r\n    \r\n            var arr = [];\r\n            var quote = false;  // true means we're inside a quoted field\r\n            // iterate over each character, keep track of current row and column (of the returned array)\r\n            for (var row = 0, col = 0, c = 0; c < str.length; c++) {\r\n                var cc = str[c], nc = str[c+1];\r\n                arr[row] = arr[row] || [];\r\n                arr[row][col] = arr[row][col] || '';\r\n    \r\n                // If the current character is a quotation mark, and we're inside a quoted field, and the next character is also a quotation mark, add a quotation mark to the current column and skip the next character\r\n                if (cc == '\"' && quote && nc == '\"') { arr[row][col] += cc; ++c; continue; }  \r\n    \r\n                // If it's just one quotation mark, begin/end quoted field\r\n                if (cc == '\"') { quote = !quote; continue; }\r\n    \r\n                // If it's a comma and we're not in a quoted field, move on to the next column\r\n                if (cc == delimiter && !quote) { ++col; continue; }\r\n    \r\n                // If it's a newline (CRLF) and we're not in a quoted field, skip the next character and move on to the next row and move to column 0 of that new row\r\n                if (cc == '\\r' && nc == '\\n' && !quote) { ++row; col = 0; ++c; continue; }\r\n    \r\n                // If it's a newline (LF or CR) and we're not in a quoted field, move on to the next row and move to column 0 of that new row\r\n                if (cc == '\\n' && !quote) { ++row; col = 0; continue; }\r\n                if (cc == '\\r' && !quote) { ++row; col = 0; continue; }\r\n    \r\n                // Otherwise, append the current character to the current column\r\n                arr[row][col] += cc;\r\n            }\r\n            return arr;\r\n        }\r\n    \r\n        obj.hash = function(str) {\r\n            var hash = 0, i, chr;\r\n    \r\n            if (str.length === 0) {\r\n                return hash;\r\n            } else {\r\n                for (i = 0; i < str.length; i++) {\r\n                  chr = str.charCodeAt(i);\r\n                  hash = ((hash << 5) - hash) + chr;\r\n                  hash |= 0;\r\n                }\r\n            }\r\n            return hash;\r\n        }\r\n    \r\n        obj.onafterchanges = function(el, records) {\r\n            // Events\r\n            obj.dispatch('onafterchanges', el, records);\r\n        }\r\n    \r\n        obj.destroy = function() {\r\n            jexcel.destroy(el);\r\n        }\r\n\r\n        /**\r\n         * Initialization method\r\n         */\r\n        obj.init = function() {\r\n            jexcel.current = obj;\r\n    \r\n            // Build handlers\r\n            if (typeof(jexcel.build) == 'function') {\r\n                if (obj.options.root) {\r\n                    jexcel.build(obj.options.root);\r\n                } else {\r\n                    jexcel.build(document);\r\n                    jexcel.build = null;\r\n                }\r\n            }\r\n    \r\n            // Event\r\n            el.setAttribute('tabindex', 1);\r\n            el.addEventListener('focus', function(e) {\r\n                if (jexcel.current && ! obj.selectedCell) {\r\n                    obj.updateSelectionFromCoords(0,0,0,0);\r\n                    obj.left();\r\n                }\r\n            });\r\n\r\n            // Load the table data based on an CSV file\r\n            if (obj.options.csv) {\r\n                // Loading\r\n                if (obj.options.loadingSpin == true) {\r\n                    jSuites.loading.show();\r\n                }\r\n    \r\n                // Load CSV file\r\n                jSuites.ajax({\r\n                    url: obj.options.csv,\r\n                    method: obj.options.method,\r\n                    data: obj.options.requestVariables,\r\n                    dataType: 'text',\r\n                    success: function(result) {\r\n                        // Convert data\r\n                        var newData = obj.parseCSV(result, obj.options.csvDelimiter)\r\n    \r\n                        // Headers\r\n                        if (obj.options.csvHeaders == true && newData.length > 0) {\r\n                            var headers = newData.shift();\r\n                            for(var i = 0; i < headers.length; i++) {\r\n                                if (! obj.options.columns[i]) {\r\n                                    obj.options.columns[i] = { type:'text', align:obj.options.defaultColAlign, width:obj.options.defaultColWidth };\r\n                                }\r\n                                // Precedence over pre-configurated titles\r\n                                if (typeof obj.options.columns[i].title === 'undefined') {\r\n                                  obj.options.columns[i].title = headers[i];\r\n                                }\r\n                            }\r\n                        }\r\n                        // Data\r\n                        obj.options.data = newData;\r\n                        // Prepare table\r\n                        obj.prepareTable();\r\n                        // Hide spin\r\n                        if (obj.options.loadingSpin == true) {\r\n                            jSuites.loading.hide();\r\n                        }\r\n                    }\r\n                });\r\n            } else if (obj.options.url) {\r\n                // Loading\r\n                if (obj.options.loadingSpin == true) {\r\n                    jSuites.loading.show();\r\n                }\r\n    \r\n                jSuites.ajax({\r\n                    url: obj.options.url,\r\n                    method: obj.options.method,\r\n                    data: obj.options.requestVariables,\r\n                    dataType: 'json',\r\n                    success: function(result) {\r\n                        // Data\r\n                        obj.options.data = (result.data) ? result.data : result;\r\n                        // Prepare table\r\n                        obj.prepareTable();\r\n                        // Hide spin\r\n                        if (obj.options.loadingSpin == true) {\r\n                            jSuites.loading.hide();\r\n                        }\r\n                    }\r\n                });\r\n            } else {\r\n                // Prepare table\r\n                obj.prepareTable();\r\n            }\r\n        }\r\n    \r\n        // Context menu\r\n        if (options && options.contextMenu != null) {\r\n            obj.options.contextMenu = options.contextMenu;\r\n        } else {\r\n            obj.options.contextMenu = function(el, x, y, e) {\r\n                var items = [];\r\n    \r\n                if (y == null) {\r\n                    // Insert a new column\r\n                    if (obj.options.allowInsertColumn == true) {\r\n                        items.push({\r\n                            title:obj.options.text.insertANewColumnBefore,\r\n                            onclick:function() {\r\n                                obj.insertColumn(1, parseInt(x), 1);\r\n                            }\r\n                        });\r\n                    }\r\n    \r\n                    if (obj.options.allowInsertColumn == true) {\r\n                        items.push({\r\n                            title:obj.options.text.insertANewColumnAfter,\r\n                            onclick:function() {\r\n                                obj.insertColumn(1, parseInt(x), 0);\r\n                            }\r\n                        });\r\n                    }\r\n    \r\n                    // Delete a column\r\n                    if (obj.options.allowDeleteColumn == true) {\r\n                        items.push({\r\n                            title:obj.options.text.deleteSelectedColumns,\r\n                            onclick:function() {\r\n                                obj.deleteColumn(obj.getSelectedColumns().length ? undefined : parseInt(x));\r\n                            }\r\n                        });\r\n                    }\r\n    \r\n                    // Rename column\r\n                    if (obj.options.allowRenameColumn == true) {\r\n                        items.push({\r\n                            title:obj.options.text.renameThisColumn,\r\n                            onclick:function() {\r\n                                obj.setHeader(x);\r\n                            }\r\n                        });\r\n                    }\r\n    \r\n                    // Sorting\r\n                    if (obj.options.columnSorting == true) {\r\n                        // Line\r\n                        items.push({ type:'line' });\r\n    \r\n                        items.push({\r\n                            title:obj.options.text.orderAscending,\r\n                            onclick:function() {\r\n                                obj.orderBy(x, 0);\r\n                            }\r\n                        });\r\n                        items.push({\r\n                            title:obj.options.text.orderDescending,\r\n                            onclick:function() {\r\n                                obj.orderBy(x, 1);\r\n                            }\r\n                        });\r\n                    }\r\n                } else {\r\n                    // Insert new row\r\n                    if (obj.options.allowInsertRow == true) {\r\n                        items.push({\r\n                            title:obj.options.text.insertANewRowBefore,\r\n                            onclick:function() {\r\n                                obj.insertRow(1, parseInt(y), 1);\r\n                            }\r\n                        });\r\n    \r\n                        items.push({\r\n                            title:obj.options.text.insertANewRowAfter,\r\n                            onclick:function() {\r\n                                obj.insertRow(1, parseInt(y));\r\n                            }\r\n                        });\r\n                    }\r\n    \r\n                    if (obj.options.allowDeleteRow == true) {\r\n                        items.push({\r\n                            title:obj.options.text.deleteSelectedRows,\r\n                            onclick:function() {\r\n                                obj.deleteRow(obj.getSelectedRows().length ? undefined : parseInt(y));\r\n                            }\r\n                        });\r\n                    }\r\n    \r\n                    if (x) {\r\n                        if (obj.options.allowComments == true) {\r\n                            items.push({ type:'line' });\r\n    \r\n                            var title = obj.records[y][x].getAttribute('title') || '';\r\n\r\n                            items.push({\r\n                                title: title ? obj.options.text.editComments : obj.options.text.addComments,\r\n                                onclick:function() {\r\n                                    var comment = prompt(obj.options.text.comments, title);\r\n                                    if (comment) {\r\n                                        obj.setComments([ x, y ], comment);\r\n                                    }\r\n                                }\r\n                            });\r\n    \r\n                            if (title) {\r\n                                items.push({\r\n                                    title:obj.options.text.clearComments,\r\n                                    onclick:function() {\r\n                                        obj.setComments([ x, y ], '');\r\n                                    }\r\n                                });\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n    \r\n                // Line\r\n                items.push({ type:'line' });\r\n    \r\n                // Copy\r\n                items.push({\r\n                    title:obj.options.text.copy,\r\n                    shortcut:'Ctrl + C',\r\n                    onclick:function() {\r\n                        obj.copy(true);\r\n                    }\r\n                });\r\n    \r\n                // Paste\r\n                if (navigator && navigator.clipboard) {\r\n                    items.push({\r\n                        title:obj.options.text.paste,\r\n                        shortcut:'Ctrl + V',\r\n                        onclick:function() {\r\n                            if (obj.selectedCell) {\r\n                                navigator.clipboard.readText().then(function(text) {\r\n                                    if (text) {\r\n                                        jexcel.current.paste(obj.selectedCell[0], obj.selectedCell[1], text);\r\n                                    }\r\n                                });\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n    \r\n                // Save\r\n                if (obj.options.allowExport) {\r\n                    items.push({\r\n                        title: obj.options.text.saveAs,\r\n                        shortcut: 'Ctrl + S',\r\n                        onclick: function () {\r\n                            obj.download();\r\n                        }\r\n                    });\r\n                }\r\n    \r\n                // About\r\n                if (obj.options.about) {\r\n                    items.push({\r\n                        title:obj.options.text.about,\r\n                        onclick:function() {\r\n                            if (obj.options.about === true) {\r\n                                alert(Version().print());\r\n                            } else {\r\n                                alert(obj.options.about);\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n    \r\n                return items;\r\n            }\r\n        }\r\n    \r\n        obj.scrollControls = function(e) {\r\n            obj.wheelControls();\r\n\r\n            if (obj.options.freezeColumns > 0 && obj.content.scrollLeft != scrollLeft) {\r\n                obj.updateFreezePosition();\r\n            }\r\n\r\n            // Close editor\r\n            if (obj.options.lazyLoading == true || obj.options.tableOverflow == true) {\r\n                if (obj.edition && e.target.className.substr(0,9) != 'jdropdown') {\r\n                    obj.closeEditor(obj.edition[0], true);\r\n                }\r\n            }\r\n        }\r\n\r\n        obj.wheelControls = function(e) {\r\n            if (obj.options.lazyLoading == true) {\r\n                if (jexcel.timeControlLoading == null) {\r\n                    jexcel.timeControlLoading = setTimeout(function() {\r\n                        if (obj.content.scrollTop + obj.content.clientHeight >= obj.content.scrollHeight - 10) {\r\n                            if (obj.loadDown()) {\r\n                                if (obj.content.scrollTop + obj.content.clientHeight > obj.content.scrollHeight - 10) {\r\n                                    obj.content.scrollTop = obj.content.scrollTop - obj.content.clientHeight;\r\n                                }\r\n                                obj.updateCornerPosition();\r\n                            }\r\n                        } else if (obj.content.scrollTop <= obj.content.clientHeight) {\r\n                            if (obj.loadUp()) {\r\n                                if (obj.content.scrollTop < 10) {\r\n                                    obj.content.scrollTop = obj.content.scrollTop + obj.content.clientHeight;\r\n                                }\r\n                                obj.updateCornerPosition();\r\n                            }\r\n                        }\r\n    \r\n                        jexcel.timeControlLoading = null;\r\n                    }, 100);\r\n                }\r\n            }\r\n        }\r\n\r\n        // Get width of all freezed cells together\r\n        obj.getFreezeWidth = function() {\r\n            var width = 0;\r\n            if (obj.options.freezeColumns > 0) {\r\n                for (var i = 0; i < obj.options.freezeColumns; i++) {\r\n                    width += parseInt(obj.options.columns[i].width);\r\n                }\r\n            }\r\n            return width;\r\n        }\r\n\r\n        var scrollLeft = 0;\r\n\r\n        obj.updateFreezePosition = function() {\r\n            scrollLeft = obj.content.scrollLeft;\r\n            var width = 0;\r\n            if (scrollLeft > 50) {\r\n                for (var i = 0; i < obj.options.freezeColumns; i++) {\r\n                    if (i > 0) {\r\n                        width += parseInt(obj.options.columns[i-1].width);\r\n                    }\r\n                    obj.headers[i].classList.add('jexcel_freezed');\r\n                    obj.headers[i].style.left = width + 'px';\r\n                    for (var j = 0; j < obj.rows.length; j++) {\r\n                        if (obj.rows[j] && obj.records[j][i]) {\r\n                            var shifted = (scrollLeft + (i > 0 ? obj.records[j][i-1].style.width : 0)) - 51 + 'px';\r\n                            obj.records[j][i].classList.add('jexcel_freezed');\r\n                            obj.records[j][i].style.left = shifted;\r\n                        }\r\n                    }\r\n                }\r\n            } else {\r\n                for (var i = 0; i < obj.options.freezeColumns; i++) {\r\n                    obj.headers[i].classList.remove('jexcel_freezed');\r\n                    obj.headers[i].style.left = '';\r\n                    for (var j = 0; j < obj.rows.length; j++) {\r\n                        if (obj.records[j][i]) {\r\n                            obj.records[j][i].classList.remove('jexcel_freezed');\r\n                            obj.records[j][i].style.left = '';\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Place the corner in the correct place\r\n            obj.updateCornerPosition();\r\n        }\r\n\r\n        el.addEventListener(\"DOMMouseScroll\", obj.wheelControls);\r\n        el.addEventListener(\"mousewheel\", obj.wheelControls);\r\n    \r\n        el.jexcel = obj;\r\n        el.jspreadsheet = obj;\r\n    \r\n        obj.init();\r\n    \r\n        return obj;\r\n    });\r\n\r\n    // Define dictionary\r\n    jexcel.setDictionary = function(o) {\r\n        jSuites.setDictionary(o);\r\n    }\r\n\r\n    // Define extesions\r\n    jexcel.setExtensions = function(o) {\r\n        var k = Object.keys(o);\r\n        for (var i = 0; i < k.length; i++) {\r\n            if (typeof(o[k[i]]) === 'function') {\r\n                jexcel[k[i]] = o[k[i]];\r\n                if (jexcel.license && typeof(o[k[i]].license) == 'function') {\r\n                    o[k[i]].license(jexcel.license);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Formulas\r\n     */\r\n    if (typeof(formula) !== 'undefined') {\r\n        jexcel.formula = formula;\r\n    }\r\n    jexcel.version = Version;\r\n\r\n    jexcel.current = null;\r\n    jexcel.timeControl = null;\r\n    jexcel.timeControlLoading = null;\r\n    \r\n    jexcel.destroy = function(element, destroyEventHandlers) {\r\n        if (element.jexcel) {\r\n            var root = element.jexcel.options.root ? element.jexcel.options.root : document;\r\n            element.removeEventListener(\"DOMMouseScroll\", element.jexcel.scrollControls);\r\n            element.removeEventListener(\"mousewheel\", element.jexcel.scrollControls);\r\n            element.jexcel = null;\r\n            element.innerHTML = '';\r\n    \r\n            if (destroyEventHandlers) {\r\n                root.removeEventListener(\"mouseup\", jexcel.mouseUpControls);\r\n                root.removeEventListener(\"mousedown\", jexcel.mouseDownControls);\r\n                root.removeEventListener(\"mousemove\", jexcel.mouseMoveControls);\r\n                root.removeEventListener(\"mouseover\", jexcel.mouseOverControls);\r\n                root.removeEventListener(\"dblclick\", jexcel.doubleClickControls);\r\n                root.removeEventListener(\"paste\", jexcel.pasteControls);\r\n                root.removeEventListener(\"contextmenu\", jexcel.contextMenuControls);\r\n                root.removeEventListener(\"touchstart\", jexcel.touchStartControls);\r\n                root.removeEventListener(\"touchend\", jexcel.touchEndControls);\r\n                root.removeEventListener(\"touchcancel\", jexcel.touchEndControls);\r\n                document.removeEventListener(\"keydown\", jexcel.keyDownControls);\r\n                jexcel = null;\r\n            }\r\n        }\r\n    }\r\n    \r\n    jexcel.build = function(root) {\r\n        root.addEventListener(\"mouseup\", jexcel.mouseUpControls);\r\n        root.addEventListener(\"mousedown\", jexcel.mouseDownControls);\r\n        root.addEventListener(\"mousemove\", jexcel.mouseMoveControls);\r\n        root.addEventListener(\"mouseover\", jexcel.mouseOverControls);\r\n        root.addEventListener(\"dblclick\", jexcel.doubleClickControls);\r\n        root.addEventListener(\"paste\", jexcel.pasteControls);\r\n        root.addEventListener(\"contextmenu\", jexcel.contextMenuControls);\r\n        root.addEventListener(\"touchstart\", jexcel.touchStartControls);\r\n        root.addEventListener(\"touchend\", jexcel.touchEndControls);\r\n        root.addEventListener(\"touchcancel\", jexcel.touchEndControls);\r\n        root.addEventListener(\"touchmove\", jexcel.touchEndControls);\r\n        document.addEventListener(\"keydown\", jexcel.keyDownControls);\r\n    }\r\n    \r\n    /**\r\n     * Events\r\n     */\r\n    jexcel.keyDownControls = function(e) {\r\n        if (jexcel.current) {\r\n            if (jexcel.current.edition) {\r\n                if (e.which == 27) {\r\n                    // Escape\r\n                    if (jexcel.current.edition) {\r\n                        // Exit without saving\r\n                        jexcel.current.closeEditor(jexcel.current.edition[0], false);\r\n                    }\r\n                    e.preventDefault();\r\n                } else if (e.which == 13) {\r\n                    // Enter\r\n                    if (jexcel.current.options.columns[jexcel.current.edition[2]].type == 'calendar') {\r\n                        jexcel.current.closeEditor(jexcel.current.edition[0], true);\r\n                    } else if (jexcel.current.options.columns[jexcel.current.edition[2]].type == 'dropdown' ||\r\n                               jexcel.current.options.columns[jexcel.current.edition[2]].type == 'autocomplete') {\r\n                        // Do nothing\r\n                    } else {\r\n                        // Alt enter -> do not close editor\r\n                        if ((jexcel.current.options.wordWrap == true ||\r\n                             jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap == true ||\r\n                             jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length > 200) && e.altKey) {\r\n                            // Add new line to the editor\r\n                            var editorTextarea = jexcel.current.edition[0].children[0];\r\n                            var editorValue = jexcel.current.edition[0].children[0].value;\r\n                            var editorIndexOf = editorTextarea.selectionStart;\r\n                            editorValue = editorValue.slice(0, editorIndexOf) + \"\\n\" + editorValue.slice(editorIndexOf);\r\n                            editorTextarea.value = editorValue;\r\n                            editorTextarea.focus();\r\n                            editorTextarea.selectionStart = editorIndexOf + 1;\r\n                            editorTextarea.selectionEnd = editorIndexOf + 1;\r\n                        } else {\r\n                            jexcel.current.edition[0].children[0].blur();\r\n                        }\r\n                    }\r\n                } else if (e.which == 9) {\r\n                    // Tab\r\n                    if (jexcel.current.options.columns[jexcel.current.edition[2]].type == 'calendar') {\r\n                        jexcel.current.closeEditor(jexcel.current.edition[0], true);\r\n                    } else {\r\n                        jexcel.current.edition[0].children[0].blur();\r\n                    }\r\n                }\r\n            }\r\n    \r\n            if (! jexcel.current.edition && jexcel.current.selectedCell) {\r\n                // Which key\r\n                if (e.which == 37) {\r\n                    jexcel.current.left(e.shiftKey, e.ctrlKey);\r\n                    e.preventDefault();\r\n                } else if (e.which == 39) {\r\n                    jexcel.current.right(e.shiftKey, e.ctrlKey);\r\n                    e.preventDefault();\r\n                } else if (e.which == 38) {\r\n                    jexcel.current.up(e.shiftKey, e.ctrlKey);\r\n                    e.preventDefault();\r\n                } else if (e.which == 40) {\r\n                    jexcel.current.down(e.shiftKey, e.ctrlKey);\r\n                    e.preventDefault();\r\n                } else if (e.which == 36) {\r\n                    jexcel.current.first(e.shiftKey, e.ctrlKey);\r\n                    e.preventDefault();\r\n                } else if (e.which == 35) {\r\n                    jexcel.current.last(e.shiftKey, e.ctrlKey);\r\n                    e.preventDefault();\r\n                } else if (e.which == 32) {\r\n                    if (jexcel.current.options.editable == true) {\r\n                        jexcel.current.setCheckRadioValue();\r\n                    }\r\n                    e.preventDefault();\r\n                } else if (e.which == 46) {\r\n                    // Delete\r\n                    if (jexcel.current.options.editable == true) {\r\n                        if (jexcel.current.selectedRow) {\r\n                            if (jexcel.current.options.allowDeleteRow == true) {\r\n                                if (confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)) {\r\n                                    jexcel.current.deleteRow();\r\n                                }\r\n                            }\r\n                        } else if (jexcel.current.selectedHeader) {\r\n                            if (jexcel.current.options.allowDeleteColumn == true) {\r\n                                if (confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)) {\r\n                                    jexcel.current.deleteColumn();\r\n                                }\r\n                            }\r\n                        } else {\r\n                            // Change value\r\n                            jexcel.current.setValue(jexcel.current.highlighted, '');\r\n                        }\r\n                    }\r\n                } else if (e.which == 13) {\r\n                    // Move cursor\r\n                    if (e.shiftKey) {\r\n                        jexcel.current.up();\r\n                    } else {\r\n                        if (jexcel.current.options.allowInsertRow == true) {\r\n                            if (jexcel.current.options.allowManualInsertRow == true) {\r\n                                if (jexcel.current.selectedCell[1] == jexcel.current.options.data.length - 1) {\r\n                                    // New record in case selectedCell in the last row\r\n                                    jexcel.current.insertRow();\r\n                                }\r\n                            }\r\n                        }\r\n    \r\n                        jexcel.current.down();\r\n                    }\r\n                    e.preventDefault();\r\n                } else if (e.which == 9) {\r\n                    // Tab\r\n                    if (e.shiftKey) {\r\n                        jexcel.current.left();\r\n                    } else {\r\n                        if (jexcel.current.options.allowInsertColumn == true) {\r\n                            if (jexcel.current.options.allowManualInsertColumn == true) {\r\n                                if (jexcel.current.selectedCell[0] == jexcel.current.options.data[0].length - 1) {\r\n                                    // New record in case selectedCell in the last column\r\n                                    jexcel.current.insertColumn();\r\n                                }\r\n                            }\r\n                        }\r\n    \r\n                        jexcel.current.right();\r\n                    }\r\n                    e.preventDefault();\r\n                } else {\r\n                    if ((e.ctrlKey || e.metaKey) && ! e.shiftKey) {\r\n                        if (e.which == 65) {\r\n                            // Ctrl + A\r\n                            jexcel.current.selectAll();\r\n                            e.preventDefault();\r\n                        } else if (e.which == 83) {\r\n                            // Ctrl + S\r\n                            jexcel.current.download();\r\n                            e.preventDefault();\r\n                        } else if (e.which == 89) {\r\n                            // Ctrl + Y\r\n                            jexcel.current.redo();\r\n                            e.preventDefault();\r\n                        } else if (e.which == 90) {\r\n                            // Ctrl + Z\r\n                            jexcel.current.undo();\r\n                            e.preventDefault();\r\n                        } else if (e.which == 67) {\r\n                            // Ctrl + C\r\n                            jexcel.current.copy(true);\r\n                            e.preventDefault();\r\n                               } else if (e.which == 88) {\r\n                            // Ctrl + X\r\n                            if (jexcel.current.options.editable == true) {\r\n                                jexcel.cutControls();\r\n                            } else {\r\n                                jexcel.copyControls();\r\n                            }\r\n                            e.preventDefault();\r\n                        } else if (e.which == 86) {\r\n                            // Ctrl + V\r\n                            jexcel.pasteControls();\r\n                        }\r\n                    } else {\r\n                        if (jexcel.current.selectedCell) {\r\n                            if (jexcel.current.options.editable == true) {\r\n                                var rowId = jexcel.current.selectedCell[1];\r\n                                var columnId = jexcel.current.selectedCell[0];\r\n    \r\n                                // If is not readonly\r\n                                if (jexcel.current.options.columns[columnId].type != 'readonly') {\r\n                                    // Characters able to start a edition\r\n                                    if (e.keyCode == 32) {\r\n                                        // Space\r\n                                        if (jexcel.current.options.columns[columnId].type == 'checkbox' ||\r\n                                            jexcel.current.options.columns[columnId].type == 'radio') {\r\n                                            e.preventDefault();\r\n                                        } else {\r\n                                            // Start edition\r\n                                            jexcel.current.openEditor(jexcel.current.records[rowId][columnId], true);\r\n                                        }\r\n                                    } else if (e.keyCode == 113) {\r\n                                        // Start edition with current content F2\r\n                                        jexcel.current.openEditor(jexcel.current.records[rowId][columnId], false);\r\n                                    } else if ((e.keyCode == 8) ||\r\n                                               (e.keyCode >= 48 && e.keyCode <= 57) ||\r\n                                               (e.keyCode >= 96 && e.keyCode <= 111) ||\r\n                                               (e.keyCode >= 187 && e.keyCode <= 190) ||\r\n                                               ((String.fromCharCode(e.keyCode) == e.key || String.fromCharCode(e.keyCode).toLowerCase() == e.key.toLowerCase()) && jexcel.validLetter(String.fromCharCode(e.keyCode)))) {\r\n                                        // Start edition\r\n                                        jexcel.current.openEditor(jexcel.current.records[rowId][columnId], true);\r\n                                        // Prevent entries in the calendar\r\n                                        if (jexcel.current.options.columns[columnId].type == 'calendar') {\r\n                                            e.preventDefault();\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            } else {\r\n                if (e.target.classList.contains('jexcel_search')) {\r\n                    if (jexcel.timeControl) {\r\n                        clearTimeout(jexcel.timeControl);\r\n                    }\r\n    \r\n                    jexcel.timeControl = setTimeout(function() {\r\n                        jexcel.current.search(e.target.value);\r\n                    }, 200);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    jexcel.isMouseAction = false;\r\n    \r\n    jexcel.mouseDownControls = function(e) {\r\n        e = e || window.event;\r\n        if (e.buttons) {\r\n            var mouseButton = e.buttons;\r\n        } else if (e.button) {\r\n            var mouseButton = e.button;\r\n        } else {\r\n            var mouseButton = e.which;\r\n        }\r\n\r\n        // Get elements\r\n        var jexcelTable = jexcel.getElement(e.target);\r\n\r\n        if (jexcelTable[0]) {\r\n            if (jexcel.current != jexcelTable[0].jexcel) {\r\n                if (jexcel.current) {\r\n                    if (jexcel.current.edition) {\r\n                        jexcel.current.closeEditor(jexcel.current.edition[0], true);\r\n                    }\r\n                    jexcel.current.resetSelection();\r\n                }\r\n                jexcel.current = jexcelTable[0].jexcel;\r\n            }\r\n        } else {\r\n            if (jexcel.current) {\r\n                if (jexcel.current.edition) {\r\n                    jexcel.current.closeEditor(jexcel.current.edition[0], true);\r\n                }\r\n                \r\n                jexcel.current.resetSelection(true);\r\n                jexcel.current = null;\r\n            }\r\n        }\r\n    \r\n        if (jexcel.current && mouseButton == 1) {\r\n            if (e.target.classList.contains('jexcel_selectall')) {\r\n                if (jexcel.current) {\r\n                    jexcel.current.selectAll();\r\n                }\r\n            } else if (e.target.classList.contains('jexcel_corner')) {\r\n                if (jexcel.current.options.editable == true) {\r\n                    jexcel.current.selectedCorner = true;\r\n                }\r\n            } else {\r\n                // Header found\r\n                if (jexcelTable[1] == 1) {\r\n                    var columnId = e.target.getAttribute('data-x');\r\n                    if (columnId) {\r\n                        // Update cursor\r\n                        var info = e.target.getBoundingClientRect();\r\n                        if (jexcel.current.options.columnResize == true && info.width - e.offsetX < 6) {\r\n                            // Resize helper\r\n                            jexcel.current.resizing = {\r\n                                mousePosition: e.pageX,\r\n                                column: columnId,\r\n                                width: info.width,\r\n                            };\r\n    \r\n                            // Border indication\r\n                            jexcel.current.headers[columnId].classList.add('resizing');\r\n                            for (var j = 0; j < jexcel.current.records.length; j++) {\r\n                                if (jexcel.current.records[j][columnId]) {\r\n                                    jexcel.current.records[j][columnId].classList.add('resizing');\r\n                                }\r\n                            }\r\n                        } else if (jexcel.current.options.columnDrag == true && info.height - e.offsetY < 6) {\r\n                            if (jexcel.current.isColMerged(columnId).length) {\r\n                                console.error('Jspreadsheet: This column is part of a merged cell.');\r\n                            } else {\r\n                                // Reset selection\r\n                                jexcel.current.resetSelection();\r\n                                // Drag helper\r\n                                jexcel.current.dragging = {\r\n                                    element: e.target,\r\n                                    column:columnId,\r\n                                    destination:columnId,\r\n                                };\r\n                                // Border indication\r\n                                jexcel.current.headers[columnId].classList.add('dragging');\r\n                                for (var j = 0; j < jexcel.current.records.length; j++) {\r\n                                    if (jexcel.current.records[j][columnId]) {\r\n                                        jexcel.current.records[j][columnId].classList.add('dragging');\r\n                                    }\r\n                                }\r\n                            }\r\n                        } else {\r\n                            if (jexcel.current.selectedHeader && (e.shiftKey || e.ctrlKey)) {\r\n                                var o = jexcel.current.selectedHeader;\r\n                                var d = columnId;\r\n                            } else {\r\n                                // Press to rename\r\n                                if (jexcel.current.selectedHeader == columnId && jexcel.current.options.allowRenameColumn == true) {\r\n                                    jexcel.timeControl = setTimeout(function() {\r\n                                        jexcel.current.setHeader(columnId);\r\n                                    }, 800);\r\n                                }\r\n    \r\n                                // Keep track of which header was selected first\r\n                                jexcel.current.selectedHeader = columnId;\r\n    \r\n                                // Update selection single column\r\n                                var o = columnId;\r\n                                var d = columnId;\r\n                            }\r\n    \r\n                            // Update selection\r\n                            jexcel.current.updateSelectionFromCoords(o, 0, d, jexcel.current.options.data.length - 1);\r\n                        }\r\n                    } else {\r\n                        if (e.target.parentNode.classList.contains('jexcel_nested')) {\r\n                            if (e.target.getAttribute('data-column')) {\r\n                                var column = e.target.getAttribute('data-column').split(',');\r\n                                var c1 = parseInt(column[0]);\r\n                                var c2 = parseInt(column[column.length-1]);\r\n                            } else {\r\n                                var c1 = 0;\r\n                                var c2 = jexcel.current.options.columns.length - 1;\r\n                            }\r\n                            jexcel.current.updateSelectionFromCoords(c1, 0, c2, jexcel.current.options.data.length - 1);\r\n                        }\r\n                    }\r\n                } else {\r\n                    jexcel.current.selectedHeader = false;\r\n                }\r\n    \r\n                // Body found\r\n                if (jexcelTable[1] == 2) {\r\n                    var rowId = e.target.getAttribute('data-y');\r\n                    \r\n                    if (e.target.classList.contains('jexcel_row')) {\r\n                        var info = e.target.getBoundingClientRect();\r\n                        if (jexcel.current.options.rowResize == true && info.height - e.offsetY < 6) {\r\n                            // Resize helper\r\n                            jexcel.current.resizing = {\r\n                                element: e.target.parentNode,\r\n                                mousePosition: e.pageY,\r\n                                row: rowId,\r\n                                height: info.height,\r\n                            };\r\n                            // Border indication\r\n                            e.target.parentNode.classList.add('resizing');\r\n                        } else if (jexcel.current.options.rowDrag == true && info.width - e.offsetX < 6) {\r\n                            if (jexcel.current.isRowMerged(rowId).length) {\r\n                                console.error('Jspreadsheet: This row is part of a merged cell');\r\n                            } else if (jexcel.current.options.search == true && jexcel.current.results) {\r\n                                console.error('Jspreadsheet: Please clear your search before perform this action');\r\n                            } else {\r\n                                // Reset selection\r\n                                jexcel.current.resetSelection();\r\n                                // Drag helper\r\n                                jexcel.current.dragging = {\r\n                                    element: e.target.parentNode,\r\n                                    row:rowId,\r\n                                    destination:rowId,\r\n                                };\r\n                                // Border indication\r\n                                e.target.parentNode.classList.add('dragging');\r\n                            }\r\n                        } else {\r\n                            if (jexcel.current.selectedRow && (e.shiftKey || e.ctrlKey)) {\r\n                                var o = jexcel.current.selectedRow;\r\n                                var d = rowId;\r\n                            } else {\r\n                                // Keep track of which header was selected first\r\n                                jexcel.current.selectedRow = rowId;\r\n    \r\n                                // Update selection single column\r\n                                var o = rowId;\r\n                                var d = rowId;\r\n                            }\r\n    \r\n                            // Update selection\r\n                            jexcel.current.updateSelectionFromCoords(0, o, jexcel.current.options.data[0].length - 1, d);\r\n                        }\r\n                    } else {\r\n                        // Jclose\r\n                        if (e.target.classList.contains('jclose') && e.target.clientWidth - e.offsetX < 50 && e.offsetY < 50) {\r\n                            jexcel.current.closeEditor(jexcel.current.edition[0], true);\r\n                        } else {\r\n                            var getCellCoords = function(element) {\r\n                                var x = element.getAttribute('data-x');\r\n                                var y = element.getAttribute('data-y');\r\n                                if (x && y) {\r\n                                    return [x, y];\r\n                                } else {\r\n                                    if (element.parentNode) {\r\n                                        return getCellCoords(element.parentNode);\r\n                                    }\r\n                                }\r\n                            };\r\n\r\n                            var position = getCellCoords(e.target);\r\n                            if (position) {\r\n\r\n                                var columnId = position[0];\r\n                                var rowId = position[1];\r\n                                // Close edition\r\n                                if (jexcel.current.edition) {\r\n                                    if (jexcel.current.edition[2] != columnId || jexcel.current.edition[3] != rowId) {\r\n                                        jexcel.current.closeEditor(jexcel.current.edition[0], true);\r\n                                    }\r\n                                }\r\n\r\n                                if (! jexcel.current.edition) {\r\n                                    // Update cell selection\r\n                                    if (e.shiftKey) {\r\n                                        jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0], jexcel.current.selectedCell[1], columnId, rowId);\r\n                                    } else {\r\n                                        jexcel.current.updateSelectionFromCoords(columnId, rowId);\r\n                                    }\r\n                                }\r\n\r\n                                // No full row selected\r\n                                jexcel.current.selectedHeader = null;\r\n                                jexcel.current.selectedRow = null;\r\n                            }\r\n                        }\r\n                    }\r\n                } else {\r\n                    jexcel.current.selectedRow = false;\r\n                }\r\n    \r\n                // Pagination\r\n                if (e.target.classList.contains('jexcel_page')) {\r\n                    if (e.target.innerText == '<') {\r\n                        jexcel.current.page(0);\r\n                    } else if (e.target.innerText == '>') {\r\n                        jexcel.current.page(e.target.getAttribute('title') - 1);\r\n                    } else {\r\n                        jexcel.current.page(e.target.innerText - 1);\r\n                    }\r\n                }\r\n            }\r\n    \r\n            if (jexcel.current.edition) {\r\n                jexcel.isMouseAction = false;\r\n            } else {\r\n                jexcel.isMouseAction = true;\r\n            }\r\n        } else {\r\n            jexcel.isMouseAction = false;\r\n        }\r\n    }\r\n    \r\n    jexcel.mouseUpControls = function(e) {\r\n        if (jexcel.current) {\r\n            // Update cell size\r\n            if (jexcel.current.resizing) {\r\n                // Columns to be updated\r\n                if (jexcel.current.resizing.column) {\r\n                    // New width\r\n                    var newWidth = jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute('width');\r\n                    // Columns\r\n                    var columns = jexcel.current.getSelectedColumns();\r\n                    if (columns.length > 1) {\r\n                        var currentWidth = [];\r\n                        for (var i = 0; i < columns.length; i++) {\r\n                            currentWidth.push(parseInt(jexcel.current.colgroup[columns[i]].getAttribute('width')));\r\n                        }\r\n                        // Previous width\r\n                        var index = columns.indexOf(parseInt(jexcel.current.resizing.column));\r\n                        currentWidth[index] = jexcel.current.resizing.width;\r\n                        jexcel.current.setWidth(columns, newWidth, currentWidth);\r\n                    } else {\r\n                        jexcel.current.setWidth(jexcel.current.resizing.column, newWidth, jexcel.current.resizing.width);\r\n                    }\r\n                    // Remove border\r\n                    jexcel.current.headers[jexcel.current.resizing.column].classList.remove('resizing');\r\n                    for (var j = 0; j < jexcel.current.records.length; j++) {\r\n                        if (jexcel.current.records[j][jexcel.current.resizing.column]) {\r\n                            jexcel.current.records[j][jexcel.current.resizing.column].classList.remove('resizing');\r\n                        }\r\n                    }\r\n                } else {\r\n                    // Remove Class\r\n                    jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove('resizing');\r\n                    var newHeight = jexcel.current.rows[jexcel.current.resizing.row].getAttribute('height');\r\n                    jexcel.current.setHeight(jexcel.current.resizing.row, newHeight, jexcel.current.resizing.height);\r\n                    // Remove border\r\n                    jexcel.current.resizing.element.classList.remove('resizing');\r\n                }\r\n                // Reset resizing helper\r\n                jexcel.current.resizing = null;\r\n            } else if (jexcel.current.dragging) {\r\n                // Reset dragging helper\r\n                if (jexcel.current.dragging) {\r\n                    if (jexcel.current.dragging.column) {\r\n                        // Target\r\n                        var columnId = e.target.getAttribute('data-x');\r\n                        // Remove move style\r\n                        jexcel.current.headers[jexcel.current.dragging.column].classList.remove('dragging');\r\n                        for (var j = 0; j < jexcel.current.rows.length; j++) {\r\n                            if (jexcel.current.records[j][jexcel.current.dragging.column]) {\r\n                                jexcel.current.records[j][jexcel.current.dragging.column].classList.remove('dragging');\r\n                            }\r\n                        }\r\n                        for (var i = 0; i < jexcel.current.headers.length; i++) {\r\n                            jexcel.current.headers[i].classList.remove('dragging-left');\r\n                            jexcel.current.headers[i].classList.remove('dragging-right');\r\n                        }\r\n                        // Update position\r\n                        if (columnId) {\r\n                            if (jexcel.current.dragging.column != jexcel.current.dragging.destination) {\r\n                                jexcel.current.moveColumn(jexcel.current.dragging.column, jexcel.current.dragging.destination);\r\n                            }\r\n                        }\r\n                    } else {\r\n                        if (jexcel.current.dragging.element.nextSibling) {\r\n                            var position = parseInt(jexcel.current.dragging.element.nextSibling.getAttribute('data-y'));\r\n                            if (jexcel.current.dragging.row < position) {\r\n                                position -= 1;\r\n                            }\r\n                        } else {\r\n                            var position = parseInt(jexcel.current.dragging.element.previousSibling.getAttribute('data-y'));\r\n                        }\r\n                        if (jexcel.current.dragging.row != jexcel.current.dragging.destination) {\r\n                            jexcel.current.moveRow(jexcel.current.dragging.row, position, true);\r\n                        }\r\n                        jexcel.current.dragging.element.classList.remove('dragging');\r\n                    }\r\n                    jexcel.current.dragging = null;\r\n                }\r\n            } else {\r\n                // Close any corner selection\r\n                if (jexcel.current.selectedCorner) {\r\n                    jexcel.current.selectedCorner = false;\r\n    \r\n                    // Data to be copied\r\n                    if (jexcel.current.selection.length > 0) {\r\n                        // Copy data\r\n                        jexcel.current.copyData(jexcel.current.selection[0], jexcel.current.selection[jexcel.current.selection.length - 1]);\r\n    \r\n                        // Remove selection\r\n                        jexcel.current.removeCopySelection();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Clear any time control\r\n        if (jexcel.timeControl) {\r\n            clearTimeout(jexcel.timeControl);\r\n            jexcel.timeControl = null;\r\n        }\r\n    \r\n        // Mouse up\r\n        jexcel.isMouseAction = false;\r\n    }\r\n    \r\n    // Mouse move controls\r\n    jexcel.mouseMoveControls = function(e) {\r\n        e = e || window.event;\r\n        if (e.buttons) {\r\n            var mouseButton = e.buttons;\r\n        } else if (e.button) {\r\n            var mouseButton = e.button;\r\n        } else {\r\n            var mouseButton = e.which;\r\n        }\r\n    \r\n        if (! mouseButton) {\r\n            jexcel.isMouseAction = false;\r\n        }\r\n    \r\n        if (jexcel.current) {\r\n            if (jexcel.isMouseAction == true) {\r\n                // Resizing is ongoing\r\n                if (jexcel.current.resizing) {\r\n                    if (jexcel.current.resizing.column) {\r\n                        var width = e.pageX - jexcel.current.resizing.mousePosition;\r\n    \r\n                        if (jexcel.current.resizing.width + width > 0) {\r\n                            var tempWidth = jexcel.current.resizing.width + width;\r\n                            jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute('width', tempWidth);\r\n    \r\n                            jexcel.current.updateCornerPosition();\r\n                        }\r\n                    } else {\r\n                        var height = e.pageY - jexcel.current.resizing.mousePosition;\r\n    \r\n                        if (jexcel.current.resizing.height + height > 0) {\r\n                            var tempHeight = jexcel.current.resizing.height + height;\r\n                            jexcel.current.rows[jexcel.current.resizing.row].setAttribute('height', tempHeight);\r\n    \r\n                            jexcel.current.updateCornerPosition();\r\n                        }\r\n                    }\r\n                }\r\n            } else {\r\n                var x = e.target.getAttribute('data-x');\r\n                var y = e.target.getAttribute('data-y');\r\n                var rect = e.target.getBoundingClientRect();\r\n    \r\n                if (jexcel.current.cursor) {\r\n                    jexcel.current.cursor.style.cursor = '';\r\n                    jexcel.current.cursor = null;\r\n                }\r\n\r\n                if (e.target.parentNode.parentNode && e.target.parentNode.parentNode.className) {\r\n                    if (e.target.parentNode.parentNode.classList.contains('resizable')) {\r\n                        if (e.target && x && ! y && (rect.width - (e.clientX - rect.left) < 6)) {\r\n                            jexcel.current.cursor = e.target;\r\n                            jexcel.current.cursor.style.cursor = 'col-resize';\r\n                        } else if (e.target && ! x && y && (rect.height - (e.clientY - rect.top) < 6)) {\r\n                            jexcel.current.cursor = e.target;\r\n                            jexcel.current.cursor.style.cursor = 'row-resize';\r\n                        }\r\n                    }\r\n    \r\n                    if (e.target.parentNode.parentNode.classList.contains('draggable')) {\r\n                        if (e.target && ! x && y && (rect.width - (e.clientX - rect.left) < 6)) {\r\n                            jexcel.current.cursor = e.target;\r\n                            jexcel.current.cursor.style.cursor = 'move';\r\n                        } else if (e.target && x && ! y && (rect.height - (e.clientY - rect.top) < 6)) {\r\n                            jexcel.current.cursor = e.target;\r\n                            jexcel.current.cursor.style.cursor = 'move';\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    jexcel.mouseOverControls = function(e) {\r\n        e = e || window.event;\r\n        if (e.buttons) {\r\n            var mouseButton = e.buttons;\r\n        } else if (e.button) {\r\n            var mouseButton = e.button;\r\n        } else {\r\n            var mouseButton = e.which;\r\n        }\r\n    \r\n        if (! mouseButton) {\r\n            jexcel.isMouseAction = false;\r\n        }\r\n    \r\n        if (jexcel.current && jexcel.isMouseAction == true) {\r\n            // Get elements\r\n            var jexcelTable = jexcel.getElement(e.target);\r\n    \r\n            if (jexcelTable[0]) {\r\n                // Avoid cross reference\r\n                if (jexcel.current != jexcelTable[0].jexcel) {\r\n                    if (jexcel.current) {\r\n                        return false;\r\n                    }\r\n                }\r\n    \r\n                var columnId = e.target.getAttribute('data-x');\r\n                var rowId = e.target.getAttribute('data-y');\r\n    \r\n                if (jexcel.current.dragging) {\r\n                    if (jexcel.current.dragging.column) {\r\n                        if (columnId) {\r\n                            if (jexcel.current.isColMerged(columnId).length) {\r\n                                console.error('Jspreadsheet: This column is part of a merged cell.');\r\n                            } else {\r\n                                for (var i = 0; i < jexcel.current.headers.length; i++) {\r\n                                    jexcel.current.headers[i].classList.remove('dragging-left');\r\n                                    jexcel.current.headers[i].classList.remove('dragging-right');\r\n                                }\r\n    \r\n                                if (jexcel.current.dragging.column == columnId) {\r\n                                    jexcel.current.dragging.destination = parseInt(columnId);\r\n                                } else {\r\n                                    if (e.target.clientWidth / 2 > e.offsetX) {\r\n                                        if (jexcel.current.dragging.column < columnId) {\r\n                                            jexcel.current.dragging.destination = parseInt(columnId) - 1;\r\n                                        } else {\r\n                                            jexcel.current.dragging.destination = parseInt(columnId);\r\n                                        }\r\n                                        jexcel.current.headers[columnId].classList.add('dragging-left');\r\n                                    } else {\r\n                                        if (jexcel.current.dragging.column < columnId) {\r\n                                            jexcel.current.dragging.destination = parseInt(columnId);\r\n                                        } else {\r\n                                            jexcel.current.dragging.destination = parseInt(columnId) + 1;\r\n                                        }\r\n                                        jexcel.current.headers[columnId].classList.add('dragging-right');\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    } else {\r\n                        if (rowId) {\r\n                            if (jexcel.current.isRowMerged(rowId).length) {\r\n                                console.error('Jspreadsheet: This row is part of a merged cell.');\r\n                            } else {\r\n                                var target = (e.target.clientHeight / 2 > e.offsetY) ? e.target.parentNode.nextSibling : e.target.parentNode;\r\n                                if (jexcel.current.dragging.element != target) {\r\n                                    e.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element, target);\r\n                                    jexcel.current.dragging.destination = Array.prototype.indexOf.call(jexcel.current.dragging.element.parentNode.children, jexcel.current.dragging.element);\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                } else if (jexcel.current.resizing) {\r\n                } else {\r\n                    // Header found\r\n                    if (jexcelTable[1] == 1) {\r\n                        if (jexcel.current.selectedHeader) {\r\n                            var columnId = e.target.getAttribute('data-x');\r\n                            var o = jexcel.current.selectedHeader;\r\n                            var d = columnId;\r\n                            // Update selection\r\n                            jexcel.current.updateSelectionFromCoords(o, 0, d, jexcel.current.options.data.length - 1);\r\n                        }\r\n                    }\r\n    \r\n                    // Body found\r\n                    if (jexcelTable[1] == 2) {\r\n                        if (e.target.classList.contains('jexcel_row')) {\r\n                            if (jexcel.current.selectedRow) {\r\n                                var o = jexcel.current.selectedRow;\r\n                                var d = rowId;\r\n                                // Update selection\r\n                                jexcel.current.updateSelectionFromCoords(0, o, jexcel.current.options.data[0].length - 1, d);\r\n                            }\r\n                        } else {\r\n                            // Do not select edtion is in progress\r\n                            if (! jexcel.current.edition) {\r\n                                if (columnId && rowId) {\r\n                                    if (jexcel.current.selectedCorner) {\r\n                                        jexcel.current.updateCopySelection(columnId, rowId);\r\n                                    } else {\r\n                                        if (jexcel.current.selectedCell) {\r\n                                            jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0], jexcel.current.selectedCell[1], columnId, rowId);\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    \r\n        // Clear any time control\r\n        if (jexcel.timeControl) {\r\n            clearTimeout(jexcel.timeControl);\r\n            jexcel.timeControl = null;\r\n        }\r\n    }\r\n    \r\n    /**\r\n     * Double click event handler: controls the double click in the corner, cell edition or column re-ordering.\r\n     */\r\n    jexcel.doubleClickControls = function(e) {\r\n        // Jexcel is selected\r\n        if (jexcel.current) {\r\n            // Corner action\r\n            if (e.target.classList.contains('jexcel_corner')) {\r\n                // Any selected cells\r\n                if (jexcel.current.highlighted.length > 0) {\r\n                    // Copy from this\r\n                    var x1 = jexcel.current.highlighted[0].getAttribute('data-x');\r\n                    var y1 = parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length - 1].getAttribute('data-y')) + 1;\r\n                    // Until this\r\n                    var x2 = jexcel.current.highlighted[jexcel.current.highlighted.length - 1].getAttribute('data-x');\r\n                    var y2 = jexcel.current.records.length - 1\r\n                    // Execute copy\r\n                    jexcel.current.copyData(jexcel.current.records[y1][x1], jexcel.current.records[y2][x2]);\r\n                }\r\n            } else if (e.target.classList.contains('jexcel_column_filter')) {\r\n                // Column\r\n                var columnId = e.target.getAttribute('data-x');\r\n                // Open filter\r\n                jexcel.current.openFilter(columnId);\r\n                \r\n            } else {\r\n                // Get table\r\n                var jexcelTable = jexcel.getElement(e.target);\r\n    \r\n                // Double click over header\r\n                if (jexcelTable[1] == 1 && jexcel.current.options.columnSorting == true) {\r\n                    // Check valid column header coords\r\n                    var columnId = e.target.getAttribute('data-x');\r\n                    if (columnId) {\r\n                        jexcel.current.orderBy(columnId);\r\n                    }\r\n                }\r\n    \r\n                // Double click over body\r\n                if (jexcelTable[1] == 2 && jexcel.current.options.editable == true) {\r\n                    if (! jexcel.current.edition) {\r\n                        var getCellCoords = function(element) {\r\n                            if (element.parentNode) {\r\n                                var x = element.getAttribute('data-x');\r\n                                var y = element.getAttribute('data-y');\r\n                                if (x && y) {\r\n                                    return element;\r\n                                } else {\r\n                                    return getCellCoords(element.parentNode);\r\n                                }\r\n                            }\r\n                        }\r\n                        var cell = getCellCoords(e.target);\r\n                        if (cell && cell.classList.contains('highlight')) {\r\n                            jexcel.current.openEditor(cell);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    jexcel.copyControls = function(e) {\r\n        if (jexcel.current && jexcel.copyControls.enabled) {\r\n            if (! jexcel.current.edition) {\r\n                jexcel.current.copy(true);\r\n            }\r\n        }\r\n    }\r\n    \r\n    jexcel.cutControls = function(e) {\r\n        if (jexcel.current) {\r\n            if (! jexcel.current.edition) {\r\n                jexcel.current.copy(true);\r\n                if (jexcel.current.options.editable == true) {\r\n                    jexcel.current.setValue(jexcel.current.highlighted, '');\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    jexcel.pasteControls = function(e) {\r\n        if (jexcel.current && jexcel.current.selectedCell) {\r\n            if (! jexcel.current.edition) {\r\n                if (jexcel.current.options.editable == true) {\r\n                    if (e && e.clipboardData) {\r\n                        jexcel.current.paste(jexcel.current.selectedCell[0], jexcel.current.selectedCell[1], e.clipboardData.getData('text'));\r\n                        e.preventDefault();\r\n                    } else if (window.clipboardData) {\r\n                        jexcel.current.paste(jexcel.current.selectedCell[0], jexcel.current.selectedCell[1], window.clipboardData.getData('text'));\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    jexcel.contextMenuControls = function(e) {\r\n        e = e || window.event;\r\n        if (\"buttons\" in e) {\r\n            var mouseButton = e.buttons;\r\n        } else {\r\n            var mouseButton = e.which || e.button;\r\n        }\r\n    \r\n        if (jexcel.current) {\r\n            if (jexcel.current.edition) {\r\n                e.preventDefault();\r\n            } else if (jexcel.current.options.contextMenu) {\r\n                jexcel.current.contextMenu.contextmenu.close();\r\n    \r\n                if (jexcel.current) {\r\n                    var x = e.target.getAttribute('data-x');\r\n                    var y = e.target.getAttribute('data-y');\r\n    \r\n                    if (x || y) {\r\n                        if ((x < parseInt(jexcel.current.selectedCell[0])) || (x > parseInt(jexcel.current.selectedCell[2])) ||\r\n                            (y < parseInt(jexcel.current.selectedCell[1])) || (y > parseInt(jexcel.current.selectedCell[3])))\r\n                        {\r\n                            jexcel.current.updateSelectionFromCoords(x, y, x, y);\r\n                        }\r\n\r\n                        // Table found\r\n                        var items = jexcel.current.options.contextMenu(jexcel.current, x, y, e);\r\n                        // The id is depending on header and body\r\n                        jexcel.current.contextMenu.contextmenu.open(e, items);\r\n                        // Avoid the real one\r\n                        e.preventDefault();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    jexcel.touchStartControls = function(e) {\r\n        var jexcelTable = jexcel.getElement(e.target);\r\n    \r\n        if (jexcelTable[0]) {\r\n            if (jexcel.current != jexcelTable[0].jexcel) {\r\n                if (jexcel.current) {\r\n                    jexcel.current.resetSelection();\r\n                }\r\n                jexcel.current = jexcelTable[0].jexcel;\r\n            }\r\n        } else {\r\n            if (jexcel.current) {\r\n                jexcel.current.resetSelection();\r\n                jexcel.current = null;\r\n            }\r\n        }\r\n    \r\n        if (jexcel.current) {\r\n            if (! jexcel.current.edition) {\r\n                var columnId = e.target.getAttribute('data-x');\r\n                var rowId = e.target.getAttribute('data-y');\r\n    \r\n                if (columnId && rowId) {\r\n                    jexcel.current.updateSelectionFromCoords(columnId, rowId);\r\n    \r\n                    jexcel.timeControl = setTimeout(function() {\r\n                        // Keep temporary reference to the element\r\n                        if (jexcel.current.options.columns[columnId].type == 'color') {\r\n                            jexcel.tmpElement = null;\r\n                        } else {\r\n                            jexcel.tmpElement = e.target;\r\n                        }\r\n                        jexcel.current.openEditor(e.target, false, e);\r\n                    }, 500);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n    jexcel.touchEndControls = function(e) {\r\n        // Clear any time control\r\n        if (jexcel.timeControl) {\r\n            clearTimeout(jexcel.timeControl);\r\n            jexcel.timeControl = null;\r\n            // Element\r\n            if (jexcel.tmpElement && jexcel.tmpElement.children[0].tagName == 'INPUT') {\r\n                jexcel.tmpElement.children[0].focus();\r\n            }\r\n            jexcel.tmpElement = null;\r\n        }\r\n    }\r\n    \r\n    /**\r\n     * Jexcel extensions\r\n     */\r\n    \r\n    jexcel.tabs = function(tabs, result) {\r\n        var instances = [];\r\n        // Create tab container\r\n        if (! tabs.classList.contains('jexcel_tabs')) {\r\n            tabs.innerHTML = '';\r\n            tabs.classList.add('jexcel_tabs')\r\n            tabs.jexcel = [];\r\n\r\n            var div = document.createElement('div');\r\n            var headers = tabs.appendChild(div);\r\n            var div = document.createElement('div');\r\n            var content = tabs.appendChild(div);\r\n        } else {\r\n            var headers = tabs.children[0];\r\n            var content = tabs.children[1];\r\n        }\r\n\r\n        var spreadsheet = []\r\n        var link = [];\r\n        for (var i = 0; i < result.length; i++) {\r\n            // Spreadsheet container\r\n            spreadsheet[i] = document.createElement('div');\r\n            spreadsheet[i].classList.add('jexcel_tab');\r\n            var worksheet = jexcel(spreadsheet[i], result[i]);\r\n            content.appendChild(spreadsheet[i]);\r\n            instances[i] = tabs.jexcel.push(worksheet);\r\n\r\n            // Tab link\r\n            link[i] = document.createElement('div');\r\n            link[i].classList.add('jexcel_tab_link');\r\n            link[i].setAttribute('data-spreadsheet', tabs.jexcel.length-1);\r\n            link[i].innerHTML = result[i].sheetName;\r\n            link[i].onclick = function() {\r\n                for (var j = 0; j < headers.children.length; j++) {\r\n                    headers.children[j].classList.remove('selected');\r\n                    content.children[j].style.display = 'none';\r\n                }\r\n                var i = this.getAttribute('data-spreadsheet');\r\n                content.children[i].style.display = 'block';\r\n                headers.children[i].classList.add('selected')\r\n            }\r\n            headers.appendChild(link[i]);\r\n        }\r\n\r\n        // First tab\r\n        for (var j = 0; j < headers.children.length; j++) {\r\n            headers.children[j].classList.remove('selected');\r\n            content.children[j].style.display = 'none';\r\n        }\r\n        headers.children[headers.children.length - 1].classList.add('selected');\r\n        content.children[headers.children.length - 1].style.display = 'block';\r\n\r\n        return instances;\r\n    }\r\n\r\n    // Compability to older versions\r\n    jexcel.createTabs = jexcel.tabs;\r\n\r\n    jexcel.fromSpreadsheet = function(file, __callback) {\r\n        var convert = function(workbook) {\r\n            var spreadsheets = [];\r\n            workbook.SheetNames.forEach(function(sheetName) {\r\n                var spreadsheet = {};\r\n                spreadsheet.rows = [];\r\n                spreadsheet.columns = [];\r\n                spreadsheet.data = [];\r\n                spreadsheet.style = {};\r\n                spreadsheet.sheetName = sheetName;\r\n    \r\n                // Column widths\r\n                var temp = workbook.Sheets[sheetName]['!cols'];\r\n                if (temp && temp.length) {\r\n                    for (var i = 0; i < temp.length; i++) {\r\n                        spreadsheet.columns[i] = {};\r\n                        if (temp[i] && temp[i].wpx) {\r\n                            spreadsheet.columns[i].width = temp[i].wpx + 'px';\r\n                        }\r\n                     }\r\n                }\r\n                // Rows heights\r\n                var temp = workbook.Sheets[sheetName]['!rows'];\r\n                if (temp && temp.length) {\r\n                    for (var i = 0; i < temp.length; i++) {\r\n                        if (temp[i] && temp[i].hpx) {\r\n                            spreadsheet.rows[i] = {};\r\n                            spreadsheet.rows[i].height = temp[i].hpx + 'px';\r\n                        }\r\n                    }\r\n                }\r\n                // Merge cells\r\n                var temp = workbook.Sheets[sheetName]['!merges'];\r\n                if (temp && temp.length > 0) {\r\n                    spreadsheet.mergeCells = [];\r\n                    for (var i = 0; i < temp.length; i++) {\r\n                        var x1 = temp[i].s.c;\r\n                        var y1 = temp[i].s.r;\r\n                        var x2 = temp[i].e.c;\r\n                        var y2 = temp[i].e.r;\r\n                        var key = jexcel.getColumnNameFromId([x1,y1]);\r\n                        spreadsheet.mergeCells[key] = [ x2-x1+1, y2-y1+1 ];\r\n                    }\r\n                }\r\n                // Data container\r\n                var max_x = 0;\r\n                var max_y = 0;\r\n                var temp = Object.keys(workbook.Sheets[sheetName]);\r\n                for (var i = 0; i < temp.length; i++) {\r\n                    if (temp[i].substr(0,1) != '!') {\r\n                        var cell = workbook.Sheets[sheetName][temp[i]];\r\n                        var info = jexcel.getIdFromColumnName(temp[i], true);\r\n                        if (! spreadsheet.data[info[1]]) {\r\n                            spreadsheet.data[info[1]] = [];\r\n                        }\r\n                        spreadsheet.data[info[1]][info[0]] = cell.f ? '=' + cell.f : cell.w;\r\n                        if (max_x < info[0]) {\r\n                            max_x = info[0];\r\n                        }\r\n                        if (max_y < info[1]) {\r\n                            max_y = info[1];\r\n                        }\r\n                        // Style\r\n                        if (cell.style && Object.keys(cell.style).length > 0) {\r\n                            spreadsheet.style[temp[i]] = cell.style;\r\n                        }\r\n                        if (cell.s && cell.s.fgColor) {\r\n                            if (spreadsheet.style[temp[i]]) {\r\n                                spreadsheet.style[temp[i]] += ';';\r\n                            }\r\n                            spreadsheet.style[temp[i]] += 'background-color:#' + cell.s.fgColor.rgb;\r\n                        }\r\n                    }\r\n                }\r\n                var numColumns = spreadsheet.columns;\r\n                for (var j = 0; j <= max_y; j++) {\r\n                    for (var i = 0; i <= max_x; i++) {\r\n                        if (! spreadsheet.data[j]) {\r\n                            spreadsheet.data[j] = [];\r\n                        }\r\n                        if (! spreadsheet.data[j][i]) {\r\n                            if (numColumns < i) {\r\n                                spreadsheet.data[j][i] = '';\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                spreadsheets.push(spreadsheet);\r\n            });\r\n    \r\n            return spreadsheets;\r\n        }\r\n    \r\n        var oReq;\r\n        oReq = new XMLHttpRequest();\r\n        oReq.open(\"GET\", file, true);\r\n    \r\n        if(typeof Uint8Array !== 'undefined') {\r\n            oReq.responseType = \"arraybuffer\";\r\n            oReq.onload = function(e) {\r\n                var arraybuffer = oReq.response;\r\n                var data = new Uint8Array(arraybuffer);\r\n                var wb = XLSX.read(data, {type:\"array\", cellFormula:true, cellStyles:true });\r\n                __callback(convert(wb))\r\n            };\r\n        } else {\r\n            oReq.setRequestHeader(\"Accept-Charset\", \"x-user-defined\");  \r\n            oReq.onreadystatechange = function() { if(oReq.readyState == 4 && oReq.status == 200) {\r\n                var ff = convertResponseBodyToText(oReq.responseBody);\r\n                var wb = XLSX.read(ff, {type:\"binary\", cellFormula:true, cellStyles:true });\r\n                __callback(convert(wb))\r\n            }};\r\n        }\r\n    \r\n        oReq.send();\r\n    }\r\n    \r\n    /**\r\n     * Valid international letter\r\n     */\r\n    \r\n    jexcel.validLetter = function (text) {\r\n        var regex = /([\\u0041-\\u005A\\u0061-\\u007A\\u00AA\\u00B5\\u00BA\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0\\u08A2-\\u08AC\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097F\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C33\\u0C35-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191C\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA697\\uA6A0-\\uA6E5\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA793\\uA7A0-\\uA7AA\\uA7F8-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA80-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC-\\u0400-\\u04FF']+)/g;\r\n        return text.match(regex) ? 1 : 0;\r\n    }\r\n    \r\n    /**\r\n     * Helper injectArray\r\n     */\r\n    jexcel.injectArray = function(o, idx, arr) {\r\n        return o.slice(0, idx).concat(arr).concat(o.slice(idx));\r\n    }\r\n    \r\n    /**\r\n     * Get letter based on a number\r\n     * \r\n     * @param integer i\r\n     * @return string letter\r\n     */\r\n    jexcel.getColumnName = function(i) {\r\n        var letter = '';\r\n        if (i > 701) {\r\n            letter += String.fromCharCode(64 + parseInt(i / 676));\r\n            letter += String.fromCharCode(64 + parseInt((i % 676) / 26));\r\n        } else if (i > 25) {\r\n            letter += String.fromCharCode(64 + parseInt(i / 26));\r\n        }\r\n        letter += String.fromCharCode(65 + (i % 26));\r\n    \r\n        return letter;\r\n    }\r\n    \r\n    /**\r\n     * Convert excel like column to jexcel id\r\n     * \r\n     * @param string id\r\n     * @return string id\r\n     */\r\n    jexcel.getIdFromColumnName = function (id, arr) {\r\n        // Get the letters\r\n        var t = /^[a-zA-Z]+/.exec(id);\r\n    \r\n        if (t) {\r\n            // Base 26 calculation\r\n            var code = 0;\r\n            for (var i = 0; i < t[0].length; i++) {\r\n                code += parseInt(t[0].charCodeAt(i) - 64) * Math.pow(26, (t[0].length - 1 - i));\r\n            }\r\n            code--;\r\n            // Make sure jexcel starts on zero\r\n            if (code < 0) {\r\n                code = 0;\r\n            }\r\n    \r\n            // Number\r\n            var number = parseInt(/[0-9]+$/.exec(id));\r\n            if (number > 0) {\r\n                number--;\r\n            }\r\n    \r\n            if (arr == true) {\r\n                id = [ code, number ];\r\n            } else {\r\n                id = code + '-' + number;\r\n            }\r\n        }\r\n    \r\n        return id;\r\n    }\r\n    \r\n    /**\r\n     * Convert jexcel id to excel like column name\r\n     * \r\n     * @param string id\r\n     * @return string id\r\n     */\r\n    jexcel.getColumnNameFromId = function (cellId) {\r\n        if (! Array.isArray(cellId)) {\r\n            cellId = cellId.split('-');\r\n        }\r\n    \r\n        return jexcel.getColumnName(parseInt(cellId[0])) + (parseInt(cellId[1]) + 1);\r\n    }\r\n    \r\n    /**\r\n     * Verify element inside jexcel table\r\n     * \r\n     * @param string id\r\n     * @return string id\r\n     */\r\n    jexcel.getElement = function(element) {\r\n        var jexcelSection = 0;\r\n        var jexcelElement = 0;\r\n    \r\n        function path (element) {\r\n            if (element.className) {\r\n                if (element.classList.contains('jexcel_container')) {\r\n                    jexcelElement = element;\r\n                }\r\n            }\r\n    \r\n            if (element.tagName == 'THEAD') {\r\n                jexcelSection = 1;\r\n            } else if (element.tagName == 'TBODY') {\r\n                jexcelSection = 2;\r\n            }\r\n    \r\n            if (element.parentNode) {\r\n                if (! jexcelElement) {\r\n                    path(element.parentNode);\r\n                }\r\n            }\r\n        }\r\n    \r\n        path(element);\r\n    \r\n        return [ jexcelElement, jexcelSection ];\r\n    }\r\n\r\n    jexcel.doubleDigitFormat = function(v) {\r\n        v = ''+v;\r\n        if (v.length == 1) {\r\n            v = '0'+v;\r\n        }\r\n        return v;\r\n    }\r\n\r\n    jexcel.createFromTable = function(el, options) {\r\n        if (el.tagName != 'TABLE') {\r\n            console.log('Element is not a table');\r\n        } else {\r\n            // Configuration\r\n            if (! options) {\r\n                options = {};\r\n            }\r\n            options.columns = [];\r\n            options.data = [];\r\n\r\n            // Colgroup\r\n            var colgroup = el.querySelectorAll('colgroup > col');\r\n            if (colgroup.length) {\r\n                // Get column width\r\n                for (var i = 0; i < colgroup.length; i++) {\r\n                    var width = colgroup[i].style.width;\r\n                    if (! width) {\r\n                        var width = colgroup[i].getAttribute('width');\r\n                    }\r\n                    // Set column width\r\n                    if (width) {\r\n                        if (! options.columns[i]) {\r\n                            options.columns[i] = {}\r\n                        }\r\n                        options.columns[i].width = width;\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Parse header\r\n            var parseHeader = function(header) {\r\n                // Get width information\r\n                var info = header.getBoundingClientRect();\r\n                var width = info.width > 50 ? info.width : 50;\r\n\r\n                // Create column option\r\n                if (! options.columns[i]) {\r\n                    options.columns[i] = {};\r\n                } \r\n                if (header.getAttribute('data-celltype')) {\r\n                    options.columns[i].type = header.getAttribute('data-celltype');\r\n                } else {\r\n                    options.columns[i].type = 'text';\r\n                }\r\n                options.columns[i].width = width + 'px';\r\n                options.columns[i].title = header.innerHTML;\r\n                options.columns[i].align = header.style.textAlign || 'center';\r\n\r\n                if (info = header.getAttribute('name')) {\r\n                    options.columns[i].name = info;\r\n                }\r\n                if (info = header.getAttribute('id')) {\r\n                    options.columns[i].id = info;\r\n                }\r\n            }\r\n\r\n            // Headers\r\n            var nested = [];\r\n            var headers = el.querySelectorAll(':scope > thead > tr');\r\n            if (headers.length) {\r\n                for (var j = 0; j < headers.length - 1; j++) {\r\n                    var cells = [];\r\n                    for (var i = 0; i < headers[j].children.length; i++) {\r\n                        var row = {\r\n                            title: headers[j].children[i].innerText,\r\n                            colspan: headers[j].children[i].getAttribute('colspan') || 1,\r\n                        };\r\n                        cells.push(row);\r\n                    }\r\n                    nested.push(cells);\r\n                }\r\n                // Get the last row in the thead\r\n                headers = headers[headers.length-1].children;\r\n                // Go though the headers\r\n                for (var i = 0; i < headers.length; i++) {\r\n                    parseHeader(headers[i]);\r\n                }\r\n            }\r\n\r\n            // Content\r\n            var rowNumber = 0;\r\n            var mergeCells = {};\r\n            var rows = {};\r\n            var style = {};\r\n            var classes = {};\r\n\r\n            var content = el.querySelectorAll(':scope > tr, :scope > tbody > tr');\r\n            for (var j = 0; j < content.length; j++) {\r\n                options.data[rowNumber] = [];\r\n                if (options.parseTableFirstRowAsHeader == true && ! headers.length && j == 0) {\r\n                    for (var i = 0; i < content[j].children.length; i++) {\r\n                        parseHeader(content[j].children[i]);\r\n                    }\r\n                } else {\r\n                    for (var i = 0; i < content[j].children.length; i++) {\r\n                        // WickedGrid formula compatibility\r\n                        var value = content[j].children[i].getAttribute('data-formula');\r\n                        if (value) {\r\n                            if (value.substr(0,1) != '=') {\r\n                                value = '=' + value;\r\n                            }\r\n                        } else {\r\n                            var value = content[j].children[i].innerHTML;\r\n                        }\r\n                        options.data[rowNumber].push(value);\r\n\r\n                        // Key\r\n                        var cellName = jexcel.getColumnNameFromId([ i, j ]);\r\n\r\n                        // Classes\r\n                        var tmp = content[j].children[i].getAttribute('class');\r\n                        if (tmp) {\r\n                            classes[cellName] = tmp;\r\n                        }\r\n\r\n                        // Merged cells\r\n                        var mergedColspan = parseInt(content[j].children[i].getAttribute('colspan')) || 0;\r\n                        var mergedRowspan = parseInt(content[j].children[i].getAttribute('rowspan')) || 0;\r\n                        if (mergedColspan || mergedRowspan) {\r\n                            mergeCells[cellName] = [ mergedColspan || 1, mergedRowspan || 1 ];\r\n                        }\r\n\r\n                        // Avoid problems with hidden cells\r\n                        if (s = content[j].children[i].style && content[j].children[i].style.display == 'none') {\r\n                            content[j].children[i].style.display = '';\r\n                        }\r\n                        // Get style\r\n                        var s = content[j].children[i].getAttribute('style');\r\n                        if (s) {\r\n                            style[cellName] = s;\r\n                        }\r\n                        // Bold\r\n                        if (content[j].children[i].classList.contains('styleBold')) {\r\n                            if (style[cellName]) {\r\n                                style[cellName] += '; font-weight:bold;';\r\n                            } else {\r\n                                style[cellName] = 'font-weight:bold;';\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    // Row Height\r\n                    if (content[j].style && content[j].style.height) {\r\n                        rows[j] = { height: content[j].style.height };\r\n                    }\r\n\r\n                    // Index\r\n                    rowNumber++;\r\n                }\r\n            }\r\n\r\n            // Nested\r\n            if (Object.keys(nested).length > 0) {\r\n                options.nestedHeaders = nested;\r\n            }\r\n            // Style\r\n            if (Object.keys(style).length > 0) {\r\n                options.style = style;\r\n            }\r\n            // Merged\r\n            if (Object.keys(mergeCells).length > 0) {\r\n                options.mergeCells = mergeCells;\r\n            }\r\n            // Row height\r\n            if (Object.keys(rows).length > 0) {\r\n                options.rows = rows;\r\n            }\r\n            // Classes\r\n            if (Object.keys(classes).length > 0) {\r\n                options.classes = classes;\r\n            }\r\n\r\n            var content = el.querySelectorAll('tfoot tr');\r\n            if (content.length) {\r\n                var footers = [];\r\n                for (var j = 0; j < content.length; j++) {\r\n                    var footer = [];\r\n                    for (var i = 0; i < content[j].children.length; i++) {\r\n                        footer.push(content[j].children[i].innerText);\r\n                    }\r\n                    footers.push(footer);\r\n                }\r\n                if (Object.keys(footers).length > 0) {\r\n                    options.footers = footers;\r\n                }\r\n            }\r\n            // TODO: data-hiddencolumns=\"3,4\"\r\n            \r\n            // I guess in terms the better column type\r\n            if (options.parseTableAutoCellType == true) {\r\n                var pattern = [];\r\n                for (var i = 0; i < options.columns.length; i++) {\r\n                    var test = true;\r\n                    var testCalendar = true;\r\n                    pattern[i] = [];\r\n                    for (var j = 0; j < options.data.length; j++) {\r\n                        var value = options.data[j][i];\r\n                        if (! pattern[i][value]) {\r\n                            pattern[i][value] = 0;\r\n                        }\r\n                        pattern[i][value]++;\r\n                        if (value.length > 25) {\r\n                            test = false;\r\n                        }\r\n                        if (value.length == 10) {\r\n                            if (! (value.substr(4,1) == '-' && value.substr(7,1) == '-')) {\r\n                                testCalendar = false;\r\n                            }\r\n                        } else {\r\n                            testCalendar = false;\r\n                        }\r\n                    }\r\n\r\n                    var keys = Object.keys(pattern[i]).length;\r\n                    if (testCalendar) {\r\n                        options.columns[i].type = 'calendar';\r\n                    } else if (test == true && keys > 1 && keys <= parseInt(options.data.length * 0.1)) {\r\n                        options.columns[i].type = 'dropdown';\r\n                        options.columns[i].source = Object.keys(pattern[i]);\r\n                    }\r\n                }\r\n            }\r\n\r\n            return options;\r\n        }\r\n    }\r\n\r\n    // Helpers\r\n    jexcel.helpers = (function() {\r\n        var component = {};\r\n\r\n        /**\r\n         * Get carret position for one element\r\n         */\r\n        component.getCaretIndex = function(e) {\r\n            if (this.config.root) {\r\n                var d = this.config.root;\r\n            } else {\r\n                var d = window;\r\n            }\r\n            var pos = 0;\r\n            var s = d.getSelection();\r\n            if (s) {\r\n                if (s.rangeCount !== 0) {\r\n                    var r = s.getRangeAt(0);\r\n                    var p = r.cloneRange();\r\n                    p.selectNodeContents(e);\r\n                    p.setEnd(r.endContainer, r.endOffset);\r\n                    pos = p.toString().length;\r\n                }\r\n            }\r\n            return pos;\r\n        }\r\n\r\n        /**\r\n         * Invert keys and values\r\n         */\r\n        component.invert = function(o) {\r\n            var d = [];\r\n            var k = Object.keys(o);\r\n            for (var i = 0; i < k.length; i++) {\r\n                d[o[k[i]]] = k[i];\r\n            }\r\n            return d;\r\n        }\r\n\r\n        /**\r\n         * Get letter based on a number\r\n         *\r\n         * @param integer i\r\n         * @return string letter\r\n         */\r\n        component.getColumnName = function(i) {\r\n            var letter = '';\r\n            if (i > 701) {\r\n                letter += String.fromCharCode(64 + parseInt(i / 676));\r\n                letter += String.fromCharCode(64 + parseInt((i % 676) / 26));\r\n            } else if (i > 25) {\r\n                letter += String.fromCharCode(64 + parseInt(i / 26));\r\n            }\r\n            letter += String.fromCharCode(65 + (i % 26));\r\n\r\n            return letter;\r\n        }\r\n\r\n        /**\r\n         * Get column name from coords\r\n         */\r\n        component.getColumnNameFromCoords = function(x, y) {\r\n            return component.getColumnName(parseInt(x)) + (parseInt(y) + 1);\r\n        }\r\n\r\n        component.getCoordsFromColumnName = function(columnName) {\r\n            // Get the letters\r\n            var t = /^[a-zA-Z]+/.exec(columnName);\r\n\r\n            if (t) {\r\n                // Base 26 calculation\r\n                var code = 0;\r\n                for (var i = 0; i < t[0].length; i++) {\r\n                    code += parseInt(t[0].charCodeAt(i) - 64) * Math.pow(26, (t[0].length - 1 - i));\r\n                }\r\n                code--;\r\n                // Make sure jspreadsheet starts on zero\r\n                if (code < 0) {\r\n                    code = 0;\r\n                }\r\n\r\n                // Number\r\n                var number = parseInt(/[0-9]+$/.exec(columnName)) || null;\r\n                if (number > 0) {\r\n                    number--;\r\n                }\r\n\r\n                return [ code, number ];\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Extract json configuration from a TABLE DOM tag\r\n         */\r\n        component.createFromTable = function() {}\r\n\r\n        /**\r\n         * Helper injectArray\r\n         */\r\n        component.injectArray = function(o, idx, arr) {\r\n            return o.slice(0, idx).concat(arr).concat(o.slice(idx));\r\n        }\r\n\r\n        /**\r\n         * Parse CSV string to JS array\r\n         */\r\n        component.parseCSV = function(str, delimiter) {\r\n            // user-supplied delimeter or default comma\r\n            delimiter = (delimiter || \",\");\r\n\r\n            // Final data\r\n            var col = 0;\r\n            var row = 0;\r\n            var num = 0;\r\n            var data = [[]];\r\n            var limit = 0;\r\n            var flag = null;\r\n            var inside = false;\r\n            var closed = false;\r\n\r\n            // Go over all chars\r\n            for (var i = 0; i < str.length; i++) {\r\n                // Create new row\r\n                if (! data[row]) {\r\n                    data[row] = [];\r\n                }\r\n                // Create new column\r\n                if (! data[row][col]) {\r\n                    data[row][col] = '';\r\n                }\r\n\r\n                // Ignore\r\n                if (str[i] == '\\r') {\r\n                    continue;\r\n                }\r\n\r\n                // New row\r\n                if ((str[i] == '\\n' || str[i] == delimiter) && (inside == false || closed == true || ! flag)) {\r\n                    // Restart flags\r\n                    flag = null;\r\n                    inside = false;\r\n                    closed = false;\r\n\r\n                    if (data[row][col][0] == '\"') {\r\n                        var val = data[row][col].trim();\r\n                        if (val[val.length-1] == '\"') {\r\n                            data[row][col] = val.substr(1, val.length-2);\r\n                        }\r\n                    }\r\n\r\n                    // Go to the next cell\r\n                    if (str[i] == '\\n') {\r\n                        // New line\r\n                        col = 0;\r\n                        row++;\r\n                    } else {\r\n                        // New column\r\n                        col++;\r\n                        if (col > limit) {\r\n                            // Keep the reference of max column\r\n                            limit = col;\r\n                        }\r\n                    }\r\n                } else {\r\n                    // Inside quotes\r\n                    if (str[i] == '\"') {\r\n                        inside = ! inside;\r\n                    }\r\n\r\n                    if (flag === null) {\r\n                        flag = inside;\r\n                        if (flag == true) {\r\n                            continue;\r\n                        }\r\n                    } else if (flag === true && ! closed) {\r\n                        if (str[i] == '\"') {\r\n                            if (str[i+1] == '\"') {\r\n                                inside = true;\r\n                                data[row][col] += str[i];\r\n                                i++;\r\n                            } else {\r\n                                closed = true;\r\n                            }\r\n                            continue;\r\n                        }\r\n                    }\r\n\r\n                    data[row][col] += str[i];\r\n                }\r\n            }\r\n\r\n            // Make sure a square matrix is generated\r\n            for (var j = 0; j < data.length; j++) {\r\n                for (var i = 0; i <= limit; i++) {\r\n                    if (data[j][i] === undefined) {\r\n                        data[j][i] = '';\r\n                    }\r\n                }\r\n            }\r\n\r\n            return data;\r\n        }\r\n\r\n        return component;\r\n    })();\r\n\r\n    /**\r\n     * Jquery Support\r\n     */\r\n    if (typeof(jQuery) != 'undefined') {\r\n        (function($){\r\n            $.fn.jspreadsheet = $.fn.jexcel = function(mixed) {\r\n                var spreadsheetContainer = $(this).get(0);\r\n                if (! spreadsheetContainer.jexcel) {\r\n                    return jexcel($(this).get(0), arguments[0]);\r\n                } else {\r\n                    if (Array.isArray(spreadsheetContainer.jexcel)) {\r\n                        return spreadsheetContainer.jexcel[mixed][arguments[1]].apply(this, Array.prototype.slice.call( arguments, 2 ));\r\n                    } else {\r\n                        return spreadsheetContainer.jexcel[mixed].apply(this, Array.prototype.slice.call( arguments, 1 ));\r\n                    }\r\n                }\r\n            };\r\n    \r\n        })(jQuery);\r\n    }\r\n\r\n    return jexcel;\r\n})));","var uncurryThis = require('../internals/function-uncurry-this');\n\n// `thisNumberValue` abstract operation\n// https://tc39.es/ecma262/#sec-thisnumbervalue\nmodule.exports = uncurryThis(1.0.valueOf);\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/sass-resources-loader/lib/loader.js??ref--9-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Sheet.vue?vue&type=style&index=1&lang=scss&\"","'use strict';\nvar global = require('../internals/global');\nvar bind = require('../internals/function-bind-context');\nvar call = require('../internals/function-call');\nvar toObject = require('../internals/to-object');\nvar callWithSafeIterationClosing = require('../internals/call-with-safe-iteration-closing');\nvar isArrayIteratorMethod = require('../internals/is-array-iterator-method');\nvar isConstructor = require('../internals/is-constructor');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar createProperty = require('../internals/create-property');\nvar getIterator = require('../internals/get-iterator');\nvar getIteratorMethod = require('../internals/get-iterator-method');\n\nvar Array = global.Array;\n\n// `Array.from` method implementation\n// https://tc39.es/ecma262/#sec-array.from\nmodule.exports = function from(arrayLike /* , mapfn = undefined, thisArg = undefined */) {\n  var O = toObject(arrayLike);\n  var IS_CONSTRUCTOR = isConstructor(this);\n  var argumentsLength = arguments.length;\n  var mapfn = argumentsLength > 1 ? arguments[1] : undefined;\n  var mapping = mapfn !== undefined;\n  if (mapping) mapfn = bind(mapfn, argumentsLength > 2 ? arguments[2] : undefined);\n  var iteratorMethod = getIteratorMethod(O);\n  var index = 0;\n  var length, result, step, iterator, next, value;\n  // if the target is not iterable or it's an array with the default iterator - use a simple case\n  if (iteratorMethod && !(this == Array && isArrayIteratorMethod(iteratorMethod))) {\n    iterator = getIterator(O, iteratorMethod);\n    next = iterator.next;\n    result = IS_CONSTRUCTOR ? new this() : [];\n    for (;!(step = call(next, iterator)).done; index++) {\n      value = mapping ? callWithSafeIterationClosing(iterator, mapfn, [step.value, index], true) : step.value;\n      createProperty(result, index, value);\n    }\n  } else {\n    length = lengthOfArrayLike(O);\n    result = IS_CONSTRUCTOR ? new this(length) : Array(length);\n    for (;length > index; index++) {\n      value = mapping ? mapfn(O[index], index) : O[index];\n      createProperty(result, index, value);\n    }\n  }\n  result.length = index;\n  return result;\n};\n","// a string of all valid unicode whitespaces\nmodule.exports = '\\u0009\\u000A\\u000B\\u000C\\u000D\\u0020\\u00A0\\u1680\\u2000\\u2001\\u2002' +\n  '\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF';\n","var uncurryThis = require('../internals/function-uncurry-this');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar toString = require('../internals/to-string');\nvar whitespaces = require('../internals/whitespaces');\n\nvar replace = uncurryThis(''.replace);\nvar whitespace = '[' + whitespaces + ']';\nvar ltrim = RegExp('^' + whitespace + whitespace + '*');\nvar rtrim = RegExp(whitespace + whitespace + '*$');\n\n// `String.prototype.{ trim, trimStart, trimEnd, trimLeft, trimRight }` methods implementation\nvar createMethod = function (TYPE) {\n  return function ($this) {\n    var string = toString(requireObjectCoercible($this));\n    if (TYPE & 1) string = replace(string, ltrim, '');\n    if (TYPE & 2) string = replace(string, rtrim, '');\n    return string;\n  };\n};\n\nmodule.exports = {\n  // `String.prototype.{ trimLeft, trimStart }` methods\n  // https://tc39.es/ecma262/#sec-string.prototype.trimstart\n  start: createMethod(1),\n  // `String.prototype.{ trimRight, trimEnd }` methods\n  // https://tc39.es/ecma262/#sec-string.prototype.trimend\n  end: createMethod(2),\n  // `String.prototype.trim` method\n  // https://tc39.es/ecma262/#sec-string.prototype.trim\n  trim: createMethod(3)\n};\n","/**\r\n * (c) jSuites Javascript Web Components\r\n *\r\n * Website: https://jsuites.net\r\n * Description: Create amazing web based applications.\r\n *\r\n * MIT License\r\n *\r\n */\r\n;(function (global, factory) {\r\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\r\n    typeof define === 'function' && define.amd ? define(factory) :\r\n    global.jSuites = factory();\r\n}(this, (function () {\r\n\r\n    'use strict';\r\n\r\nvar jSuites = function(options) {\r\n    var obj = {}\r\n    var version = '4.9.27';\r\n\r\n    var find = function(DOMElement, component) {\r\n        if (DOMElement[component.type] && DOMElement[component.type] == component) {\r\n            return true;\r\n        }\r\n        if (DOMElement.parentNode) {\r\n            return find(DOMElement.parentNode, component);\r\n        }\r\n        return false;\r\n    }\r\n\r\n    var isOpened = function(element) {\r\n        if (jSuites.current.length > 0) {\r\n            for (var i = 0; i < jSuites.current.length; i++) {\r\n                if (jSuites.current[i] && ! find(element, jSuites.current[i])) {\r\n                    jSuites.current[i].close();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.init = function() {\r\n        var element = null;\r\n\r\n        document.addEventListener(\"mousedown\", function(e) {\r\n            if (e.changedTouches && e.changedTouches[0]) {\r\n                var x = e.changedTouches[0].clientX;\r\n                var y = e.changedTouches[0].clientY;\r\n            } else {\r\n                var x = e.clientX;\r\n                var y = e.clientY;\r\n            }\r\n\r\n            if (e.target && e.target.shadowRoot) {\r\n                var d = e.target.shadowRoot;\r\n            } else {\r\n                var d = document;\r\n            }\r\n\r\n            // Get the first target element\r\n            element = d.elementFromPoint(x, y);\r\n        });\r\n\r\n        document.addEventListener(\"click\", function(e) {\r\n            // Check opened components\r\n            isOpened(element);\r\n        });\r\n\r\n        obj.version = version;\r\n    }\r\n\r\n    obj.setExtensions = function(o) {\r\n        if (typeof(o) == 'object') {\r\n            var k = Object.keys(o);\r\n            for (var i = 0; i < k.length; i++) {\r\n                obj[k[i]] = o[k[i]];\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.tracking = function(component, state) {\r\n        if (state == true) {\r\n            jSuites.current = jSuites.current.filter(function(v) {\r\n                return v !== null;\r\n            });\r\n\r\n            // Start after all events\r\n            setTimeout(function() {\r\n                jSuites.current.push(component);\r\n            }, 0);\r\n\r\n        } else {\r\n            var index = jSuites.current.indexOf(component);\r\n            if (index >= 0) {\r\n                jSuites.current[index] = null;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get or set a property from a JSON from a string.\r\n     */\r\n    obj.path = function(str, val) {\r\n        str = str.split('.');\r\n        if (str.length) {\r\n            var o = this;\r\n            var p = null;\r\n            while (str.length > 1) {\r\n                // Get the property\r\n                p = str.shift();\r\n                // Check if the property exists\r\n                if (o.hasOwnProperty(p)) {\r\n                    o = o[p];\r\n                } else {\r\n                    // Property does not exists\r\n                    if (val === undefined) {\r\n                        return undefined;\r\n                    } else {\r\n                        // Create the property\r\n                        o[p] = {};\r\n                        // Next property\r\n                        o = o[p];\r\n                    }\r\n                }\r\n            }\r\n            // Get the property\r\n            p = str.shift();\r\n            // Set or get the value\r\n            if (val !== undefined) {\r\n                o[p] = val;\r\n                // Success\r\n                return true;\r\n            } else {\r\n                // Return the value\r\n                if (o) {\r\n                    return o[p];\r\n                }\r\n            }\r\n        }\r\n        // Something went wrong\r\n        return false;\r\n    }\r\n\r\n    // Update dictionary\r\n    obj.setDictionary = function(d) {\r\n        var k = Object.keys(obj.dictionary);\r\n        if (k.length == 0) {\r\n            obj.dictionary = d;\r\n        } else {\r\n            // Replace the key into the dictionary and append the new ones\r\n            var k = Object.keys(d);\r\n            for (var i = 0; i < k.length; i++) {\r\n                obj.dictionary[k[i]] = d[k[i]];\r\n            }\r\n        }\r\n\r\n        // Translations\r\n        var t = null;\r\n        for (var i = 0; i < jSuites.calendar.weekdays.length; i++) {\r\n            t =  jSuites.translate(jSuites.calendar.weekdays[i]);\r\n            if (jSuites.calendar.weekdays[i]) {\r\n                jSuites.calendar.weekdays[i] = t;\r\n                jSuites.calendar.weekdaysShort[i] = t.substr(0,3);\r\n            }\r\n        }\r\n        for (var i = 0; i < jSuites.calendar.months.length; i++) {\r\n            t = jSuites.translate(jSuites.calendar.months[i]);\r\n            if (t) {\r\n                jSuites.calendar.months[i] = t;\r\n                jSuites.calendar.monthsShort[i] = t.substr(0,3);\r\n            }\r\n        }\r\n    }\r\n\r\n    // Dictionary\r\n    obj.dictionary = {};\r\n\r\n    // Translate\r\n    obj.translate = function(t) {\r\n        return obj.dictionary[t] || t;\r\n    }\r\n\r\n    // Array of opened components\r\n    obj.current = [];\r\n\r\n    return obj;\r\n}();\r\n\r\n/**\r\n * Global jsuites event\r\n */\r\nif (typeof(document) !== \"undefined\") {\r\n    jSuites.init();\r\n}\r\n\r\njSuites.ajax = (function(options, complete) {\r\n    if (Array.isArray(options)) {\r\n        // Create multiple request controller \r\n        var multiple = {\r\n            instance: [],\r\n            complete: complete,\r\n        }\r\n\r\n        if (options.length > 0) {\r\n            for (var i = 0; i < options.length; i++) {\r\n                options[i].multiple = multiple;\r\n                multiple.instance.push(jSuites.ajax(options[i]));\r\n            }\r\n        }\r\n\r\n        return multiple;\r\n    }\r\n\r\n    if (! options.data) {\r\n        options.data = {};\r\n    }\r\n\r\n    if (options.type) {\r\n        options.method = options.type;\r\n    }\r\n\r\n    // Default method\r\n    if (! options.method) {\r\n        options.method = 'GET';\r\n    }\r\n\r\n    // Default type\r\n    if (! options.dataType) {\r\n        options.dataType = 'json';\r\n    }\r\n\r\n    if (options.data) {\r\n        // Parse object to variables format\r\n        var parseData = function (value, key) {\r\n            var vars = [];\r\n            var keys = Object.keys(value);\r\n            if (keys.length) {\r\n                for (var i = 0; i < keys.length; i++) {\r\n                    if (key) {\r\n                        var k = key + '[' + keys[i] + ']';\r\n                    } else {\r\n                        var k = keys[i];\r\n                    }\r\n\r\n                    if (value[k] instanceof FileList) {\r\n                        vars[k] = value[keys[i]];\r\n                    } else if (typeof (value[keys[i]]) == 'object') {\r\n                        var r = parseData(value[keys[i]], k);\r\n                        var o = Object.keys(r);\r\n                        for (var j = 0; j < o.length; j++) {\r\n                            vars[o[j]] = r[o[j]];\r\n                        }\r\n                    } else {\r\n                        vars[k] = value[keys[i]];\r\n                    }\r\n                }\r\n            }\r\n\r\n            return vars;\r\n        }\r\n\r\n        var d = parseData(options.data);\r\n        var k = Object.keys(d);\r\n\r\n        // Data form\r\n        if (options.method == 'GET') {\r\n            if (k.length) {\r\n                var data = [];\r\n                for (var i = 0; i < k.length; i++) {\r\n                    data.push(k[i] + '=' + encodeURIComponent(d[k[i]]));\r\n                }\r\n\r\n                if (options.url.indexOf('?') < 0) {\r\n                    options.url += '?';\r\n                }\r\n                options.url += data.join('&');\r\n            }\r\n        } else {\r\n            var data = new FormData();\r\n            for (var i = 0; i < k.length; i++) {\r\n                if (d[k[i]] instanceof FileList) {\r\n                    if (d[k[i]].length) {\r\n                        for (var j = 0; j < d[k[i]].length; j++) {\r\n                            data.append(k[i], d[k[i]][j], d[k[i]][j].name);\r\n                        }\r\n                    }\r\n                } else {\r\n                    data.append(k[i], d[k[i]]);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    var httpRequest = new XMLHttpRequest();\r\n    httpRequest.open(options.method, options.url, true);\r\n    httpRequest.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\r\n\r\n    // Content type\r\n    if (options.contentType) {\r\n        httpRequest.setRequestHeader('Content-Type', options.contentType);\r\n    }\r\n\r\n    // Headers\r\n    if (options.method == 'POST') {\r\n        httpRequest.setRequestHeader('Accept', 'application/json');\r\n    } else {\r\n        if (options.dataType == 'blob') {\r\n            httpRequest.responseType = \"blob\";\r\n        } else {\r\n            if (! options.contentType) {\r\n                if (options.dataType == 'json') {\r\n                    httpRequest.setRequestHeader('Content-Type', 'text/json');\r\n                } else if (options.dataType == 'html') {\r\n                    httpRequest.setRequestHeader('Content-Type', 'text/html');\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // No cache\r\n    if (options.cache != true) {\r\n        httpRequest.setRequestHeader('pragma', 'no-cache');\r\n        httpRequest.setRequestHeader('cache-control', 'no-cache');\r\n    }\r\n\r\n    // Authentication\r\n    if (options.withCredentials == true) {\r\n        httpRequest.withCredentials = true\r\n    }\r\n\r\n    // Before send\r\n    if (typeof(options.beforeSend) == 'function') {\r\n        options.beforeSend(httpRequest);\r\n    }\r\n\r\n    httpRequest.onload = function() {\r\n        if (httpRequest.status === 200) {\r\n            if (options.dataType == 'json') {\r\n                try {\r\n                    var result = JSON.parse(httpRequest.responseText);\r\n\r\n                    if (options.success && typeof(options.success) == 'function') {\r\n                        options.success(result);\r\n                    }\r\n                } catch(err) {\r\n                    if (options.error && typeof(options.error) == 'function') {\r\n                        options.error(err, result);\r\n                    }\r\n                }\r\n            } else {\r\n                if (options.dataType == 'blob') {\r\n                    var result = httpRequest.response;\r\n                } else {\r\n                    var result = httpRequest.responseText;\r\n                }\r\n\r\n                if (options.success && typeof(options.success) == 'function') {\r\n                    options.success(result);\r\n                }\r\n            }\r\n        } else {\r\n            if (options.error && typeof(options.error) == 'function') {\r\n                options.error(httpRequest.responseText, httpRequest.status);\r\n            }\r\n        }\r\n\r\n        // Global queue\r\n        if (jSuites.ajax.queue && jSuites.ajax.queue.length > 0) {\r\n            jSuites.ajax.send(jSuites.ajax.queue.shift());\r\n        }\r\n\r\n        // Global complete method\r\n        if (jSuites.ajax.requests && jSuites.ajax.requests.length) {\r\n            // Get index of this request in the container\r\n            var index = jSuites.ajax.requests.indexOf(httpRequest);\r\n            // Remove from the ajax requests container\r\n            jSuites.ajax.requests.splice(index, 1);\r\n            // Deprected: Last one?\r\n            if (! jSuites.ajax.requests.length) {\r\n                // Object event\r\n                if (options.complete && typeof(options.complete) == 'function') {\r\n                    options.complete(result);\r\n                }\r\n            }\r\n            // Group requests\r\n            if (options.group) {\r\n                if (jSuites.ajax.oncomplete && typeof(jSuites.ajax.oncomplete[options.group]) == 'function') {\r\n                    if (! jSuites.ajax.pending(options.group)) {\r\n                        jSuites.ajax.oncomplete[options.group]();\r\n                        jSuites.ajax.oncomplete[options.group] = null;\r\n                    }\r\n                }\r\n            }\r\n            // Multiple requests controller\r\n            if (options.multiple && options.multiple.instance) {\r\n                // Get index of this request in the container\r\n                var index = options.multiple.instance.indexOf(httpRequest);\r\n                // Remove from the ajax requests container\r\n                options.multiple.instance.splice(index, 1);\r\n                // If this is the last one call method complete\r\n                if (! options.multiple.instance.length) {\r\n                    if (options.multiple.complete && typeof(options.multiple.complete) == 'function') {\r\n                        options.multiple.complete(result);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Keep the options\r\n    httpRequest.options = options;\r\n    // Data\r\n    httpRequest.data = data;\r\n\r\n    // Queue\r\n    if (options.queue == true && jSuites.ajax.requests.length > 0) {\r\n        jSuites.ajax.queue.push(httpRequest);\r\n    } else {\r\n        jSuites.ajax.send(httpRequest)\r\n    }\r\n\r\n    return httpRequest;\r\n});\r\n\r\njSuites.ajax.send = function(httpRequest) {\r\n    if (httpRequest.data) {\r\n        if (Array.isArray(httpRequest.data)) {\r\n            httpRequest.send(httpRequest.data.join('&'));\r\n        } else {\r\n            httpRequest.send(httpRequest.data);\r\n        }\r\n    } else {\r\n        httpRequest.send();\r\n    }\r\n\r\n    jSuites.ajax.requests.push(httpRequest);\r\n}\r\n\r\njSuites.ajax.exists = function(url, __callback) {\r\n    var http = new XMLHttpRequest();\r\n    http.open('HEAD', url, false);\r\n    http.send();\r\n    if (http.status) {\r\n        __callback(http.status);\r\n    }\r\n}\r\n\r\njSuites.ajax.pending = function(group) {\r\n    var n = 0;\r\n    var o = jSuites.ajax.requests;\r\n    if (o && o.length) {\r\n        for (var i = 0; i < o.length; i++) {\r\n            if (! group || group == o[i].options.group) {\r\n                n++\r\n            }\r\n        }\r\n    }\r\n    return n;\r\n}\r\n\r\njSuites.ajax.oncomplete = {};\r\njSuites.ajax.requests = [];\r\njSuites.ajax.queue = [];\r\n\r\njSuites.alert = function(message) {\r\n    if (jSuites.getWindowWidth() < 800 && jSuites.dialog) {\r\n        jSuites.dialog.open({\r\n            title:'Alert',\r\n            message:message,\r\n        });\r\n    } else {\r\n        alert(message);\r\n    }\r\n}\r\n\r\njSuites.animation = {};\r\n\r\njSuites.animation.slideLeft = function(element, direction, done) {\r\n    if (direction == true) {\r\n        element.classList.add('slide-left-in');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-left-in');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    } else {\r\n        element.classList.add('slide-left-out');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-left-out');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    }\r\n}\r\n\r\njSuites.animation.slideRight = function(element, direction, done) {\r\n    if (direction == true) {\r\n        element.classList.add('slide-right-in');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-right-in');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    } else {\r\n        element.classList.add('slide-right-out');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-right-out');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    }\r\n}\r\n\r\njSuites.animation.slideTop = function(element, direction, done) {\r\n    if (direction == true) {\r\n        element.classList.add('slide-top-in');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-top-in');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    } else {\r\n        element.classList.add('slide-top-out');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-top-out');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    }\r\n}\r\n\r\njSuites.animation.slideBottom = function(element, direction, done) {\r\n    if (direction == true) {\r\n        element.classList.add('slide-bottom-in');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-bottom-in');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    } else {\r\n        element.classList.add('slide-bottom-out');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-bottom-out');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 100);\r\n    }\r\n}\r\n\r\njSuites.animation.fadeIn = function(element, done) {\r\n    element.style.display = '';\r\n    element.classList.add('fade-in');\r\n    setTimeout(function() {\r\n        element.classList.remove('fade-in');\r\n        if (typeof(done) == 'function') {\r\n            done();\r\n        }\r\n    }, 2000);\r\n}\r\n\r\njSuites.animation.fadeOut = function(element, done) {\r\n    element.classList.add('fade-out');\r\n    setTimeout(function() {\r\n        element.style.display = 'none';\r\n        element.classList.remove('fade-out');\r\n        if (typeof(done) == 'function') {\r\n            done();\r\n        }\r\n    }, 1000);\r\n}\r\n\r\njSuites.calendar = (function(el, options) {\r\n    // Already created, update options\r\n    if (el.calendar) {\r\n        return el.calendar.setOptions(options, true);\r\n    }\r\n\r\n    // New instance\r\n    var obj = { type:'calendar' };\r\n    obj.options = {};\r\n\r\n    // Date\r\n    obj.date = null;\r\n\r\n    /**\r\n     * Update options\r\n     */\r\n    obj.setOptions = function(options, reset) {\r\n        // Default configuration\r\n        var defaults = {\r\n            // Render type: [ default | year-month-picker ]\r\n            type: 'default',\r\n            // Restrictions\r\n            validRange: null,\r\n            // Starting weekday - 0 for sunday, 6 for saturday\r\n            startingDay: null, \r\n            // Date format\r\n            format: 'DD/MM/YYYY',\r\n            // Allow keyboard date entry\r\n            readonly: true,\r\n            // Today is default\r\n            today: false,\r\n            // Show timepicker\r\n            time: false,\r\n            // Show the reset button\r\n            resetButton: true,\r\n            // Placeholder\r\n            placeholder: '',\r\n            // Translations can be done here\r\n            months: jSuites.calendar.monthsShort,\r\n            monthsFull: jSuites.calendar.months,\r\n            weekdays: jSuites.calendar.weekdays,\r\n            weekdays_short: jSuites.calendar.weekdays,\r\n            textDone: jSuites.translate('Done'),\r\n            textReset: jSuites.translate('Reset'),\r\n            textUpdate: jSuites.translate('Update'),\r\n            // Value\r\n            value: null,\r\n            // Fullscreen (this is automatic set for screensize < 800)\r\n            fullscreen: false,\r\n            // Create the calendar closed as default\r\n            opened: false,\r\n            // Events\r\n            onopen: null,\r\n            onclose: null,\r\n            onchange: null,\r\n            onupdate: null,\r\n            // Internal mode controller\r\n            mode: null,\r\n            position: null,\r\n            // Data type\r\n            dataType: null,\r\n        }\r\n\r\n        for (var i = 0; i < defaults.weekdays_short.length; i++) {\r\n            defaults.weekdays_short[i] = defaults.weekdays_short[i].substr(0,1);\r\n        }\r\n\r\n        // Loop through our object\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else {\r\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\r\n                    obj.options[property] = defaults[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Reset button\r\n        if (obj.options.resetButton == false) {\r\n            calendarReset.style.display = 'none';\r\n        } else {\r\n            calendarReset.style.display = '';\r\n        }\r\n\r\n        // Readonly\r\n        if (obj.options.readonly) {\r\n            el.setAttribute('readonly', 'readonly');\r\n        } else {\r\n            el.removeAttribute('readonly');\r\n        }\r\n\r\n        // Placeholder\r\n        if (obj.options.placeholder) {\r\n            el.setAttribute('placeholder', obj.options.placeholder);\r\n        } else {\r\n            el.removeAttribute('placeholder');\r\n        }\r\n\r\n        if (jSuites.isNumeric(obj.options.value) && obj.options.value > 0) {\r\n            obj.options.value = jSuites.calendar.numToDate(obj.options.value);\r\n            // Data type numberic\r\n            obj.options.dataType = 'numeric';\r\n        }\r\n\r\n        // Texts\r\n        calendarReset.innerHTML = obj.options.textReset;\r\n        calendarConfirm.innerHTML = obj.options.textDone;\r\n        calendarControlsUpdateButton.innerHTML = obj.options.textUpdate;\r\n\r\n        // Define mask\r\n        el.setAttribute('data-mask', obj.options.format.toLowerCase());\r\n\r\n        // Value\r\n        if (! obj.options.value && obj.options.today) {\r\n            var value = jSuites.calendar.now();\r\n        } else {\r\n            var value = obj.options.value;\r\n        }\r\n\r\n        // Set internal date\r\n        if (value) {\r\n            // Force the update\r\n            obj.options.value = null;\r\n            // New value\r\n            obj.setValue(value);\r\n        }\r\n\r\n        return obj;\r\n    }\r\n\r\n    /**\r\n     * Open the calendar\r\n     */\r\n    obj.open = function (value) {\r\n        if (! calendar.classList.contains('jcalendar-focus')) {\r\n            if (! calendar.classList.contains('jcalendar-inline')) {\r\n                // Current\r\n                jSuites.calendar.current = obj;\r\n                // Start tracking\r\n                jSuites.tracking(obj, true);\r\n                // Create the days\r\n                obj.getDays();\r\n                // Render months\r\n                if (obj.options.type == 'year-month-picker') {\r\n                    obj.getMonths();\r\n                }\r\n                // Get time\r\n                if (obj.options.time) {\r\n                    calendarSelectHour.value = obj.date[3];\r\n                    calendarSelectMin.value = obj.date[4];\r\n                }\r\n\r\n                // Show calendar\r\n                calendar.classList.add('jcalendar-focus');\r\n\r\n                // Get the position of the corner helper\r\n                if (jSuites.getWindowWidth() < 800 || obj.options.fullscreen) {\r\n                    calendar.classList.add('jcalendar-fullsize');\r\n                    // Animation\r\n                    jSuites.animation.slideBottom(calendarContent, 1);\r\n                } else {\r\n                    calendar.classList.remove('jcalendar-fullsize');\r\n\r\n                    var rect = el.getBoundingClientRect();\r\n                    var rectContent = calendarContent.getBoundingClientRect();\r\n\r\n                    if (obj.options.position) {\r\n                        calendarContainer.style.position = 'fixed';\r\n                        if (window.innerHeight < rect.bottom + rectContent.height) {\r\n                            calendarContainer.style.top = (rect.top - (rectContent.height + 2)) + 'px';\r\n                        } else {\r\n                            calendarContainer.style.top = (rect.top + rect.height + 2) + 'px';\r\n                        }\r\n                        calendarContainer.style.left = rect.left + 'px';\r\n                    } else {\r\n                        if (window.innerHeight < rect.bottom + rectContent.height) {\r\n                            var d = -1 * (rect.height + rectContent.height + 2);\r\n                            if (d + rect.top < 0) {\r\n                                d = -1 * (rect.top + rect.height);\r\n                            }\r\n                            calendarContainer.style.top = d + 'px';\r\n                        } else {\r\n                            calendarContainer.style.top = 2 + 'px'; \r\n                        }\r\n\r\n                        if (window.innerWidth < rect.left + rectContent.width) {\r\n                            var d = window.innerWidth - (rect.left + rectContent.width + 20);\r\n                            calendarContainer.style.left = d + 'px';\r\n                        } else {\r\n                            calendarContainer.style.left = '0px'; \r\n                        }\r\n                    }\r\n                }\r\n\r\n                // Events\r\n                if (typeof(obj.options.onopen) == 'function') {\r\n                    obj.options.onopen(el);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.close = function (ignoreEvents, update) {\r\n        if (calendar.classList.contains('jcalendar-focus')) {\r\n            if (update !== false) {\r\n                var element = calendar.querySelector('.jcalendar-selected');\r\n\r\n                if (typeof(update) == 'string') {\r\n                    var value = update;\r\n                } else if (! element || element.classList.contains('jcalendar-disabled')) {\r\n                    var value = obj.options.value\r\n                } else {\r\n                    var value = obj.getValue();\r\n                }\r\n\r\n                obj.setValue(value);\r\n            }\r\n\r\n            // Events\r\n            if (! ignoreEvents && typeof(obj.options.onclose) == 'function') {\r\n                obj.options.onclose(el);\r\n            }\r\n            // Hide\r\n            calendar.classList.remove('jcalendar-focus');\r\n            // Stop tracking\r\n            jSuites.tracking(obj, false);\r\n            // Current\r\n            jSuites.calendar.current = null;\r\n        }\r\n\r\n        return obj.options.value;\r\n    }\r\n\r\n    obj.prev = function() {\r\n        // Check if the visualization is the days picker or years picker\r\n        if (obj.options.mode == 'years') {\r\n            obj.date[0] = obj.date[0] - 12;\r\n\r\n            // Update picker table of days\r\n            obj.getYears();\r\n        } else if (obj.options.mode == 'months') {\r\n            obj.date[0] = parseInt(obj.date[0]) - 1;\r\n            // Update picker table of months\r\n            obj.getMonths();\r\n        } else {\r\n            // Go to the previous month\r\n            if (obj.date[1] < 2) {\r\n                obj.date[0] = obj.date[0] - 1;\r\n                obj.date[1] = 12;\r\n            } else {\r\n                obj.date[1] = obj.date[1] - 1;\r\n            }\r\n\r\n            // Update picker table of days\r\n            obj.getDays();\r\n        }\r\n    }\r\n\r\n    obj.next = function() {\r\n        // Check if the visualization is the days picker or years picker\r\n        if (obj.options.mode == 'years') {\r\n            obj.date[0] = parseInt(obj.date[0]) + 12;\r\n\r\n            // Update picker table of days\r\n            obj.getYears();\r\n        } else if (obj.options.mode == 'months') {\r\n            obj.date[0] = parseInt(obj.date[0]) + 1;\r\n            // Update picker table of months\r\n            obj.getMonths();\r\n        } else {\r\n            // Go to the previous month\r\n            if (obj.date[1] > 11) {\r\n                obj.date[0] = parseInt(obj.date[0]) + 1;\r\n                obj.date[1] = 1;\r\n            } else {\r\n                obj.date[1] = parseInt(obj.date[1]) + 1;\r\n            }\r\n\r\n            // Update picker table of days\r\n            obj.getDays();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set today\r\n     */\r\n    obj.setToday = function() {\r\n        // Today\r\n        var value = new Date().toISOString().substr(0, 10);\r\n        // Change value\r\n        obj.setValue(value);\r\n        // Value\r\n        return value;\r\n    }\r\n\r\n    obj.setValue = function(val) {\r\n        if (! val) {\r\n            val = '' + val;\r\n        }\r\n        // Values\r\n        var newValue = val;\r\n        var oldValue = obj.options.value;\r\n\r\n        if (oldValue != newValue) {\r\n            // Set label\r\n            if (! newValue) {\r\n                obj.date = null;\r\n                var val = '';\r\n            } else {\r\n                var value = obj.setLabel(newValue, obj.options);\r\n                var date = newValue.split(' ');\r\n                if (! date[1]) {\r\n                    date[1] = '00:00:00';\r\n                }\r\n                var time = date[1].split(':')\r\n                var date = date[0].split('-');\r\n                var y = parseInt(date[0]);\r\n                var m = parseInt(date[1]);\r\n                var d = parseInt(date[2]);\r\n                var h = parseInt(time[0]);\r\n                var i = parseInt(time[1]);\r\n                obj.date = [ y, m, d, h, i, 0 ];\r\n                var val = obj.setLabel(newValue, obj.options);\r\n            }\r\n\r\n            // New value\r\n            obj.options.value = newValue;\r\n\r\n            if (typeof(obj.options.onchange) ==  'function') {\r\n                obj.options.onchange(el, newValue, oldValue);\r\n            }\r\n\r\n            // Lemonade JS\r\n            if (el.value != val) {\r\n                el.value = val;\r\n                if (typeof(el.onchange) == 'function') {\r\n                    el.onchange({\r\n                        type: 'change',\r\n                        target: el,\r\n                        value: el.value\r\n                    });\r\n                }\r\n            }\r\n        }\r\n\r\n        obj.getDays();\r\n    }\r\n\r\n    obj.getValue = function() {\r\n        if (obj.date) {\r\n            if (obj.options.time) {\r\n                return jSuites.two(obj.date[0]) + '-' + jSuites.two(obj.date[1]) + '-' + jSuites.two(obj.date[2]) + ' ' + jSuites.two(obj.date[3]) + ':' + jSuites.two(obj.date[4]) + ':' + jSuites.two(0);\r\n            } else {\r\n                return jSuites.two(obj.date[0]) + '-' + jSuites.two(obj.date[1]) + '-' + jSuites.two(obj.date[2]) + ' ' + jSuites.two(0) + ':' + jSuites.two(0) + ':' + jSuites.two(0);\r\n            }\r\n        } else {\r\n            return \"\";\r\n        }\r\n    }\r\n\r\n    /**\r\n     *  Calendar\r\n     */\r\n    obj.update = function(element, v) {\r\n        if (element.classList.contains('jcalendar-disabled')) {\r\n            // Do nothing\r\n        } else {\r\n            var elements = calendar.querySelector('.jcalendar-selected');\r\n            if (elements) {\r\n                elements.classList.remove('jcalendar-selected');\r\n            }\r\n            element.classList.add('jcalendar-selected');\r\n\r\n            if (element.classList.contains('jcalendar-set-month')) {\r\n                obj.date[1] = v;\r\n            } else {\r\n                obj.date[2] = element.innerText;\r\n            }\r\n\r\n            if (! obj.options.time) {\r\n                obj.close();\r\n            } else {\r\n                obj.date[3] = calendarSelectHour.value;\r\n                obj.date[4] = calendarSelectMin.value;\r\n            }\r\n        }\r\n\r\n        // Update\r\n        updateActions();\r\n    }\r\n\r\n    /**\r\n     * Set to blank\r\n     */\r\n    obj.reset = function() {\r\n        // Close calendar\r\n        obj.setValue('');\r\n        obj.date = null;\r\n        obj.close(false, false);\r\n    }\r\n\r\n    /**\r\n     * Get calendar days\r\n     */\r\n    obj.getDays = function() {\r\n        // Mode\r\n        obj.options.mode = 'days';\r\n\r\n        // Setting current values in case of NULLs\r\n        var date = new Date();\r\n\r\n        // Current selection\r\n        var year = obj.date && jSuites.isNumeric(obj.date[0]) ? obj.date[0] : parseInt(date.getFullYear());\r\n        var month = obj.date && jSuites.isNumeric(obj.date[1]) ? obj.date[1] : parseInt(date.getMonth()) + 1;\r\n        var day = obj.date && jSuites.isNumeric(obj.date[2]) ? obj.date[2] : parseInt(date.getDate());\r\n        var hour = obj.date && jSuites.isNumeric(obj.date[3]) ? obj.date[3] : parseInt(date.getHours());\r\n        var min = obj.date && jSuites.isNumeric(obj.date[4]) ? obj.date[4] : parseInt(date.getMinutes());\r\n\r\n        // Selection container\r\n        obj.date = [ year, month, day, hour, min, 0 ];\r\n\r\n        // Update title\r\n        calendarLabelYear.innerHTML = year;\r\n        calendarLabelMonth.innerHTML = obj.options.months[month - 1];\r\n\r\n        // Current month and Year\r\n        var isCurrentMonthAndYear = (date.getMonth() == month - 1) && (date.getFullYear() == year) ? true : false;\r\n        var currentDay = date.getDate();\r\n\r\n        // Number of days in the month\r\n        var date = new Date(year, month, 0, 0, 0);\r\n        var numberOfDays = date.getDate();\r\n\r\n        // First day\r\n        var date = new Date(year, month-1, 0, 0, 0);\r\n        var firstDay = date.getDay() + 1;\r\n\r\n        // Index value\r\n        var index = obj.options.startingDay || 0;\r\n\r\n        // First of day relative to the starting calendar weekday\r\n        firstDay = firstDay - index;\r\n\r\n        // Reset table\r\n        calendarBody.innerHTML = '';\r\n\r\n        // Weekdays Row\r\n        var row = document.createElement('tr');\r\n        row.setAttribute('align', 'center');\r\n        calendarBody.appendChild(row);\r\n\r\n        // Create weekdays row\r\n        for (var i = 0; i < 7; i++) {\r\n            var cell = document.createElement('td');\r\n            cell.classList.add('jcalendar-weekday')\r\n            cell.innerHTML = obj.options.weekdays_short[index];\r\n            row.appendChild(cell);\r\n            // Next week day\r\n            index++;\r\n            // Restart index\r\n            if (index > 6) {\r\n                index = 0;\r\n            }\r\n        }\r\n\r\n        // Index of days\r\n        var index = 0;\r\n        var d = 0;\r\n \r\n        // Calendar table\r\n        for (var j = 0; j < 6; j++) {\r\n            // Reset cells container\r\n            var row = document.createElement('tr');\r\n            row.setAttribute('align', 'center');\r\n            // Data control\r\n            var emptyRow = true;\r\n            // Create cells\r\n            for (var i = 0; i < 7; i++) {\r\n                // Create cell\r\n                var cell = document.createElement('td');\r\n                cell.classList.add('jcalendar-set-day');\r\n\r\n                if (index >= firstDay && index < (firstDay + numberOfDays)) {\r\n                    // Day cell\r\n                    d++;\r\n                    cell.innerHTML = d;\r\n\r\n                    // Selected\r\n                    if (d == day) {\r\n                        cell.classList.add('jcalendar-selected');\r\n                    }\r\n\r\n                    // Current selection day is today\r\n                    if (isCurrentMonthAndYear && currentDay == d) {\r\n                        cell.style.fontWeight = 'bold';\r\n                    }\r\n\r\n                    // Current selection day\r\n                    var current = jSuites.calendar.now(new Date(year, month-1, d), true);\r\n\r\n                    // Available ranges\r\n                    if (obj.options.validRange) {\r\n                        if (! obj.options.validRange[0] || current >= obj.options.validRange[0]) {\r\n                            var test1 = true;\r\n                        } else {\r\n                            var test1 = false;\r\n                        }\r\n\r\n                        if (! obj.options.validRange[1] || current <= obj.options.validRange[1]) {\r\n                            var test2 = true;\r\n                        } else {\r\n                            var test2 = false;\r\n                        }\r\n\r\n                        if (! (test1 && test2)) {\r\n                            cell.classList.add('jcalendar-disabled');\r\n                        }\r\n                    }\r\n\r\n                    // Control\r\n                    emptyRow = false;\r\n                }\r\n                // Day cell\r\n                row.appendChild(cell);\r\n                // Index\r\n                index++;\r\n            }\r\n\r\n            // Add cell to the calendar body\r\n            if (emptyRow == false) {\r\n                calendarBody.appendChild(row);\r\n            }\r\n        }\r\n\r\n        // Show time controls\r\n        if (obj.options.time) {\r\n            calendarControlsTime.style.display = '';\r\n        } else {\r\n            calendarControlsTime.style.display = 'none';\r\n        }\r\n\r\n        // Update\r\n        updateActions();\r\n    }\r\n\r\n    obj.getMonths = function() {\r\n        // Mode\r\n        obj.options.mode = 'months';\r\n\r\n        // Loading month labels\r\n        var months = obj.options.months;\r\n\r\n        // Value\r\n        var value = obj.options.value; \r\n\r\n        // Current date\r\n        var date = new Date();\r\n        var currentYear = parseInt(date.getFullYear());\r\n        var currentMonth = parseInt(date.getMonth()) + 1;\r\n        var selectedYear = obj.date && jSuites.isNumeric(obj.date[0]) ? obj.date[0] : currentYear;\r\n        var selectedMonth = obj.date && jSuites.isNumeric(obj.date[1]) ? obj.date[1] : currentMonth;\r\n\r\n        // Update title\r\n        calendarLabelYear.innerHTML = obj.date[0];\r\n        calendarLabelMonth.innerHTML = months[selectedMonth-1];\r\n\r\n        // Table\r\n        var table = document.createElement('table');\r\n        table.setAttribute('width', '100%');\r\n\r\n        // Row\r\n        var row = null;\r\n\r\n        // Calendar table\r\n        for (var i = 0; i < 12; i++) {\r\n            if (! (i % 4)) {\r\n                // Reset cells container\r\n                var row = document.createElement('tr');\r\n                row.setAttribute('align', 'center');\r\n                table.appendChild(row);\r\n            }\r\n\r\n            // Create cell\r\n            var cell = document.createElement('td');\r\n            cell.classList.add('jcalendar-set-month');\r\n            cell.setAttribute('data-value', i+1);\r\n            cell.innerText = months[i];\r\n\r\n            if (obj.options.validRange) {\r\n                var current = selectedYear + '-' + jSuites.two(i+1);\r\n                if (! obj.options.validRange[0] || current >= obj.options.validRange[0].substr(0,7)) {\r\n                    var test1 = true;\r\n                } else {\r\n                    var test1 = false;\r\n                }\r\n\r\n                if (! obj.options.validRange[1] || current <= obj.options.validRange[1].substr(0,7)) {\r\n                    var test2 = true;\r\n                } else {\r\n                    var test2 = false;\r\n                }\r\n\r\n                if (! (test1 && test2)) {\r\n                    cell.classList.add('jcalendar-disabled');\r\n                }\r\n            }\r\n\r\n            if (i+1 == selectedMonth) {\r\n                cell.classList.add('jcalendar-selected');\r\n            }\r\n\r\n            if (currentYear == selectedYear && i+1 == currentMonth) {\r\n                cell.style.fontWeight = 'bold';\r\n            }\r\n\r\n            row.appendChild(cell);\r\n        }\r\n\r\n        calendarBody.innerHTML = '<tr><td colspan=\"7\"></td></tr>';\r\n        calendarBody.children[0].children[0].appendChild(table);\r\n\r\n        // Update\r\n        updateActions();\r\n    }\r\n\r\n    obj.getYears = function() { \r\n        // Mode\r\n        obj.options.mode = 'years';\r\n\r\n        // Current date\r\n        var date = new Date();\r\n        var currentYear = date.getFullYear();\r\n        var selectedYear = obj.date && jSuites.isNumeric(obj.date[0]) ? obj.date[0] : parseInt(date.getFullYear());\r\n\r\n        // Array of years\r\n        var y = [];\r\n        for (var i = 0; i < 25; i++) {\r\n            y[i] = parseInt(obj.date[0]) + (i - 12);\r\n        }\r\n\r\n        // Assembling the year tables\r\n        var table = document.createElement('table');\r\n        table.setAttribute('width', '100%');\r\n\r\n        for (var i = 0; i < 25; i++) {\r\n            if (! (i % 5)) {\r\n                // Reset cells container\r\n                var row = document.createElement('tr');\r\n                row.setAttribute('align', 'center');\r\n                table.appendChild(row);\r\n            }\r\n\r\n            // Create cell\r\n            var cell = document.createElement('td');\r\n            cell.classList.add('jcalendar-set-year');\r\n            cell.innerText = y[i];\r\n\r\n            if (selectedYear == y[i]) {\r\n                cell.classList.add('jcalendar-selected');\r\n            }\r\n\r\n            if (currentYear == y[i]) {\r\n                cell.style.fontWeight = 'bold';\r\n            }\r\n\r\n            row.appendChild(cell);\r\n        }\r\n\r\n        calendarBody.innerHTML = '<tr><td colspan=\"7\"></td></tr>';\r\n        calendarBody.firstChild.firstChild.appendChild(table);\r\n\r\n        // Update\r\n        updateActions();\r\n    }\r\n\r\n    obj.setLabel = function(value, mixed) {\r\n        return jSuites.calendar.getDateString(value, mixed);\r\n    }\r\n\r\n    obj.fromFormatted = function (value, format) {\r\n        return jSuites.calendar.extractDateFromString(value, format);\r\n    }\r\n\r\n    var mouseUpControls = function(e) {\r\n        var element = jSuites.findElement(e.target, 'jcalendar-container');\r\n        if (element) {\r\n            var action = e.target.className;\r\n\r\n            // Object id\r\n            if (action == 'jcalendar-prev') {\r\n                obj.prev();\r\n            } else if (action == 'jcalendar-next') {\r\n                obj.next();\r\n            } else if (action == 'jcalendar-month') {\r\n                obj.getMonths();\r\n            } else if (action == 'jcalendar-year') {\r\n                obj.getYears();\r\n            } else if (action == 'jcalendar-set-year') {\r\n                obj.date[0] = e.target.innerText;\r\n                if (obj.options.type == 'year-month-picker') {\r\n                    obj.getMonths();\r\n                } else {\r\n                    obj.getDays();\r\n                }\r\n            } else if (e.target.classList.contains('jcalendar-set-month')) {\r\n                var month = parseInt(e.target.getAttribute('data-value'));\r\n                if (obj.options.type == 'year-month-picker') {\r\n                    obj.update(e.target, month);\r\n                } else {\r\n                    obj.date[1] = month;\r\n                    obj.getDays();\r\n                }\r\n            } else if (action == 'jcalendar-confirm' || action == 'jcalendar-update' || action == 'jcalendar-close') {\r\n                obj.close();\r\n            } else if (action == 'jcalendar-backdrop') {\r\n                obj.close(false, false);\r\n            } else if (action == 'jcalendar-reset') {\r\n                obj.reset();\r\n            } else if (e.target.classList.contains('jcalendar-set-day') && e.target.innerText) {\r\n                obj.update(e.target);\r\n            }\r\n        } else {\r\n            obj.close();\r\n        }\r\n    }\r\n\r\n    var keyUpControls = function(e) {\r\n        if (e.target.value && e.target.value.length > 3) {\r\n            var test = jSuites.calendar.extractDateFromString(e.target.value, obj.options.format);\r\n            if (test) {\r\n                obj.setValue(test);\r\n            }\r\n        }\r\n    }\r\n\r\n    // Update actions button\r\n    var updateActions = function() {\r\n        var currentDay = calendar.querySelector('.jcalendar-selected');\r\n\r\n        if (currentDay && currentDay.classList.contains('jcalendar-disabled')) {\r\n            calendarControlsUpdateButton.setAttribute('disabled', 'disabled');\r\n            calendarSelectHour.setAttribute('disabled', 'disabled');\r\n            calendarSelectMin.setAttribute('disabled', 'disabled');\r\n        } else {\r\n            calendarControlsUpdateButton.removeAttribute('disabled');\r\n            calendarSelectHour.removeAttribute('disabled');\r\n            calendarSelectMin.removeAttribute('disabled');\r\n        }\r\n\r\n        // Event\r\n        if (typeof(obj.options.onupdate) == 'function') {\r\n            obj.options.onupdate(el, obj.getValue());\r\n        }\r\n    }\r\n\r\n    var calendar = null;\r\n    var calendarReset = null;\r\n    var calendarConfirm = null;\r\n    var calendarContainer = null;\r\n    var calendarContent = null;\r\n    var calendarLabelYear = null;\r\n    var calendarLabelMonth = null;\r\n    var calendarTable = null;\r\n    var calendarBody = null;\r\n\r\n    var calendarControls = null;\r\n    var calendarControlsTime = null;\r\n    var calendarControlsUpdate = null;\r\n    var calendarControlsUpdateButton = null;\r\n    var calendarSelectHour = null;\r\n    var calendarSelectMin = null;\r\n\r\n    var init = function() {\r\n        // Get value from initial element if that is an input\r\n        if (el.tagName == 'INPUT' && el.value) {\r\n            options.value = el.value;\r\n        }\r\n\r\n        // Calendar DOM elements\r\n        calendarReset = document.createElement('div');\r\n        calendarReset.className = 'jcalendar-reset';\r\n\r\n        calendarConfirm = document.createElement('div');\r\n        calendarConfirm.className = 'jcalendar-confirm';\r\n\r\n        calendarControls = document.createElement('div');\r\n        calendarControls.className = 'jcalendar-controls'\r\n        calendarControls.style.borderBottom = '1px solid #ddd';\r\n        calendarControls.appendChild(calendarReset);\r\n        calendarControls.appendChild(calendarConfirm);\r\n\r\n        calendarContainer = document.createElement('div');\r\n        calendarContainer.className = 'jcalendar-container';\r\n\r\n        calendarContent = document.createElement('div');\r\n        calendarContent.className = 'jcalendar-content';\r\n        calendarContainer.appendChild(calendarContent);\r\n\r\n        // Main element\r\n        if (el.tagName == 'DIV') {\r\n            calendar = el;\r\n            calendar.classList.add('jcalendar-inline');\r\n        } else {\r\n            // Add controls to the screen\r\n            calendarContent.appendChild(calendarControls);\r\n\r\n            calendar = document.createElement('div');\r\n            calendar.className = 'jcalendar';\r\n        }\r\n        calendar.classList.add('jcalendar-container');\r\n        calendar.appendChild(calendarContainer);\r\n\r\n        // Table container\r\n        var calendarTableContainer = document.createElement('div');\r\n        calendarTableContainer.className = 'jcalendar-table';\r\n        calendarContent.appendChild(calendarTableContainer);\r\n\r\n        // Previous button\r\n        var calendarHeaderPrev = document.createElement('td');\r\n        calendarHeaderPrev.setAttribute('colspan', '2');\r\n        calendarHeaderPrev.className = 'jcalendar-prev';\r\n\r\n        // Header with year and month\r\n        calendarLabelYear = document.createElement('span');\r\n        calendarLabelYear.className = 'jcalendar-year';\r\n        calendarLabelMonth = document.createElement('span');\r\n        calendarLabelMonth.className = 'jcalendar-month';\r\n\r\n        var calendarHeaderTitle = document.createElement('td');\r\n        calendarHeaderTitle.className = 'jcalendar-header';\r\n        calendarHeaderTitle.setAttribute('colspan', '3');\r\n        calendarHeaderTitle.appendChild(calendarLabelMonth);\r\n        calendarHeaderTitle.appendChild(calendarLabelYear);\r\n\r\n        var calendarHeaderNext = document.createElement('td');\r\n        calendarHeaderNext.setAttribute('colspan', '2');\r\n        calendarHeaderNext.className = 'jcalendar-next';\r\n\r\n        var calendarHeader = document.createElement('thead');\r\n        var calendarHeaderRow = document.createElement('tr');\r\n        calendarHeaderRow.appendChild(calendarHeaderPrev);\r\n        calendarHeaderRow.appendChild(calendarHeaderTitle);\r\n        calendarHeaderRow.appendChild(calendarHeaderNext);\r\n        calendarHeader.appendChild(calendarHeaderRow);\r\n\r\n        calendarTable = document.createElement('table');\r\n        calendarBody = document.createElement('tbody');\r\n        calendarTable.setAttribute('cellpadding', '0');\r\n        calendarTable.setAttribute('cellspacing', '0');\r\n        calendarTable.appendChild(calendarHeader);\r\n        calendarTable.appendChild(calendarBody);\r\n        calendarTableContainer.appendChild(calendarTable);\r\n\r\n        calendarSelectHour = document.createElement('select');\r\n        calendarSelectHour.className = 'jcalendar-select';\r\n        calendarSelectHour.onchange = function() {\r\n            obj.date[3] = this.value; \r\n\r\n            // Event\r\n            if (typeof(obj.options.onupdate) == 'function') {\r\n                obj.options.onupdate(el, obj.getValue());\r\n            }\r\n        }\r\n\r\n        for (var i = 0; i < 24; i++) {\r\n            var element = document.createElement('option');\r\n            element.value = i;\r\n            element.innerHTML = jSuites.two(i);\r\n            calendarSelectHour.appendChild(element);\r\n        }\r\n\r\n        calendarSelectMin = document.createElement('select');\r\n        calendarSelectMin.className = 'jcalendar-select';\r\n        calendarSelectMin.onchange = function() {\r\n            obj.date[4] = this.value;\r\n\r\n            // Event\r\n            if (typeof(obj.options.onupdate) == 'function') {\r\n                obj.options.onupdate(el, obj.getValue());\r\n            }\r\n        }\r\n\r\n        for (var i = 0; i < 60; i++) {\r\n            var element = document.createElement('option');\r\n            element.value = i;\r\n            element.innerHTML = jSuites.two(i);\r\n            calendarSelectMin.appendChild(element);\r\n        }\r\n\r\n        // Footer controls\r\n        var calendarControlsFooter = document.createElement('div');\r\n        calendarControlsFooter.className = 'jcalendar-controls';\r\n\r\n        calendarControlsTime = document.createElement('div');\r\n        calendarControlsTime.className = 'jcalendar-time';\r\n        calendarControlsTime.style.maxWidth = '140px';\r\n        calendarControlsTime.appendChild(calendarSelectHour);\r\n        calendarControlsTime.appendChild(calendarSelectMin);\r\n\r\n        calendarControlsUpdateButton = document.createElement('button');\r\n        calendarControlsUpdateButton.setAttribute('type', 'button');\r\n        calendarControlsUpdateButton.className = 'jcalendar-update';\r\n\r\n        calendarControlsUpdate = document.createElement('div');\r\n        calendarControlsUpdate.style.flexGrow = '10';\r\n        calendarControlsUpdate.appendChild(calendarControlsUpdateButton);\r\n        calendarControlsFooter.appendChild(calendarControlsTime);\r\n\r\n        // Only show the update button for input elements\r\n        if (el.tagName == 'INPUT') {\r\n            calendarControlsFooter.appendChild(calendarControlsUpdate);\r\n        }\r\n\r\n        calendarContent.appendChild(calendarControlsFooter);\r\n\r\n        var calendarBackdrop = document.createElement('div');\r\n        calendarBackdrop.className = 'jcalendar-backdrop';\r\n        calendar.appendChild(calendarBackdrop);\r\n\r\n        // Handle events\r\n        el.addEventListener(\"keyup\", keyUpControls);\r\n\r\n        // Add global events\r\n        calendar.addEventListener(\"swipeleft\", function(e) {\r\n            jSuites.animation.slideLeft(calendarTable, 0, function() {\r\n                obj.next();\r\n                jSuites.animation.slideRight(calendarTable, 1);\r\n            });\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        });\r\n\r\n        calendar.addEventListener(\"swiperight\", function(e) {\r\n            jSuites.animation.slideRight(calendarTable, 0, function() {\r\n                obj.prev();\r\n                jSuites.animation.slideLeft(calendarTable, 1);\r\n            });\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        });\r\n\r\n        el.onmouseup = function() {\r\n            obj.open();\r\n        }\r\n\r\n        if ('ontouchend' in document.documentElement === true) {\r\n            calendar.addEventListener(\"touchend\", mouseUpControls);\r\n        } else {\r\n            calendar.addEventListener(\"mouseup\", mouseUpControls);\r\n        }\r\n\r\n        // Global controls\r\n        if (! jSuites.calendar.hasEvents) {\r\n            // Execute only one time\r\n            jSuites.calendar.hasEvents = true;\r\n            // Enter and Esc\r\n            document.addEventListener(\"keydown\", jSuites.calendar.keydown);\r\n        }\r\n\r\n        // Set configuration\r\n        obj.setOptions(options);\r\n\r\n        // Append element to the DOM\r\n        if (el.tagName == 'INPUT') {\r\n            el.parentNode.insertBefore(calendar, el.nextSibling);\r\n            // Add properties\r\n            el.setAttribute('autocomplete', 'off');\r\n            // Element\r\n            el.classList.add('jcalendar-input');\r\n            // Value\r\n            el.value = obj.setLabel(obj.getValue(), obj.options);\r\n        } else {\r\n            // Get days\r\n            obj.getDays();\r\n            // Hour\r\n            if (obj.options.time) {\r\n                calendarSelectHour.value = obj.date[3];\r\n                calendarSelectMin.value = obj.date[4];\r\n            }\r\n        }\r\n\r\n        // Default opened\r\n        if (obj.options.opened == true) {\r\n            obj.open();\r\n        }\r\n\r\n        // Change method\r\n        el.change = obj.setValue;\r\n\r\n        // Global generic value handler\r\n        el.val = function(val) {\r\n            if (val === undefined) {\r\n                return obj.getValue();\r\n            } else {\r\n                obj.setValue(val);\r\n            }\r\n        }\r\n\r\n        // Keep object available from the node\r\n        el.calendar = calendar.calendar = obj;\r\n    }\r\n\r\n    init();\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.calendar.keydown = function(e) {\r\n    var calendar = null;\r\n    if (calendar = jSuites.calendar.current) { \r\n        if (e.which == 13) {\r\n            // ENTER\r\n            calendar.close(false, true);\r\n        } else if (e.which == 27) {\r\n            // ESC\r\n            calendar.close(false, false);\r\n        }\r\n    }\r\n}\r\n\r\njSuites.calendar.prettify = function(d, texts) {\r\n    if (! texts) {\r\n        var texts = {\r\n            justNow: 'Just now',\r\n            xMinutesAgo: '{0}m ago',\r\n            xHoursAgo: '{0}h ago',\r\n            xDaysAgo: '{0}d ago',\r\n            xWeeksAgo: '{0}w ago',\r\n            xMonthsAgo: '{0} mon ago',\r\n            xYearsAgo: '{0}y ago',\r\n        }\r\n    }\r\n\r\n    var d1 = new Date();\r\n    var d2 = new Date(d);\r\n    var total = parseInt((d1 - d2) / 1000 / 60);\r\n\r\n    String.prototype.format = function(o) {\r\n        return this.replace('{0}', o);\r\n    }\r\n\r\n    if (total == 0) {\r\n        var text = texts.justNow;\r\n    } else if (total < 90) {\r\n        var text = texts.xMinutesAgo.format(total);\r\n    } else if (total < 1440) { // One day\r\n        var text = texts.xHoursAgo.format(Math.round(total/60));\r\n    } else if (total < 20160) { // 14 days\r\n        var text = texts.xDaysAgo.format(Math.round(total / 1440));\r\n    } else if (total < 43200) { // 30 days\r\n        var text = texts.xWeeksAgo.format(Math.round(total / 10080));\r\n    } else if (total < 1036800) { // 24 months\r\n        var text = texts.xMonthsAgo.format(Math.round(total / 43200));\r\n    } else { // 24 months+\r\n        var text = texts.xYearsAgo.format(Math.round(total / 525600));\r\n    }\r\n\r\n    return text;\r\n}\r\n\r\njSuites.calendar.prettifyAll = function() {\r\n    var elements = document.querySelectorAll('.prettydate');\r\n    for (var i = 0; i < elements.length; i++) {\r\n        if (elements[i].getAttribute('data-date')) {\r\n            elements[i].innerHTML = jSuites.calendar.prettify(elements[i].getAttribute('data-date'));\r\n        } else {\r\n            if (elements[i].innerHTML) {\r\n                elements[i].setAttribute('data-date', elements[i].innerHTML);\r\n                elements[i].innerHTML = jSuites.calendar.prettify(elements[i].innerHTML);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\njSuites.calendar.now = function(date, dateOnly) {\r\n    if (Array.isArray(date)) {\r\n        var y = date[0];\r\n        var m = date[1];\r\n        var d = date[2];\r\n        var h = date[3];\r\n        var i = date[4];\r\n        var s = date[5];\r\n    } else {\r\n        if (! date) {\r\n            var date = new Date();\r\n        }\r\n        var y = date.getFullYear();\r\n        var m = date.getMonth() + 1;\r\n        var d = date.getDate();\r\n        var h = date.getHours();\r\n        var i = date.getMinutes();\r\n        var s = date.getSeconds();\r\n    }\r\n\r\n    if (dateOnly == true) {\r\n        return jSuites.two(y) + '-' + jSuites.two(m) + '-' + jSuites.two(d);\r\n    } else {\r\n        return jSuites.two(y) + '-' + jSuites.two(m) + '-' + jSuites.two(d) + ' ' + jSuites.two(h) + ':' + jSuites.two(i) + ':' + jSuites.two(s);\r\n    }\r\n}\r\n\r\njSuites.calendar.toArray = function(value) {\r\n    var date = value.split(((value.indexOf('T') !== -1) ? 'T' : ' '));\r\n    var time = date[1];\r\n    var date = date[0].split('-');\r\n    var y = parseInt(date[0]);\r\n    var m = parseInt(date[1]);\r\n    var d = parseInt(date[2]);\r\n\r\n    if (time) {\r\n        var time = time.split(':');\r\n        var h = parseInt(time[0]);\r\n        var i = parseInt(time[1]);\r\n    } else {\r\n        var h = 0;\r\n        var i = 0;\r\n    }\r\n    return [ y, m, d, h, i, 0 ];\r\n}\r\n\r\n// Helper to extract date from a string\r\njSuites.calendar.extractDateFromString = function(date, format) {\r\n    if (date > 0 && Number(date) == date) {\r\n        var d = new Date(Math.round((date - 25569)*86400*1000));\r\n        return d.getFullYear() + \"-\" + jSuites.two(d.getMonth()) + \"-\" + jSuites.two(d.getDate()) + ' 00:00:00';\r\n    }\r\n\r\n    var o = jSuites.mask(date, { mask: format }, true);\r\n    if (o.date[0] && o.date[1]) {\r\n        if (! o.date[2]) {\r\n            o.date[2] = 1;\r\n        }\r\n\r\n        return o.date[0] + '-' + jSuites.two(o.date[1]) + '-' + jSuites.two(o.date[2]) + ' ' + jSuites.two(o.date[3]) + ':' + jSuites.two(o.date[4])+ ':' + jSuites.two(o.date[5]);\r\n    }\r\n    return '';\r\n}\r\n\r\n/**\r\n * Date to number\r\n */\r\njSuites.calendar.dateToNum = function(a, b) {\r\n    a = new Date(a);\r\n    if (! b) {\r\n        b = '1899-12-30 ' + a.getHours() + ':' + a.getMinutes() + ':' + a.getSeconds();\r\n    }\r\n    b = new Date(b);\r\n    var v = a.getTime() - b.getTime();\r\n    return Math.round(v / 86400000);\r\n}\r\n\r\n/**\r\n * Number to date\r\n */\r\njSuites.calendar.numToDate = function(value) {\r\n    var d = new Date(Math.round((value - 25569)*86400*1000));\r\n    return d.getFullYear() + \"-\" + jSuites.two(d.getMonth()+1) + \"-\" + jSuites.two(d.getDate()) + ' 00:00:00';\r\n}\r\n\r\n// Helper to convert date into string\r\njSuites.calendar.getDateString = function(value, options) {\r\n    if (! options) {\r\n        var options = {};\r\n    }\r\n\r\n    // Labels\r\n    if (options && typeof(options) == 'object') {\r\n        var format = options.format;\r\n    } else {\r\n        var format = options;\r\n    }\r\n\r\n    if (! format) {\r\n        format = 'YYYY-MM-DD';\r\n    }\r\n\r\n    // Convert to number of hours\r\n    if (typeof(value) == 'number' && format.indexOf('[h]') >= 0) {\r\n        var result = parseFloat(24 * Number(value));\r\n        if (format.indexOf('mm') >= 0) {\r\n            var h = (''+result).split('.');\r\n            if (h[1]) {\r\n                var d = 60 * parseFloat('0.' + h[1])\r\n                d = parseFloat(d.toFixed(2));\r\n            } else {\r\n                var d = 0;\r\n            }\r\n            result = parseInt(h[0]) + ':' + jSuites.two(d);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    // Date instance\r\n    if (value instanceof Date) {\r\n        value = jSuites.calendar.now(value);\r\n    } else if (value && jSuites.isNumeric(value)) {\r\n        value = jSuites.calendar.numToDate(value);\r\n    }\r\n\r\n    // Tokens\r\n    var tokens = [ 'DAY', 'WD', 'DDDD', 'DDD', 'DD', 'D', 'Q', 'HH24', 'HH12', 'HH', 'H', 'AM/PM', 'MI', 'SS', 'MS', 'YYYY', 'YYY', 'YY', 'Y', 'MONTH', 'MON', 'MMMMM', 'MMMM', 'MMM', 'MM', 'M', '.' ];\r\n\r\n    // Expression to extract all tokens from the string\r\n    var e = new RegExp(tokens.join('|'), 'gi');\r\n    // Extract\r\n    var t = format.match(e);\r\n\r\n    // Compatibility with excel\r\n    for (var i = 0; i < t.length; i++) {\r\n        if (t[i].toUpperCase() == 'MM') {\r\n            // Not a month, correct to minutes\r\n            if (t[i-1] && t[i-1].toUpperCase().indexOf('H') >= 0) {\r\n                t[i] = 'mi';\r\n            } else if (t[i-2] && t[i-2].toUpperCase().indexOf('H') >= 0) {\r\n                t[i] = 'mi';\r\n            } else if (t[i+1] && t[i+1].toUpperCase().indexOf('S') >= 0) {\r\n                t[i] = 'mi';\r\n            } else if (t[i+2] && t[i+2].toUpperCase().indexOf('S') >= 0) {\r\n                t[i] = 'mi';\r\n            }\r\n        }\r\n    }\r\n\r\n    // Object\r\n    var o = {\r\n        tokens: t\r\n    }\r\n\r\n    // Value\r\n    if (value) {\r\n        var d = ''+value;\r\n        var splitStr = (d.indexOf('T') !== -1) ? 'T' : ' ';\r\n        d = d.split(splitStr);\r\n \r\n        var h = 0;\r\n        var m = 0;\r\n        var s = 0;\r\n\r\n        if (d[1]) {\r\n            h = d[1].split(':');\r\n            m = h[1] ? h[1] : 0;\r\n            s = h[2] ? h[2] : 0;\r\n            h = h[0] ? h[0] : 0;\r\n        }\r\n\r\n        d = d[0].split('-');\r\n\r\n        if (d[0] && d[1] && d[2] && d[0] > 0 && d[1] > 0 && d[1] < 13 && d[2] > 0 && d[2] < 32) {\r\n\r\n            // Data\r\n            o.data = [ d[0], d[1], d[2], h, m, s ];\r\n\r\n            // Value\r\n            o.value = [];\r\n\r\n            // Calendar instance\r\n            var calendar = new Date(o.data[0], o.data[1]-1, o.data[2], o.data[3], o.data[4], o.data[5]);\r\n\r\n            // Get method\r\n            var get = function(i) {\r\n                // Token\r\n                var t = this.tokens[i];\r\n                // Case token\r\n                var s = t.toUpperCase();\r\n                var v = null;\r\n\r\n                if (s === 'YYYY') {\r\n                    v = this.data[0];\r\n                } else if (s === 'YYY') {\r\n                    v = this.data[0].substring(1,4);\r\n                } else if (s === 'YY') {\r\n                    v = this.data[0].substring(2,4);\r\n                } else if (s === 'Y') {\r\n                    v = this.data[0].substring(3,4);\r\n                } else if (t === 'MON') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()].substr(0,3).toUpperCase();\r\n                } else if (t === 'mon') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()].substr(0,3).toLowerCase();\r\n                } else if (t === 'MONTH') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()].toUpperCase();\r\n                } else if (t === 'month') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()].toLowerCase();\r\n                } else if (s === 'MMMMM') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()].substr(0, 1);\r\n                } else if (s === 'MMMM' || t === 'Month') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()];\r\n                } else if (s === 'MMM' || t == 'Mon') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()].substr(0,3);\r\n                } else if (s === 'MM') {\r\n                    v = jSuites.two(this.data[1]);\r\n                } else if (s === 'M') {\r\n                    v = calendar.getMonth()+1;\r\n                } else if (t === 'DAY') {\r\n                    v = jSuites.calendar.weekdays[calendar.getDay()].toUpperCase();\r\n                } else if (t === 'day') {\r\n                    v = jSuites.calendar.weekdays[calendar.getDay()].toLowerCase();\r\n                } else if (s === 'DDDD' || t == 'Day') {\r\n                    v = jSuites.calendar.weekdays[calendar.getDay()];\r\n                } else if (s === 'DDD') {\r\n                    v = jSuites.calendar.weekdays[calendar.getDay()].substr(0,3);\r\n                } else if (s === 'DD') {\r\n                    v = jSuites.two(this.data[2]);\r\n                } else if (s === 'D') {\r\n                    v = this.data[2];\r\n                } else if (s === 'Q') {\r\n                    v = Math.floor((calendar.getMonth() + 3) / 3);\r\n                } else if (s === 'HH24' || s === 'HH') {\r\n                    v = jSuites.two(this.data[3]);\r\n                } else if (s === 'HH12') {\r\n                    if (this.data[3] > 12) {\r\n                        v = jSuites.two(this.data[3] - 12);\r\n                    } else {\r\n                        v = jSuites.two(this.data[3]);\r\n                    }\r\n                } else if (s === 'H') {\r\n                    v = this.data[3];\r\n                } else if (s === 'MI') {\r\n                    v = jSuites.two(this.data[4]);\r\n                } else if (s === 'SS') {\r\n                    v = jSuites.two(this.data[5]);\r\n                } else if (s === 'MS') {\r\n                    v = calendar.getMilliseconds();\r\n                } else if (s === 'AM/PM') {\r\n                    if (this.data[3] >= 12) {\r\n                        v = 'PM';\r\n                    } else {\r\n                        v = 'AM';\r\n                    }\r\n                } else if (s === 'WD') {\r\n                    v = jSuites.calendar.weekdays[calendar.getDay()];\r\n                }\r\n\r\n                if (v === null) {\r\n                    this.value[i] = this.tokens[i];\r\n                } else {\r\n                    this.value[i] = v;\r\n                }\r\n            }\r\n\r\n            for (var i = 0; i < o.tokens.length; i++) {\r\n                get.call(o, i);\r\n            }\r\n            // Put pieces together\r\n            value = o.value.join('');\r\n        } else {\r\n            value = '';\r\n        }\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n// Jsuites calendar labels\r\njSuites.calendar.weekdays = [ 'Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday' ];\r\njSuites.calendar.months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];\r\njSuites.calendar.weekdaysShort = [ 'Sun','Mon','Tue','Wed','Thu','Fri','Sat' ];\r\njSuites.calendar.monthsShort = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\r\n\r\n\r\njSuites.color = (function(el, options) {\r\n    // Already created, update options\r\n    if (el.color) {\r\n        return el.color.setOptions(options, true);\r\n    }\r\n\r\n    // New instance\r\n    var obj = { type: 'color' };\r\n    obj.options = {};\r\n\r\n    var container = null;\r\n    var backdrop = null;\r\n    var content = null;\r\n    var resetButton = null;\r\n    var closeButton = null;\r\n    var tabs = null;\r\n    var jsuitesTabs = null;\r\n\r\n    /**\r\n     * Update options\r\n     */\r\n    obj.setOptions = function(options, reset) {\r\n        /**\r\n         * @typedef {Object} defaults\r\n         * @property {(string|Array)} value - Initial value of the compontent\r\n         * @property {string} placeholder - The default instruction text on the element\r\n         * @property {requestCallback} onchange - Method to be execute after any changes on the element\r\n         * @property {requestCallback} onclose - Method to be execute when the element is closed\r\n         * @property {string} doneLabel - Label for button done\r\n         * @property {string} resetLabel - Label for button reset\r\n         * @property {string} resetValue - Value for button reset\r\n         * @property {Bool} showResetButton - Active or note for button reset - default false\r\n         */\r\n        var defaults = {\r\n            placeholder: '',\r\n            value: null,\r\n            onopen: null,\r\n            onclose: null,\r\n            onchange: null,\r\n            closeOnChange: true,\r\n            palette: null,\r\n            position: null,\r\n            doneLabel: 'Done',\r\n            resetLabel: 'Reset',\r\n            fullscreen: false,\r\n            opened: false,\r\n        }\r\n\r\n        if (! options) {\r\n            options = {};\r\n        }\r\n\r\n        if (options && ! options.palette) {\r\n            // Default pallete\r\n            options.palette = jSuites.palette();\r\n        }\r\n\r\n        // Loop through our object\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else {\r\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\r\n                    obj.options[property] = defaults[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Update the text of the controls, if they have already been created\r\n        if (resetButton) {\r\n            resetButton.innerHTML = obj.options.resetLabel;\r\n        }\r\n        if (closeButton) {\r\n            closeButton.innerHTML = obj.options.doneLabel;\r\n        }\r\n\r\n        // Update the pallete\r\n        if (obj.options.palette && jsuitesTabs) {\r\n            jsuitesTabs.updateContent(0, table());\r\n        }\r\n\r\n        // Value\r\n        if (typeof obj.options.value === 'string') {\r\n            el.value = obj.options.value;\r\n        }\r\n\r\n        // Placeholder\r\n        if (obj.options.placeholder) {\r\n            el.setAttribute('placeholder', obj.options.placeholder);\r\n        } else {\r\n            if (el.getAttribute('placeholder')) {\r\n                el.removeAttribute('placeholder');\r\n            }\r\n        }\r\n\r\n        return obj;\r\n    }\r\n\r\n    /**\r\n     * Open color pallete\r\n     */\r\n    obj.open = function() {\r\n        if (! container.classList.contains('jcolor-focus')) {\r\n            // Start tracking\r\n            jSuites.tracking(obj, true);\r\n\r\n            // Show colorpicker\r\n            container.classList.add('jcolor-focus');\r\n\r\n            var rectContent = content.getBoundingClientRect();\r\n\r\n            if (jSuites.getWindowWidth() < 800 || obj.options.fullscreen == true) {\r\n                content.style.top = '';\r\n                content.classList.add('jcolor-fullscreen');\r\n                jSuites.animation.slideBottom(content, 1);\r\n                backdrop.style.display = 'block';\r\n            } else {\r\n                if (content.classList.contains('jcolor-fullscreen')) {\r\n                    content.classList.remove('jcolor-fullscreen');\r\n                    backdrop.style.display = '';\r\n                }\r\n\r\n                var rect = el.getBoundingClientRect();\r\n\r\n                if (obj.options.position) {\r\n                    content.style.position = 'fixed';\r\n                    if (window.innerHeight < rect.bottom + rectContent.height) {\r\n                        content.style.top = (rect.top - (rectContent.height + 2)) + 'px';\r\n                    } else {\r\n                        content.style.top = (rect.top + rect.height + 2) + 'px';\r\n                    }\r\n                    content.style.left = rect.left + 'px';\r\n                } else {\r\n                    if (window.innerHeight < rect.bottom + rectContent.height) {\r\n                        content.style.top = -1 * (rectContent.height + rect.height + 2) + 'px';\r\n                    } else {\r\n                        content.style.top = '2px';\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (typeof(obj.options.onopen) == 'function') {\r\n                obj.options.onopen(el);\r\n            }\r\n\r\n            jsuitesTabs.setBorder(jsuitesTabs.getActive());\r\n\r\n            // Update sliders\r\n            if (obj.options.value) {\r\n                var rgb = HexToRgb(obj.options.value);\r\n\r\n                rgbInputs.forEach(function(rgbInput, index) {\r\n                    rgbInput.value = rgb[index];\r\n                    rgbInput.dispatchEvent(new Event('input'));\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Close color pallete\r\n     */\r\n    obj.close = function(ignoreEvents) {\r\n        if (container.classList.contains('jcolor-focus')) {\r\n            // Remove focus\r\n            container.classList.remove('jcolor-focus');\r\n            // Make sure backdrop is hidden\r\n            backdrop.style.display = '';\r\n            // Call related events\r\n            if (! ignoreEvents && typeof(obj.options.onclose) == 'function') {\r\n                obj.options.onclose(el);\r\n            }\r\n            // Stop  the object\r\n            jSuites.tracking(obj, false);\r\n        }\r\n\r\n        return obj.options.value;\r\n    }\r\n\r\n    /**\r\n     * Set value\r\n     */\r\n    obj.setValue = function(color) {\r\n        if (! color) {\r\n            color = '';\r\n        }\r\n\r\n        if (color != obj.options.value) {\r\n            obj.options.value = color;\r\n            slidersResult = color;\r\n\r\n            // Remove current selecded mark\r\n            var selected = container.querySelector('.jcolor-selected');\r\n            if (selected) {\r\n                selected.classList.remove('jcolor-selected');\r\n            }\r\n\r\n            // Mark cell as selected\r\n            if (obj.values[color]) {\r\n                obj.values[color].classList.add('jcolor-selected');\r\n            }\r\n\r\n            // Onchange\r\n            if (typeof(obj.options.onchange) == 'function') {\r\n                obj.options.onchange(el, color);\r\n            }\r\n\r\n            // Changes\r\n            if (el.value != obj.options.value) {\r\n                // Set input value\r\n                el.value = obj.options.value;\r\n                // Element onchange native\r\n                if (typeof(el.onchange) == 'function') {\r\n                    el.onchange({\r\n                        type: 'change',\r\n                        target: el,\r\n                        value: el.value\r\n                    });\r\n                }\r\n            }\r\n\r\n            if (obj.options.closeOnChange == true) {\r\n                obj.close();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get value\r\n     */\r\n    obj.getValue = function() {\r\n        return obj.options.value;\r\n    }\r\n\r\n    var backdropClickControl = false;\r\n\r\n    // Converts a number in decimal to hexadecimal\r\n    var decToHex = function(num) {\r\n        var hex = num.toString(16);\r\n        return hex.length === 1 ? \"0\" + hex : hex;\r\n    }\r\n\r\n    // Converts a color in rgb to hexadecimal\r\n    var rgbToHex = function(r, g, b) {\r\n        return \"#\" + decToHex(r) + decToHex(g) + decToHex(b);\r\n    }\r\n\r\n    // Converts a number in hexadecimal to decimal\r\n    var hexToDec = function(hex) {\r\n        return parseInt('0x' + hex);\r\n    }\r\n\r\n    // Converts a color in hexadecimal to rgb\r\n    var HexToRgb = function(hex) {\r\n        return [hexToDec(hex.substr(1, 2)), hexToDec(hex.substr(3, 2)), hexToDec(hex.substr(5, 2))]\r\n    }\r\n\r\n    var table = function() {\r\n        // Content of the first tab\r\n        var tableContainer = document.createElement('div');\r\n        tableContainer.className = 'jcolor-grid';\r\n\r\n        // Cells\r\n        obj.values = [];\r\n\r\n        // Table pallete\r\n        var t = document.createElement('table');\r\n        t.setAttribute('cellpadding', '7');\r\n        t.setAttribute('cellspacing', '0');\r\n\r\n        for (var j = 0; j < obj.options.palette.length; j++) {\r\n            var tr = document.createElement('tr');\r\n            for (var i = 0; i < obj.options.palette[j].length; i++) {\r\n                var td = document.createElement('td');\r\n                var color = obj.options.palette[j][i];\r\n                if (color.length < 7 && color.substr(0,1) !== '#') {\r\n                    color = '#' + color;\r\n                }\r\n                td.style.backgroundColor = color;\r\n                td.setAttribute('data-value', color);\r\n                td.innerHTML = '';\r\n                tr.appendChild(td);\r\n\r\n                // Selected color\r\n                if (obj.options.value == color) {\r\n                    td.classList.add('jcolor-selected');\r\n                }\r\n\r\n                // Possible values\r\n                obj.values[color] = td;\r\n            }\r\n            t.appendChild(tr);\r\n        }\r\n\r\n        // Append to the table\r\n        tableContainer.appendChild(t);\r\n\r\n        // Select color\r\n        tableContainer.addEventListener(\"mousedown\", function(e) {\r\n            if (e.target.tagName == 'TD') {\r\n                var value = e.target.getAttribute('data-value');\r\n                if (value) {\r\n                    obj.setValue(value);\r\n                }\r\n            }\r\n        });\r\n\r\n        return tableContainer;\r\n    }\r\n\r\n    // Canvas where the image will be rendered\r\n    var canvas = document.createElement('canvas');\r\n    canvas.width = 200;\r\n    canvas.height = 160;\r\n    var context = canvas.getContext(\"2d\");\r\n\r\n    var resizeCanvas = function() {\r\n        // Specifications necessary to correctly obtain colors later in certain positions\r\n        var m = tabs.firstChild.getBoundingClientRect();\r\n        canvas.width = m.width - 14;\r\n        gradient()\r\n    }\r\n\r\n    var gradient = function() {\r\n        var g = context.createLinearGradient(0, 0, canvas.width, 0);\r\n        // Create color gradient\r\n        g.addColorStop(0,    \"rgb(255,0,0)\");\r\n        g.addColorStop(0.15, \"rgb(255,0,255)\");\r\n        g.addColorStop(0.33, \"rgb(0,0,255)\");\r\n        g.addColorStop(0.49, \"rgb(0,255,255)\");\r\n        g.addColorStop(0.67, \"rgb(0,255,0)\");\r\n        g.addColorStop(0.84, \"rgb(255,255,0)\");\r\n        g.addColorStop(1,    \"rgb(255,0,0)\");\r\n        context.fillStyle = g;\r\n        context.fillRect(0, 0, canvas.width, canvas.height);\r\n        g = context.createLinearGradient(0, 0, 0, canvas.height);\r\n        g.addColorStop(0,   \"rgba(255,255,255,1)\");\r\n        g.addColorStop(0.5, \"rgba(255,255,255,0)\");\r\n        g.addColorStop(0.5, \"rgba(0,0,0,0)\");\r\n        g.addColorStop(1,   \"rgba(0,0,0,1)\");\r\n        context.fillStyle = g;\r\n        context.fillRect(0, 0, canvas.width, canvas.height);\r\n    }\r\n\r\n    var hsl = function() {\r\n        var element = document.createElement('div');\r\n        element.className = \"jcolor-hsl\";\r\n\r\n        var point = document.createElement('div');\r\n        point.className = 'jcolor-point';\r\n\r\n        var div = document.createElement('div');\r\n        div.appendChild(canvas);\r\n        div.appendChild(point);\r\n        element.appendChild(div);\r\n\r\n        // Moves the marquee point to the specified position\r\n        var update = function(buttons, x, y) {\r\n            if (buttons === 1) {\r\n                var rect = element.getBoundingClientRect();\r\n                var left = x - rect.left;\r\n                var top = y - rect.top;\r\n                if (left < 0) {\r\n                    left = 0;\r\n                }\r\n                if (top < 0) {\r\n                    top = 0;\r\n                }\r\n                if (left > rect.width) {\r\n                    left = rect.width;\r\n                }\r\n                if (top > rect.height) {\r\n                    top = rect.height;\r\n                }\r\n                point.style.left = left + 'px';\r\n                point.style.top = top + 'px';\r\n                var pixel = context.getImageData(left, top, 1, 1).data;\r\n                slidersResult = rgbToHex(pixel[0], pixel[1], pixel[2]);\r\n            }\r\n        }\r\n\r\n        // Applies the point's motion function to the div that contains it\r\n        element.addEventListener('mousedown', function(e) {\r\n            update(e.buttons, e.clientX, e.clientY);\r\n        });\r\n\r\n        element.addEventListener('mousemove', function(e) {\r\n            update(e.buttons, e.clientX, e.clientY);\r\n        });\r\n\r\n        element.addEventListener('touchmove', function(e) {\r\n            update(1, e.changedTouches[0].clientX, e.changedTouches[0].clientY);\r\n        });\r\n\r\n        return element;\r\n    }\r\n\r\n    var slidersResult = '';\r\n\r\n    var rgbInputs = [];\r\n\r\n    var changeInputColors = function() {\r\n        if (slidersResult !== '') {\r\n            for (var j = 0; j < rgbInputs.length; j++) {\r\n                var currentColor = HexToRgb(slidersResult);\r\n\r\n                currentColor[j] = 0;\r\n\r\n                var newGradient = 'linear-gradient(90deg, rgb(';\r\n                newGradient += currentColor.join(', ');\r\n                newGradient += '), rgb(';\r\n\r\n                currentColor[j] = 255;\r\n\r\n                newGradient += currentColor.join(', ');\r\n                newGradient += '))';\r\n\r\n                rgbInputs[j].style.backgroundImage = newGradient;\r\n            }\r\n        }\r\n    }\r\n\r\n    var sliders = function() {\r\n        // Content of the third tab\r\n        var slidersElement = document.createElement('div');\r\n        slidersElement.className = 'jcolor-sliders';\r\n\r\n        var slidersBody = document.createElement('div');\r\n\r\n        // Creates a range-type input with the specified name\r\n        var createSliderInput = function(name) {\r\n            var inputContainer = document.createElement('div');\r\n            inputContainer.className = 'jcolor-sliders-input-container';\r\n\r\n            var label = document.createElement('label');\r\n            label.innerText = name;\r\n\r\n            var subContainer = document.createElement('div');\r\n            subContainer.className = 'jcolor-sliders-input-subcontainer';\r\n\r\n            var input = document.createElement('input');\r\n            input.type = 'range';\r\n            input.min = 0;\r\n            input.max = 255;\r\n            input.value = 0;\r\n\r\n            inputContainer.appendChild(label);\r\n            subContainer.appendChild(input);\r\n\r\n            var value = document.createElement('div');\r\n            value.innerText = input.value;\r\n\r\n            input.addEventListener('input', function() {\r\n                value.innerText = input.value;\r\n            });\r\n\r\n            subContainer.appendChild(value);\r\n            inputContainer.appendChild(subContainer);\r\n\r\n            slidersBody.appendChild(inputContainer);\r\n\r\n            return input;\r\n        }\r\n\r\n        // Creates red, green and blue inputs\r\n        rgbInputs = [\r\n            createSliderInput('Red'),\r\n            createSliderInput('Green'),\r\n            createSliderInput('Blue'),\r\n        ];\r\n\r\n        slidersElement.appendChild(slidersBody);\r\n\r\n        // Element that prints the current color\r\n        var slidersResultColor = document.createElement('div');\r\n        slidersResultColor.className = 'jcolor-sliders-final-color';\r\n\r\n        var resultElement = document.createElement('div');\r\n        resultElement.style.visibility = 'hidden';\r\n        resultElement.innerText = 'a';\r\n        slidersResultColor.appendChild(resultElement)\r\n\r\n        // Update the element that prints the current color\r\n        var updateResult = function() {\r\n            var resultColor = rgbToHex(parseInt(rgbInputs[0].value), parseInt(rgbInputs[1].value), parseInt(rgbInputs[2].value));\r\n\r\n            resultElement.innerText = resultColor;\r\n            resultElement.style.color = resultColor;\r\n            resultElement.style.removeProperty('visibility');\r\n\r\n            slidersResult = resultColor;\r\n        }\r\n\r\n        // Apply the update function to color inputs\r\n        rgbInputs.forEach(function(rgbInput) {\r\n            rgbInput.addEventListener('input', function() {\r\n                updateResult();\r\n                changeInputColors();\r\n            });\r\n        });\r\n\r\n        slidersElement.appendChild(slidersResultColor);\r\n\r\n        return slidersElement;\r\n    }\r\n\r\n    var init = function() {\r\n        // Initial options\r\n        obj.setOptions(options);\r\n\r\n        // Add a proper input tag when the element is an input\r\n        if (el.tagName == 'INPUT') {\r\n            el.classList.add('jcolor-input');\r\n            el.readOnly = true;\r\n        }\r\n\r\n        // Table container\r\n        container = document.createElement('div');\r\n        container.className = 'jcolor';\r\n\r\n        // Table container\r\n        backdrop = document.createElement('div');\r\n        backdrop.className = 'jcolor-backdrop';\r\n        container.appendChild(backdrop);\r\n\r\n        // Content\r\n        content = document.createElement('div');\r\n        content.className = 'jcolor-content';\r\n\r\n        // Controls\r\n        var controls = document.createElement('div');\r\n        controls.className = 'jcolor-controls';\r\n        content.appendChild(controls);\r\n\r\n        // Reset button\r\n        resetButton  = document.createElement('div');\r\n        resetButton.className = 'jcolor-reset';\r\n        resetButton.innerHTML = obj.options.resetLabel;\r\n        resetButton.onclick = function(e) {\r\n            obj.setValue('');\r\n            obj.close();\r\n        }\r\n        controls.appendChild(resetButton);\r\n\r\n        // Close button\r\n        closeButton  = document.createElement('div');\r\n        closeButton.className = 'jcolor-close';\r\n        closeButton.innerHTML = obj.options.doneLabel;\r\n        closeButton.onclick = function(e) {\r\n            if (jsuitesTabs.getActive() > 0) {\r\n                obj.setValue(slidersResult);\r\n            }\r\n            obj.close();\r\n        }\r\n        controls.appendChild(closeButton);\r\n\r\n        // Element that will be used to create the tabs\r\n        tabs = document.createElement('div');\r\n        content.appendChild(tabs);\r\n\r\n        // Starts the jSuites tabs component\r\n        jsuitesTabs = jSuites.tabs(tabs, {\r\n            animation: true,\r\n            data: [\r\n                {\r\n                    title: 'Grid',\r\n                    contentElement: table(),\r\n                },\r\n                {\r\n                    title: 'Spectrum',\r\n                    contentElement: hsl(),\r\n                },\r\n                {\r\n                    title: 'Sliders',\r\n                    contentElement: sliders(),\r\n                }\r\n            ],\r\n            onchange: function(element, instance, index) {\r\n                if (index === 1) {\r\n                    resizeCanvas();\r\n                } else {\r\n                    var color = slidersResult !== '' ? slidersResult : obj.getValue();\r\n\r\n                    if (index === 2 && color) {\r\n                        var rgb = HexToRgb(color);\r\n\r\n                        rgbInputs.forEach(function(rgbInput, index) {\r\n                            rgbInput.value = rgb[index];\r\n                            rgbInput.dispatchEvent(new Event('input'));\r\n                        });\r\n                    }\r\n                }\r\n            },\r\n            palette: 'modern',\r\n        });\r\n\r\n        container.appendChild(content);\r\n\r\n        // Insert picker after the element\r\n        if (el.tagName == 'INPUT') {\r\n            el.parentNode.insertBefore(container, el.nextSibling);\r\n        } else {\r\n            el.appendChild(container);\r\n        }\r\n\r\n        /**\r\n         * If element is focus open the picker\r\n         */\r\n        el.addEventListener(\"mouseup\", function(e) {\r\n            obj.open();\r\n        });\r\n\r\n        backdrop.addEventListener(\"mousedown\", function(e) {\r\n            backdropClickControl = true;\r\n        });\r\n\r\n        backdrop.addEventListener(\"mouseup\", function(e) {\r\n            if (backdropClickControl) {\r\n                obj.close();\r\n                backdropClickControl = false;\r\n            }\r\n        });\r\n\r\n        // If the picker is open on the spectrum tab, it changes the canvas size when the window size is changed\r\n        window.addEventListener('resize', function() {\r\n            if (container.classList.contains('jcolor-focus') && jsuitesTabs.getActive() == 1) {\r\n                resizeCanvas();\r\n            }\r\n        });\r\n\r\n        // Default opened\r\n        if (obj.options.opened == true) {\r\n            obj.open();\r\n        }\r\n\r\n        // Change\r\n        el.change = obj.setValue;\r\n\r\n        // Global generic value handler\r\n        el.val = function(val) {\r\n            if (val === undefined) {\r\n                return obj.getValue();\r\n            } else {\r\n                obj.setValue(val);\r\n            }\r\n        }\r\n\r\n        // Keep object available from the node\r\n        el.color = obj;\r\n\r\n        // Container shortcut\r\n        container.color = obj;\r\n    }\r\n\r\n    init();\r\n\r\n    return obj;\r\n});\r\n\r\n\r\n\r\njSuites.contextmenu = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        items: null,\r\n        onclick: null,\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Class definition\r\n    el.classList.add('jcontextmenu');\r\n    // Focusable\r\n    el.setAttribute('tabindex', '900');\r\n\r\n    /**\r\n     * Open contextmenu\r\n     */\r\n    obj.open = function(e, items) {\r\n        if (items) {\r\n            // Update content\r\n            obj.options.items = items;\r\n            // Create items\r\n            obj.create(items);\r\n        }\r\n\r\n        // Coordinates\r\n        if ((obj.options.items && obj.options.items.length > 0) || el.children.length) {\r\n            if (e.target) {\r\n                var x = e.clientX;\r\n                var y = e.clientY;\r\n            } else {\r\n                var x = e.x;\r\n                var y = e.y;\r\n            }\r\n\r\n            el.classList.add('jcontextmenu-focus');\r\n            el.focus();\r\n\r\n            var rect = el.getBoundingClientRect();\r\n\r\n            if (window.innerHeight < y + rect.height) {\r\n                var h = y - rect.height;\r\n                if (h < 0) {\r\n                    h = 0;\r\n                }\r\n                el.style.top = h + 'px';\r\n            } else {\r\n                el.style.top = y + 'px';\r\n            }\r\n\r\n            if (window.innerWidth < x + rect.width) {\r\n                if (x - rect.width > 0) {\r\n                    el.style.left = (x - rect.width) + 'px';\r\n                } else {\r\n                    el.style.left = '10px';\r\n                }\r\n            } else {\r\n                el.style.left = x + 'px';\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Close menu\r\n     */\r\n    obj.close = function() {\r\n        if (el.classList.contains('jcontextmenu-focus')) {\r\n            el.classList.remove('jcontextmenu-focus');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Create items based on the declared objectd\r\n     * @param {object} items - List of object\r\n     */\r\n    obj.create = function(items) {\r\n        // Update content\r\n        el.innerHTML = '';\r\n\r\n        // Add header contextmenu\r\n        var itemHeader = createHeader();\r\n        el.appendChild(itemHeader);\r\n\r\n        // Append items\r\n        for (var i = 0; i < items.length; i++) {\r\n            var itemContainer = createItemElement(items[i]);\r\n            el.appendChild(itemContainer);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * createHeader for context menu\r\n     * @private\r\n     * @returns {HTMLElement}\r\n     */\r\n    function createHeader() {\r\n        var header = document.createElement('div');\r\n        header.classList.add(\"header\");\r\n        header.addEventListener(\"click\", function(e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        });\r\n        var title = document.createElement('a');\r\n        title.classList.add(\"title\");\r\n        title.innerHTML = jSuites.translate(\"Menu\");\r\n\r\n        header.appendChild(title);\r\n\r\n        var closeButton = document.createElement('a');\r\n        closeButton.classList.add(\"close\");\r\n        closeButton.innerHTML = jSuites.translate(\"close\");\r\n        closeButton.addEventListener(\"click\", function(e) {\r\n            obj.close();\r\n        });\r\n\r\n        header.appendChild(closeButton);\r\n\r\n        return header;\r\n    }\r\n\r\n    /**\r\n     * Private function for create a new Item element\r\n     * @param {type} item\r\n     * @returns {jsuitesL#15.jSuites.contextmenu.createItemElement.itemContainer}\r\n     */\r\n    function createItemElement(item) {\r\n        if (item.type && (item.type == 'line' || item.type == 'divisor')) {\r\n            var itemContainer = document.createElement('hr');\r\n        } else {\r\n            var itemContainer = document.createElement('div');\r\n            var itemText = document.createElement('a');\r\n            itemText.innerHTML = item.title;\r\n\r\n            if (item.tooltip) {\r\n                itemContainer.setAttribute('title', item.tooltip);\r\n            }\r\n\r\n            if (item.icon) {\r\n                itemContainer.setAttribute('data-icon', item.icon);\r\n            }\r\n\r\n            if (item.id) {\r\n                itemContainer.id = item.id;\r\n            }\r\n\r\n            if (item.disabled) {\r\n                itemContainer.className = 'jcontextmenu-disabled';\r\n            } else if (item.onclick) {\r\n                itemContainer.method = item.onclick;\r\n                itemContainer.addEventListener(\"mousedown\", function(e) {\r\n                    e.preventDefault();\r\n                });\r\n                itemContainer.addEventListener(\"mouseup\", function(e) {\r\n                    // Execute method\r\n                    this.method(this, e);\r\n                });\r\n            }\r\n            itemContainer.appendChild(itemText);\r\n\r\n            if (item.submenu) {\r\n                var itemIconSubmenu = document.createElement('span');\r\n                itemIconSubmenu.innerHTML = \"&#9658;\";\r\n                itemContainer.appendChild(itemIconSubmenu);\r\n                itemContainer.classList.add('jcontexthassubmenu');\r\n                var el_submenu = document.createElement('div');\r\n                // Class definition\r\n                el_submenu.classList.add('jcontextmenu');\r\n                // Focusable\r\n                el_submenu.setAttribute('tabindex', '900');\r\n\r\n                // Append items\r\n                var submenu = item.submenu;\r\n                for (var i = 0; i < submenu.length; i++) {\r\n                    var itemContainerSubMenu = createItemElement(submenu[i]);\r\n                    el_submenu.appendChild(itemContainerSubMenu);\r\n                }\r\n\r\n                itemContainer.appendChild(el_submenu);\r\n            } else if (item.shortcut) {\r\n                var itemShortCut = document.createElement('span');\r\n                itemShortCut.innerHTML = item.shortcut;\r\n                itemContainer.appendChild(itemShortCut);\r\n            }\r\n        }\r\n        return itemContainer;\r\n    }\r\n\r\n    if (typeof(obj.options.onclick) == 'function') {\r\n        el.addEventListener('click', function(e) {\r\n            obj.options.onclick(obj, e);\r\n        });\r\n    }\r\n\r\n    // Create items\r\n    if (obj.options.items) {\r\n        obj.create(obj.options.items);\r\n    }\r\n\r\n    el.addEventListener('blur', function(e) {\r\n        obj.close();\r\n    });\r\n\r\n    if (! jSuites.contextmenu.hasEvents) {\r\n        window.addEventListener(\"mousewheel\", function() {\r\n            obj.close();\r\n        });\r\n\r\n        document.addEventListener(\"contextmenu\", function(e) {\r\n            var id = jSuites.contextmenu.getElement(e.target);\r\n            if (id) {\r\n                var element = document.querySelector('#' + id);\r\n                if (! element) {\r\n                    console.error('JSUITES: Contextmenu id not found');\r\n                } else {\r\n                    element.contextmenu.open(e);\r\n                    e.preventDefault();\r\n                }\r\n            }\r\n        });\r\n\r\n        jSuites.contextmenu.hasEvents = true;\r\n    }\r\n\r\n    el.contextmenu = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.contextmenu.getElement = function(element) {\r\n    var foundId = 0;\r\n\r\n    function path (element) {\r\n        if (element.parentNode && element.getAttribute('aria-contextmenu-id')) {\r\n            foundId = element.getAttribute('aria-contextmenu-id')\r\n        } else {\r\n            if (element.parentNode) {\r\n                path(element.parentNode);\r\n            }\r\n        }\r\n    }\r\n\r\n    path(element);\r\n\r\n    return foundId;\r\n}\r\n\r\n\r\njSuites.dropdown = (function(el, options) {\r\n    // Already created, update options\r\n    if (el.dropdown) {\r\n        return el.dropdown.setOptions(options, true);\r\n    }\r\n\r\n    // New instance\r\n    var obj = { type: 'dropdown' };\r\n    obj.options = {};\r\n\r\n    // Success\r\n    var success = function(data, val) {\r\n        // Set data\r\n        if (data && data.length) {\r\n            // Sort\r\n            if (obj.options.sortResults !== false) {\r\n                if(typeof obj.options.sortResults == \"function\") {\r\n                    data.sort(obj.options.sortResults);\r\n                } else {\r\n                    data.sort(sortData);\r\n                }\r\n            }\r\n\r\n            obj.setData(data);\r\n\r\n            // Onload method\r\n            if (typeof(obj.options.onload) == 'function') {\r\n                obj.options.onload(el, obj, data, val);\r\n            }\r\n        }\r\n\r\n        // Set value\r\n        if (val) {\r\n            applyValue(val);\r\n        }\r\n\r\n        // Component value\r\n        if (val === undefined || val === null) {\r\n            obj.options.value = '';\r\n        }\r\n        el.value = obj.options.value;\r\n\r\n        // Open dropdown\r\n        if (obj.options.opened == true) {\r\n            obj.open();\r\n        }\r\n    }\r\n\r\n    \r\n    // Default sort\r\n    var sortData = function(itemA, itemB) {\r\n        var testA, testB;\r\n        if(typeof itemA == \"string\") {\r\n            testA = itemA;\r\n        } else {\r\n            if(itemA.text) {\r\n                testA = itemA.text;\r\n            } else if(itemA.name) {\r\n                testA = itemA.name;\r\n            }\r\n        }\r\n        \r\n        if(typeof itemB == \"string\") {\r\n            testB = itemB;\r\n        } else {\r\n            if(itemB.text) {\r\n                testB = itemB.text;\r\n            } else if(itemB.name) {\r\n                testB = itemB.name;\r\n            }\r\n        }\r\n        \r\n        if(typeof testA == \"string\" || typeof testB == \"string\") {\r\n            if(typeof testA != \"string\") { testA = \"\"+testA; }\r\n            if(typeof testB != \"string\") { testB = \"\"+testB; }\r\n            return testA.localeCompare(testB);\r\n        } else {\r\n            return testA - testB;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Reset the options for the dropdown\r\n     */\r\n    var resetValue = function() {\r\n        // Reset value container\r\n        obj.value = {};\r\n        // Remove selected\r\n        for (var i = 0; i < obj.items.length; i++) {\r\n            if (obj.items[i].selected == true) {\r\n                if (obj.items[i].element) {\r\n                    obj.items[i].element.classList.remove('jdropdown-selected')\r\n                }\r\n                obj.items[i].selected = null;\r\n            }\r\n        }\r\n        // Reset options\r\n        obj.options.value = '';\r\n    }\r\n\r\n    /**\r\n     * Apply values to the dropdown\r\n     */\r\n    var applyValue = function(values) {\r\n        // Reset the current values\r\n        resetValue();\r\n\r\n        // Read values\r\n        if (values !== null) {\r\n            if (! values) {\r\n                if (typeof(obj.value['']) !== 'undefined') {\r\n                    obj.value[''] = '';\r\n                }\r\n            } else {\r\n                if (! Array.isArray(values)) {\r\n                    values = ('' + values).split(';');\r\n                }\r\n                for (var i = 0; i < values.length; i++) {\r\n                    obj.value[values[i]] = '';\r\n                }\r\n            }\r\n        }\r\n\r\n        // Update the DOM\r\n        for (var i = 0; i < obj.items.length; i++) {\r\n            if (typeof(obj.value[Value(i)]) !== 'undefined') {\r\n                if (obj.items[i].element) {\r\n                    obj.items[i].element.classList.add('jdropdown-selected')\r\n                }\r\n                obj.items[i].selected = true;\r\n\r\n                // Keep label\r\n                obj.value[Value(i)] = Text(i);\r\n            }\r\n        }\r\n\r\n        // Global value\r\n        obj.options.value = Object.keys(obj.value).join(';');\r\n\r\n        // Update labels\r\n        obj.header.value = obj.getText();\r\n    }\r\n\r\n    // Get the value of one item\r\n    var Value = function(k, v) {\r\n        // Legacy purposes\r\n        if (! obj.options.format) {\r\n            var property = 'value';\r\n        } else {\r\n            var property = 'id';\r\n        }\r\n\r\n        if (obj.items[k]) {\r\n            if (v !== undefined) {\r\n                return obj.items[k].data[property] = v;\r\n            } else {\r\n                return obj.items[k].data[property];\r\n            }\r\n        }\r\n\r\n        return '';\r\n    }\r\n\r\n    // Get the label of one item\r\n    var Text = function(k, v) {\r\n        // Legacy purposes\r\n        if (! obj.options.format) {\r\n            var property = 'text';\r\n        } else {\r\n            var property = 'name';\r\n        }\r\n\r\n        if (obj.items[k]) {\r\n            if (v !== undefined) {\r\n                return obj.items[k].data[property] = v;\r\n            } else {\r\n                return obj.items[k].data[property];\r\n            }\r\n        }\r\n\r\n        return '';\r\n    }\r\n\r\n    var getValue = function() {\r\n        return Object.keys(obj.value);\r\n    }\r\n\r\n    var getText = function() {\r\n        var data = [];\r\n        var k = Object.keys(obj.value);\r\n        for (var i = 0; i < k.length; i++) {\r\n            data.push(obj.value[k[i]]);\r\n        }\r\n        return data;\r\n    }\r\n\r\n    obj.setOptions = function(options, reset) {\r\n        if (! options) {\r\n            options = {};\r\n        }\r\n\r\n        // Default configuration\r\n        var defaults = {\r\n            url: null,\r\n            data: [],\r\n            format: 0,\r\n            multiple: false,\r\n            autocomplete: false,\r\n            remoteSearch: false,\r\n            lazyLoading: false,\r\n            type: null,\r\n            width: null,\r\n            maxWidth: null,\r\n            opened: false,\r\n            value: null,\r\n            placeholder: '',\r\n            newOptions: false,\r\n            position: false,\r\n            onchange: null,\r\n            onload: null,\r\n            onopen: null,\r\n            onclose: null,\r\n            onfocus: null,\r\n            onblur: null,\r\n            oninsert: null,\r\n            onbeforeinsert: null,\r\n            sortResults: false,\r\n            autofocus: false,\r\n        }\r\n\r\n        // Loop through our object\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else {\r\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\r\n                    obj.options[property] = defaults[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Force autocomplete search\r\n        if (obj.options.remoteSearch == true || obj.options.type === 'searchbar') {\r\n            obj.options.autocomplete = true;\r\n        }\r\n\r\n        // New options\r\n        if (obj.options.newOptions == true) {\r\n            obj.header.classList.add('jdropdown-add');\r\n        } else {\r\n            obj.header.classList.remove('jdropdown-add');\r\n        }\r\n\r\n        // Autocomplete\r\n        if (obj.options.autocomplete == true) {\r\n            obj.header.removeAttribute('readonly');\r\n        } else {\r\n            obj.header.setAttribute('readonly', 'readonly');\r\n        }\r\n\r\n        // Place holder\r\n        if (obj.options.placeholder) {\r\n            obj.header.setAttribute('placeholder', obj.options.placeholder);\r\n        } else {\r\n            obj.header.removeAttribute('placeholder');\r\n        }\r\n\r\n        // Remove specific dropdown typing to add again\r\n        el.classList.remove('jdropdown-searchbar');\r\n        el.classList.remove('jdropdown-picker');\r\n        el.classList.remove('jdropdown-list');\r\n\r\n        if (obj.options.type == 'searchbar') {\r\n            el.classList.add('jdropdown-searchbar');\r\n        } else if (obj.options.type == 'list') {\r\n            el.classList.add('jdropdown-list');\r\n        } else if (obj.options.type == 'picker') {\r\n            el.classList.add('jdropdown-picker');\r\n        } else {\r\n            if (jSuites.getWindowWidth() < 800) {\r\n                if (obj.options.autocomplete) {\r\n                    el.classList.add('jdropdown-searchbar');\r\n                    obj.options.type = 'searchbar';\r\n                } else {\r\n                    el.classList.add('jdropdown-picker');\r\n                    obj.options.type = 'picker';\r\n                }\r\n            } else {\r\n                if (obj.options.width) {\r\n                    el.style.width = obj.options.width;\r\n                    el.style.minWidth = obj.options.width;\r\n                } else {\r\n                    el.style.removeProperty('width');\r\n                    el.style.removeProperty('min-width');\r\n                }\r\n\r\n                el.classList.add('jdropdown-default');\r\n                obj.options.type = 'default';\r\n            }\r\n        }\r\n\r\n        // Close button\r\n        if (obj.options.type == 'searchbar') {\r\n            containerHeader.appendChild(closeButton);\r\n        } else {\r\n            container.insertBefore(closeButton, container.firstChild);\r\n        }\r\n\r\n        // Load the content\r\n        if (obj.options.url && ! options.data) {\r\n            jSuites.ajax({\r\n                url: obj.options.url,\r\n                method: 'GET',\r\n                dataType: 'json',\r\n                success: function(data) {\r\n                    if (data) {\r\n                        success(data, obj.options.value);\r\n                    }\r\n                }\r\n            });\r\n        } else {\r\n            success(obj.options.data, obj.options.value);\r\n        }\r\n\r\n        // Return the instance\r\n        return obj;\r\n    }\r\n\r\n    // Helpers\r\n    var containerHeader = null;\r\n    var container = null;\r\n    var content = null;\r\n    var closeButton = null;\r\n    var resetButton = null;\r\n    var backdrop = null;\r\n\r\n    var keyTimer = null;\r\n\r\n    /**\r\n     * Init dropdown\r\n     */\r\n    var init = function() {\r\n        // Do not accept null\r\n        if (! options) {\r\n            options = {};\r\n        }\r\n\r\n        // If the element is a SELECT tag, create a configuration object\r\n        if (el.tagName == 'SELECT') {\r\n            var ret = jSuites.dropdown.extractFromDom(el, options);\r\n            el = ret.el;\r\n            options = ret.options;\r\n        }\r\n\r\n        // Place holder\r\n        if (! options.placeholder && el.getAttribute('placeholder')) {\r\n            options.placeholder = el.getAttribute('placeholder');\r\n        }\r\n\r\n        // Value container\r\n        obj.value = {};\r\n        // Containers\r\n        obj.items = [];\r\n        obj.groups = [];\r\n        // Search options\r\n        obj.search = '';\r\n        obj.results = null;\r\n\r\n        // Create dropdown\r\n        el.classList.add('jdropdown');\r\n\r\n        // Header container\r\n        containerHeader = document.createElement('div');\r\n        containerHeader.className = 'jdropdown-container-header';\r\n\r\n        // Header\r\n        obj.header = document.createElement('input');\r\n        obj.header.className = 'jdropdown-header';\r\n        obj.header.type = 'text';\r\n        obj.header.setAttribute('autocomplete', 'off');\r\n        obj.header.onfocus = function() {\r\n            if (typeof(obj.options.onfocus) == 'function') {\r\n                obj.options.onfocus(el);\r\n            }\r\n        }\r\n\r\n        obj.header.onblur = function() {\r\n            if (typeof(obj.options.onblur) == 'function') {\r\n                obj.options.onblur(el);\r\n            }\r\n        }\r\n\r\n        obj.header.onkeyup = function(e) {\r\n            if (obj.options.autocomplete == true && ! keyTimer) {\r\n                if (obj.search != obj.header.value.trim()) {\r\n                    keyTimer = setTimeout(function() {\r\n                        obj.find(obj.header.value.trim());\r\n                        keyTimer = null;\r\n                    }, 400);\r\n                }\r\n\r\n                if (! el.classList.contains('jdropdown-focus')) {\r\n                    obj.open();\r\n                }\r\n            } else {\r\n                if (! obj.options.autocomplete) {\r\n                    obj.next(e.key);\r\n                }\r\n            }\r\n        }\r\n\r\n        // Global controls\r\n        if (! jSuites.dropdown.hasEvents) {\r\n            // Execute only one time\r\n            jSuites.dropdown.hasEvents = true;\r\n            // Enter and Esc\r\n            document.addEventListener(\"keydown\", jSuites.dropdown.keydown);\r\n        }\r\n\r\n        // Container\r\n        container = document.createElement('div');\r\n        container.className = 'jdropdown-container';\r\n\r\n        // Dropdown content\r\n        content = document.createElement('div');\r\n        content.className = 'jdropdown-content';\r\n\r\n        // Close button\r\n        closeButton = document.createElement('div');\r\n        closeButton.className = 'jdropdown-close';\r\n        closeButton.innerHTML = 'Done';\r\n\r\n        // Reset button\r\n        resetButton = document.createElement('div');\r\n        resetButton.className = 'jdropdown-reset';\r\n        resetButton.innerHTML = 'x';\r\n        resetButton.onclick = function() {\r\n            obj.reset();\r\n            obj.close();\r\n        }\r\n\r\n        // Create backdrop\r\n        backdrop = document.createElement('div');\r\n        backdrop.className = 'jdropdown-backdrop';\r\n\r\n        // Append elements\r\n        containerHeader.appendChild(obj.header);\r\n\r\n        container.appendChild(content);\r\n        el.appendChild(containerHeader);\r\n        el.appendChild(container);\r\n        el.appendChild(backdrop);\r\n\r\n        // Set the otiptions\r\n        obj.setOptions(options);\r\n\r\n        if ('ontouchsend' in document.documentElement === true) {\r\n            el.addEventListener('touchsend', jSuites.dropdown.mouseup);\r\n        } else {\r\n            el.addEventListener('mouseup', jSuites.dropdown.mouseup);\r\n        }\r\n\r\n        // Lazyloading\r\n        if (obj.options.lazyLoading == true) {\r\n            jSuites.lazyLoading(content, {\r\n                loadUp: obj.loadUp,\r\n                loadDown: obj.loadDown,\r\n            });\r\n        }\r\n\r\n        content.onwheel = function(e) {\r\n            e.stopPropagation();\r\n        }\r\n\r\n        // Change method\r\n        el.change = obj.setValue;\r\n\r\n        // Global generic value handler\r\n        el.val = function(val) {\r\n            if (val === undefined) {\r\n                return obj.getValue(obj.options.multiple ? true : false);\r\n            } else {\r\n                obj.setValue(val);\r\n            }\r\n        }\r\n\r\n        // Keep object available from the node\r\n        el.dropdown = obj;\r\n    }\r\n\r\n    /**\r\n     * Get the current remote source of data URL\r\n     */\r\n    obj.getUrl = function() {\r\n        return obj.options.url;\r\n    }\r\n\r\n    /**\r\n     * Set the new data from a remote source\r\n     * @param {string} url - url from the remote source\r\n     * @param {function} callback - callback when the data is loaded\r\n     */\r\n    obj.setUrl = function(url, callback) {\r\n        obj.options.url = url;\r\n\r\n        jSuites.ajax({\r\n            url: obj.options.url,\r\n            method: 'GET',\r\n            dataType: 'json',\r\n            success: function(data) {\r\n                obj.setData(data);\r\n                // Callback\r\n                if (typeof(callback) == 'function') {\r\n                    callback(obj);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Set ID for one item\r\n     */\r\n    obj.setId = function(item, v) {\r\n        // Legacy purposes\r\n        if (! obj.options.format) {\r\n            var property = 'value';\r\n        } else {\r\n            var property = 'id';\r\n        }\r\n\r\n        if (typeof(item) == 'object') {\r\n            item[property] = v;\r\n        } else {\r\n            obj.items[item].data[property] = v;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Add a new item\r\n     * @param {string} title - title of the new item\r\n     * @param {string} id - value/id of the new item\r\n     */\r\n    obj.add = function(title, id) {\r\n        if (! title) {\r\n            var current = obj.options.autocomplete == true ? obj.header.value : '';\r\n            var title = prompt(jSuites.translate('Add A New Option'), current);\r\n            if (! title) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        // Id\r\n        if (! id) {\r\n           id = jSuites.guid();\r\n        }\r\n\r\n        // Create new item\r\n        if (! obj.options.format) {\r\n            var item = {\r\n                value: id,\r\n                text: title,\r\n            }\r\n        } else {\r\n            var item = {\r\n                id: id,\r\n                name: title,\r\n            }\r\n        }\r\n\r\n        // Callback\r\n        if (typeof(obj.options.onbeforeinsert) == 'function') {\r\n            var ret = obj.options.onbeforeinsert(obj, item);\r\n            if (ret === false) {\r\n                return false;\r\n            } else if (ret) {\r\n                item = ret;\r\n            }\r\n        }\r\n\r\n        // Add item to the main list\r\n        obj.options.data.push(item);\r\n\r\n        // Create DOM\r\n        var newItem = obj.createItem(item);\r\n\r\n        // Append DOM to the list\r\n        content.appendChild(newItem.element);\r\n\r\n        // Callback\r\n        if (typeof(obj.options.oninsert) == 'function') {\r\n            obj.options.oninsert(obj, item, newItem);\r\n        }\r\n\r\n        // Show content\r\n        if (content.style.display == 'none') {\r\n            content.style.display = '';\r\n        }\r\n\r\n        // Search?\r\n        if (obj.results) {\r\n            obj.results.push(newItem);\r\n        }\r\n\r\n        return item;\r\n    }\r\n\r\n    /**\r\n     * Create a new item\r\n     */\r\n    obj.createItem = function(data, group, groupName) {\r\n        // Keep the correct source of data\r\n        if (! obj.options.format) {\r\n            if (! data.value && data.id !== undefined) {\r\n                data.value = data.id;\r\n                //delete data.id;\r\n            }\r\n            if (! data.text && data.name !== undefined) {\r\n                data.text = data.name;\r\n                //delete data.name;\r\n            }\r\n        } else {\r\n            if (! data.id && data.value !== undefined) {\r\n                data.id = data.value;\r\n                //delete data.value;\r\n            }\r\n            if (! data.name && data.text !== undefined) {\r\n                data.name = data.text\r\n                //delete data.text;\r\n            }\r\n        }\r\n\r\n        // Create item\r\n        var item = {};\r\n        item.element = document.createElement('div');\r\n        item.element.className = 'jdropdown-item';\r\n        item.element.indexValue = obj.items.length;\r\n        item.data = data;\r\n\r\n        // Groupd DOM\r\n        if (group) {\r\n            item.group = group; \r\n        }\r\n\r\n        // Id\r\n        if (data.id) {\r\n            item.element.setAttribute('id', data.id);\r\n        }\r\n\r\n        // Disabled\r\n        if (data.disabled == true) {\r\n            item.element.setAttribute('data-disabled', true);\r\n        }\r\n\r\n        // Tooltip\r\n        if (data.tooltip) {\r\n            item.element.setAttribute('title', data.tooltip);\r\n        }\r\n\r\n        // Image\r\n        if (data.image) {\r\n            var image = document.createElement('img');\r\n            image.className = 'jdropdown-image';\r\n            image.src = data.image;\r\n            if (! data.title) {\r\n               image.classList.add('jdropdown-image-small');\r\n            }\r\n            item.element.appendChild(image);\r\n        } else if (data.icon) {\r\n            var icon = document.createElement('span');\r\n            icon.className = \"jdropdown-icon material-icons\";\r\n            icon.innerText = data.icon;\r\n            if (! data.title) {\r\n               icon.classList.add('jdropdown-icon-small');\r\n            }\r\n            if (data.color) {\r\n                icon.style.color = data.color;\r\n            }\r\n            item.element.appendChild(icon);\r\n        } else if (data.color) {\r\n            var color = document.createElement('div');\r\n            color.className = 'jdropdown-color';\r\n            color.style.backgroundColor = data.color;\r\n            item.element.appendChild(color);\r\n        }\r\n\r\n        // Set content\r\n        if (! obj.options.format) {\r\n            var text = data.text;\r\n        } else {\r\n            var text = data.name;\r\n        }\r\n\r\n        var node = document.createElement('div');\r\n        node.className = 'jdropdown-description';\r\n        node.innerHTML = text || '&nbsp;'; \r\n\r\n        // Title\r\n        if (data.title) {\r\n            var title = document.createElement('div');\r\n            title.className = 'jdropdown-title';\r\n            title.innerText = data.title;\r\n            node.appendChild(title);\r\n        }\r\n\r\n        // Set content\r\n        if (! obj.options.format) {\r\n            var val = data.value;\r\n        } else {\r\n            var val = data.id;\r\n        }\r\n\r\n        // Value\r\n        if (obj.value[val]) {\r\n            item.element.classList.add('jdropdown-selected');\r\n            item.selected = true;\r\n        }\r\n\r\n        // Keep DOM accessible\r\n        obj.items.push(item);\r\n\r\n        // Add node to item\r\n        item.element.appendChild(node);\r\n\r\n        return item;\r\n    }\r\n\r\n    obj.appendData = function(data) {\r\n        // Create elements\r\n        if (data.length) {\r\n            // Helpers\r\n            var items = [];\r\n            var groups = [];\r\n\r\n            // Prepare data\r\n            for (var i = 0; i < data.length; i++) {\r\n                // Process groups\r\n                if (data[i].group) {\r\n                    if (! groups[data[i].group]) {\r\n                        groups[data[i].group] = [];\r\n                    }\r\n                    groups[data[i].group].push(i);\r\n                } else {\r\n                    items.push(i);\r\n                }\r\n            }\r\n\r\n            // Number of items counter\r\n            var counter = 0;\r\n\r\n            // Groups\r\n            var groupNames = Object.keys(groups);\r\n\r\n            // Append groups in case exists\r\n            if (groupNames.length > 0) {\r\n                for (var i = 0; i < groupNames.length; i++) {\r\n                    // Group container\r\n                    var group = document.createElement('div');\r\n                    group.className = 'jdropdown-group';\r\n                    // Group name\r\n                    var groupName = document.createElement('div');\r\n                    groupName.className = 'jdropdown-group-name';\r\n                    groupName.innerHTML = groupNames[i];\r\n                    // Group arrow\r\n                    var groupArrow = document.createElement('i');\r\n                    groupArrow.className = 'jdropdown-group-arrow jdropdown-group-arrow-down';\r\n                    groupName.appendChild(groupArrow);\r\n                    // Group items\r\n                    var groupContent = document.createElement('div');\r\n                    groupContent.className = 'jdropdown-group-items';\r\n                    for (var j = 0; j < groups[groupNames[i]].length; j++) {\r\n                        var item = obj.createItem(data[groups[groupNames[i]][j]], group, groupNames[i]);\r\n\r\n                        if (obj.options.lazyLoading == false || counter < 200) {\r\n                            groupContent.appendChild(item.element);\r\n                            counter++;\r\n                        }\r\n                    }\r\n                    // Group itens\r\n                    group.appendChild(groupName);\r\n                    group.appendChild(groupContent);\r\n                    // Keep group DOM\r\n                    obj.groups.push(group);\r\n                    // Only add to the screen if children on the group\r\n                    if (groupContent.children.length > 0) {\r\n                        // Add DOM to the content\r\n                        content.appendChild(group);\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (items.length) {\r\n                for (var i = 0; i < items.length; i++) {\r\n                    var item = obj.createItem(data[items[i]]);\r\n                    if (obj.options.lazyLoading == false || counter < 200) {\r\n                        content.appendChild(item.element);\r\n                        counter++;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.setData = function(data) {\r\n        // Prepare data\r\n        if (data.length) {\r\n            for (var i = 0; i < data.length; i++) {\r\n                // Compatibility\r\n                if (typeof(data[i]) != 'object') {\r\n                    // Correct format\r\n                    if (! obj.options.format) {\r\n                        data[i] = {\r\n                            value: data[i],\r\n                            text: data[i]\r\n                        }\r\n                    } else {\r\n                        data[i] = {\r\n                            id: data[i],\r\n                            name: data[i]\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Reset current value\r\n            resetValue();\r\n\r\n            // Make sure the content container is blank\r\n            content.innerHTML = '';\r\n\r\n            // Reset\r\n            obj.header.value = '';\r\n\r\n            // Reset items and values\r\n            obj.items = [];\r\n\r\n            // Append data\r\n            obj.appendData(data);\r\n\r\n            // Update data\r\n            obj.options.data = data;\r\n        }\r\n    }\r\n\r\n    obj.getData = function() {\r\n        return obj.options.data;\r\n    }\r\n\r\n    /**\r\n     * Get position of the item\r\n     */\r\n    obj.getPosition = function(val) {\r\n        for (var i = 0; i < obj.items.length; i++) {\r\n            if (Value(i) == val) {\r\n                return i;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Get dropdown current text\r\n     */\r\n    obj.getText = function(asArray) {\r\n        // Get value\r\n        var v = getText();\r\n        // Return value\r\n        if (asArray) {\r\n            return v;\r\n        } else {\r\n            return v.join('; ');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get dropdown current value\r\n     */\r\n    obj.getValue = function(asArray) {\r\n        // Get value\r\n        var v = getValue();\r\n        // Return value\r\n        if (asArray) {\r\n            return v;\r\n        } else {\r\n            return v.join(';');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Change event\r\n     */\r\n    var change = function(oldValue) {\r\n        // Events\r\n        if (typeof(obj.options.onchange) == 'function') {\r\n            obj.options.onchange(el, obj, oldValue, obj.options.value);\r\n        }\r\n\r\n        // Lemonade JS\r\n        if (el.value != obj.options.value) {\r\n            el.value = obj.options.value;\r\n            if (typeof(el.onchange) == 'function') {\r\n                el.onchange({\r\n                    type: 'change',\r\n                    target: el,\r\n                    value: el.value\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set value\r\n     */\r\n    obj.setValue = function(newValue) {\r\n        // Current value\r\n        var oldValue = obj.getValue();\r\n        // New value\r\n        if (Array.isArray(newValue)) {\r\n            newValue = newValue.join(';')\r\n        }\r\n\r\n        if (oldValue !== newValue) {\r\n            // Set value\r\n            applyValue(newValue);\r\n\r\n            // Change\r\n            change(oldValue);\r\n        }\r\n    }\r\n\r\n    obj.resetSelected = function() {\r\n        obj.setValue(null);\r\n    } \r\n\r\n    obj.selectIndex = function(index, force) {\r\n        // Make sure is a number\r\n        var index = parseInt(index);\r\n\r\n        // Only select those existing elements\r\n        if (obj.items && obj.items[index] && (force === true || obj.items[index].data.disabled !== true)) {\r\n            // Reset cursor to a new position\r\n            obj.setCursor(index, false);\r\n\r\n            // Behaviour\r\n            if (! obj.options.multiple) {\r\n                // Update value\r\n                if (obj.items[index].selected) {\r\n                    obj.setValue(null);\r\n                } else {\r\n                    obj.setValue(Value(index));\r\n                }\r\n\r\n                // Close component\r\n                obj.close();\r\n            } else {\r\n                // Old value\r\n                var oldValue = obj.options.value;\r\n\r\n                // Toggle option\r\n                if (obj.items[index].selected) {\r\n                    obj.items[index].element.classList.remove('jdropdown-selected');\r\n                    obj.items[index].selected = false;\r\n\r\n                    delete obj.value[Value(index)];\r\n                } else {\r\n                    // Select element\r\n                    obj.items[index].element.classList.add('jdropdown-selected');\r\n                    obj.items[index].selected = true;\r\n\r\n                    // Set value\r\n                    obj.value[Value(index)] = Text(index);\r\n                }\r\n\r\n                // Global value\r\n                obj.options.value = Object.keys(obj.value).join(';');\r\n\r\n                // Update labels for multiple dropdown\r\n                if (obj.options.autocomplete == false) {\r\n                    obj.header.value = getText().join('; ');\r\n                }\r\n\r\n                // Events\r\n                change(oldValue);\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.selectItem = function(item) {\r\n        obj.selectIndex(item.indexValue);\r\n    }\r\n\r\n    var exists = function(k, result) {\r\n        for (var j = 0; j < result.length; j++) {\r\n            if (! obj.options.format) {\r\n                if (result[j].value == k) {\r\n                    return true;\r\n                }\r\n            } else {\r\n                if (result[j].id == k) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    obj.find = function(str) {\r\n        if (obj.search == str.trim()) {\r\n            return false;\r\n        }\r\n\r\n        // Search term\r\n        obj.search = str;\r\n\r\n        // Reset index\r\n        obj.setCursor();\r\n\r\n        // Remove nodes from all groups\r\n        if (obj.groups.length) {\r\n            for (var i = 0; i < obj.groups.length; i++) {\r\n                obj.groups[i].lastChild.innerHTML = '';\r\n            }\r\n        }\r\n\r\n        // Remove all nodes\r\n        content.innerHTML = '';\r\n\r\n        // Remove current items in the remote search\r\n        if (obj.options.remoteSearch == true) {\r\n            // Reset results\r\n            obj.results = null;\r\n            // URL\r\n            var url = obj.options.url + (obj.options.url.indexOf('?') > 0 ? '&' : '?') + 'q=' + str;\r\n            // Remote search\r\n            jSuites.ajax({\r\n                url: url,\r\n                method: 'GET',\r\n                dataType: 'json',\r\n                success: function(result) {\r\n                    // Reset items\r\n                    obj.items = [];\r\n\r\n                    // Add the current selected items to the results in case they are not there\r\n                    var current = Object.keys(obj.value);\r\n                    if (current.length) {\r\n                        for (var i = 0; i < current.length; i++) {\r\n                            if (! exists(current[i], result)) {\r\n                                if (! obj.options.format) {\r\n                                    result.unshift({ value: current[i], text: obj.value[current[i]] });\r\n                                } else {\r\n                                    result.unshift({ id: current[i], name: obj.value[current[i]] });\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    // Append data\r\n                    obj.appendData(result);\r\n                    // Show or hide results\r\n                    if (! result.length) {\r\n                        content.style.display = 'none';\r\n                    } else {\r\n                        content.style.display = '';\r\n                    }\r\n                }\r\n            });\r\n        } else {\r\n            // Search terms\r\n            str = new RegExp(str, 'gi');\r\n\r\n            // Reset search\r\n            var results = [];\r\n\r\n            // Append options\r\n            for (var i = 0; i < obj.items.length; i++) {\r\n                // Item label\r\n                var label = Text(i);\r\n                // Item title\r\n                var title = obj.items[i].data.title || '';\r\n                // Group name\r\n                var groupName = obj.items[i].data.group || '';\r\n                // Synonym\r\n                var synonym = obj.items[i].data.synonym || '';\r\n                if (synonym) {\r\n                    synonym = synonym.join(' ');\r\n                }\r\n\r\n                if (str == null || obj.items[i].selected == true || label.match(str) || title.match(str) || groupName.match(str) || synonym.match(str)) {\r\n                    results.push(obj.items[i]);\r\n                }\r\n            }\r\n\r\n            if (! results.length) {\r\n                content.style.display = 'none';\r\n\r\n                // Results\r\n                obj.results = null;\r\n            } else {\r\n                content.style.display = '';\r\n\r\n                // Results\r\n                obj.results = results;\r\n\r\n                // Show 200 items at once\r\n                var number = results.length || 0;\r\n\r\n                // Lazyloading\r\n                if (obj.options.lazyLoading == true && number > 200) {\r\n                    number = 200;\r\n                }\r\n\r\n                for (var i = 0; i < number; i++) {\r\n                    if (obj.results[i].group) {\r\n                        if (! obj.results[i].group.parentNode) {\r\n                            content.appendChild(obj.results[i].group);\r\n                        }\r\n                        obj.results[i].group.lastChild.appendChild(obj.results[i].element);\r\n                    } else {\r\n                        content.appendChild(obj.results[i].element);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Auto focus\r\n        if (obj.options.autofocus == true) {\r\n            obj.first();\r\n        }\r\n    }\r\n\r\n    obj.open = function() {\r\n        // Focus\r\n        if (! el.classList.contains('jdropdown-focus')) {\r\n            // Current dropdown\r\n            jSuites.dropdown.current = obj;\r\n\r\n            // Start tracking\r\n            jSuites.tracking(obj, true);\r\n\r\n            // Add focus\r\n            el.classList.add('jdropdown-focus');\r\n\r\n            // Animation\r\n            if (jSuites.getWindowWidth() < 800) {\r\n                if (obj.options.type == null || obj.options.type == 'picker') {\r\n                    jSuites.animation.slideBottom(container, 1);\r\n                }\r\n            }\r\n\r\n            // Filter\r\n            if (obj.options.autocomplete == true) {\r\n                obj.header.value = obj.search;\r\n                obj.header.focus();\r\n            }\r\n\r\n            // Set cursor for the first or first selected element\r\n            var k = getValue();\r\n            if (k[0]) {\r\n                var cursor = obj.getPosition(k[0]);\r\n                if (cursor !== false) {\r\n                    obj.setCursor(cursor);\r\n                }\r\n            }\r\n\r\n            // Container Size\r\n            if (! obj.options.type || obj.options.type == 'default') {\r\n                var rect = el.getBoundingClientRect();\r\n                var rectContainer = container.getBoundingClientRect();\r\n\r\n                if (obj.options.position) {\r\n                    container.style.position = 'fixed';\r\n                    if (window.innerHeight < rect.bottom + rectContainer.height) {\r\n                        container.style.top = '';\r\n                        container.style.bottom = (window.innerHeight - rect.top ) + 1 + 'px';\r\n                    } else {\r\n                        container.style.top = rect.bottom + 'px';\r\n                        container.style.bottom = '';\r\n                    }\r\n                    container.style.left = rect.left + 'px';\r\n                } else {\r\n                    if (window.innerHeight < rect.bottom + rectContainer.height) {\r\n                        container.style.top = '';\r\n                        container.style.bottom = rect.height + 1 + 'px';\r\n                    } else {\r\n                        container.style.top = '';\r\n                        container.style.bottom = '';\r\n                    }\r\n                }\r\n\r\n                container.style.minWidth = rect.width + 'px';\r\n\r\n                if (obj.options.maxWidth) {\r\n                    container.style.maxWidth = obj.options.maxWidth;\r\n                }\r\n\r\n                if (! obj.items.length && obj.options.autocomplete == true) {\r\n                    content.style.display = 'none';\r\n                } else {\r\n                    content.style.display = '';\r\n                }\r\n            }\r\n        }\r\n\r\n        // Events\r\n        if (typeof(obj.options.onopen) == 'function') {\r\n            obj.options.onopen(el);\r\n        }\r\n    }\r\n\r\n    obj.close = function(ignoreEvents) {\r\n        if (el.classList.contains('jdropdown-focus')) {\r\n            // Update labels\r\n            obj.header.value = obj.getText();\r\n            // Remove cursor\r\n            obj.setCursor();\r\n            // Events\r\n            if (! ignoreEvents && typeof(obj.options.onclose) == 'function') {\r\n                obj.options.onclose(el);\r\n            }\r\n            // Blur\r\n            if (obj.header.blur) {\r\n                obj.header.blur();\r\n            }\r\n            // Remove focus\r\n            el.classList.remove('jdropdown-focus');\r\n            // Start tracking\r\n            jSuites.tracking(obj, false);\r\n            // Current dropdown\r\n            jSuites.dropdown.current = null;\r\n        }\r\n\r\n        return obj.getValue();\r\n    }\r\n\r\n    /**\r\n     * Set cursor\r\n     */\r\n    obj.setCursor = function(index, setPosition) {\r\n        // Remove current cursor\r\n        if (obj.currentIndex != null) {\r\n            // Remove visual cursor\r\n            if (obj.items && obj.items[obj.currentIndex]) {\r\n                obj.items[obj.currentIndex].element.classList.remove('jdropdown-cursor');\r\n            }\r\n        }\r\n\r\n        if (index == undefined) {\r\n            obj.currentIndex = null;\r\n        } else {\r\n            index = parseInt(index);\r\n\r\n            // Cursor only for visible items\r\n            if (obj.items[index].element.parentNode) {\r\n                obj.items[index].element.classList.add('jdropdown-cursor');\r\n                obj.currentIndex = index;\r\n\r\n                // Update scroll to the cursor element\r\n                if (setPosition !== false && obj.items[obj.currentIndex].element) {\r\n                    var container = content.scrollTop;\r\n                    var element = obj.items[obj.currentIndex].element;\r\n                    content.scrollTop = element.offsetTop - element.scrollTop + element.clientTop - 95;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Compatibility\r\n    obj.resetCursor = obj.setCursor;\r\n    obj.updateCursor = obj.setCursor;\r\n\r\n    /**\r\n     * Reset cursor and selected items\r\n     */\r\n    obj.reset = function() {\r\n        // Reset cursor\r\n        obj.setCursor();\r\n\r\n        // Reset selected\r\n        obj.setValue(null);\r\n    }\r\n\r\n    /**\r\n     * First available item\r\n     */\r\n    obj.first = function() {\r\n        if (obj.options.lazyLoading === true) {\r\n            obj.loadFirst();\r\n        }\r\n\r\n        var items = content.querySelectorAll('.jdropdown-item');\r\n        if (items.length) {\r\n            var newIndex = items[0].indexValue;\r\n            obj.setCursor(newIndex);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Last available item \r\n     */\r\n    obj.last = function() {\r\n        if (obj.options.lazyLoading === true) {\r\n            obj.loadLast();\r\n        }\r\n\r\n        var items = content.querySelectorAll('.jdropdown-item');\r\n        if (items.length) {\r\n            var newIndex = items[items.length-1].indexValue;\r\n            obj.setCursor(newIndex);\r\n        }\r\n    }\r\n\r\n    obj.next = function(letter) {\r\n        var newIndex = null;\r\n\r\n        if (letter) {\r\n            if (letter.length == 1) {\r\n                // Current index\r\n                var current = obj.currentIndex || -1;\r\n                // Letter\r\n                letter = letter.toLowerCase();\r\n\r\n                var e = null;\r\n                var l = null;\r\n                var items = content.querySelectorAll('.jdropdown-item');\r\n                if (items.length) {\r\n                    for (var i = 0; i < items.length; i++) {\r\n                        if (items[i].indexValue > current) {\r\n                            if (e = obj.items[items[i].indexValue]) {\r\n                                if (l = e.element.innerText[0]) {\r\n                                    l = l.toLowerCase();\r\n                                    if (letter == l) {\r\n                                        newIndex = items[i].indexValue;\r\n                                        break;\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    obj.setCursor(newIndex);\r\n                }\r\n            }\r\n        } else {\r\n            if (obj.currentIndex == undefined || obj.currentIndex == null) {\r\n                obj.first();\r\n            } else {\r\n                var element = obj.items[obj.currentIndex].element;\r\n\r\n                var next = element.nextElementSibling;\r\n                if (next) {\r\n                    if (next.classList.contains('jdropdown-group')) {\r\n                        next = next.lastChild.firstChild;\r\n                    }\r\n                    newIndex = next.indexValue;\r\n                } else {\r\n                    if (element.parentNode.classList.contains('jdropdown-group-items')) {\r\n                        if (next = element.parentNode.parentNode.nextElementSibling) {\r\n                            if (next.classList.contains('jdropdown-group')) {\r\n                                next = next.lastChild.firstChild;\r\n                            } else if (next.classList.contains('jdropdown-item')) {\r\n                                newIndex = next.indexValue;\r\n                            } else {\r\n                                next = null;\r\n                            }\r\n                        }\r\n\r\n                        if (next) {\r\n                            newIndex = next.indexValue;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if (newIndex !== null) {\r\n                    obj.setCursor(newIndex);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.prev = function() {\r\n        var newIndex = null;\r\n\r\n        if (obj.currentIndex === null) {\r\n            obj.first();\r\n        } else {\r\n            var element = obj.items[obj.currentIndex].element;\r\n\r\n            var prev = element.previousElementSibling;\r\n            if (prev) {\r\n                if (prev.classList.contains('jdropdown-group')) {\r\n                    prev = prev.lastChild.lastChild;\r\n                }\r\n                newIndex = prev.indexValue;\r\n            } else {\r\n                if (element.parentNode.classList.contains('jdropdown-group-items')) {\r\n                    if (prev = element.parentNode.parentNode.previousElementSibling) {\r\n                        if (prev.classList.contains('jdropdown-group')) {\r\n                            prev = prev.lastChild.lastChild;\r\n                        } else if (prev.classList.contains('jdropdown-item')) {\r\n                            newIndex = prev.indexValue;\r\n                        } else {\r\n                            prev = null\r\n                        }\r\n                    }\r\n\r\n                    if (prev) {\r\n                        newIndex = prev.indexValue;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (newIndex !== null) {\r\n            obj.setCursor(newIndex);\r\n        }\r\n    }\r\n\r\n    obj.loadFirst = function() {\r\n        // Search\r\n        if (obj.results) {\r\n            var results = obj.results;\r\n        } else {\r\n            var results = obj.items;\r\n        }\r\n\r\n        // Show 200 items at once\r\n        var number = results.length || 0;\r\n\r\n        // Lazyloading\r\n        if (obj.options.lazyLoading == true && number > 200) {\r\n            number = 200;\r\n        }\r\n\r\n        // Reset container\r\n        content.innerHTML = '';\r\n\r\n        // First 200 items\r\n        for (var i = 0; i < number; i++) {\r\n            if (results[i].group) {\r\n                if (! results[i].group.parentNode) {\r\n                    content.appendChild(results[i].group);\r\n                }\r\n                results[i].group.lastChild.appendChild(results[i].element);\r\n            } else {\r\n                content.appendChild(results[i].element);\r\n            }\r\n        }\r\n\r\n        // Scroll go to the begin\r\n        content.scrollTop = 0;\r\n    }\r\n\r\n    obj.loadLast = function() {\r\n        // Search\r\n        if (obj.results) {\r\n            var results = obj.results;\r\n        } else {\r\n            var results = obj.items;\r\n        }\r\n\r\n        // Show first page\r\n        var number = results.length;\r\n\r\n        // Max 200 items\r\n        if (number > 200) {\r\n            number = number - 200;\r\n\r\n            // Reset container\r\n            content.innerHTML = '';\r\n\r\n            // First 200 items\r\n            for (var i = number; i < results.length; i++) {\r\n                if (results[i].group) {\r\n                    if (! results[i].group.parentNode) {\r\n                        content.appendChild(results[i].group);\r\n                    }\r\n                    results[i].group.lastChild.appendChild(results[i].element);\r\n                } else {\r\n                    content.appendChild(results[i].element);\r\n                }\r\n            }\r\n\r\n            // Scroll go to the begin\r\n            content.scrollTop = content.scrollHeight;\r\n        }\r\n    }\r\n\r\n    obj.loadUp = function() {\r\n        var test = false;\r\n\r\n        // Search\r\n        if (obj.results) {\r\n            var results = obj.results;\r\n        } else {\r\n            var results = obj.items;\r\n        }\r\n\r\n        var items = content.querySelectorAll('.jdropdown-item');\r\n        var fistItem = items[0].indexValue;\r\n        fistItem = obj.items[fistItem];\r\n        var index = results.indexOf(fistItem) - 1;\r\n\r\n        if (index > 0) {\r\n            var number = 0;\r\n\r\n            while (index > 0 && results[index] && number < 200) {\r\n                if (results[index].group) {\r\n                    if (! results[index].group.parentNode) {\r\n                        content.insertBefore(results[index].group, content.firstChild);\r\n                    }\r\n                    results[index].group.lastChild.insertBefore(results[index].element, results[index].group.lastChild.firstChild);\r\n                } else {\r\n                    content.insertBefore(results[index].element, content.firstChild);\r\n                }\r\n\r\n                index--;\r\n                number++;\r\n            }\r\n\r\n            // New item added\r\n            test = true;\r\n        }\r\n\r\n        return test;\r\n    }\r\n\r\n    obj.loadDown = function() {\r\n        var test = false;\r\n\r\n        // Search\r\n        if (obj.results) {\r\n            var results = obj.results;\r\n        } else {\r\n            var results = obj.items;\r\n        }\r\n\r\n        var items = content.querySelectorAll('.jdropdown-item');\r\n        var lastItem = items[items.length-1].indexValue;\r\n        lastItem = obj.items[lastItem];\r\n        var index = results.indexOf(lastItem) + 1;\r\n\r\n        if (index < results.length) {\r\n            var number = 0;\r\n            while (index < results.length && results[index] && number < 200) {\r\n                if (results[index].group) {\r\n                    if (! results[index].group.parentNode) {\r\n                        content.appendChild(results[index].group);\r\n                    }\r\n                    results[index].group.lastChild.appendChild(results[index].element);\r\n                } else {\r\n                    content.appendChild(results[index].element);\r\n                }\r\n\r\n                index++;\r\n                number++;\r\n            }\r\n\r\n            // New item added\r\n            test = true;\r\n        }\r\n\r\n        return test;\r\n    }\r\n\r\n    init();\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.dropdown.keydown = function(e) {\r\n    var dropdown = null;\r\n    if (dropdown = jSuites.dropdown.current) {\r\n        if (e.which == 13 || e.which == 9) {  // enter or tab\r\n            if (dropdown.header.value && dropdown.currentIndex == null && dropdown.options.newOptions) {\r\n                // if they typed something in, but it matched nothing, and newOptions are allowed, start that flow\r\n                dropdown.add();\r\n            } else {\r\n                // Quick Select/Filter\r\n                if (dropdown.currentIndex == null && dropdown.options.autocomplete == true && dropdown.header.value != \"\") {\r\n                    dropdown.find(dropdown.header.value);\r\n                }\r\n                dropdown.selectIndex(dropdown.currentIndex);\r\n            }\r\n        } else if (e.which == 38) {  // up arrow\r\n            if (dropdown.currentIndex == null) {\r\n                dropdown.first();\r\n            } else if (dropdown.currentIndex > 0) {\r\n                dropdown.prev();\r\n            }\r\n            e.preventDefault();\r\n        } else if (e.which == 40) {  // down arrow\r\n            if (dropdown.currentIndex == null) {\r\n                dropdown.first();\r\n            } else if (dropdown.currentIndex + 1 < dropdown.items.length) {\r\n                dropdown.next();\r\n            }\r\n            e.preventDefault();\r\n        } else if (e.which == 36) {\r\n            dropdown.first();\r\n            if (! e.target.classList.contains('jdropdown-header')) {\r\n                e.preventDefault();\r\n            }\r\n        } else if (e.which == 35) {\r\n            dropdown.last();\r\n            if (! e.target.classList.contains('jdropdown-header')) {\r\n                e.preventDefault();\r\n            }\r\n        } else if (e.which == 27) {\r\n            dropdown.close();\r\n        } else if (e.which == 33) {  // page up\r\n            if (dropdown.currentIndex == null) {\r\n                dropdown.first();\r\n            } else if (dropdown.currentIndex > 0) {\r\n                for (var i = 0; i < 7; i++) {\r\n                    dropdown.prev()\r\n                }\r\n            }\r\n            e.preventDefault();\r\n        } else if (e.which == 34) {  // page down\r\n            if (dropdown.currentIndex == null) {\r\n                dropdown.first();\r\n            } else if (dropdown.currentIndex + 1 < dropdown.items.length) {\r\n                for (var i = 0; i < 7; i++) {\r\n                    dropdown.next()\r\n                }\r\n            }\r\n            e.preventDefault();\r\n        }\r\n    }\r\n}\r\n\r\njSuites.dropdown.mouseup = function(e) {\r\n    var element = jSuites.findElement(e.target, 'jdropdown');\r\n    if (element) {\r\n        var dropdown = element.dropdown;\r\n        if (e.target.classList.contains('jdropdown-header')) {\r\n            if (element.classList.contains('jdropdown-focus') && element.classList.contains('jdropdown-default')) {\r\n                var rect = element.getBoundingClientRect();\r\n\r\n                if (e.changedTouches && e.changedTouches[0]) {\r\n                    var x = e.changedTouches[0].clientX;\r\n                    var y = e.changedTouches[0].clientY;\r\n                } else {\r\n                    var x = e.clientX;\r\n                    var y = e.clientY;\r\n                }\r\n\r\n                if (rect.width - (x - rect.left) < 30) {\r\n                    if (e.target.classList.contains('jdropdown-add')) {\r\n                        dropdown.add();\r\n                    } else {\r\n                        dropdown.close();\r\n                    }\r\n                } else {\r\n                    if (dropdown.options.autocomplete == false) {\r\n                        dropdown.close();\r\n                    }\r\n                }\r\n            } else {\r\n                dropdown.open();\r\n            }\r\n        } else if (e.target.classList.contains('jdropdown-group-name')) {\r\n            var items = e.target.nextSibling.children;\r\n            if (e.target.nextSibling.style.display != 'none') {\r\n                for (var i = 0; i < items.length; i++) {\r\n                    if (items[i].style.display != 'none') {\r\n                        dropdown.selectItem(items[i]);\r\n                    }\r\n                }\r\n            }\r\n        } else if (e.target.classList.contains('jdropdown-group-arrow')) {\r\n            if (e.target.classList.contains('jdropdown-group-arrow-down')) {\r\n                e.target.classList.remove('jdropdown-group-arrow-down');\r\n                e.target.classList.add('jdropdown-group-arrow-up');\r\n                e.target.parentNode.nextSibling.style.display = 'none';\r\n            } else {\r\n                e.target.classList.remove('jdropdown-group-arrow-up');\r\n                e.target.classList.add('jdropdown-group-arrow-down');\r\n                e.target.parentNode.nextSibling.style.display = '';\r\n            }\r\n        } else if (e.target.classList.contains('jdropdown-item')) {\r\n            dropdown.selectItem(e.target);\r\n        } else if (e.target.classList.contains('jdropdown-image')) {\r\n            dropdown.selectItem(e.target.parentNode);\r\n        } else if (e.target.classList.contains('jdropdown-description')) {\r\n            dropdown.selectItem(e.target.parentNode);\r\n        } else if (e.target.classList.contains('jdropdown-title')) {\r\n            dropdown.selectItem(e.target.parentNode.parentNode);\r\n        } else if (e.target.classList.contains('jdropdown-close') || e.target.classList.contains('jdropdown-backdrop')) {\r\n            dropdown.close();\r\n        }\r\n    }\r\n}\r\n\r\njSuites.dropdown.extractFromDom = function(el, options) {\r\n    // Keep reference\r\n    var select = el;\r\n    if (! options) {\r\n        options = {};\r\n    }\r\n    // Prepare configuration\r\n    if (el.getAttribute('multiple') && (! options || options.multiple == undefined)) {\r\n        options.multiple = true;\r\n    }\r\n    if (el.getAttribute('placeholder') && (! options || options.placeholder == undefined)) {\r\n        options.placeholder = el.getAttribute('placeholder');\r\n    }\r\n    if (el.getAttribute('data-autocomplete') && (! options || options.autocomplete == undefined)) {\r\n        options.autocomplete = true;\r\n    }\r\n    if (! options || options.width == undefined) {\r\n        options.width = el.offsetWidth;\r\n    }\r\n    if (el.value && (! options || options.value == undefined)) {\r\n        options.value = el.value;\r\n    }\r\n    if (! options || options.data == undefined) {\r\n        options.data = [];\r\n        for (var j = 0; j < el.children.length; j++) {\r\n            if (el.children[j].tagName == 'OPTGROUP') {\r\n                for (var i = 0; i < el.children[j].children.length; i++) {\r\n                    options.data.push({\r\n                        value: el.children[j].children[i].value,\r\n                        text: el.children[j].children[i].innerHTML,\r\n                        group: el.children[j].getAttribute('label'),\r\n                    });\r\n                }\r\n            } else {\r\n                options.data.push({\r\n                    value: el.children[j].value,\r\n                    text: el.children[j].innerHTML,\r\n                });\r\n            }\r\n        }\r\n    }\r\n    if (! options || options.onchange == undefined) {\r\n        options.onchange = function(a,b,c,d) {\r\n            if (options.multiple == true) {\r\n                if (obj.items[b].classList.contains('jdropdown-selected')) {\r\n                    select.options[b].setAttribute('selected', 'selected');\r\n                } else {\r\n                    select.options[b].removeAttribute('selected');\r\n                }\r\n            } else {\r\n                select.value = d;\r\n            }\r\n        }\r\n    }\r\n    // Create DIV\r\n    var div = document.createElement('div');\r\n    el.parentNode.insertBefore(div, el);\r\n    el.style.display = 'none';\r\n    el = div;\r\n\r\n    return { el:el, options:options };\r\n}\r\n\r\njSuites.editor = (function(el, options) {\r\n    // New instance\r\n    var obj = { type:'editor' };\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        // Initial HTML content\r\n        value: null,\r\n        // Initial snippet\r\n        snippet: null,\r\n        // Add toolbar\r\n        toolbar: null,\r\n        // Website parser is to read websites and images from cross domain\r\n        remoteParser: null,\r\n        // Placeholder\r\n        placeholder: null,\r\n        // Parse URL\r\n        parseURL: false,\r\n        filterPaste: true,\r\n        // Accept drop files\r\n        dropZone: false,\r\n        dropAsSnippet: false,\r\n        acceptImages: false,\r\n        acceptFiles: false,\r\n        maxFileSize: 5000000,\r\n        allowImageResize: true,\r\n        // Style\r\n        border: true,\r\n        padding: true,\r\n        maxHeight: null,\r\n        height: null,\r\n        focus: false,\r\n        // Events\r\n        onclick: null,\r\n        onfocus: null,\r\n        onblur: null,\r\n        onload: null,\r\n        onkeyup: null,\r\n        onkeydown: null,\r\n        onchange: null,\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Private controllers\r\n    var imageResize = 0;\r\n    var editorTimer = null;\r\n    var editorAction = null;\r\n    var files = [];\r\n\r\n    // Make sure element is empty\r\n    el.innerHTML = '';\r\n\r\n    // Keep the reference for the container\r\n    obj.el = el;\r\n\r\n    if (typeof(obj.options.onclick) == 'function') {\r\n        el.onclick = function(e) {\r\n            obj.options.onclick(el, obj, e);\r\n        }\r\n    }\r\n\r\n    // Prepare container\r\n    el.classList.add('jeditor-container');\r\n\r\n    // Padding\r\n    if (obj.options.padding == true) {\r\n        el.classList.add('jeditor-padding');\r\n    }\r\n\r\n    // Border\r\n    if (obj.options.border == false) {\r\n        el.style.border = '0px';\r\n    }\r\n\r\n    // Snippet\r\n    var snippet = document.createElement('div');\r\n    snippet.className = 'jsnippet';\r\n    snippet.setAttribute('contenteditable', false);\r\n\r\n    // Toolbar\r\n    var toolbar = document.createElement('div');\r\n    toolbar.className = 'jeditor-toolbar';\r\n\r\n    // Create editor\r\n    var editor = document.createElement('div');\r\n    editor.setAttribute('contenteditable', true);\r\n    editor.setAttribute('spellcheck', false);\r\n    editor.className = 'jeditor';\r\n\r\n    // Placeholder\r\n    if (obj.options.placeholder) {\r\n        editor.setAttribute('data-placeholder', obj.options.placeholder);\r\n    }\r\n\r\n    // Max height\r\n    if (obj.options.maxHeight || obj.options.height) {\r\n        editor.style.overflowY = 'auto';\r\n\r\n        if (obj.options.maxHeight) {\r\n            editor.style.maxHeight = obj.options.maxHeight;\r\n        }\r\n        if (obj.options.height) {\r\n            editor.style.height = obj.options.height;\r\n        }\r\n    }\r\n\r\n    // Set editor initial value\r\n    if (obj.options.value) {\r\n        var value = obj.options.value;\r\n    } else {\r\n        var value = el.innerHTML ? el.innerHTML : ''; \r\n    }\r\n\r\n    if (! value) {\r\n        var value = '';\r\n    }\r\n\r\n    /**\r\n     * Onchange event controllers\r\n     */\r\n    var change = function(e) {\r\n        if (typeof(obj.options.onchange) == 'function') { \r\n            obj.options.onchange(el, obj, e);\r\n        }\r\n\r\n        // Update value\r\n        obj.options.value = obj.getData();\r\n\r\n        // Lemonade JS\r\n        if (el.value != obj.options.value) {\r\n            el.value = obj.options.value;\r\n            if (typeof(el.onchange) == 'function') {\r\n                el.onchange({\r\n                    type: 'change',\r\n                    target: el,\r\n                    value: el.value\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Extract images from a HTML string\r\n     */\r\n    var extractImageFromHtml = function(html) {\r\n        // Create temp element\r\n        var div = document.createElement('div');\r\n        div.innerHTML = html;\r\n\r\n        // Extract images\r\n        var img = div.querySelectorAll('img');\r\n\r\n        if (img.length) {\r\n            for (var i = 0; i < img.length; i++) {\r\n                obj.addImage(img[i].src);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Insert node at caret\r\n     */\r\n    var insertNodeAtCaret = function(newNode) {\r\n        var sel, range;\r\n\r\n        if (window.getSelection) {\r\n            sel = window.getSelection();\r\n            if (sel.rangeCount) {\r\n                range = sel.getRangeAt(0);\r\n                var selectedText = range.toString();\r\n                range.deleteContents();\r\n                range.insertNode(newNode); \r\n                // move the cursor after element\r\n                range.setStartAfter(newNode);\r\n                range.setEndAfter(newNode); \r\n                sel.removeAllRanges();\r\n                sel.addRange(range);\r\n            }\r\n        }\r\n    }\r\n\r\n    var updateTotalImages = function() {\r\n        var o = null;\r\n        if (o = snippet.children[0]) {\r\n            // Make sure is a grid\r\n            if (! o.classList.contains('jslider-grid')) {\r\n                o.classList.add('jslider-grid');\r\n            }\r\n            // Quantify of images\r\n            var number = o.children.length;\r\n            // Set the configuration of the grid\r\n            o.setAttribute('data-number', number > 4 ? 4 : number);\r\n            // Total of images inside the grid\r\n            if (number > 4) {\r\n                o.setAttribute('data-total', number - 4);\r\n            } else {\r\n                o.removeAttribute('data-total');\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Append image to the snippet\r\n     */\r\n    var appendImage = function(image) {\r\n        if (! snippet.innerHTML) {\r\n            appendElement({});\r\n        }\r\n        snippet.children[0].appendChild(image);\r\n        updateTotalImages();\r\n    }\r\n\r\n    /**\r\n     * Append snippet\r\n     * @Param object data\r\n     */\r\n    var appendElement = function(data) {\r\n        // Reset snippet\r\n        snippet.innerHTML = '';\r\n\r\n        // Attributes\r\n        var a = [ 'image', 'title', 'description', 'host', 'url' ];\r\n\r\n        for (var i = 0; i < a.length; i++) {\r\n            var div = document.createElement('div');\r\n            div.className = 'jsnippet-' + a[i];\r\n            div.setAttribute('data-k', a[i]);\r\n            snippet.appendChild(div);\r\n            if (data[a[i]]) {\r\n                if (a[i] == 'image') {\r\n                    if (! Array.isArray(data.image)) {\r\n                        data.image = [ data.image ];\r\n                    }\r\n                    for (var j = 0; j < data.image.length; j++) {\r\n                        var img = document.createElement('img');\r\n                        img.src = data.image[j];\r\n                        div.appendChild(img);\r\n                    }\r\n                } else {\r\n                    div.innerHTML = data[a[i]];\r\n                }\r\n            }\r\n        }\r\n\r\n        editor.appendChild(document.createElement('br'));\r\n        editor.appendChild(snippet);\r\n    }\r\n\r\n    var verifyEditor = function() {\r\n        clearTimeout(editorTimer);\r\n        editorTimer = setTimeout(function() {\r\n            var snippet = editor.querySelector('.jsnippet');\r\n            if (! snippet) {\r\n                var html = editor.innerHTML.replace(/\\n/g, ' ');\r\n                var container = document.createElement('div');\r\n                container.innerHTML = html;\r\n                var text = container.innerText; \r\n                var url = jSuites.editor.detectUrl(text);\r\n\r\n                if (url) {\r\n                    if (url[0].substr(-3) == 'jpg' || url[0].substr(-3) == 'png' || url[0].substr(-3) == 'gif') {\r\n                         obj.addImage(url[0], true);\r\n                    } else {\r\n                        var id = jSuites.editor.youtubeParser(url[0]);\r\n                        obj.parseWebsite(url[0], id);\r\n                    }\r\n                }\r\n            }\r\n        }, 1000);\r\n    }\r\n\r\n    obj.parseContent = function() {\r\n        verifyEditor();\r\n    }\r\n\r\n    obj.parseWebsite = function(url, youtubeId) {\r\n        if (! obj.options.remoteParser) {\r\n            console.log('The remoteParser is not defined');\r\n        } else {\r\n            // Youtube definitions\r\n            if (youtubeId) {\r\n                var url = 'https://www.youtube.com/watch?v=' + youtubeId;\r\n            }\r\n\r\n            var p = {\r\n                title: '',\r\n                description: '',\r\n                image: '',\r\n                host: url.split('/')[2],\r\n                url: url,\r\n            }\r\n\r\n            jSuites.ajax({\r\n                url: obj.options.remoteParser + encodeURI(url.trim()),\r\n                method: 'GET',\r\n                dataType: 'json',\r\n                success: function(result) {\r\n                    // Get title\r\n                    if (result.title) {\r\n                        p.title = result.title;\r\n                    }\r\n                    // Description\r\n                    if (result.description) {\r\n                        p.description = result.description;\r\n                    }\r\n                    // Host\r\n                    if (result.host) {\r\n                        p.host = result.host;\r\n                    }\r\n                    // Url\r\n                    if (result.url) {\r\n                        p.url = result.url;\r\n                    }\r\n                    // Append snippet\r\n                    appendElement(p);\r\n                    // Add image\r\n                    if (result.image) {\r\n                        obj.addImage(result.image, true);\r\n                    } else if (result['og:image']) {\r\n                        obj.addImage(result['og:image'], true);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set editor value\r\n     */\r\n    obj.setData = function(html) {\r\n        editor.innerHTML = html;\r\n\r\n        if (obj.options.focus) {\r\n            jSuites.editor.setCursor(editor, true);\r\n        }\r\n\r\n        // Reset files container\r\n        files = [];\r\n    }\r\n\r\n    obj.getFiles = function() {\r\n        var f = editor.querySelectorAll('.jfile');\r\n        var d = [];\r\n        for (var i = 0; i < f.length; i++) {\r\n            if (files[f[i].src]) {\r\n                d.push(files[f[i].src]);\r\n            }\r\n        }\r\n        return d;\r\n    }\r\n\r\n    obj.getText = function() {\r\n        return editor.innerText;\r\n    }\r\n\r\n    /**\r\n     * Get editor data\r\n     */\r\n    obj.getData = function(json) {\r\n        if (! json) {\r\n            var data = editor.innerHTML;\r\n        } else {\r\n            var data = {\r\n                content : '',\r\n            }\r\n\r\n            // Get snippet\r\n            if (snippet.innerHTML) {\r\n                var index = 0;\r\n                data.snippet = {};\r\n                for (var i = 0; i < snippet.children.length; i++) {\r\n                    // Get key from element\r\n                    var key = snippet.children[i].getAttribute('data-k');\r\n                    if (key) {\r\n                        if (key == 'image') {\r\n                            if (! data.snippet.image) {\r\n                                data.snippet.image = [];\r\n                            }\r\n                            // Get all images\r\n                            for (var j = 0; j < snippet.children[i].children.length; j++) {\r\n                                data.snippet.image.push(snippet.children[i].children[j].getAttribute('src'))\r\n                            }\r\n                        } else {\r\n                            data.snippet[key] = snippet.children[i].innerHTML;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Get files\r\n            var f = Object.keys(files);\r\n            if (f.length) {\r\n                data.files = [];\r\n                for (var i = 0; i < f.length; i++) {\r\n                    data.files.push(files[f[i]]);\r\n                }\r\n            }\r\n\r\n            // Get content\r\n            var text = editor.innerHTML;\r\n            text = text.replace(/<br>/g, \"\\n\");\r\n            text = text.replace(/<\\/div>/g, \"<\\/div>\\n\");\r\n            text = text.replace(/<(?:.|\\n)*?>/gm, \"\");\r\n            data.content = text.trim();\r\n        }\r\n\r\n        return data;\r\n    }\r\n\r\n    // Reset\r\n    obj.reset = function() {\r\n        editor.innerHTML = '';\r\n        snippet.innerHTML = '';\r\n        files = [];\r\n    }\r\n\r\n    obj.addPdf = function(data) {\r\n        if (data.result.substr(0,4) != 'data') {\r\n            console.error('Invalid source');\r\n        } else {\r\n            var canvas = document.createElement('canvas');\r\n            canvas.width = 60;\r\n            canvas.height = 60;\r\n\r\n            var img = new Image();\r\n            var ctx = canvas.getContext('2d');\r\n            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\r\n\r\n            canvas.toBlob(function(blob) {\r\n                var newImage = document.createElement('img');\r\n                newImage.src = window.URL.createObjectURL(blob);\r\n                newImage.title = data.name;\r\n                newImage.className = 'jfile pdf';\r\n\r\n                files[newImage.src] = {\r\n                    file: newImage.src,\r\n                    extension: 'pdf',\r\n                    content: data.result,\r\n                }\r\n\r\n                insertNodeAtCaret(newImage);\r\n            });\r\n        }\r\n    }\r\n\r\n    obj.addImage = function(src, asSnippet) {\r\n        if (! src) {\r\n            src = '';\r\n        }\r\n\r\n        if (src.substr(0,4) != 'data' && ! obj.options.remoteParser) {\r\n            console.error('remoteParser not defined in your initialization');\r\n        } else {\r\n            // This is to process cross domain images\r\n            if (src.substr(0,4) == 'data') {\r\n                var extension = src.split(';')\r\n                extension = extension[0].split('/');\r\n                extension = extension[1];\r\n            } else {\r\n                var extension = src.substr(src.lastIndexOf('.') + 1);\r\n                // Work for cross browsers\r\n                src = obj.options.remoteParser + src;\r\n            }\r\n\r\n            var img = new Image();\r\n\r\n            img.onload = function onload() {\r\n                var canvas = document.createElement('canvas');\r\n                canvas.width = img.width;\r\n                canvas.height = img.height;\r\n\r\n                var ctx = canvas.getContext('2d');\r\n                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\r\n\r\n                canvas.toBlob(function(blob) {\r\n                    var newImage = document.createElement('img');\r\n                    newImage.src = window.URL.createObjectURL(blob);\r\n                    newImage.classList.add('jfile');\r\n                    newImage.setAttribute('tabindex', '900');\r\n                    files[newImage.src] = {\r\n                        file: newImage.src,\r\n                        extension: extension,\r\n                        content: canvas.toDataURL(),\r\n                    }\r\n\r\n                    if (obj.options.dropAsSnippet || asSnippet) {\r\n                        appendImage(newImage);\r\n                        // Just to understand the attachment is part of a snippet\r\n                        files[newImage.src].snippet = true;\r\n                    } else {\r\n                        insertNodeAtCaret(newImage);\r\n                    }\r\n\r\n                    change();\r\n                });\r\n            };\r\n\r\n            img.src = src;\r\n        }\r\n    }\r\n\r\n    obj.addFile = function(files) {\r\n        var reader = [];\r\n\r\n        for (var i = 0; i < files.length; i++) {\r\n            if (files[i].size > obj.options.maxFileSize) {\r\n                alert('The file is too big');\r\n            } else {\r\n                // Only PDF or Images\r\n                var type = files[i].type.split('/');\r\n\r\n                if (type[0] == 'image') {\r\n                    type = 1;\r\n                } else if (type[1] == 'pdf') {\r\n                    type = 2;\r\n                } else {\r\n                    type = 0;\r\n                }\r\n\r\n                if (type) {\r\n                    // Create file\r\n                    reader[i] = new FileReader();\r\n                    reader[i].index = i;\r\n                    reader[i].type = type;\r\n                    reader[i].name = files[i].name;\r\n                    reader[i].date = files[i].lastModified;\r\n                    reader[i].size = files[i].size;\r\n                    reader[i].addEventListener(\"load\", function (data) {\r\n                        // Get result\r\n                        if (data.target.type == 2) {\r\n                            if (obj.options.acceptFiles == true) {\r\n                                obj.addPdf(data.target);\r\n                            }\r\n                        } else {\r\n                            obj.addImage(data.target.result);\r\n                        }\r\n                    }, false);\r\n\r\n                    reader[i].readAsDataURL(files[i])\r\n                } else {\r\n                    alert('The extension is not allowed');\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Destroy\r\n    obj.destroy = function() {\r\n        editor.removeEventListener('mouseup', editorMouseUp);\r\n        editor.removeEventListener('mousedown', editorMouseDown);\r\n        editor.removeEventListener('mousemove', editorMouseMove);\r\n        editor.removeEventListener('keyup', editorKeyUp);\r\n        editor.removeEventListener('keydown', editorKeyDown);\r\n        editor.removeEventListener('dragstart', editorDragStart);\r\n        editor.removeEventListener('dragenter', editorDragEnter);\r\n        editor.removeEventListener('dragover', editorDragOver);\r\n        editor.removeEventListener('drop', editorDrop);\r\n        editor.removeEventListener('paste', editorPaste);\r\n\r\n        if (typeof(obj.options.onblur) == 'function') {\r\n            editor.removeEventListener('blur', editorBlur);\r\n        }\r\n        if (typeof(obj.options.onfocus) == 'function') {\r\n            editor.removeEventListener('focus', editorFocus);\r\n        }\r\n\r\n        el.editor = null;\r\n        el.classList.remove('jeditor-container');\r\n\r\n        toolbar.remove();\r\n        snippet.remove();\r\n        editor.remove();\r\n    }\r\n\r\n    var isLetter = function (str) {\r\n        var regex = /([\\u0041-\\u005A\\u0061-\\u007A\\u00AA\\u00B5\\u00BA\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0\\u08A2-\\u08AC\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097F\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C33\\u0C35-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191C\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA697\\uA6A0-\\uA6E5\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA793\\uA7A0-\\uA7AA\\uA7F8-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA80-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]+)/g;\r\n        return str.match(regex) ? 1 : 0;\r\n    }\r\n\r\n    // Event handlers\r\n    var editorMouseUp = function(e) {\r\n        if (editorAction && editorAction.e) {\r\n            editorAction.e.classList.remove('resizing');\r\n        }\r\n\r\n        editorAction = false;\r\n    }\r\n\r\n    var editorMouseDown = function(e) {\r\n        var close = function(snippet) {\r\n            var rect = snippet.getBoundingClientRect();\r\n            if (rect.width - (e.clientX - rect.left) < 40 && e.clientY - rect.top < 40) {\r\n                snippet.innerHTML = '';\r\n                snippet.remove();\r\n            }\r\n        }\r\n\r\n        if (e.target.tagName == 'IMG') {\r\n            if (e.target.style.cursor) {\r\n                var rect = e.target.getBoundingClientRect();\r\n                editorAction = {\r\n                    e: e.target,\r\n                    x: e.clientX,\r\n                    y: e.clientY,\r\n                    w: rect.width,\r\n                    h: rect.height,\r\n                    d: e.target.style.cursor,\r\n                }\r\n\r\n                if (! e.target.width) {\r\n                    e.target.width = rect.width + 'px';\r\n                }\r\n\r\n                if (! e.target.height) {\r\n                    e.target.height = rect.height + 'px';\r\n                }\r\n\r\n                var s = window.getSelection();\r\n                if (s.rangeCount) {\r\n                    for (var i = 0; i < s.rangeCount; i++) {\r\n                        s.removeRange(s.getRangeAt(i));\r\n                    }\r\n                }\r\n\r\n                e.target.classList.add('resizing');\r\n            } else {\r\n                editorAction = true;\r\n            }\r\n        } else { \r\n            if (e.target.classList.contains('jsnippet')) {\r\n                close(e.target);\r\n            } else if (e.target.parentNode.classList.contains('jsnippet')) {\r\n                close(e.target.parentNode);\r\n            }\r\n\r\n            editorAction = true;\r\n        }\r\n    }\r\n\r\n    var editorMouseMove = function(e) {\r\n        if (e.target.tagName == 'IMG' && ! e.target.parentNode.classList.contains('jsnippet-image') && obj.options.allowImageResize == true) {\r\n            if (e.target.getAttribute('tabindex')) {\r\n                var rect = e.target.getBoundingClientRect();\r\n                if (e.clientY - rect.top < 5) {\r\n                    if (rect.width - (e.clientX - rect.left) < 5) {\r\n                        e.target.style.cursor = 'ne-resize';\r\n                    } else if (e.clientX - rect.left < 5) {\r\n                        e.target.style.cursor = 'nw-resize';\r\n                    } else {\r\n                        e.target.style.cursor = 'n-resize';\r\n                    }\r\n                } else if (rect.height - (e.clientY - rect.top) < 5) {\r\n                    if (rect.width - (e.clientX - rect.left) < 5) {\r\n                        e.target.style.cursor = 'se-resize';\r\n                    } else if (e.clientX - rect.left < 5) {\r\n                        e.target.style.cursor = 'sw-resize';\r\n                    } else {\r\n                        e.target.style.cursor = 's-resize';\r\n                    }\r\n                } else if (rect.width - (e.clientX - rect.left) < 5) {\r\n                    e.target.style.cursor = 'e-resize';\r\n                } else if (e.clientX - rect.left < 5) {\r\n                    e.target.style.cursor = 'w-resize';\r\n                } else {\r\n                    e.target.style.cursor = '';\r\n                }\r\n            }\r\n        }\r\n\r\n        // Move\r\n        if (e.which == 1 && editorAction && editorAction.d) {\r\n            if (editorAction.d == 'e-resize' || editorAction.d == 'ne-resize' ||  editorAction.d == 'se-resize') {\r\n                editorAction.e.width = (editorAction.w + (e.clientX - editorAction.x));\r\n\r\n                if (e.shiftKey) {\r\n                    var newHeight = (e.clientX - editorAction.x) * (editorAction.h / editorAction.w);\r\n                    editorAction.e.height = editorAction.h + newHeight;\r\n                } else {\r\n                    var newHeight =  null;\r\n                }\r\n            }\r\n\r\n            if (! newHeight) {\r\n                if (editorAction.d == 's-resize' || editorAction.d == 'se-resize' || editorAction.d == 'sw-resize') {\r\n                    if (! e.shiftKey) {\r\n                        editorAction.e.height = editorAction.h + (e.clientY - editorAction.y);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    var editorKeyUp = function(e) {\r\n        if (! editor.innerHTML) {\r\n            editor.innerHTML = '<div><br></div>';\r\n        }\r\n\r\n        if (typeof(obj.options.onkeyup) == 'function') { \r\n            obj.options.onkeyup(el, obj, e);\r\n        }\r\n    }\r\n\r\n\r\n    var editorKeyDown = function(e) {\r\n        // Check for URL\r\n        if (obj.options.parseURL == true) {\r\n            verifyEditor();\r\n        }\r\n\r\n        if (typeof(obj.options.onkeydown) == 'function') { \r\n            obj.options.onkeydown(el, obj, e);\r\n        }\r\n\r\n        if (e.key == 'Delete') {\r\n            if (e.target.tagName == 'IMG' && e.target.parentNode.classList.contains('jsnippet-image')) {\r\n                e.target.remove();\r\n                updateTotalImages();\r\n            }\r\n        }\r\n    }\r\n\r\n    // Elements to be removed\r\n    var remove = [HTMLUnknownElement,HTMLAudioElement,HTMLEmbedElement,HTMLIFrameElement,HTMLTextAreaElement,HTMLInputElement,HTMLScriptElement];\r\n\r\n    // Valid properties\r\n    var validProperty = ['width', 'height', 'align', 'border', 'src', 'tabindex'];\r\n\r\n    // Valid CSS attributes\r\n    var validStyle = ['color', 'font-weight', 'font-size', 'background', 'background-color', 'margin'];\r\n\r\n    var parse = function(element) {\r\n       // Remove attributes\r\n       if (element.attributes && element.attributes.length) {\r\n           var image = null;\r\n           var style = null;\r\n           // Process style attribute\r\n           var elementStyle = element.getAttribute('style');\r\n           if (elementStyle) {\r\n               style = [];\r\n               var t = elementStyle.split(';');\r\n               for (var j = 0; j < t.length; j++) {\r\n                   var v = t[j].trim().split(':');\r\n                   if (validStyle.indexOf(v[0].trim()) >= 0) {\r\n                       var k = v.shift();\r\n                       var v = v.join(':');\r\n                       style.push(k + ':' + v);\r\n                   }\r\n               }\r\n           }\r\n           // Process image\r\n           if (element.tagName.toUpperCase() == 'IMG') {\r\n               if (! obj.options.acceptImages || ! element.src) {\r\n                   element.parentNode.removeChild(element);\r\n               } else {\r\n                   // Check if is data\r\n                   element.setAttribute('tabindex', '900');\r\n                   // Check attributes for persistance\r\n                   obj.addImage(element.src);\r\n               }\r\n           }\r\n           // Remove attributes\r\n           var attr = [];\r\n           var numAttributes = element.attributes.length - 1;\r\n           if (numAttributes > 0) {\r\n               for (var i = numAttributes; i >= 0 ; i--) {\r\n                   attr.push(element.attributes[i].name);\r\n               }\r\n               attr.forEach(function(v) {\r\n                   if (validProperty.indexOf(v) == -1) {\r\n                       element.removeAttribute(v);\r\n                   }\r\n               });\r\n           }\r\n           element.style = '';\r\n           // Add valid style\r\n           if (style && style.length) {\r\n               element.setAttribute('style', style.join(';'));\r\n           }\r\n       }\r\n       // Parse children\r\n       if (element.children.length) {\r\n           for (var i = 0; i < element.children.length; i++) {\r\n               parse(element.children[i]);\r\n           }\r\n       }\r\n\r\n       if (remove.indexOf(element.constructor) >= 0) {\r\n           element.remove();\r\n       }\r\n    }\r\n\r\n    var filter = function(data) {\r\n        if (data) {\r\n            data = data.replace(new RegExp('<!--(.*?)-->', 'gsi'), '');\r\n        }\r\n        var parser = new DOMParser();\r\n        var d = parser.parseFromString(data, \"text/html\");\r\n        parse(d);\r\n        var span = document.createElement('span');\r\n        span.innerHTML = d.firstChild.innerHTML;\r\n        return span;\r\n    } \r\n\r\n    var editorPaste = function(e) {\r\n        if (obj.options.filterPaste == true) {\r\n            if (e.clipboardData || e.originalEvent.clipboardData) {\r\n                var html = (e.originalEvent || e).clipboardData.getData('text/html');\r\n                var text = (e.originalEvent || e).clipboardData.getData('text/plain');\r\n                var file = (e.originalEvent || e).clipboardData.files\r\n            } else if (window.clipboardData) {\r\n                var html = window.clipboardData.getData('Html');\r\n                var text = window.clipboardData.getData('Text');\r\n                var file = window.clipboardData.files\r\n            }\r\n\r\n            if (file.length) {\r\n                // Paste a image from the clipboard\r\n                obj.addFile(file);\r\n            } else {\r\n                if (! html) {\r\n                    html = text.split('\\r\\n');\r\n                    if (! e.target.innerText) {\r\n                        html.map(function(v) {\r\n                            var d = document.createElement('div');\r\n                            d.innerText = v;\r\n                            editor.appendChild(d);\r\n                        });\r\n                    } else {\r\n                        html = html.map(function(v) {\r\n                            return '<div>' + v + '</div>';\r\n                        });\r\n                        document.execCommand('insertHtml', false, html.join(''));\r\n                    }\r\n                } else {\r\n                    var d = filter(html);\r\n                    // Paste to the editor\r\n                    //insertNodeAtCaret(d);\r\n                    document.execCommand('insertHtml', false, d.innerHTML);\r\n                }\r\n            }\r\n\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorDragStart = function(e) {\r\n        if (editorAction && editorAction.e) {\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorDragEnter = function(e) {\r\n        if (editorAction || obj.options.dropZone == false) {\r\n            // Do nothing\r\n        } else {\r\n            el.classList.add('jeditor-dragging');\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorDragOver = function(e) {\r\n        if (editorAction || obj.options.dropZone == false) {\r\n            // Do nothing\r\n        } else {\r\n            if (editorTimer) {\r\n                clearTimeout(editorTimer);\r\n            }\r\n\r\n            editorTimer = setTimeout(function() {\r\n                el.classList.remove('jeditor-dragging');\r\n            }, 100);\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorDrop = function(e) {\r\n        if (editorAction || obj.options.dropZone == false) {\r\n            // Do nothing\r\n        } else {\r\n            // Position caret on the drop\r\n            var range = null;\r\n            if (document.caretRangeFromPoint) {\r\n                range=document.caretRangeFromPoint(e.clientX, e.clientY);\r\n            } else if (e.rangeParent) {\r\n                range=document.createRange();\r\n                range.setStart(e.rangeParent,e.rangeOffset);\r\n            }\r\n            var sel = window.getSelection();\r\n            sel.removeAllRanges();\r\n            sel.addRange(range);\r\n            sel.anchorNode.parentNode.focus();\r\n\r\n            var html = (e.originalEvent || e).dataTransfer.getData('text/html');\r\n            var text = (e.originalEvent || e).dataTransfer.getData('text/plain');\r\n            var file = (e.originalEvent || e).dataTransfer.files;\r\n    \r\n            if (file.length) {\r\n                obj.addFile(file);\r\n            } else if (text) {\r\n                extractImageFromHtml(html);\r\n            }\r\n\r\n            el.classList.remove('jeditor-dragging');\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorBlur = function(e) {\r\n        // Blur\r\n        if (typeof(obj.options.onblur) == 'function') {\r\n            obj.options.onblur(el, obj, e);\r\n        }\r\n\r\n        change(e);\r\n    }\r\n\r\n    var editorFocus = function(e) {\r\n        // Focus\r\n        if (typeof(obj.options.onfocus) == 'function') {\r\n            obj.options.onfocus(el, obj, e);\r\n        }\r\n    }\r\n\r\n    editor.addEventListener('mouseup', editorMouseUp);\r\n    editor.addEventListener('mousedown', editorMouseDown);\r\n    editor.addEventListener('mousemove', editorMouseMove);\r\n    editor.addEventListener('keyup', editorKeyUp);\r\n    editor.addEventListener('keydown', editorKeyDown);\r\n    editor.addEventListener('dragstart', editorDragStart);\r\n    editor.addEventListener('dragenter', editorDragEnter);\r\n    editor.addEventListener('dragover', editorDragOver);\r\n    editor.addEventListener('drop', editorDrop);\r\n    editor.addEventListener('paste', editorPaste);\r\n    editor.addEventListener('focus', editorFocus);\r\n    editor.addEventListener('blur', editorBlur);\r\n\r\n    // Onload\r\n    if (typeof(obj.options.onload) == 'function') {\r\n        obj.options.onload(el, obj, editor);\r\n    }\r\n\r\n    // Set value to the editor\r\n    editor.innerHTML = value;\r\n\r\n    // Append editor to the containre\r\n    el.appendChild(editor);\r\n\r\n    // Snippet\r\n    if (obj.options.snippet) {\r\n        appendElement(obj.options.snippet);\r\n    }\r\n\r\n    // Default toolbar\r\n    if (obj.options.toolbar == null) {\r\n        obj.options.toolbar = jSuites.editor.getDefaultToolbar();\r\n    }\r\n\r\n    // Add toolbar\r\n    if (obj.options.toolbar) {\r\n        // Append to the DOM\r\n        el.appendChild(toolbar);\r\n        // Create toolbar\r\n        jSuites.toolbar(toolbar, {\r\n            container: true,\r\n            responsive: true,\r\n            items: obj.options.toolbar\r\n        });\r\n    }\r\n\r\n    // Focus to the editor\r\n    if (obj.options.focus) {\r\n        jSuites.editor.setCursor(editor, obj.options.focus == 'initial' ? true : false);\r\n    }\r\n\r\n    // Change method\r\n    el.change = obj.setData;\r\n\r\n    // Global generic value handler\r\n    el.val = function(val) {\r\n        if (val === undefined) {\r\n            // Data type\r\n            var o = el.getAttribute('data-html') === 'true' ? false : true;\r\n            return obj.getData(o);\r\n        } else {\r\n            obj.setData(val);\r\n        }\r\n    }\r\n\r\n    el.editor = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.editor.setCursor = function(element, first) {\r\n    element.focus();\r\n    document.execCommand('selectAll');\r\n    var sel = window.getSelection();\r\n    var range = sel.getRangeAt(0);\r\n    if (first == true) {\r\n        var node = range.startContainer;\r\n        var size = 0;\r\n    } else {\r\n        var node = range.endContainer;\r\n        var size = node.length;\r\n    }\r\n    range.setStart(node, size);\r\n    range.setEnd(node, size);\r\n    sel.removeAllRanges();\r\n    sel.addRange(range);\r\n}\r\n\r\njSuites.editor.getDomain = function(url) {\r\n    return url.replace('http://','').replace('https://','').replace('www.','').split(/[/?#]/)[0].split(/:/g)[0];\r\n}\r\n\r\njSuites.editor.detectUrl = function(text) {\r\n    var expression = /(((https?:\\/\\/)|(www\\.))[-A-Z0-9+&@#\\/%?=~_|!:,.;]*[-A-Z0-9+&@#\\/%=~_|]+)/ig;\r\n    var links = text.match(expression);\r\n\r\n    if (links) {\r\n        if (links[0].substr(0,3) == 'www') {\r\n            links[0] = 'http://' + links[0];\r\n        }\r\n    }\r\n\r\n    return links;\r\n}\r\n\r\njSuites.editor.youtubeParser = function(url) {\r\n    var regExp = /^.*((youtu.be\\/)|(v\\/)|(\\/u\\/\\w\\/)|(embed\\/)|(watch\\?))\\??v?=?([^#\\&\\?]*).*/;\r\n    var match = url.match(regExp);\r\n\r\n    return (match && match[7].length == 11) ? match[7] : false;\r\n}\r\n\r\njSuites.editor.getDefaultToolbar = function() { \r\n    return [\r\n        {\r\n            content: 'undo',\r\n            onclick: function() {\r\n                document.execCommand('undo');\r\n            }\r\n        },\r\n        {\r\n            content: 'redo',\r\n            onclick: function() {\r\n                document.execCommand('redo');\r\n            }\r\n        },\r\n        {\r\n            type:'divisor'\r\n        },\r\n        {\r\n            content: 'format_bold',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('bold');\r\n\r\n                if (document.queryCommandState(\"bold\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_italic',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('italic');\r\n\r\n                if (document.queryCommandState(\"italic\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_underline',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('underline');\r\n\r\n                if (document.queryCommandState(\"underline\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            type:'divisor'\r\n        },\r\n        {\r\n            content: 'format_list_bulleted',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('insertUnorderedList');\r\n\r\n                if (document.queryCommandState(\"insertUnorderedList\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_list_numbered',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('insertOrderedList');\r\n\r\n                if (document.queryCommandState(\"insertOrderedList\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_indent_increase',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('indent', true, null);\r\n\r\n                if (document.queryCommandState(\"indent\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_indent_decrease',\r\n            onclick: function() {\r\n                document.execCommand('outdent');\r\n\r\n                if (document.queryCommandState(\"outdent\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        }/*,\r\n        {\r\n            icon: ['format_align_left', 'format_align_right', 'format_align_center'],\r\n            onclick: function() {\r\n                document.execCommand('justifyCenter');\r\n\r\n                if (document.queryCommandState(\"justifyCenter\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        }\r\n        {\r\n            type:'select',\r\n            items: ['Verdana','Arial','Courier New'],\r\n            onchange: function() {\r\n            }\r\n        },\r\n        {\r\n            type:'select',\r\n            items: ['10px','12px','14px','16px','18px','20px','22px'],\r\n            onchange: function() {\r\n            }\r\n        },\r\n        {\r\n            icon:'format_align_left',\r\n            onclick: function() {\r\n                document.execCommand('JustifyLeft');\r\n\r\n                if (document.queryCommandState(\"JustifyLeft\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            icon:'format_align_center',\r\n            onclick: function() {\r\n                document.execCommand('justifyCenter');\r\n\r\n                if (document.queryCommandState(\"justifyCenter\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            icon:'format_align_right',\r\n            onclick: function() {\r\n                document.execCommand('justifyRight');\r\n\r\n                if (document.queryCommandState(\"justifyRight\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            icon:'format_align_justify',\r\n            onclick: function() {\r\n                document.execCommand('justifyFull');\r\n\r\n                if (document.queryCommandState(\"justifyFull\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            icon:'format_list_bulleted',\r\n            onclick: function() {\r\n                document.execCommand('insertUnorderedList');\r\n\r\n                if (document.queryCommandState(\"insertUnorderedList\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        }*/\r\n    ];\r\n}\r\n\r\n\r\njSuites.form = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        url: null,\r\n        message: 'Are you sure? There are unsaved information in your form',\r\n        ignore: false,\r\n        currentHash: null,\r\n        submitButton:null,\r\n        validations: null,\r\n        onbeforeload: null,\r\n        onload: null,\r\n        onbeforesave: null,\r\n        onsave: null,\r\n        onbeforeremove: null,\r\n        onremove: null,\r\n        onerror: function(el, message) {\r\n            jSuites.alert(message);\r\n        }\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Validations\r\n    if (! obj.options.validations) {\r\n        obj.options.validations = {};\r\n    }\r\n\r\n    // Submit Button\r\n    if (! obj.options.submitButton) {\r\n        obj.options.submitButton = el.querySelector('input[type=submit]');\r\n    }\r\n\r\n    if (obj.options.submitButton && obj.options.url) {\r\n        obj.options.submitButton.onclick = function() {\r\n            obj.save();\r\n        }\r\n    }\r\n\r\n    if (! obj.options.validations.email) {\r\n        obj.options.validations.email = jSuites.validations.email;\r\n    }\r\n\r\n    if (! obj.options.validations.length) {\r\n        obj.options.validations.length = jSuites.validations.length;\r\n    }\r\n\r\n    if (! obj.options.validations.required) {\r\n        obj.options.validations.required = jSuites.validations.required;\r\n    }\r\n\r\n    obj.setUrl = function(url) {\r\n        obj.options.url = url;\r\n    }\r\n\r\n    obj.load = function() {\r\n        jSuites.ajax({\r\n            url: obj.options.url,\r\n            method: 'GET',\r\n            dataType: 'json',\r\n            queue: true,\r\n            success: function(data) {\r\n                // Overwrite values from the backend\r\n                if (typeof(obj.options.onbeforeload) == 'function') {\r\n                    var ret = obj.options.onbeforeload(el, data);\r\n                    if (ret) {\r\n                        data = ret;\r\n                    }\r\n                }\r\n                // Apply values to the form\r\n                jSuites.form.setElements(el, data);\r\n                // Onload methods\r\n                if (typeof(obj.options.onload) == 'function') {\r\n                    obj.options.onload(el, data);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    obj.save = function() {\r\n        var test = obj.validate();\r\n\r\n        if (test) {\r\n            obj.options.onerror(el, test);\r\n        } else {\r\n            var data = jSuites.form.getElements(el, true);\r\n\r\n            if (typeof(obj.options.onbeforesave) == 'function') {\r\n                var data = obj.options.onbeforesave(el, data);\r\n\r\n                if (data === false) {\r\n                    return;\r\n                }\r\n            }\r\n\r\n            jSuites.ajax({\r\n                url: obj.options.url,\r\n                method: 'POST',\r\n                dataType: 'json',\r\n                data: data,\r\n                success: function(result) {\r\n                    if (typeof(obj.options.onsave) == 'function') {\r\n                        obj.options.onsave(el, data, result);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    obj.remove = function() {\r\n        if (typeof(obj.options.onbeforeremove) == 'function') {\r\n            var ret = obj.options.onbeforeremove(el, obj);\r\n            if (ret === false) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        jSuites.ajax({\r\n            url: obj.options.url,\r\n            method: 'DELETE',\r\n            dataType: 'json',\r\n            success: function(result) {\r\n                if (typeof(obj.options.onremove) == 'function') {\r\n                    obj.options.onremove(el, obj, result);\r\n                }\r\n\r\n                obj.reset();\r\n            }\r\n        });\r\n    }\r\n\r\n    var addError = function(element) {\r\n        // Add error in the element\r\n        element.classList.add('error');\r\n        // Submit button\r\n        if (obj.options.submitButton) {\r\n            obj.options.submitButton.setAttribute('disabled', true);\r\n        }\r\n        // Return error message\r\n        var error = element.getAttribute('data-error') || 'There is an error in the form';\r\n        element.setAttribute('title', error);\r\n        return error;\r\n    }\r\n\r\n    var delError = function(element) {\r\n        var error = false;\r\n        // Remove class from this element\r\n        element.classList.remove('error');\r\n        element.removeAttribute('title');\r\n        // Get elements in the form\r\n        var elements = el.querySelectorAll(\"input, select, textarea, div[name]\");\r\n        // Run all elements \r\n        for (var i = 0; i < elements.length; i++) {\r\n            if (elements[i].getAttribute('data-validation')) {\r\n                if (elements[i].classList.contains('error')) {\r\n                    error = true;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (obj.options.submitButton) {\r\n            if (error) {\r\n                obj.options.submitButton.setAttribute('disabled', true);\r\n            } else {\r\n                obj.options.submitButton.removeAttribute('disabled');\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.validateElement = function(element) {\r\n        // Test results\r\n        var test = false;\r\n        // Value\r\n        var value = jSuites.form.getValue(element);\r\n        // Validation\r\n        var validation = element.getAttribute('data-validation');\r\n        // Parse\r\n        if (typeof(obj.options.validations[validation]) == 'function' && ! obj.options.validations[validation](value, element)) {\r\n            // Not passed in the test\r\n            test = addError(element);\r\n        } else {\r\n            if (element.classList.contains('error')) {\r\n                delError(element);\r\n            }\r\n        }\r\n\r\n        return test;\r\n    }\r\n\r\n    obj.reset = function() {\r\n        // Get elements in the form\r\n        var name = null;\r\n        var elements = el.querySelectorAll(\"input, select, textarea, div[name]\");\r\n        // Run all elements \r\n        for (var i = 0; i < elements.length; i++) {\r\n            if (name = elements[i].getAttribute('name')) {\r\n                if (elements[i].type == 'checkbox' || elements[i].type == 'radio') {\r\n                    elements[i].checked = false;\r\n                } else {\r\n                    if (typeof(elements[i].val) == 'function') {\r\n                        elements[i].val('');\r\n                    } else {\r\n                        elements[i].value = '';\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Run form validation\r\n    obj.validate = function() {\r\n        var test = [];\r\n        // Get elements in the form\r\n        var elements = el.querySelectorAll(\"input, select, textarea, div[name]\");\r\n        // Run all elements \r\n        for (var i = 0; i < elements.length; i++) {\r\n            // Required\r\n            if (elements[i].getAttribute('data-validation')) {\r\n                var res = obj.validateElement(elements[i]);\r\n                if (res) {\r\n                    test.push(res);\r\n                }\r\n            }\r\n        }\r\n        if (test.length > 0) {\r\n            return test.join('<br>');\r\n        } else {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    // Check the form\r\n    obj.getError = function() {\r\n        // Validation\r\n        return obj.validation() ? true : false;\r\n    }\r\n\r\n    // Return the form hash\r\n    obj.setHash = function() {\r\n        return obj.getHash(jSuites.form.getElements(el));\r\n    }\r\n\r\n    // Get the form hash\r\n    obj.getHash = function(str) {\r\n        var hash = 0, i, chr;\r\n\r\n        if (str.length === 0) {\r\n            return hash;\r\n        } else {\r\n            for (i = 0; i < str.length; i++) {\r\n              chr = str.charCodeAt(i);\r\n              hash = ((hash << 5) - hash) + chr;\r\n              hash |= 0;\r\n            }\r\n        }\r\n\r\n        return hash;\r\n    }\r\n\r\n    // Is there any change in the form since start tracking?\r\n    obj.isChanged = function() {\r\n        var hash = obj.setHash();\r\n        return (obj.options.currentHash != hash);\r\n    }\r\n\r\n    // Restart tracking\r\n    obj.resetTracker = function() {\r\n        obj.options.currentHash = obj.setHash();\r\n        obj.options.ignore = false;\r\n    }\r\n\r\n    // Ignore flag\r\n    obj.setIgnore = function(ignoreFlag) {\r\n        obj.options.ignore = ignoreFlag ? true : false;\r\n    }\r\n\r\n    // Start tracking in one second\r\n    setTimeout(function() {\r\n        obj.options.currentHash = obj.setHash();\r\n    }, 1000);\r\n\r\n    // Validations\r\n    el.addEventListener(\"keyup\", function(e) {\r\n        if (e.target.getAttribute('data-validation')) {\r\n            obj.validateElement(e.target);\r\n        }\r\n    });\r\n\r\n    // Alert\r\n    if (! jSuites.form.hasEvents) {\r\n        window.addEventListener(\"beforeunload\", function (e) {\r\n            if (obj.isChanged() && obj.options.ignore == false) {\r\n                var confirmationMessage =  obj.options.message? obj.options.message : \"\\o/\";\r\n\r\n                if (confirmationMessage) {\r\n                    if (typeof e == 'undefined') {\r\n                        e = window.event;\r\n                    }\r\n\r\n                    if (e) {\r\n                        e.returnValue = confirmationMessage;\r\n                    }\r\n\r\n                    return confirmationMessage;\r\n                } else {\r\n                    return void(0);\r\n                }\r\n            }\r\n        });\r\n\r\n        jSuites.form.hasEvents = true;\r\n    }\r\n\r\n    el.form = obj;\r\n\r\n    return obj;\r\n});\r\n\r\n// Get value from one element\r\njSuites.form.getValue = function(element) {\r\n    var value = null;\r\n    if (element.type == 'checkbox') {\r\n        if (element.checked == true) {\r\n            value = element.value || true;\r\n        }\r\n    } else if (element.type == 'radio') {\r\n        if (element.checked == true) {\r\n            value = element.value;\r\n        }\r\n    } else if (element.type == 'file') {\r\n        value = element.files;\r\n    } else if (element.tagName == 'select' && element.multiple == true) {\r\n        value = [];\r\n        var options = element.querySelectorAll(\"options[selected]\");\r\n        for (var j = 0; j < options.length; j++) {\r\n            value.push(options[j].value);\r\n        }\r\n    } else if (typeof(element.val) == 'function') {\r\n        value = element.val();\r\n    } else {\r\n        value = element.value || '';\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n// Get form elements\r\njSuites.form.getElements = function(el, asArray) {\r\n    var data = {};\r\n    var name = null;\r\n    var elements = el.querySelectorAll(\"input, select, textarea, div[name]\");\r\n\r\n    for (var i = 0; i < elements.length; i++) {\r\n        if (name = elements[i].getAttribute('name')) {\r\n            data[name] = jSuites.form.getValue(elements[i]) || '';\r\n        }\r\n    }\r\n\r\n    return asArray == true ? data : JSON.stringify(data);\r\n}\r\n\r\n//Get form elements\r\njSuites.form.setElements = function(el, data) {\r\n    var name = null;\r\n    var value = null;\r\n    var elements = el.querySelectorAll(\"input, select, textarea, div[name]\");\r\n    for (var i = 0; i < elements.length; i++) {\r\n        // Attributes\r\n        var type = elements[i].getAttribute('type');\r\n        if (name = elements[i].getAttribute('name')) {\r\n            // Transform variable names in pathname\r\n            name = name.replace(new RegExp(/\\[(.*?)\\]/ig), '.$1');\r\n            value = null;\r\n            // Seach for the data in the path\r\n            if (name.match(/\\./)) {\r\n                var tmp = jSuites.path.call(data, name) || '';\r\n                if (typeof(tmp) !== 'undefined') {\r\n                    value = tmp;\r\n                }\r\n            } else {\r\n                if (typeof(data[name]) !== 'undefined') {\r\n                    value = data[name];\r\n                }\r\n            }\r\n            // Set the values\r\n            if (value !== null) {\r\n                if (type == 'checkbox' || type == 'radio') {\r\n                    elements[i].checked = value ? true : false;\r\n                } else if (type == 'file') {\r\n                    // Do nothing\r\n                } else {\r\n                    if (typeof (elements[i].val) == 'function') {\r\n                        elements[i].val(value);\r\n                    } else {\r\n                        elements[i].value = value;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n// Legacy\r\njSuites.tracker = jSuites.form;\r\n\r\njSuites.focus = function(el) {\r\n    if (el.innerText.length) {\r\n        var range = document.createRange();\r\n        var sel = window.getSelection();\r\n        var node = el.childNodes[el.childNodes.length-1];\r\n        range.setStart(node, node.length)\r\n        range.collapse(true)\r\n        sel.removeAllRanges()\r\n        sel.addRange(range)\r\n        el.scrollLeft = el.scrollWidth;\r\n    }\r\n}\r\n\r\njSuites.isNumeric = (function (num) {\r\n    return !isNaN(num) && num !== null && num !== '';\r\n});\r\n\r\njSuites.guid = function() {\r\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\r\n        var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\r\n        return v.toString(16);\r\n    });\r\n}\r\n\r\njSuites.getNode = function() {\r\n    var node = document.getSelection().anchorNode;\r\n    if (node) {\r\n        return (node.nodeType == 3 ? node.parentNode : node);\r\n    } else {\r\n        return null;\r\n    }\r\n}\r\n/**\r\n * Generate hash from a string\r\n */\r\njSuites.hash = function(str) {\r\n    var hash = 0, i, chr;\r\n\r\n    if (str.length === 0) {\r\n        return hash;\r\n    } else {\r\n        for (i = 0; i < str.length; i++) {\r\n            chr = str.charCodeAt(i);\r\n            if (chr > 32) {\r\n                hash = ((hash << 5) - hash) + chr;\r\n                hash |= 0;\r\n            }\r\n        }\r\n    }\r\n    return hash;\r\n}\r\n\r\n/**\r\n * Generate a random color\r\n */\r\njSuites.randomColor = function(h) {\r\n    var lum = -0.25;\r\n    var hex = String('#' + Math.random().toString(16).slice(2, 8).toUpperCase()).replace(/[^0-9a-f]/gi, '');\r\n    if (hex.length < 6) {\r\n        hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];\r\n    }\r\n    var rgb = [], c, i;\r\n    for (i = 0; i < 3; i++) {\r\n        c = parseInt(hex.substr(i * 2, 2), 16);\r\n        c = Math.round(Math.min(Math.max(0, c + (c * lum)), 255)).toString(16);\r\n        rgb.push((\"00\" + c).substr(c.length));\r\n    }\r\n\r\n    // Return hex\r\n    if (h == true) {\r\n        return '#' + jSuites.two(rgb[0].toString(16)) + jSuites.two(rgb[1].toString(16)) + jSuites.two(rgb[2].toString(16));\r\n    }\r\n\r\n    return rgb;\r\n}\r\n\r\njSuites.getWindowWidth = function() {\r\n    var w = window,\r\n    d = document,\r\n    e = d.documentElement,\r\n    g = d.getElementsByTagName('body')[0],\r\n    x = w.innerWidth || e.clientWidth || g.clientWidth;\r\n    return x;\r\n}\r\n\r\njSuites.getWindowHeight = function() {\r\n    var w = window,\r\n    d = document,\r\n    e = d.documentElement,\r\n    g = d.getElementsByTagName('body')[0],\r\n    y = w.innerHeight|| e.clientHeight|| g.clientHeight;\r\n    return  y;\r\n}\r\n\r\njSuites.getPosition = function(e) {\r\n    if (e.changedTouches && e.changedTouches[0]) {\r\n        var x = e.changedTouches[0].pageX;\r\n        var y = e.changedTouches[0].pageY;\r\n    } else {\r\n        var x = (window.Event) ? e.pageX : e.clientX + (document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft);\r\n        var y = (window.Event) ? e.pageY : e.clientY + (document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop);\r\n    }\r\n\r\n    return [ x, y ];\r\n}\r\n\r\njSuites.click = function(el) {\r\n    if (el.click) {\r\n        el.click();\r\n    } else {\r\n        var evt = new MouseEvent('click', {\r\n            bubbles: true,\r\n            cancelable: true,\r\n            view: window\r\n        });\r\n        el.dispatchEvent(evt);\r\n    }\r\n}\r\n\r\njSuites.findElement = function(element, condition) {\r\n    var foundElement = false;\r\n\r\n    function path (element) {\r\n        if (element && ! foundElement) {\r\n            if (typeof(condition) == 'function') {\r\n                foundElement = condition(element)\r\n            } else if (typeof(condition) == 'string') {\r\n                if (element.classList && element.classList.contains(condition)) {\r\n                    foundElement = element;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (element.parentNode && ! foundElement) {\r\n            path(element.parentNode);\r\n        }\r\n    }\r\n\r\n    path(element);\r\n\r\n    return foundElement;\r\n}\r\n\r\n// Two digits\r\njSuites.two = function(value) {\r\n    value = '' + value;\r\n    if (value.length == 1) {\r\n        value = '0' + value;\r\n    }\r\n    return value;\r\n}\r\n\r\njSuites.sha512 = (function(str) {\r\n    function int64(msint_32, lsint_32) {\r\n        this.highOrder = msint_32;\r\n        this.lowOrder = lsint_32;\r\n    }\r\n\r\n    var H = [new int64(0x6a09e667, 0xf3bcc908), new int64(0xbb67ae85, 0x84caa73b),\r\n        new int64(0x3c6ef372, 0xfe94f82b), new int64(0xa54ff53a, 0x5f1d36f1),\r\n        new int64(0x510e527f, 0xade682d1), new int64(0x9b05688c, 0x2b3e6c1f),\r\n        new int64(0x1f83d9ab, 0xfb41bd6b), new int64(0x5be0cd19, 0x137e2179)];\r\n\r\n    var K = [new int64(0x428a2f98, 0xd728ae22), new int64(0x71374491, 0x23ef65cd),\r\n        new int64(0xb5c0fbcf, 0xec4d3b2f), new int64(0xe9b5dba5, 0x8189dbbc),\r\n        new int64(0x3956c25b, 0xf348b538), new int64(0x59f111f1, 0xb605d019),\r\n        new int64(0x923f82a4, 0xaf194f9b), new int64(0xab1c5ed5, 0xda6d8118),\r\n        new int64(0xd807aa98, 0xa3030242), new int64(0x12835b01, 0x45706fbe),\r\n        new int64(0x243185be, 0x4ee4b28c), new int64(0x550c7dc3, 0xd5ffb4e2),\r\n        new int64(0x72be5d74, 0xf27b896f), new int64(0x80deb1fe, 0x3b1696b1),\r\n        new int64(0x9bdc06a7, 0x25c71235), new int64(0xc19bf174, 0xcf692694),\r\n        new int64(0xe49b69c1, 0x9ef14ad2), new int64(0xefbe4786, 0x384f25e3),\r\n        new int64(0x0fc19dc6, 0x8b8cd5b5), new int64(0x240ca1cc, 0x77ac9c65),\r\n        new int64(0x2de92c6f, 0x592b0275), new int64(0x4a7484aa, 0x6ea6e483),\r\n        new int64(0x5cb0a9dc, 0xbd41fbd4), new int64(0x76f988da, 0x831153b5),\r\n        new int64(0x983e5152, 0xee66dfab), new int64(0xa831c66d, 0x2db43210),\r\n        new int64(0xb00327c8, 0x98fb213f), new int64(0xbf597fc7, 0xbeef0ee4),\r\n        new int64(0xc6e00bf3, 0x3da88fc2), new int64(0xd5a79147, 0x930aa725),\r\n        new int64(0x06ca6351, 0xe003826f), new int64(0x14292967, 0x0a0e6e70),\r\n        new int64(0x27b70a85, 0x46d22ffc), new int64(0x2e1b2138, 0x5c26c926),\r\n        new int64(0x4d2c6dfc, 0x5ac42aed), new int64(0x53380d13, 0x9d95b3df),\r\n        new int64(0x650a7354, 0x8baf63de), new int64(0x766a0abb, 0x3c77b2a8),\r\n        new int64(0x81c2c92e, 0x47edaee6), new int64(0x92722c85, 0x1482353b),\r\n        new int64(0xa2bfe8a1, 0x4cf10364), new int64(0xa81a664b, 0xbc423001),\r\n        new int64(0xc24b8b70, 0xd0f89791), new int64(0xc76c51a3, 0x0654be30),\r\n        new int64(0xd192e819, 0xd6ef5218), new int64(0xd6990624, 0x5565a910),\r\n        new int64(0xf40e3585, 0x5771202a), new int64(0x106aa070, 0x32bbd1b8),\r\n        new int64(0x19a4c116, 0xb8d2d0c8), new int64(0x1e376c08, 0x5141ab53),\r\n        new int64(0x2748774c, 0xdf8eeb99), new int64(0x34b0bcb5, 0xe19b48a8),\r\n        new int64(0x391c0cb3, 0xc5c95a63), new int64(0x4ed8aa4a, 0xe3418acb),\r\n        new int64(0x5b9cca4f, 0x7763e373), new int64(0x682e6ff3, 0xd6b2b8a3),\r\n        new int64(0x748f82ee, 0x5defb2fc), new int64(0x78a5636f, 0x43172f60),\r\n        new int64(0x84c87814, 0xa1f0ab72), new int64(0x8cc70208, 0x1a6439ec),\r\n        new int64(0x90befffa, 0x23631e28), new int64(0xa4506ceb, 0xde82bde9),\r\n        new int64(0xbef9a3f7, 0xb2c67915), new int64(0xc67178f2, 0xe372532b),\r\n        new int64(0xca273ece, 0xea26619c), new int64(0xd186b8c7, 0x21c0c207),\r\n        new int64(0xeada7dd6, 0xcde0eb1e), new int64(0xf57d4f7f, 0xee6ed178),\r\n        new int64(0x06f067aa, 0x72176fba), new int64(0x0a637dc5, 0xa2c898a6),\r\n        new int64(0x113f9804, 0xbef90dae), new int64(0x1b710b35, 0x131c471b),\r\n        new int64(0x28db77f5, 0x23047d84), new int64(0x32caab7b, 0x40c72493),\r\n        new int64(0x3c9ebe0a, 0x15c9bebc), new int64(0x431d67c4, 0x9c100d4c),\r\n        new int64(0x4cc5d4be, 0xcb3e42b6), new int64(0x597f299c, 0xfc657e2a),\r\n        new int64(0x5fcb6fab, 0x3ad6faec), new int64(0x6c44198c, 0x4a475817)];\r\n\r\n    var W = new Array(64);\r\n    var a, b, c, d, e, f, g, h, i, j;\r\n    var T1, T2;\r\n    var charsize = 8;\r\n\r\n    function utf8_encode(str) {\r\n        return unescape(encodeURIComponent(str));\r\n    }\r\n\r\n    function str2binb(str) {\r\n        var bin = [];\r\n        var mask = (1 << charsize) - 1;\r\n        var len = str.length * charsize;\r\n    \r\n        for (var i = 0; i < len; i += charsize) {\r\n            bin[i >> 5] |= (str.charCodeAt(i / charsize) & mask) << (32 - charsize - (i % 32));\r\n        }\r\n    \r\n        return bin;\r\n    }\r\n\r\n    function binb2hex(binarray) {\r\n        var hex_tab = \"0123456789abcdef\";\r\n        var str = \"\";\r\n        var length = binarray.length * 4;\r\n        var srcByte;\r\n\r\n        for (var i = 0; i < length; i += 1) {\r\n            srcByte = binarray[i >> 2] >> ((3 - (i % 4)) * 8);\r\n            str += hex_tab.charAt((srcByte >> 4) & 0xF) + hex_tab.charAt(srcByte & 0xF);\r\n        }\r\n\r\n        return str;\r\n    }\r\n\r\n    function safe_add_2(x, y) {\r\n        var lsw, msw, lowOrder, highOrder;\r\n\r\n        lsw = (x.lowOrder & 0xFFFF) + (y.lowOrder & 0xFFFF);\r\n        msw = (x.lowOrder >>> 16) + (y.lowOrder >>> 16) + (lsw >>> 16);\r\n        lowOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\r\n\r\n        lsw = (x.highOrder & 0xFFFF) + (y.highOrder & 0xFFFF) + (msw >>> 16);\r\n        msw = (x.highOrder >>> 16) + (y.highOrder >>> 16) + (lsw >>> 16);\r\n        highOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\r\n\r\n        return new int64(highOrder, lowOrder);\r\n    }\r\n\r\n    function safe_add_4(a, b, c, d) {\r\n        var lsw, msw, lowOrder, highOrder;\r\n\r\n        lsw = (a.lowOrder & 0xFFFF) + (b.lowOrder & 0xFFFF) + (c.lowOrder & 0xFFFF) + (d.lowOrder & 0xFFFF);\r\n        msw = (a.lowOrder >>> 16) + (b.lowOrder >>> 16) + (c.lowOrder >>> 16) + (d.lowOrder >>> 16) + (lsw >>> 16);\r\n        lowOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\r\n\r\n        lsw = (a.highOrder & 0xFFFF) + (b.highOrder & 0xFFFF) + (c.highOrder & 0xFFFF) + (d.highOrder & 0xFFFF) + (msw >>> 16);\r\n        msw = (a.highOrder >>> 16) + (b.highOrder >>> 16) + (c.highOrder >>> 16) + (d.highOrder >>> 16) + (lsw >>> 16);\r\n        highOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\r\n\r\n        return new int64(highOrder, lowOrder);\r\n    }\r\n\r\n    function safe_add_5(a, b, c, d, e) {\r\n        var lsw, msw, lowOrder, highOrder;\r\n\r\n        lsw = (a.lowOrder & 0xFFFF) + (b.lowOrder & 0xFFFF) + (c.lowOrder & 0xFFFF) + (d.lowOrder & 0xFFFF) + (e.lowOrder & 0xFFFF);\r\n        msw = (a.lowOrder >>> 16) + (b.lowOrder >>> 16) + (c.lowOrder >>> 16) + (d.lowOrder >>> 16) + (e.lowOrder >>> 16) + (lsw >>> 16);\r\n        lowOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\r\n\r\n        lsw = (a.highOrder & 0xFFFF) + (b.highOrder & 0xFFFF) + (c.highOrder & 0xFFFF) + (d.highOrder & 0xFFFF) + (e.highOrder & 0xFFFF) + (msw >>> 16);\r\n        msw = (a.highOrder >>> 16) + (b.highOrder >>> 16) + (c.highOrder >>> 16) + (d.highOrder >>> 16) + (e.highOrder >>> 16) + (lsw >>> 16);\r\n        highOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\r\n\r\n        return new int64(highOrder, lowOrder);\r\n    }\r\n\r\n    function maj(x, y, z) {\r\n        return new int64(\r\n            (x.highOrder & y.highOrder) ^ (x.highOrder & z.highOrder) ^ (y.highOrder & z.highOrder),\r\n            (x.lowOrder & y.lowOrder) ^ (x.lowOrder & z.lowOrder) ^ (y.lowOrder & z.lowOrder)\r\n        );\r\n    }\r\n\r\n    function ch(x, y, z) {\r\n        return new int64(\r\n            (x.highOrder & y.highOrder) ^ (~x.highOrder & z.highOrder),\r\n            (x.lowOrder & y.lowOrder) ^ (~x.lowOrder & z.lowOrder)\r\n        );\r\n    }\r\n\r\n    function rotr(x, n) {\r\n        if (n <= 32) {\r\n            return new int64(\r\n             (x.highOrder >>> n) | (x.lowOrder << (32 - n)),\r\n             (x.lowOrder >>> n) | (x.highOrder << (32 - n))\r\n            );\r\n        } else {\r\n            return new int64(\r\n             (x.lowOrder >>> n) | (x.highOrder << (32 - n)),\r\n             (x.highOrder >>> n) | (x.lowOrder << (32 - n))\r\n            );\r\n        }\r\n    }\r\n\r\n    function sigma0(x) {\r\n        var rotr28 = rotr(x, 28);\r\n        var rotr34 = rotr(x, 34);\r\n        var rotr39 = rotr(x, 39);\r\n\r\n        return new int64(\r\n            rotr28.highOrder ^ rotr34.highOrder ^ rotr39.highOrder,\r\n            rotr28.lowOrder ^ rotr34.lowOrder ^ rotr39.lowOrder\r\n        );\r\n    }\r\n\r\n    function sigma1(x) {\r\n        var rotr14 = rotr(x, 14);\r\n        var rotr18 = rotr(x, 18);\r\n        var rotr41 = rotr(x, 41);\r\n\r\n        return new int64(\r\n            rotr14.highOrder ^ rotr18.highOrder ^ rotr41.highOrder,\r\n            rotr14.lowOrder ^ rotr18.lowOrder ^ rotr41.lowOrder\r\n        );\r\n    }\r\n\r\n    function gamma0(x) {\r\n        var rotr1 = rotr(x, 1), rotr8 = rotr(x, 8), shr7 = shr(x, 7);\r\n\r\n        return new int64(\r\n            rotr1.highOrder ^ rotr8.highOrder ^ shr7.highOrder,\r\n            rotr1.lowOrder ^ rotr8.lowOrder ^ shr7.lowOrder\r\n        );\r\n    }\r\n\r\n    function gamma1(x) {\r\n        var rotr19 = rotr(x, 19);\r\n        var rotr61 = rotr(x, 61);\r\n        var shr6 = shr(x, 6);\r\n\r\n        return new int64(\r\n            rotr19.highOrder ^ rotr61.highOrder ^ shr6.highOrder,\r\n            rotr19.lowOrder ^ rotr61.lowOrder ^ shr6.lowOrder\r\n        );\r\n    }\r\n\r\n    function shr(x, n) {\r\n        if (n <= 32) {\r\n            return new int64(\r\n                x.highOrder >>> n,\r\n                x.lowOrder >>> n | (x.highOrder << (32 - n))\r\n            );\r\n        } else {\r\n            return new int64(\r\n                0,\r\n                x.highOrder << (32 - n)\r\n            );\r\n        }\r\n    }\r\n\r\n    var str = utf8_encode(str);\r\n    var strlen = str.length*charsize;\r\n    str = str2binb(str);\r\n\r\n    str[strlen >> 5] |= 0x80 << (24 - strlen % 32);\r\n    str[(((strlen + 128) >> 10) << 5) + 31] = strlen;\r\n\r\n    for (var i = 0; i < str.length; i += 32) {\r\n        a = H[0];\r\n        b = H[1];\r\n        c = H[2];\r\n        d = H[3];\r\n        e = H[4];\r\n        f = H[5];\r\n        g = H[6];\r\n        h = H[7];\r\n\r\n        for (var j = 0; j < 80; j++) {\r\n            if (j < 16) {\r\n                W[j] = new int64(str[j*2 + i], str[j*2 + i + 1]);\r\n            } else {\r\n                W[j] = safe_add_4(gamma1(W[j - 2]), W[j - 7], gamma0(W[j - 15]), W[j - 16]);\r\n            }\r\n\r\n            T1 = safe_add_5(h, sigma1(e), ch(e, f, g), K[j], W[j]);\r\n            T2 = safe_add_2(sigma0(a), maj(a, b, c));\r\n            h = g;\r\n            g = f;\r\n            f = e;\r\n            e = safe_add_2(d, T1);\r\n            d = c;\r\n            c = b;\r\n            b = a;\r\n            a = safe_add_2(T1, T2);\r\n        }\r\n\r\n        H[0] = safe_add_2(a, H[0]);\r\n        H[1] = safe_add_2(b, H[1]);\r\n        H[2] = safe_add_2(c, H[2]);\r\n        H[3] = safe_add_2(d, H[3]);\r\n        H[4] = safe_add_2(e, H[4]);\r\n        H[5] = safe_add_2(f, H[5]);\r\n        H[6] = safe_add_2(g, H[6]);\r\n        H[7] = safe_add_2(h, H[7]);\r\n    }\r\n\r\n    var binarray = [];\r\n    for (var i = 0; i < H.length; i++) {\r\n        binarray.push(H[i].highOrder);\r\n        binarray.push(H[i].lowOrder);\r\n    }\r\n\r\n    return binb2hex(binarray);\r\n});\r\n\r\nif (! jSuites.login) {\r\n    jSuites.login = {};\r\n    jSuites.login.sha512 = jSuites.sha512;\r\n}\r\n\r\njSuites.image = jSuites.upload = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        type: 'image',\r\n        extension: '*',\r\n        input: false,\r\n        minWidth: false,\r\n        maxWidth: null,\r\n        maxHeight: null,\r\n        maxJpegSizeBytes: null, // For example, 350Kb would be 350000\r\n        onchange: null,\r\n        multiple: false,\r\n        remoteParser: null,\r\n        text:{\r\n            extensionNotAllowed:'The extension is not allowed',\r\n        }\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Multiple\r\n    if (obj.options.multiple == true) {\r\n        el.setAttribute('data-multiple', true);\r\n    }\r\n\r\n    // Container\r\n    el.content = [];\r\n\r\n    // Upload icon\r\n    el.classList.add('jupload');\r\n\r\n    if (obj.options.input == true) {\r\n        el.classList.add('input');\r\n    }\r\n\r\n    obj.add = function(data) {\r\n        // Reset container for single files\r\n        if (obj.options.multiple == false) {\r\n            el.content = [];\r\n            el.innerText = '';\r\n        }\r\n\r\n        // Append to the element\r\n        if (obj.options.type == 'image') {\r\n            var img = document.createElement('img');\r\n            img.setAttribute('src', data.file);\r\n            img.setAttribute('tabindex', -1);\r\n            if (! el.getAttribute('name')) {\r\n                img.className = 'jfile';\r\n                img.content = data;\r\n            }\r\n            el.appendChild(img);\r\n        } else {\r\n            if (data.name) {\r\n                var name = data.name;\r\n            } else {\r\n                var name = data.file;\r\n            }\r\n            var div = document.createElement('div');\r\n            div.innerText = name || obj.options.type;\r\n            div.classList.add('jupload-item');\r\n            div.setAttribute('tabindex', -1);\r\n            el.appendChild(div);\r\n        }\r\n\r\n        if (data.content) {\r\n            data.file = jSuites.guid();\r\n        }\r\n\r\n        // Push content\r\n        el.content.push(data);\r\n\r\n        // Onchange\r\n        if (typeof(obj.options.onchange) == 'function') {\r\n            obj.options.onchange(el, data);\r\n        }\r\n    }\r\n\r\n    obj.addFromFile = function(file) {\r\n        var type = file.type.split('/');\r\n        if (type[0] == obj.options.type) {\r\n            var readFile = new FileReader();\r\n            readFile.addEventListener(\"load\", function (v) {\r\n                var data = {\r\n                    file: v.srcElement.result,\r\n                    extension: file.name.substr(file.name.lastIndexOf('.') + 1),\r\n                    name: file.name,\r\n                    size: file.size,\r\n                    lastmodified: file.lastModified,\r\n                    content: v.srcElement.result,\r\n                }\r\n\r\n                obj.add(data);\r\n            });\r\n\r\n            readFile.readAsDataURL(file);\r\n        } else {\r\n            alert(obj.options.text.extensionNotAllowed);\r\n        }\r\n    }\r\n\r\n    obj.addFromUrl = function(src) {\r\n        if (src.substr(0,4) != 'data' && ! obj.options.remoteParser) {\r\n            console.error('remoteParser not defined in your initialization');\r\n        } else {\r\n            // This is to process cross domain images\r\n            if (src.substr(0,4) == 'data') {\r\n                var extension = src.split(';')\r\n                extension = extension[0].split('/');\r\n                var type = extension[0].replace('data:','');\r\n                if (type == obj.options.type) {\r\n                    var data = {\r\n                        file: src,\r\n                        name: '',\r\n                        extension: extension[1],\r\n                        content: src,\r\n                    }\r\n                    obj.add(data);\r\n                } else {\r\n                    alert(obj.options.text.extensionNotAllowed);\r\n                }\r\n            } else {\r\n                var extension = src.substr(src.lastIndexOf('.') + 1);\r\n                // Work for cross browsers\r\n                src = obj.options.remoteParser + src;\r\n                // Get remove content\r\n                jSuites.ajax({\r\n                    url: src,\r\n                    type: 'GET',\r\n                    dataType: 'blob',\r\n                    success: function(data) {\r\n                        //add(extension[0].replace('data:',''), data);\r\n                    }\r\n                })\r\n            }\r\n        }\r\n    }\r\n\r\n    var getDataURL = function(canvas, type) {\r\n        var compression = 0.92;\r\n        var lastContentLength = null;\r\n        var content = canvas.toDataURL(type, compression);\r\n        while (obj.options.maxJpegSizeBytes && type === 'image/jpeg' &&\r\n               content.length > obj.options.maxJpegSizeBytes && content.length !== lastContentLength) {\r\n            // Apply the compression\r\n            compression *= 0.9;\r\n            lastContentLength = content.length;\r\n            content = canvas.toDataURL(type, compression);\r\n        }\r\n        return content;\r\n    }\r\n\r\n    var mime = obj.options.type + '/' + obj.options.extension;\r\n    var input = document.createElement('input');\r\n    input.type = 'file';\r\n    input.setAttribute('accept', mime);\r\n    input.onchange = function() {\r\n        for (var i = 0; i < this.files.length; i++) {\r\n            obj.addFromFile(this.files[i]);\r\n        }\r\n    }\r\n\r\n    // Allow multiple files\r\n    if (obj.options.multiple == true) {\r\n        input.setAttribute('multiple', true);\r\n    }\r\n\r\n    var current = null;\r\n\r\n    el.addEventListener(\"click\", function(e) {\r\n        current = null;\r\n        if (! el.children.length || e.target === el) {\r\n            jSuites.click(input);\r\n        } else {\r\n            if (e.target.parentNode == el) {\r\n                current = e.target;\r\n            }\r\n        }\r\n    });\r\n\r\n    el.addEventListener(\"dblclick\", function(e) {\r\n        jSuites.click(input);\r\n    });\r\n\r\n    el.addEventListener('dragenter', function(e) {\r\n        el.style.border = '1px dashed #000';\r\n    });\r\n\r\n    el.addEventListener('dragleave', function(e) {\r\n        el.style.border = '1px solid #eee';\r\n    });\r\n\r\n    el.addEventListener('dragstop', function(e) {\r\n        el.style.border = '1px solid #eee';\r\n    });\r\n\r\n    el.addEventListener('dragover', function(e) {\r\n        e.preventDefault();\r\n    });\r\n\r\n    el.addEventListener('keydown', function(e) {\r\n        if (current && e.which == 46) {\r\n            var index = Array.prototype.indexOf.call(el.children, current);\r\n            if (index >= 0) {\r\n                el.content.splice(index, 1);\r\n                current.remove();\r\n                current = null;\r\n            }\r\n        }\r\n    });\r\n\r\n    el.addEventListener('drop', function(e) {\r\n        e.preventDefault();  \r\n        e.stopPropagation();\r\n\r\n        var html = (e.originalEvent || e).dataTransfer.getData('text/html');\r\n        var file = (e.originalEvent || e).dataTransfer.files;\r\n\r\n        if (file.length) {\r\n            for (var i = 0; i < e.dataTransfer.files.length; i++) {\r\n                obj.addFromFile(e.dataTransfer.files[i]);\r\n            }\r\n        } else if (html) {\r\n            if (obj.options.multiple == false) {\r\n                el.innerText = '';\r\n            }\r\n\r\n            // Create temp element\r\n            var div = document.createElement('div');\r\n            div.innerHTML = html;\r\n\r\n            // Extract images\r\n            var img = div.querySelectorAll('img');\r\n\r\n            if (img.length) {\r\n                for (var i = 0; i < img.length; i++) {\r\n                    obj.addFromUrl(img[i].src);\r\n                }\r\n            }\r\n        }\r\n\r\n        el.style.border = '1px solid #eee';\r\n\r\n        return false;\r\n    });\r\n\r\n    el.val = function(val) {\r\n        if (val === undefined) {\r\n            return el.content && el.content.length ? el.content : null;\r\n        } else {\r\n            // Reset\r\n            el.innerText = '';\r\n            el.content = [];\r\n\r\n            if (val) {\r\n                if (Array.isArray(val)) {\r\n                    for (var i = 0; i < val.length; i++) {\r\n                        if (typeof(val[i]) == 'string') {\r\n                            obj.add({ file: val[i] });\r\n                        } else {\r\n                            obj.add(val[i]);\r\n                        }\r\n                    }\r\n                } else if (typeof(val) == 'string') {\r\n                    obj.add({ file: val });\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    el.upload = el.image = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.image.create = function(data) {\r\n    var img = document.createElement('img');\r\n    img.setAttribute('src', data.file);\r\n    img.className = 'jfile';\r\n    img.setAttribute('tabindex', -1);\r\n    img.content = data;\r\n\r\n    return img;\r\n}\r\n\r\n\r\njSuites.lazyLoading = (function(el, options) {\r\n    var obj = {}\r\n\r\n    // Mandatory options\r\n    if (! options.loadUp || typeof(options.loadUp) != 'function') {\r\n        options.loadUp = function() {\r\n            return false;\r\n        }\r\n    }\r\n    if (! options.loadDown || typeof(options.loadDown) != 'function') {\r\n        options.loadDown = function() {\r\n            return false;\r\n        }\r\n    }\r\n    // Timer ms\r\n    if (! options.timer) {\r\n        options.timer = 100;\r\n    }\r\n\r\n    // Timer\r\n    var timeControlLoading = null;\r\n\r\n    // Controls\r\n    var scrollControls = function(e) {\r\n        if (timeControlLoading == null) {\r\n            var event = false;\r\n            var scrollTop = el.scrollTop;\r\n            if (el.scrollTop + (el.clientHeight * 2) >= el.scrollHeight) {\r\n                if (options.loadDown()) {\r\n                    if (scrollTop == el.scrollTop) {\r\n                        el.scrollTop = el.scrollTop - (el.clientHeight);\r\n                    }\r\n                    event = true;\r\n                }\r\n            } else if (el.scrollTop <= el.clientHeight) {\r\n                if (options.loadUp()) {\r\n                    if (scrollTop == el.scrollTop) {\r\n                        el.scrollTop = el.scrollTop + (el.clientHeight);\r\n                    }\r\n                    event = true;\r\n                }\r\n            }\r\n\r\n            timeControlLoading = setTimeout(function() {\r\n                timeControlLoading = null;\r\n            }, options.timer);\r\n\r\n            if (event) {\r\n                if (typeof(options.onupdate) == 'function') {\r\n                    options.onupdate();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Onscroll\r\n    el.onscroll = function(e) {\r\n        scrollControls(e);\r\n    }\r\n\r\n    el.onwheel = function(e) {\r\n        scrollControls(e);\r\n    }\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.loading = (function() {\r\n    var obj = {};\r\n\r\n    var loading = null;\r\n\r\n    obj.show = function() {\r\n        if (! loading) {\r\n            loading = document.createElement('div');\r\n            loading.className = 'jloading';\r\n        }\r\n        document.body.appendChild(loading);\r\n    }\r\n\r\n    obj.hide = function() {\r\n        if (loading && loading.parentNode) {\r\n            document.body.removeChild(loading);\r\n        }\r\n    }\r\n\r\n    return obj;\r\n})();\r\n\r\njSuites.mask = (function() {\r\n    // Currency \r\n    var tokens = {\r\n        // Currency tokens\r\n        currency: [ '#(.{1})##0?(.{1}0+)?( ?;(.*)?)?', '#' ],\r\n        // Percentage\r\n        percentage: [ '0{1}(.{1}0+)?%' ],\r\n        // Number\r\n        numeric: [ '0{1}(.{1}0+)?' ],\r\n        // Data tokens\r\n        datetime: [ 'YYYY', 'YYY', 'YY', 'MMMMM', 'MMMM', 'MMM', 'MM', 'DDDDD', 'DDDD', 'DDD', 'DD', 'DY', 'DAY', 'WD', 'D', 'Q', 'HH24', 'HH12', 'HH', '\\\\[H\\\\]', 'H', 'AM/PM', 'PM', 'AM', 'MI', 'SS', 'MS', 'MONTH', 'MON', 'Y', 'M' ],\r\n        // Other\r\n        general: [ 'A', '0', '[0-9a-zA-Z\\$]+', '.']\r\n    }\r\n\r\n    var getDate = function() {\r\n        if (this.mask.toLowerCase().indexOf('[h]') !== -1) {\r\n            var m = 0;\r\n            if (this.date[4]) {\r\n                m = parseFloat(this.date[4] / 60);\r\n            }\r\n            var v = parseInt(this.date[3]) + m;\r\n            v /= 24;\r\n        } else if (! (this.date[0] && this.date[1] && this.date[2]) && (this.date[3] || this.date[4])) {\r\n            v = jSuites.two(this.date[3]) + ':' + jSuites.two(this.date[4]) + ':' + jSuites.two(this.date[5]) \r\n        } else {\r\n            if (this.date[0] && this.date[1] && ! this.date[2]) {\r\n                this.date[2] = 1;\r\n            }\r\n            v = jSuites.two(this.date[0]) + '-' + jSuites.two(this.date[1]) + '-' + jSuites.two(this.date[2]);\r\n\r\n            if (this.date[3] || this.date[4] || this.date[5]) {\r\n                v += ' ' + jSuites.two(this.date[3]) + ':' + jSuites.two(this.date[4]) + ':' + jSuites.two(this.date[5]);\r\n            }\r\n        }\r\n\r\n        return v;\r\n    }\r\n\r\n    var isBlank = function(v) {\r\n        return v === null || v === '' || v === undefined ? true : false;\r\n    }\r\n\r\n    var isFormula = function(value) {\r\n        return (''+value).chartAt(0) == '=';\r\n    }\r\n\r\n    var isNumeric = function(t) {\r\n        return t === 'currency' || t === 'percentage' || t === 'numeric' ? true : false;\r\n    }\r\n    /**\r\n     * Get the decimal defined in the mask configuration\r\n     */\r\n    var getDecimal = function(v) {\r\n        if (v && Number(v) == v) {\r\n            return '.';\r\n        } else {\r\n            if (this.options.decimal) {\r\n                return this.options.decimal;\r\n            } else {\r\n                if (this.locale) {\r\n                    var t = Intl.NumberFormat(this.locale).format(1.1);\r\n                    return this.options.decimal = t[1];\r\n                } else {\r\n                    if (! v) {\r\n                        v  = this.mask;\r\n                    }\r\n                    var e = new RegExp('0{1}(.{1})0+', 'ig');\r\n                    var t = e.exec(v);\r\n                    if (t && t[1] && t[1].length == 1) {\r\n                        // Save decimal\r\n                        this.options.decimal = t[1];\r\n                        // Return decimal\r\n                        return t[1];\r\n                    } else {\r\n                        // Did not find any decimal last resort the default\r\n                        var e = new RegExp('#,##', 'ig');\r\n                        if ((v && v.match(e)) || '1.1'.toLocaleString().substring(1,2) == ',') {\r\n                            this.options.decimal = ',';\r\n                        } else {\r\n                            this.options.decimal = '.';\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (this.options.decimal) {\r\n            return this.options.decimal;\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    var ParseValue = function(v, decimal) {\r\n        if (v == '') {\r\n            return '';\r\n        }\r\n\r\n        // Get decimal\r\n        if (! decimal) {\r\n            decimal = getDecimal.call(this);\r\n        }\r\n\r\n        // New value\r\n        v = (''+v).split(decimal);\r\n        v[0] = v[0].match(/[\\-0-9]+/g, '');\r\n        if (v[0]) {\r\n            v[0] = v[0].join('');\r\n        }\r\n        if (v[0] || v[1]) {\r\n            if (v[1] !== undefined) {\r\n                v[1] = v[1].match(/[0-9]+/g, '');\r\n                if (v[1]) {\r\n                    v[1] = v[1].join('');\r\n                } else {\r\n                    v[1] = '';\r\n                }\r\n            }\r\n        } else {\r\n            return '';\r\n        }\r\n\r\n        return v;\r\n    }\r\n\r\n    var FormatValue = function(v) {\r\n        if (v == '') {\r\n            return '';\r\n        }\r\n        // Get decimal\r\n        var d = getDecimal.call(this);\r\n        // Convert value\r\n        var o = this.options;\r\n        // Parse value\r\n        v = ParseValue.call(this, v);\r\n        if (v == '') {\r\n            return '';\r\n        }\r\n        // Temporary value\r\n        if (v[0]) {\r\n            var t = parseFloat(v.join('.'));\r\n            if (o.style == 'percent') {\r\n                t /= 100;\r\n            }\r\n        } else {\r\n            var t = null;\r\n        }\r\n        var n = new Intl.NumberFormat(this.locale, o).format(t);\r\n        n = n.split(d);\r\n        if (typeof(n[1]) !== 'undefined') {\r\n            var s = n[1].replace(/[0-9]*/g, '');\r\n            if (s) {\r\n                n[2] = s;\r\n            }\r\n        }\r\n\r\n        if (v[1] !== undefined) {\r\n            n[1] = d + v[1];\r\n        } else {\r\n            n[1] = '';\r\n        }\r\n\r\n        return n.join('');\r\n    }\r\n\r\n    var Format = function(e) {\r\n        var v = Value.call(e);\r\n        if (! v) {\r\n            return;\r\n        }\r\n\r\n        // Get decimal\r\n        var d = getDecimal.call(this);\r\n        var n = FormatValue.call(this, v);\r\n        var t = (n.length) - v.length;\r\n        var index = Caret.call(e) + t;\r\n        // Set value and update caret\r\n        Value.call(e, n, index, true);\r\n    }\r\n\r\n    var Extract = function(v) {\r\n        // Keep the raw value\r\n        var current = ParseValue.call(this, v);\r\n        if (current) {\r\n            return parseFloat(current.join('.'));\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Caret getter and setter methods\r\n     */\r\n    var Caret = function(index, adjustNumeric) {\r\n        if (index === undefined) {\r\n            if (this.tagName == 'DIV') {\r\n                var pos = 0;\r\n                var s = window.getSelection();\r\n                if (s) {\r\n                    if (s.rangeCount !== 0) {\r\n                        var r = s.getRangeAt(0);\r\n                        var p = r.cloneRange();\r\n                        p.selectNodeContents(this);\r\n                        p.setEnd(r.endContainer, r.endOffset);\r\n                        pos = p.toString().length;\r\n                    }\r\n                }\r\n                return pos;\r\n            } else {\r\n                return this.selectionStart;\r\n            }\r\n        } else {\r\n            // Get the current value\r\n            var n = Value.call(this);\r\n\r\n            // Review the position\r\n            if (adjustNumeric) {\r\n                var p = null;\r\n                for (var i = 0; i < n.length; i++) {\r\n                    if (n[i].match(/[\\-0-9]/g) || n[i] == '.' || n[i] == ',') {  \r\n                        p = i;\r\n                    }\r\n                }\r\n\r\n                // If the string has no numbers\r\n                if (p === null) {\r\n                    p = n.indexOf(' ');\r\n                }\r\n\r\n                if (index >= p) {\r\n                    index = p + 1;\r\n                }\r\n            }\r\n\r\n            // Do not update caret\r\n            if (index > n.length) {\r\n                index = n.length;\r\n            }\r\n\r\n            if (index) {\r\n                // Set caret\r\n                if (this.tagName == 'DIV') {\r\n                    var s = window.getSelection();\r\n                    var r = document.createRange();\r\n                    r.setStart(this.childNodes[0], index);\r\n                    s.removeAllRanges();\r\n                    s.addRange(r);\r\n                } else {\r\n                    this.selectionStart = index;\r\n                    this.selectionEnd = index;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Value getter and setter method\r\n     */\r\n    var Value = function(v, updateCaret, adjustNumeric) {\r\n        if (this.tagName == 'DIV') {\r\n            if (v === undefined) {\r\n                return this.innerText;\r\n            } else {\r\n                if (this.innerText !== v) {\r\n                    this.innerText = v;\r\n\r\n                    if (updateCaret) {\r\n                        Caret.call(this, updateCaret, adjustNumeric);\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            if (v === undefined) {\r\n                return this.value;\r\n            } else {\r\n                if (this.value !== v) {\r\n                    this.value = v;\r\n                    if (updateCaret) {\r\n                        Caret.call(this, updateCaret, adjustNumeric);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Labels\r\n    var weekDaysFull = jSuites.calendar.weekdays;\r\n    var weekDays = jSuites.calendar.weekdaysShort;\r\n    var monthsFull = jSuites.calendar.months;\r\n    var months = jSuites.calendar.monthsShort;\r\n\r\n    var parser = {\r\n        'YEAR': function(v, s) {\r\n            var y = ''+new Date().getFullYear();\r\n\r\n            if (typeof(this.values[this.index]) === 'undefined') {\r\n                this.values[this.index] = '';\r\n            }\r\n            if (parseInt(v) >= 0 && parseInt(v) <= 10) {\r\n                if (this.values[this.index].length < s) {\r\n                    this.values[this.index] += v;\r\n                }\r\n            }\r\n            if (this.values[this.index].length == s) {\r\n                if (s == 2) {\r\n                    var y = y.substr(0,2) + this.values[this.index];\r\n                } else if (s == 3) {\r\n                    var y = y.substr(0,1) + this.values[this.index];\r\n                } else if (s == 4) {\r\n                    var y = this.values[this.index];\r\n                }\r\n                this.date[0] = y;\r\n                this.index++;\r\n            }\r\n        },\r\n        'YYYY': function(v) {\r\n            parser.YEAR.call(this, v, 4);\r\n        },\r\n        'YYY': function(v) {\r\n            parser.YEAR.call(this, v, 3);\r\n        },\r\n        'YY': function(v) {\r\n            parser.YEAR.call(this, v, 2);\r\n        },\r\n        'FIND': function(v, a) {\r\n            if (isBlank(this.values[this.index])) {\r\n                this.values[this.index] = '';\r\n            }\r\n            var pos = 0;\r\n            var count = 0;\r\n            var value = (this.values[this.index] + v).toLowerCase();\r\n            for (var i = 0; i < a.length; i++) {\r\n                if (a[i].toLowerCase().indexOf(value) == 0) {\r\n                    pos = i;\r\n                    count++;\r\n                }\r\n            }\r\n            if (count > 1) {\r\n                this.values[this.index] += v;\r\n            } else if (count == 1) {\r\n                // Jump number of chars\r\n                var t = (a[pos].length - this.values[this.index].length) - 1;\r\n                this.position += t;\r\n\r\n                this.values[this.index] = a[pos];\r\n                this.index++;\r\n                return pos;\r\n            }\r\n        },\r\n        'MMM': function(v) {\r\n            var ret = parser.FIND.call(this, v, months);\r\n            if (ret !== undefined) {\r\n                this.date[1] = ret + 1;\r\n            }\r\n        },\r\n        'MMMM': function(v) {\r\n            var ret = parser.FIND.call(this, v, monthsFull);\r\n            if (ret !== undefined) {\r\n                this.date[1] = ret + 1;\r\n            }\r\n        },\r\n        'MMMMM': function(v) {\r\n            if (isBlank(this.values[this.index])) {\r\n                this.values[this.index] = '';\r\n            }\r\n            var pos = 0;\r\n            var count = 0;\r\n            var value = (this.values[this.index] + v).toLowerCase();\r\n            for (var i = 0; i < monthsFull.length; i++) {\r\n                if (monthsFull[i][0].toLowerCase().indexOf(value) == 0) {\r\n                    this.values[this.index] = monthsFull[i][0];\r\n                    this.date[1] = i + 1;\r\n                    this.index++;\r\n                    break;\r\n                }\r\n            }\r\n        },\r\n        'MM': function(v) {\r\n            if (isBlank(this.values[this.index])) {\r\n                if (parseInt(v) > 1 && parseInt(v) < 10) {\r\n                    this.date[1] = this.values[this.index] = '0' + v;\r\n                    this.index++;\r\n                } else if (parseInt(v) < 2) {\r\n                    this.values[this.index] = v;\r\n                }\r\n            } else {\r\n                if (this.values[this.index] == 1 && parseInt(v) < 3) {\r\n                    this.date[1] = this.values[this.index] += v;\r\n                    this.index++;\r\n                } else if (this.values[this.index] == 0 && parseInt(v) > 0 && parseInt(v) < 10) {\r\n                    this.date[1] = this.values[this.index] += v;\r\n                    this.index++;\r\n                }\r\n            }\r\n        },\r\n        'M': function(v) {\r\n            var test = false;\r\n            if (parseInt(v) >= 0 && parseInt(v) < 10) {\r\n                if (isBlank(this.values[this.index])) {\r\n                    this.values[this.index] = v;\r\n                    if (v > 1) {\r\n                        this.date[1] = this.values[this.index];\r\n                        this.index++;\r\n                    }\r\n                } else {\r\n                    if (this.values[this.index] == 1 && parseInt(v) < 3) {\r\n                        this.date[1] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    } else if (this.values[this.index] == 0 && parseInt(v) > 0) {\r\n                        this.date[1] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    } else {\r\n                        var test = true;\r\n                    }\r\n                }\r\n            } else {\r\n                var test = true;\r\n            }\r\n\r\n            // Re-test\r\n            if (test == true) {\r\n                var t = parseInt(this.values[this.index]);\r\n                if (t > 0 && t < 12) {\r\n                    this.date[2] = this.values[this.index];\r\n                    this.index++;\r\n                    // Repeat the character\r\n                    this.position--;\r\n                }\r\n            }\r\n        },\r\n        'D': function(v) {\r\n            var test = false;\r\n            if (parseInt(v) >= 0 && parseInt(v) < 10) {\r\n                if (isBlank(this.values[this.index])) {\r\n                    this.values[this.index] = v;\r\n                    if (parseInt(v) > 3) {\r\n                        this.date[2] = this.values[this.index];\r\n                        this.index++;\r\n                    }\r\n                } else {\r\n                    if (this.values[this.index] == 3 && parseInt(v) < 2) {\r\n                        this.date[2] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    } else if (this.values[this.index] == 1 || this.values[this.index] == 2) {\r\n                        this.date[2] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    } else if (this.values[this.index] == 0 && parseInt(v) > 0) {\r\n                        this.date[2] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    } else {\r\n                        var test = true;\r\n                    }\r\n                }\r\n            } else {\r\n                var test = true;\r\n            }\r\n\r\n            // Re-test\r\n            if (test == true) {\r\n                var t = parseInt(this.values[this.index]);\r\n                if (t > 0 && t < 32) {\r\n                    this.date[2] = this.values[this.index];\r\n                    this.index++;\r\n                    // Repeat the character\r\n                    this.position--;\r\n                }\r\n            }\r\n        },\r\n        'DD': function(v) {\r\n            if (isBlank(this.values[this.index])) {\r\n                if (parseInt(v) > 3 && parseInt(v) < 10) {\r\n                    this.date[2] = this.values[this.index] = '0' + v;\r\n                    this.index++;\r\n                } else if (parseInt(v) < 10) {\r\n                    this.values[this.index] = v;\r\n                }\r\n            } else {\r\n                if (this.values[this.index] == 3 && parseInt(v) < 2) {\r\n                    this.date[2] = this.values[this.index] += v;\r\n                    this.index++;\r\n                } else if ((this.values[this.index] == 1 || this.values[this.index] == 2) && parseInt(v) < 10) {\r\n                    this.date[2] = this.values[this.index] += v;\r\n                    this.index++;\r\n                } else if (this.values[this.index] == 0 && parseInt(v) > 0 && parseInt(v) < 10) {\r\n                    this.date[2] = this.values[this.index] += v;\r\n                    this.index++;\r\n                }\r\n            }\r\n        },\r\n        'DDD': function(v) {\r\n            parser.FIND.call(this, v, weekDays);\r\n        },\r\n        'DDDD': function(v) {\r\n            parser.FIND.call(this, v, weekDaysFull);\r\n        },\r\n        'HH12': function(v, two) {\r\n            if (isBlank(this.values[this.index])) {\r\n                if (parseInt(v) > 1 && parseInt(v) < 10) {\r\n                    if (two) {\r\n                        v = 0 + v;\r\n                    }\r\n                    this.date[3] = this.values[this.index] = v;\r\n                    this.index++;\r\n                } else if (parseInt(v) < 10) {\r\n                    this.values[this.index] = v;\r\n                }\r\n            } else {\r\n                if (this.values[this.index] == 1 && parseInt(v) < 3) {\r\n                    this.date[3] = this.values[this.index] += v;\r\n                    this.index++;\r\n                } else if (this.values[this.index] < 1 && parseInt(v) < 10) {\r\n                    this.date[3] = this.values[this.index] += v;\r\n                    this.index++;\r\n                }\r\n            }\r\n        },\r\n        'HH24': function(v, two) {\r\n            var test = false;\r\n            if (parseInt(v) >= 0 && parseInt(v) < 10) {\r\n                if (this.values[this.index] == null || this.values[this.index] == '') {\r\n                    if (parseInt(v) > 2 && parseInt(v) < 10) {\r\n                        if (two) {\r\n                            v = 0 + v;\r\n                        }\r\n                        this.date[3] = this.values[this.index] = v;\r\n                        this.index++;\r\n                    } else if (parseInt(v) < 10) {\r\n                        this.values[this.index] = v;\r\n                    }\r\n                } else {\r\n                    if (this.values[this.index] == 2 && parseInt(v) < 4) {\r\n                        this.date[3] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    } else if (this.values[this.index] < 2 && parseInt(v) < 10) {\r\n                        this.date[3] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        'HH': function(v) {\r\n            parser['HH24'].call(this, v, 1);\r\n        },\r\n        'H': function(v) {\r\n            parser['HH24'].call(this, v, 0);\r\n        },\r\n        '\\\\[H\\\\]': function(v) {\r\n            if (this.values[this.index] == undefined) {\r\n                this.values[this.index] = '';\r\n            }\r\n            if (v.match(/[0-9]/g)) {\r\n                this.date[3] = this.values[this.index] += v;\r\n            } else {\r\n                if (this.values[this.index].match(/[0-9]/g)) {\r\n                    this.date[3] = this.values[this.index];\r\n                    this.index++;\r\n                    // Repeat the character\r\n                    this.position--;\r\n                }\r\n            }\r\n        },\r\n        'N60': function(v, i) {\r\n            if (this.values[this.index] == null || this.values[this.index] == '') {\r\n                if (parseInt(v) > 5 && parseInt(v) < 10) {\r\n                    this.date[i] = this.values[this.index] = '0' + v;\r\n                    this.index++;\r\n                } else if (parseInt(v) < 10) {\r\n                    this.values[this.index] = v;\r\n                }\r\n            } else {\r\n                if (parseInt(v) < 10) {\r\n                    this.date[i] = this.values[this.index] += v;\r\n                    this.index++;\r\n                 }\r\n            }\r\n        },\r\n        'MI': function(v) {\r\n            parser.N60.call(this, v, 4);\r\n        },\r\n        'SS': function(v) {\r\n            parser.N60.call(this, v, 5);\r\n        },\r\n        'AM/PM': function(v) {\r\n            this.values[this.index] = '';\r\n            if (v) {\r\n                if (this.date[3] > 12) {\r\n                    this.values[this.index] = 'PM';\r\n                } else {\r\n                    this.values[this.index] = 'AM';\r\n                }\r\n            }\r\n            this.index++;\r\n        },\r\n        'WD': function(v) {\r\n            if (typeof(this.values[this.index]) === 'undefined') {\r\n                this.values[this.index] = '';\r\n            }\r\n            if (parseInt(v) >= 0 && parseInt(v) < 7) {\r\n                this.values[this.index] = v;\r\n            }\r\n            if (this.value[this.index].length == 1) {\r\n                this.index++;\r\n            }\r\n        },\r\n        '0{1}(.{1}0+)?': function(v) {\r\n            // Get decimal\r\n            var decimal = getDecimal.call(this);\r\n            // Negative number\r\n            var neg = false;\r\n            // Create if is blank\r\n            if (isBlank(this.values[this.index])) {\r\n                this.values[this.index] = '';\r\n            } else {\r\n                if (this.values[this.index] == '-') {\r\n                    neg = true;\r\n                }\r\n            }\r\n            var current = ParseValue.call(this, this.values[this.index], decimal);\r\n            if (current) {\r\n                this.values[this.index] = current.join(decimal);\r\n            }\r\n            // New entry\r\n            if (parseInt(v) >= 0 && parseInt(v) < 10) {\r\n                if (this.values[this.index] != '0' || v == decimal) {\r\n                    this.values[this.index] += v;\r\n                }\r\n            } else if (decimal && v == decimal) {\r\n                if (this.values[this.index].indexOf(decimal) == -1) {\r\n                    if (! this.values[this.index]) {\r\n                        this.values[this.index] = '0';\r\n                    }\r\n                    this.values[this.index] += v;\r\n                }\r\n            } else if (v == '-') {\r\n                // Negative signed\r\n                neg = true;\r\n            }\r\n\r\n            if (neg === true && this.values[this.index][0] !== '-') {\r\n                this.values[this.index] = '-' + this.values[this.index];\r\n            }\r\n        },\r\n        '0{1}(.{1}0+)?%': function(v) {\r\n            parser['0{1}(.{1}0+)?'].call(this, v);\r\n\r\n            if (this.values[this.index].match(/[\\-0-9]/g)) {\r\n                if (this.values[this.index] && this.values[this.index].indexOf('%') == -1) {\r\n                    this.values[this.index] += '%';\r\n                }\r\n            } else {\r\n                this.values[this.index] = '';\r\n            }\r\n        },\r\n        '#(.{1})##0?(.{1}0+)?( ?;(.*)?)?': function(v) {\r\n            // Parse number\r\n            parser['0{1}(.{1}0+)?'].call(this, v);\r\n            // Get decimal\r\n            var decimal = getDecimal.call(this);\r\n            // Get separator\r\n            var separator = this.tokens[this.index].substr(1,1);\r\n            // Negative\r\n            var negative = this.values[this.index][0] === '-' ? true : false;\r\n            // Current value\r\n            var current = ParseValue.call(this, this.values[this.index], decimal);\r\n\r\n            // Get main and decimal parts\r\n            if (current !== '') {\r\n                // Format number\r\n                var n = current[0].match(/[0-9]/g);\r\n                if (n) {\r\n                    // Format\r\n                    n = n.join('');\r\n                    var t = [];\r\n                    var s = 0;\r\n                    for (var j = n.length - 1; j >= 0 ; j--) {\r\n                        t.push(n[j]);\r\n                        s++;\r\n                        if (! (s % 3)) {\r\n                            t.push(separator);\r\n                        }\r\n                    }\r\n                    t = t.reverse();\r\n                    current[0] = t.join('');\r\n                    if (current[0].substr(0,1) == separator) {\r\n                        current[0] = current[0].substr(1);\r\n                    }\r\n                } else {\r\n                    current[0] = '';\r\n                }\r\n\r\n                // Value\r\n                this.values[this.index] = current.join(decimal);\r\n\r\n                // Negative\r\n                if (negative) {\r\n                    this.values[this.index] = '-' + this.values[this.index];\r\n                }\r\n            }\r\n        },\r\n        '0': function(v) {\r\n            if (v.match(/[0-9]/g)) {\r\n                this.values[this.index] = v;\r\n                this.index++;\r\n            }\r\n        },\r\n        '[0-9a-zA-Z$]+': function(v) {\r\n            if (isBlank(this.values[this.index])) {\r\n                this.values[this.index] = '';\r\n            }\r\n            var t = this.tokens[this.index];\r\n            var s = this.values[this.index];\r\n            var i = s.length;\r\n\r\n            if (t[i] == v) {\r\n                this.values[this.index] += v;\r\n\r\n                if (this.values[this.index] == t) {\r\n                    this.index++;\r\n                }\r\n            } else {\r\n                this.values[this.index] = t;\r\n                this.index++;\r\n\r\n                if (v.match(/[\\-0-9]/g)) {\r\n                    // Repeat the character\r\n                    this.position--;\r\n                }\r\n            }\r\n        },\r\n        'A': function(v) {\r\n            if (v.match(/[a-zA-Z]/gi)) {\r\n                this.values[this.index] = v;\r\n                this.index++;\r\n            }\r\n        },\r\n        '.': function(v) {\r\n            parser['[0-9a-zA-Z$]+'].call(this, v);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get the tokens in the mask string\r\n     */\r\n    var getTokens = function(str) {\r\n        if (this.type == 'general') {\r\n            var t = [].concat(tokens.general);\r\n        } else {\r\n            var t = [].concat(tokens.currency, tokens.datetime, tokens.percentage, tokens.numeric, tokens.general);\r\n        }\r\n        // Expression to extract all tokens from the string\r\n        var e = new RegExp(t.join('|'), 'gi');\r\n        // Extract\r\n        return str.match(e);\r\n    }\r\n\r\n    /**\r\n     * Get the method of one given token\r\n     */\r\n    var getMethod = function(str) {\r\n        if (! this.type) {\r\n            var types = Object.keys(tokens);\r\n        } else if (this.type == 'general') {\r\n            var types = [ 'general' ];\r\n        } else if (this.type == 'datetime') {\r\n            var types = [ 'numeric', 'datetime', 'general' ];\r\n        } else {\r\n            var types = [ 'currency', 'percentage', 'numeric', 'general' ];\r\n        }\r\n\r\n        // Found\r\n        for (var i = 0; i < types.length; i++) {\r\n            var type = types[i];\r\n            for (var j = 0; j < tokens[type].length; j++) {\r\n                var e = new RegExp(tokens[type][j], 'gi');\r\n                var r = str.match(e);\r\n                if (r) {\r\n                    return { type: type, method: tokens[type][j] }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Identify each method for each token\r\n     */\r\n    var getMethods = function(t) {\r\n        var result = [];\r\n        for (var i = 0; i < t.length; i++) {\r\n            var m = getMethod.call(this, t[i]);\r\n            if (m) {\r\n                result.push(m.method);\r\n            } else {\r\n                result.push(null);\r\n            }\r\n        }\r\n\r\n        // Compatibility with excel\r\n        for (var i = 0; i < result.length; i++) {\r\n            if (result[i] == 'MM') {\r\n                // Not a month, correct to minutes\r\n                if (result[i-1] && result[i-1].indexOf('H') >= 0) {\r\n                    result[i] = 'MI';\r\n                } else if (result[i-2] && result[i-2].indexOf('H') >= 0) {\r\n                    result[i] = 'MI';\r\n                } else if (result[i+1] && result[i+1].indexOf('S') >= 0) {\r\n                    result[i] = 'MI';\r\n                } else if (result[i+2] && result[i+2].indexOf('S') >= 0) {\r\n                    result[i] = 'MI';\r\n                }\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Get the type for one given token\r\n     */\r\n    var getType = function(str) {\r\n        var m = getMethod.call(this, str);\r\n        if (m) {\r\n            var type = m.type;\r\n        }\r\n\r\n        if (type) {\r\n            var numeric = 0;\r\n            // Make sure the correct type\r\n            var t = getTokens.call(this, str);\r\n            for (var i = 0; i < t.length; i++) {\r\n                m = getMethod.call(this, t[i]);\r\n                if (m && isNumeric(m.type)) {\r\n                    numeric++;\r\n                }\r\n            }\r\n            if (numeric > 1) {\r\n                type = 'general';\r\n            }\r\n        }\r\n\r\n        return type;\r\n    }\r\n\r\n    /**\r\n     * Parse character per character using the detected tokens in the mask\r\n     */\r\n    var parse = function() {\r\n        // Parser method for this position\r\n        if (typeof(parser[this.methods[this.index]]) == 'function') {\r\n            parser[this.methods[this.index]].call(this, this.value[this.position]);\r\n            this.position++;\r\n        } else {\r\n            this.values[this.index] = this.tokens[this.index];\r\n            this.index++;\r\n        }\r\n    }\r\n\r\n    var isFormula = function(value) {\r\n        var v = (''+value)[0];\r\n        return v == '=' ? true : false;\r\n    }\r\n\r\n    var toPlainString = function(num) {\r\n        return (''+ +num).replace(/(-?)(\\d*)\\.?(\\d*)e([+-]\\d+)/,\r\n          function(a,b,c,d,e) {\r\n            return e < 0\r\n              ? b + '0.' + Array(1-e-c.length).join(0) + c + d\r\n              : b + c + d + Array(e-d.length+1).join(0);\r\n          });\r\n    }\r\n\r\n    /**\r\n     * Mask function\r\n     * @param {mixed|string} JS input or a string to be parsed\r\n     * @param {object|string} When the first param is a string, the second is the mask or object with the mask options\r\n     */\r\n    var obj = function(e, config, returnObject) {\r\n        // Options\r\n        var r = null;\r\n        var t = null;\r\n        var o = {\r\n            // Element\r\n            input: null,\r\n            // Current value\r\n            value: null,\r\n            // Mask options\r\n            options: {},\r\n            // New values for each token found\r\n            values: [],\r\n            // Token position\r\n            index: 0,\r\n            // Character position\r\n            position: 0,\r\n            // Date raw values\r\n            date: [0,0,0,0,0,0],\r\n            // Raw number for the numeric values\r\n            number: 0,\r\n        }\r\n\r\n        // This is a JavaScript Event\r\n        if (typeof(e) == 'object') {\r\n            // Element\r\n            o.input = e.target;\r\n            // Current value\r\n            o.value = Value.call(e.target);\r\n            // Current caret position\r\n            o.caret = Caret.call(e.target);\r\n            // Mask\r\n            if (t = e.target.getAttribute('data-mask')) {\r\n                o.mask = t;\r\n            }\r\n            // Type\r\n            if (t = e.target.getAttribute('data-type')) {\r\n                o.type = t;\r\n            }\r\n            // Options\r\n            if (e.target.mask) {\r\n                if (e.target.mask.options) {\r\n                    o.options = e.target.mask.options;\r\n                }\r\n                if (e.target.mask.locale) {\r\n                    o.locale = e.target.mask.locale;\r\n                }\r\n            } else {\r\n                // Locale\r\n                if (t = e.target.getAttribute('data-locale')) {\r\n                    o.locale = t;\r\n                    if (o.mask) {\r\n                        o.options.style = o.mask;\r\n                    }\r\n                }\r\n            }\r\n            // Extra configuration\r\n            if (e.target.attributes && e.target.attributes.length) {\r\n                for (var i = 0; i < e.target.attributes.length; i++) {\r\n                    var k = e.target.attributes[i].name;\r\n                    var v = e.target.attributes[i].value;\r\n                    if (k.substr(0,4) == 'data') {\r\n                        o.options[k.substr(5)] = v;\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            // Options\r\n            if (typeof(config) == 'string') {\r\n                // Mask\r\n                o.mask = config;\r\n            } else {\r\n                // Mask\r\n                var k = Object.keys(config);\r\n                for (var i = 0; i < k.length; i++) {\r\n                    o[k[i]] = config[k[i]];\r\n                }\r\n            }\r\n\r\n            if (typeof(e) === 'number') {\r\n                // Get decimal\r\n                getDecimal.call(o, o.mask);\r\n                // Replace to the correct decimal\r\n                e = (''+e).replace('.', o.options.decimal);\r\n            }\r\n\r\n            // Current\r\n            o.value = e;\r\n\r\n            if (o.input) {\r\n                // Value\r\n                Value.call(o.input, e);\r\n                // Focus\r\n                jSuites.focus(o.input);\r\n                // Caret\r\n                o.caret = Caret.call(o.input);\r\n            }\r\n        }\r\n\r\n        // Mask detected start the process\r\n        if (! isFormula(o.value) && (o.mask || o.locale)) {\r\n            // Compatibility ixes\r\n            if (o.mask) {\r\n                // Legacy\r\n                o.mask = o.mask.replace('[-]', '');\r\n                // Excel mask TODO: Improve\r\n                if (o.mask.indexOf('##') !== -1) {\r\n                    var d = o.mask.split(';');\r\n                    if (d[0]) {\r\n                        d[0] = d[0].replace('*', '');\r\n                        d[0] = d[0].replace(/_/g, '');\r\n                        d[0] = d[0].replace(/-/g, '');\r\n                        d[0] = d[0].replace('(','');\r\n                        d[0] = d[0].replace(')','');\r\n                        d[0] = d[0].replace('##0.###','##0.000');\r\n                        d[0] = d[0].replace('##0.##','##0.00');\r\n                        d[0] = d[0].replace('##0.#','##0.0');\r\n                    }\r\n                    o.mask = d[0];\r\n                }\r\n                // Get type\r\n                if (! o.type) {\r\n                    o.type = getType.call(o, o.mask);\r\n                }\r\n                // Get tokens\r\n                o.tokens = getTokens.call(o, o.mask);\r\n            }\r\n            // On new input\r\n            if (typeof(e) !== 'object' || ! e.inputType || e.inputType == 'insertText' || e.inputType == 'insertFromPaste') {\r\n                // Start tranformation\r\n                if (o.locale) {\r\n                    if (o.input) {\r\n                        Format.call(o, o.input);\r\n                    } else {\r\n                        var newValue = FormatValue.call(o, o.value);\r\n                    }\r\n                } else {\r\n                    // Get tokens\r\n                    o.methods = getMethods.call(o, o.tokens);\r\n                    // Go through all tokes\r\n                    while (o.position < o.value.length && typeof(o.tokens[o.index]) !== 'undefined') {\r\n                        // Get the approate parser\r\n                        parse.call(o);\r\n                    }\r\n\r\n                    if (isNumeric(o.type)) {\r\n                        // Complement things in the end of the mask\r\n                        while (typeof(o.tokens[o.index]) !== 'undefined') {\r\n                            var t = getMethod.call(o, o.tokens[o.index]);\r\n                            if (t && t.type == 'general') {\r\n                                o.values[o.index] = o.tokens[o.index];\r\n                            }\r\n                            o.index++;\r\n                        }\r\n\r\n                        var adjustNumeric = true;\r\n                    } else {\r\n                        var adjustNumeric = false;\r\n                    }\r\n\r\n                    // New value\r\n                    var newValue = o.values.join('');\r\n\r\n                    // Reset value\r\n                    if (o.input) {\r\n                        t = newValue.length - o.value.length;\r\n                        if (t > 0) {\r\n                            var caret = o.caret + t;\r\n                        } else {\r\n                            var caret = o.caret;\r\n                        }\r\n                        Value.call(o.input, newValue, caret, adjustNumeric);\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Update raw data\r\n            if (o.input) {\r\n                var label = null;\r\n                if (isNumeric(o.type)) {\r\n                    // Extract the number\r\n                    o.number = Extract.call(o, Value.call(o.input));\r\n                    // Keep the raw data as a property of the tag\r\n                    if (o.type == 'percentage') {\r\n                        label = o.number / 100;\r\n                    } else {\r\n                        label = o.number;\r\n                    }\r\n                } else if (o.type == 'datetime') {\r\n                    label = getDate.call(o);\r\n\r\n                    if (o.date[0] && o.date[1] && o.date[2]) {\r\n                        o.input.setAttribute('data-completed', true);\r\n                    }\r\n                }\r\n\r\n                if (label) {\r\n                    o.input.setAttribute('data-value', label);\r\n                }\r\n            }\r\n\r\n            if (newValue !== undefined) {\r\n                if (returnObject) {\r\n                    return o;\r\n                } else {\r\n                    return newValue;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Extract the tokens from a mask\r\n    obj.prepare = function(str, o) {\r\n        if (! o) {\r\n            o = {};\r\n        }\r\n        return getTokens.call(o, str);\r\n    }\r\n\r\n    /**\r\n     * Apply the mask to a element (legacy)\r\n     */\r\n    obj.apply = function(e) {\r\n        var v = Value.call(e.target);\r\n        if (e.key.length == 1) {\r\n            v += e.key;\r\n        }\r\n        Value.call(e.target, obj(v, e.target.getAttribute('data-mask')));\r\n    }\r\n\r\n    /**\r\n     * Legacy support\r\n     */\r\n    obj.run = function(value, mask, decimal) {\r\n        return obj(value, { mask: mask, decimal: decimal });\r\n    }\r\n\r\n    /**\r\n     * Extract number from masked string\r\n     */\r\n    obj.extract = function(v, options, returnObject) {\r\n        if (isBlank(v)) {\r\n            return v;\r\n        }\r\n        if (typeof(options) != 'object') {\r\n            return value;\r\n        } else {\r\n            if (! options.options) {\r\n                options.options = {};\r\n            }\r\n        }\r\n\r\n        // Compatibility\r\n        if (! options.mask && options.format) {\r\n            options.mask = options.format;\r\n        }\r\n\r\n        // Get decimal\r\n        getDecimal.call(options, options.mask);\r\n\r\n        var type = null;\r\n        if (options.type == 'percent' || options.options.style == 'percent') {\r\n            type = 'percentage';\r\n        } else if (options.mask) {\r\n            type = getType.call(options, options.mask);\r\n        }\r\n\r\n\r\n        if (type === 'datetime') {\r\n            if (v instanceof Date) {\r\n                var t = jSuites.calendar.getDateString(value, options.mask);\r\n            }\r\n\r\n            var o = obj(v, options, true);\r\n            var value = getDate.call(o);\r\n            if ((o.date[0] && o.date[1] && o.date[2]) && ! (o.date[3] || o.date[4] || o.date[5])) {\r\n                var t = jSuites.calendar.now(o.date);\r\n                value = jSuites.calendar.dateToNum(t);\r\n            }\r\n        } else {\r\n            var value = Extract.call(options, v);\r\n            // Percentage\r\n            if (type == 'percentage') {\r\n                value /= 100;\r\n            }\r\n            var o = options;\r\n        }\r\n\r\n        o.value = value;\r\n\r\n        if (returnObject) {\r\n            return o;\r\n        } else {\r\n            return value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Render\r\n     */\r\n    obj.render = function(value, options, fullMask) {\r\n        if (isBlank(value)) {\r\n            return value;\r\n        }\r\n\r\n        if (typeof(options) != 'object') {\r\n            return value;\r\n        } else {\r\n            if (! options.options) {\r\n                options.options = {};\r\n            }\r\n        }\r\n\r\n        // Compatibility\r\n        if (! options.mask && options.format) {\r\n            options.mask = options.format;\r\n        }\r\n\r\n        var type = null;\r\n        if (options.type == 'percent' || options.options.style == 'percent') {\r\n            type = 'percentage';\r\n        } else if (options.mask) {\r\n            type = getType.call(options, options.mask);\r\n        } else if (value instanceof Date) {\r\n            type = 'datetime';\r\n        }\r\n\r\n        // Fill with blanks\r\n        var fillWithBlanks = false;\r\n\r\n        if (type =='datetime' || options.type == 'calendar') {\r\n            var t = jSuites.calendar.getDateString(value, options.mask);\r\n            if (t) {\r\n                value = t;\r\n            }\r\n\r\n            if (options.mask && fullMask) {\r\n                fillWithBlanks = true;\r\n            }\r\n        } else {\r\n            // Percentage\r\n            if (type == 'percentage') {\r\n                value *= 100;\r\n            }\r\n            // Number of decimal places\r\n            if (typeof(value) === 'number') {\r\n                var t = null;\r\n                if (options.mask && fullMask) {\r\n                    var e = new RegExp('0{1}(.{1})0+', 'ig');\r\n                    var d = options.mask.match(e);\r\n                    if (d && d[0]) {\r\n                        d = d[0].length - 2;\r\n                        t = value.toFixed(d);\r\n                    } else {\r\n                        t = value.toFixed(0);\r\n                    }\r\n                } else if (options.locale && fullMask) {\r\n                    // Append zeros \r\n                    var d = (''+value).split('.');\r\n                    if (options.options) {\r\n                        if (typeof(d[1]) === 'undefined') {\r\n                            d[1] = '';\r\n                        }\r\n                        var len = d[1].length;\r\n                        if (options.options.minimumFractionDigits > len) {\r\n                            for (var i = 0; i < options.options.minimumFractionDigits - len; i++) {\r\n                                d[1] += '0';\r\n                            }\r\n                        }\r\n                    }\r\n                    if (! d[1].length) {\r\n                        t = d[0]\r\n                    } else {\r\n                        t = d.join('.');\r\n                    }\r\n                    var len = d[1].length;\r\n                    if (options.options && options.options.maximumFractionDigits < len) {\r\n                        t = parseFloat(t).toFixed(options.options.maximumFractionDigits);\r\n                    }\r\n                } else {\r\n                    t = toPlainString(value);\r\n                }\r\n\r\n                if (t !== null) {\r\n                    value = t;\r\n                    // Get decimal\r\n                    getDecimal.call(options, options.mask);\r\n                    // Replace to the correct decimal\r\n                    if (options.options.decimal) {\r\n                        value = value.replace('.', options.options.decimal);\r\n                    }\r\n                }\r\n            } else {\r\n                if (options.mask && fullMask) {\r\n                    fillWithBlanks = true;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (fillWithBlanks) {\r\n            var s = options.mask.length - value.length;\r\n            if (s > 0) {\r\n                for (var i = 0; i < s; i++) {\r\n                    value += ' ';\r\n                }\r\n            }\r\n        }\r\n\r\n        value = obj(value, options);\r\n\r\n        return value;\r\n    }\r\n\r\n    obj.set = function(e, m) {\r\n        if (m) {\r\n            e.setAttribute('data-mask', m);\r\n            // Reset the value\r\n            var event = new Event('input', {\r\n                bubbles: true,\r\n                cancelable: true,\r\n            });\r\n            e.dispatchEvent(event);\r\n        }\r\n    }\r\n\r\n    if (typeof document !== 'undefined') {\r\n        document.addEventListener('input', function(e) {\r\n            if (e.target.getAttribute('data-mask') || e.target.mask) {\r\n                obj(e);\r\n            }\r\n        });\r\n    }\r\n\r\n    return obj;\r\n})();\r\n\r\njSuites.modal = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        url: null,\r\n        onopen: null,\r\n        onclose: null,\r\n        closed: false,\r\n        width: null,\r\n        height: null,\r\n        title: null,\r\n        padding: null,\r\n        backdrop: true,\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Title\r\n    if (! obj.options.title && el.getAttribute('title')) {\r\n        obj.options.title = el.getAttribute('title');\r\n    }\r\n\r\n    var temp = document.createElement('div');\r\n    while (el.children[0]) {\r\n        temp.appendChild(el.children[0]);\r\n    }\r\n\r\n    obj.content = document.createElement('div');\r\n    obj.content.className = 'jmodal_content';\r\n    obj.content.innerHTML = el.innerHTML;\r\n\r\n    while (temp.children[0]) {\r\n        obj.content.appendChild(temp.children[0]);\r\n    }\r\n\r\n    obj.container = document.createElement('div');\r\n    obj.container.className = 'jmodal';\r\n    obj.container.appendChild(obj.content);\r\n\r\n    if (obj.options.padding) {\r\n        obj.content.style.padding = obj.options.padding;\r\n    }\r\n    if (obj.options.width) {\r\n        obj.container.style.width = obj.options.width;\r\n    }\r\n    if (obj.options.height) {\r\n        obj.container.style.height = obj.options.height;\r\n    }\r\n    if (obj.options.title) {\r\n        obj.container.setAttribute('title', obj.options.title);\r\n    } else {\r\n        obj.container.classList.add('no-title');\r\n    }\r\n    el.innerHTML = '';\r\n    el.style.display = 'none';\r\n    el.appendChild(obj.container);\r\n\r\n    // Backdrop\r\n    if (obj.options.backdrop) {\r\n        var backdrop = document.createElement('div');\r\n        backdrop.className = 'jmodal_backdrop';\r\n        backdrop.onclick = function () {\r\n            obj.close();\r\n        }\r\n        el.appendChild(backdrop);\r\n    }\r\n\r\n    obj.open = function() {\r\n        el.style.display = 'block';\r\n        // Fullscreen\r\n        var rect = obj.container.getBoundingClientRect();\r\n        if (jSuites.getWindowWidth() < rect.width) {\r\n            obj.container.style.top = '';\r\n            obj.container.style.left = '';\r\n            obj.container.classList.add('jmodal_fullscreen');\r\n            jSuites.animation.slideBottom(obj.container, 1);\r\n        } else {\r\n            if (obj.options.backdrop) {\r\n                backdrop.style.display = 'block';\r\n            }\r\n        }\r\n        // Event\r\n        if (typeof(obj.options.onopen) == 'function') {\r\n            obj.options.onopen(el, obj);\r\n        }\r\n    }\r\n\r\n    obj.resetPosition = function() {\r\n        obj.container.style.top = '';\r\n        obj.container.style.left = '';\r\n    }\r\n\r\n    obj.isOpen = function() {\r\n        return el.style.display != 'none' ? true : false;\r\n    }\r\n\r\n    obj.close = function() {\r\n        el.style.display = 'none';\r\n        if (obj.options.backdrop) {\r\n            // Backdrop\r\n            backdrop.style.display = '';\r\n        }\r\n        // Remove fullscreen class\r\n        obj.container.classList.remove('jmodal_fullscreen');\r\n        // Event\r\n        if (typeof(obj.options.onclose) == 'function') {\r\n            obj.options.onclose(el, obj);\r\n        }\r\n    }\r\n\r\n    if (! jSuites.modal.hasEvents) {\r\n        //  Position\r\n        var tracker = null;\r\n\r\n        document.addEventListener('keydown', function(e) {\r\n            if (e.which == 27) {\r\n                var modals = document.querySelectorAll('.jmodal');\r\n                for (var i = 0; i < modals.length; i++) {\r\n                    modals[i].parentNode.modal.close();\r\n                }\r\n            }\r\n        });\r\n\r\n        document.addEventListener('mouseup', function(e) {\r\n            if (tracker) {\r\n                tracker.element.style.cursor = 'auto';\r\n                tracker = null;\r\n            }\r\n        });\r\n\r\n        document.addEventListener('mousedown', function(e) {\r\n            var item = jSuites.findElement(e.target, 'jmodal');\r\n            if (item) {\r\n                // Get target info\r\n                var rect = item.getBoundingClientRect();\r\n\r\n                if (e.changedTouches && e.changedTouches[0]) {\r\n                    var x = e.changedTouches[0].clientX;\r\n                    var y = e.changedTouches[0].clientY;\r\n                } else {\r\n                    var x = e.clientX;\r\n                    var y = e.clientY;\r\n                }\r\n\r\n                if (rect.width - (x - rect.left) < 50 && (y - rect.top) < 50) {\r\n                    item.parentNode.modal.close();\r\n                } else {\r\n                    if (e.target.getAttribute('title') && (y - rect.top) < 50) {\r\n                        if (document.selection) {\r\n                            document.selection.empty();\r\n                        } else if ( window.getSelection ) {\r\n                            window.getSelection().removeAllRanges();\r\n                        }\r\n\r\n                        tracker = {\r\n                            left: rect.left,\r\n                            top: rect.top,\r\n                            x: e.clientX,\r\n                            y: e.clientY,\r\n                            width: rect.width,\r\n                            height: rect.height,\r\n                            element: item,\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        document.addEventListener('mousemove', function(e) {\r\n            if (tracker) {\r\n                e = e || window.event;\r\n                if (e.buttons) {\r\n                    var mouseButton = e.buttons;\r\n                } else if (e.button) {\r\n                    var mouseButton = e.button;\r\n                } else {\r\n                    var mouseButton = e.which;\r\n                }\r\n\r\n                if (mouseButton) {\r\n                    tracker.element.style.top = (tracker.top + (e.clientY - tracker.y) + (tracker.height / 2)) + 'px';\r\n                    tracker.element.style.left = (tracker.left + (e.clientX - tracker.x) + (tracker.width / 2)) + 'px';\r\n                    tracker.element.style.cursor = 'move';\r\n                } else {\r\n                    tracker.element.style.cursor = 'auto';\r\n                }\r\n            }\r\n        });\r\n\r\n        jSuites.modal.hasEvents = true;\r\n    }\r\n\r\n    if (obj.options.url) {\r\n        jSuites.ajax({\r\n            url: obj.options.url,\r\n            method: 'GET',\r\n            dataType: 'text/html',\r\n            success: function(data) {\r\n                obj.content.innerHTML = data;\r\n\r\n                if (! obj.options.closed) {\r\n                    obj.open();\r\n                }\r\n            }\r\n        });\r\n    } else {\r\n        if (! obj.options.closed) {\r\n            obj.open();\r\n        }\r\n    }\r\n\r\n    // Keep object available from the node\r\n    el.modal = obj;\r\n\r\n    return obj;\r\n});\r\n\r\n\r\njSuites.notification = (function(options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        icon: null,\r\n        name: 'Notification',\r\n        date: null,\r\n        error: null,\r\n        title: null,\r\n        message: null,\r\n        timeout: 4000,\r\n        autoHide: true,\r\n        closeable: true,\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    var notification = document.createElement('div');\r\n    notification.className = 'jnotification';\r\n\r\n    if (obj.options.error) {\r\n        notification.classList.add('jnotification-error');\r\n    }\r\n\r\n    var notificationContainer = document.createElement('div');\r\n    notificationContainer.className = 'jnotification-container';\r\n    notification.appendChild(notificationContainer);\r\n\r\n    var notificationHeader = document.createElement('div');\r\n    notificationHeader.className = 'jnotification-header';\r\n    notificationContainer.appendChild(notificationHeader);\r\n\r\n    var notificationImage = document.createElement('div');\r\n    notificationImage.className = 'jnotification-image';\r\n    notificationHeader.appendChild(notificationImage);\r\n\r\n    if (obj.options.icon) {\r\n        var notificationIcon = document.createElement('img');\r\n        notificationIcon.src = obj.options.icon;\r\n        notificationImage.appendChild(notificationIcon);\r\n    }\r\n\r\n    var notificationName = document.createElement('div');\r\n    notificationName.className = 'jnotification-name';\r\n    notificationName.innerHTML = obj.options.name;\r\n    notificationHeader.appendChild(notificationName);\r\n\r\n    if (obj.options.closeable == true) {\r\n        var notificationClose = document.createElement('div');\r\n        notificationClose.className = 'jnotification-close';\r\n        notificationClose.onclick = function() {\r\n            obj.hide();\r\n        }\r\n        notificationHeader.appendChild(notificationClose);\r\n    }\r\n\r\n    var notificationDate = document.createElement('div');\r\n    notificationDate.className = 'jnotification-date';\r\n    notificationHeader.appendChild(notificationDate);\r\n\r\n    var notificationContent = document.createElement('div');\r\n    notificationContent.className = 'jnotification-content';\r\n    notificationContainer.appendChild(notificationContent);\r\n\r\n    if (obj.options.title) {\r\n        var notificationTitle = document.createElement('div');\r\n        notificationTitle.className = 'jnotification-title';\r\n        notificationTitle.innerHTML = obj.options.title;\r\n        notificationContent.appendChild(notificationTitle);\r\n    }\r\n\r\n    var notificationMessage = document.createElement('div');\r\n    notificationMessage.className = 'jnotification-message';\r\n    notificationMessage.innerHTML = obj.options.message;\r\n    notificationContent.appendChild(notificationMessage);\r\n\r\n    obj.show = function() {\r\n        document.body.appendChild(notification);\r\n        if (jSuites.getWindowWidth() > 800) { \r\n            jSuites.animation.fadeIn(notification);\r\n        } else {\r\n            jSuites.animation.slideTop(notification, 1);\r\n        }\r\n    }\r\n\r\n    obj.hide = function() {\r\n        if (jSuites.getWindowWidth() > 800) { \r\n            jSuites.animation.fadeOut(notification, function() {\r\n                if (notification.parentNode) {\r\n                    notification.parentNode.removeChild(notification);\r\n                    if (notificationTimeout) {\r\n                        clearTimeout(notificationTimeout);\r\n                    }\r\n                }\r\n            });\r\n        } else {\r\n            jSuites.animation.slideTop(notification, 0, function() {\r\n                if (notification.parentNode) {\r\n                    notification.parentNode.removeChild(notification);\r\n                    if (notificationTimeout) {\r\n                        clearTimeout(notificationTimeout);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    obj.show();\r\n\r\n    if (obj.options.autoHide == true) {\r\n        var notificationTimeout = setTimeout(function() {\r\n            obj.hide();\r\n        }, obj.options.timeout);\r\n    }\r\n\r\n    if (jSuites.getWindowWidth() < 800) {\r\n        notification.addEventListener(\"swipeup\", function(e) {\r\n            obj.hide();\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        });\r\n    }\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.notification.isVisible = function() {\r\n    var j = document.querySelector('.jnotification');\r\n    return j && j.parentNode ? true : false;\r\n}\r\n\r\n// More palettes https://coolors.co/ or https://gka.github.io/palettes/#/10|s|003790,005647,ffffe0|ffffe0,ff005e,93003a|1|1\r\njSuites.palette = function(o, v) {\r\n    var palette = {\r\n        material: [\r\n            [ \"#ffebee\", \"#fce4ec\", \"#f3e5f5\", \"#e8eaf6\", \"#e3f2fd\", \"#e0f7fa\", \"#e0f2f1\", \"#e8f5e9\", \"#f1f8e9\", \"#f9fbe7\", \"#fffde7\", \"#fff8e1\", \"#fff3e0\", \"#fbe9e7\", \"#efebe9\", \"#fafafa\", \"#eceff1\" ],\r\n            [ \"#ffcdd2\", \"#f8bbd0\", \"#e1bee7\", \"#c5cae9\", \"#bbdefb\", \"#b2ebf2\", \"#b2dfdb\", \"#c8e6c9\", \"#dcedc8\", \"#f0f4c3\", \"#fff9c4\", \"#ffecb3\", \"#ffe0b2\", \"#ffccbc\", \"#d7ccc8\", \"#f5f5f5\", \"#cfd8dc\" ],\r\n            [ \"#ef9a9a\", \"#f48fb1\", \"#ce93d8\", \"#9fa8da\", \"#90caf9\", \"#80deea\", \"#80cbc4\", \"#a5d6a7\", \"#c5e1a5\", \"#e6ee9c\", \"#fff59d\", \"#ffe082\", \"#ffcc80\", \"#ffab91\", \"#bcaaa4\", \"#eeeeee\", \"#b0bec5\" ],\r\n            [ \"#e57373\", \"#f06292\", \"#ba68c8\", \"#7986cb\", \"#64b5f6\", \"#4dd0e1\", \"#4db6ac\", \"#81c784\", \"#aed581\", \"#dce775\", \"#fff176\", \"#ffd54f\", \"#ffb74d\", \"#ff8a65\", \"#a1887f\", \"#e0e0e0\", \"#90a4ae\" ],\r\n            [ \"#ef5350\", \"#ec407a\", \"#ab47bc\", \"#5c6bc0\", \"#42a5f5\", \"#26c6da\", \"#26a69a\", \"#66bb6a\", \"#9ccc65\", \"#d4e157\", \"#ffee58\", \"#ffca28\", \"#ffa726\", \"#ff7043\", \"#8d6e63\", \"#bdbdbd\", \"#78909c\" ],\r\n            [ \"#f44336\", \"#e91e63\", \"#9c27b0\", \"#3f51b5\", \"#2196f3\", \"#00bcd4\", \"#009688\", \"#4caf50\", \"#8bc34a\", \"#cddc39\", \"#ffeb3b\", \"#ffc107\", \"#ff9800\", \"#ff5722\", \"#795548\", \"#9e9e9e\", \"#607d8b\" ],\r\n            [ \"#e53935\", \"#d81b60\", \"#8e24aa\", \"#3949ab\", \"#1e88e5\", \"#00acc1\", \"#00897b\", \"#43a047\", \"#7cb342\", \"#c0ca33\", \"#fdd835\", \"#ffb300\", \"#fb8c00\", \"#f4511e\", \"#6d4c41\", \"#757575\", \"#546e7a\" ],\r\n            [ \"#d32f2f\", \"#c2185b\", \"#7b1fa2\", \"#303f9f\", \"#1976d2\", \"#0097a7\", \"#00796b\", \"#388e3c\", \"#689f38\", \"#afb42b\", \"#fbc02d\", \"#ffa000\", \"#f57c00\", \"#e64a19\", \"#5d4037\", \"#616161\", \"#455a64\" ],\r\n            [ \"#c62828\", \"#ad1457\", \"#6a1b9a\", \"#283593\", \"#1565c0\", \"#00838f\", \"#00695c\", \"#2e7d32\", \"#558b2f\", \"#9e9d24\", \"#f9a825\", \"#ff8f00\", \"#ef6c00\", \"#d84315\", \"#4e342e\", \"#424242\", \"#37474f\" ],\r\n            [ \"#b71c1c\", \"#880e4f\", \"#4a148c\", \"#1a237e\", \"#0d47a1\", \"#006064\", \"#004d40\", \"#1b5e20\", \"#33691e\", \"#827717\", \"#f57f17\", \"#ff6f00\", \"#e65100\", \"#bf360c\", \"#3e2723\", \"#212121\", \"#263238\" ],\r\n        ],\r\n        fire: [\r\n            [\"0b1a6d\",\"840f38\",\"b60718\",\"de030b\",\"ff0c0c\",\"fd491c\",\"fc7521\",\"faa331\",\"fbb535\",\"ffc73a\"],\r\n            [\"071147\",\"5f0b28\",\"930513\",\"be0309\",\"ef0000\",\"fa3403\",\"fb670b\",\"f9991b\",\"faad1e\",\"ffc123\"],\r\n            [\"03071e\",\"370617\",\"6a040f\",\"9d0208\",\"d00000\",\"dc2f02\",\"e85d04\",\"f48c06\",\"faa307\",\"ffba08\"],\r\n            [\"020619\",\"320615\",\"61040d\",\"8c0207\",\"bc0000\",\"c82a02\",\"d05203\",\"db7f06\",\"e19405\",\"efab00\"],\r\n            [\"020515\",\"2d0513\",\"58040c\",\"7f0206\",\"aa0000\",\"b62602\",\"b94903\",\"c57205\",\"ca8504\",\"d89b00\"],\r\n        ],\r\n        baby: [\r\n            [\"eddcd2\",\"fff1e6\",\"fde2e4\",\"fad2e1\",\"c5dedd\",\"dbe7e4\",\"f0efeb\",\"d6e2e9\",\"bcd4e6\",\"99c1de\"],\r\n            [\"e1c4b3\",\"ffd5b5\",\"fab6ba\",\"f5a8c4\",\"aacecd\",\"bfd5cf\",\"dbd9d0\",\"baceda\",\"9dc0db\",\"7eb1d5\"],\r\n            [\"daa990\",\"ffb787\",\"f88e95\",\"f282a9\",\"8fc4c3\",\"a3c8be\",\"cec9b3\",\"9dbcce\",\"82acd2\",\"649dcb\"],\r\n            [\"d69070\",\"ff9c5e\",\"f66770\",\"f05f8f\",\"74bbb9\",\"87bfae\",\"c5b993\",\"83aac3\",\"699bca\",\"4d89c2\"],\r\n            [\"c97d5d\",\"f58443\",\"eb4d57\",\"e54a7b\",\"66a9a7\",\"78ae9c\",\"b5a67e\",\"7599b1\",\"5c88b7\",\"4978aa\"],\r\n        ],\r\n        chart: [\r\n            ['#C1D37F','#4C5454','#FFD275','#66586F','#D05D5B','#C96480','#95BF8F','#6EA240','#0F0F0E','#EB8258','#95A3B3','#995D81'],\r\n        ],\r\n    }\r\n\r\n    // Is defined, set new palette value\r\n    if (typeof(v) !== 'undefined') {\r\n        palette[o] = v;\r\n    }\r\n\r\n    // Otherwise get palette value\r\n    if (palette[o]) {\r\n        return palette[o];\r\n    } else {\r\n        return palette.material;\r\n    }\r\n}\r\n\r\n\r\njSuites.picker = (function(el, options) {\r\n    // Already created, update options\r\n    if (el.picker) {\r\n        return el.picker.setOptions(options, true);\r\n    }\r\n\r\n    // New instance\r\n    var obj = { type: 'picker' };\r\n    obj.options = {};\r\n\r\n    var dropdownHeader = null;\r\n    var dropdownContent = null;\r\n\r\n    /**\r\n     * Create the content options\r\n     */\r\n    var createContent = function() {\r\n        dropdownContent.innerHTML = '';\r\n\r\n        // Create items\r\n        var keys = Object.keys(obj.options.data);\r\n\r\n        // Go though all options\r\n        for (var i = 0; i < keys.length; i++) {\r\n            // Item\r\n            var dropdownItem = document.createElement('div');\r\n            dropdownItem.classList.add('jpicker-item');\r\n            dropdownItem.k = keys[i];\r\n            dropdownItem.v = obj.options.data[keys[i]];\r\n            // Label\r\n            dropdownItem.innerHTML = obj.getLabel(keys[i]);\r\n            // Append\r\n            dropdownContent.appendChild(dropdownItem);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set or reset the options for the picker\r\n     */\r\n    obj.setOptions = function(options, reset) {\r\n        // Default configuration\r\n        var defaults = {\r\n            value: 0,\r\n            data: null,\r\n            render: null,\r\n            onchange: null,\r\n            onselect: null,\r\n            onopen: null,\r\n            onclose: null,\r\n            onload: null,\r\n            width: null,\r\n            header: true,\r\n            right: false,\r\n            content: false,\r\n            columns: null,\r\n            height: null,\r\n        }\r\n\r\n        // Legacy purpose only\r\n        if (options && options.options) {\r\n            options.data = options.options;\r\n        }\r\n\r\n        // Loop through the initial configuration\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else {\r\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\r\n                    obj.options[property] = defaults[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Start using the options\r\n        if (obj.options.header === false) {\r\n            dropdownHeader.style.display = 'none';\r\n        } else {\r\n            dropdownHeader.style.display = '';\r\n        }\r\n\r\n        // Width\r\n        if (obj.options.width) {\r\n            dropdownHeader.style.width = parseInt(obj.options.width) + 'px';\r\n        } else {\r\n            dropdownHeader.style.width = '';\r\n        }\r\n\r\n        // Height\r\n        if (obj.options.height) {\r\n            dropdownContent.style.maxHeight = obj.options.height + 'px';\r\n            dropdownContent.style.overflow = 'scroll';\r\n        } else {\r\n            dropdownContent.style.overflow = '';\r\n        }\r\n\r\n        if (obj.options.columns > 0) {\r\n            dropdownContent.classList.add('jpicker-columns');\r\n            dropdownContent.style.width =  obj.options.width ? obj.options.width : 36 * obj.options.columns + 'px';\r\n        }\r\n\r\n        if (isNaN(obj.options.value)) {\r\n            obj.options.value = '0';\r\n        }\r\n\r\n        // Create list from data\r\n        createContent();\r\n\r\n        // Set value\r\n        obj.setValue(obj.options.value);\r\n\r\n        // Set options all returns the own instance\r\n        return obj;\r\n    }\r\n\r\n    obj.getValue = function() {\r\n        return obj.options.value;\r\n    }\r\n\r\n    obj.setValue = function(v) {\r\n        // Set label\r\n        obj.setLabel(v);\r\n\r\n        // Update value\r\n        obj.options.value = String(v);\r\n\r\n        // Lemonade JS\r\n        if (el.value != obj.options.value) {\r\n            el.value = obj.options.value;\r\n            if (typeof(el.onchange) == 'function') {\r\n                el.onchange({\r\n                    type: 'change',\r\n                    target: el,\r\n                    value: el.value\r\n                });\r\n            }\r\n        }\r\n\r\n        if (dropdownContent.children[v].getAttribute('type') !== 'generic') {\r\n            obj.close();\r\n        }\r\n    }\r\n\r\n    obj.getLabel = function(v) {\r\n        var label = obj.options.data[v] || null;\r\n        if (typeof(obj.options.render) == 'function') {\r\n            label = obj.options.render(label);\r\n        }\r\n        return label;\r\n    }\r\n\r\n    obj.setLabel = function(v) {\r\n        if (obj.options.content) {\r\n            var label = '<i class=\"material-icons\">' + obj.options.content + '</i>';\r\n        } else {\r\n            var label = obj.getLabel(v);\r\n        }\r\n\r\n        dropdownHeader.innerHTML = label;\r\n    }\r\n\r\n    obj.open = function() {\r\n        if (! el.classList.contains('jpicker-focus')) {\r\n            // Start tracking the element\r\n            jSuites.tracking(obj, true);\r\n\r\n            // Open picker\r\n            el.classList.add('jpicker-focus');\r\n            el.focus();\r\n\r\n            var rectHeader = dropdownHeader.getBoundingClientRect();\r\n            var rectContent = dropdownContent.getBoundingClientRect();\r\n            if (window.innerHeight < rectHeader.bottom + rectContent.height) {\r\n                dropdownContent.style.marginTop = -1 * (rectContent.height + 4) + 'px';\r\n            } else {\r\n                dropdownContent.style.marginTop = rectHeader.height + 2 + 'px';\r\n            }\r\n\r\n            if (obj.options.right === true) {\r\n                dropdownContent.style.marginLeft = -1 * rectContent.width + 24 + 'px';\r\n            }\r\n\r\n            if (typeof obj.options.onopen == 'function') {\r\n                obj.options.onopen(el, obj);\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.close = function() {\r\n        if (el.classList.contains('jpicker-focus')) {\r\n            el.classList.remove('jpicker-focus');\r\n\r\n            // Start tracking the element\r\n            jSuites.tracking(obj, false);\r\n\r\n            if (typeof obj.options.onclose == 'function') {\r\n                obj.options.onclose(el, obj);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Create floating picker\r\n     */\r\n    var init = function() {\r\n        // Class\r\n        el.classList.add('jpicker');\r\n        el.setAttribute('tabindex', '900');\r\n        el.onmousedown = function(e) {\r\n            if (! el.classList.contains('jpicker-focus')) {\r\n                obj.open();\r\n            }\r\n        }\r\n\r\n        // Dropdown Header\r\n        dropdownHeader = document.createElement('div');\r\n        dropdownHeader.classList.add('jpicker-header');\r\n\r\n        // Dropdown content\r\n        dropdownContent = document.createElement('div');\r\n        dropdownContent.classList.add('jpicker-content');\r\n        dropdownContent.onclick = function(e) {\r\n            var item = jSuites.findElement(e.target, 'jpicker-item');\r\n            if (item) {\r\n                if (item.parentNode === dropdownContent) {\r\n                    // Update label\r\n                    obj.setValue(item.k);\r\n                    // Call method\r\n                    if (typeof(obj.options.onchange) == 'function') {\r\n                        obj.options.onchange.call(obj, el, obj, item.v, item.v, item.k);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Append content and header\r\n        el.appendChild(dropdownHeader);\r\n        el.appendChild(dropdownContent);\r\n\r\n        // Default value\r\n        el.value = options.value || 0;\r\n\r\n        // Set options\r\n        obj.setOptions(options);\r\n\r\n        if (typeof(obj.options.onload) == 'function') {\r\n            obj.options.onload(el, obj);\r\n        }\r\n\r\n        // Change\r\n        el.change = obj.setValue;\r\n\r\n        // Global generic value handler\r\n        el.val = function(val) {\r\n            if (val === undefined) {\r\n                return obj.getValue();\r\n            } else {\r\n                obj.setValue(val);\r\n            }\r\n        }\r\n\r\n        // Reference\r\n        el.picker = obj;\r\n    }\r\n\r\n    init();\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.progressbar = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        value: 0,\r\n        onchange: null,\r\n        width: null,\r\n    };\r\n\r\n    // Loop through the initial configuration\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Class\r\n    el.classList.add('jprogressbar');\r\n    el.setAttribute('tabindex', 1);\r\n    el.setAttribute('data-value', obj.options.value);\r\n\r\n    var bar = document.createElement('div');\r\n    bar.style.width = obj.options.value + '%';\r\n    bar.style.color = '#fff';\r\n    el.appendChild(bar);\r\n\r\n    if (obj.options.width) {\r\n        el.style.width = obj.options.width;\r\n    }\r\n\r\n    // Set value\r\n    obj.setValue = function(value) {\r\n        value = parseInt(value);\r\n        obj.options.value = value;\r\n        bar.style.width = value + '%';\r\n        el.setAttribute('data-value', value + '%');\r\n\r\n        if (value < 6) {\r\n            el.style.color = '#000';\r\n        } else {\r\n            el.style.color = '#fff';\r\n        }\r\n\r\n        // Update value\r\n        obj.options.value = value;\r\n\r\n        if (typeof(obj.options.onchange) == 'function') {\r\n            obj.options.onchange(el, value);\r\n        }\r\n\r\n        // Lemonade JS\r\n        if (el.value != obj.options.value) {\r\n            el.value = obj.options.value;\r\n            if (typeof(el.onchange) == 'function') {\r\n                el.onchange({\r\n                    type: 'change',\r\n                    target: el,\r\n                    value: el.value\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.getValue = function() {\r\n        return obj.options.value;\r\n    }\r\n\r\n    var action = function(e) {\r\n        if (e.which) {\r\n            // Get target info\r\n            var rect = el.getBoundingClientRect();\r\n\r\n            if (e.changedTouches && e.changedTouches[0]) {\r\n                var x = e.changedTouches[0].clientX;\r\n                var y = e.changedTouches[0].clientY;\r\n            } else {\r\n                var x = e.clientX;\r\n                var y = e.clientY;\r\n            }\r\n\r\n            obj.setValue(Math.round((x - rect.left) / rect.width * 100));\r\n        }\r\n    }\r\n\r\n    // Events\r\n    if ('touchstart' in document.documentElement === true) {\r\n        el.addEventListener('touchstart', action);\r\n        el.addEventListener('touchend', action);\r\n    } else {\r\n        el.addEventListener('mousedown', action);\r\n        el.addEventListener(\"mousemove\", action);\r\n    }\r\n\r\n    // Change\r\n    el.change = obj.setValue;\r\n\r\n    // Global generic value handler\r\n    el.val = function(val) {\r\n        if (val === undefined) {\r\n            return obj.getValue();\r\n        } else {\r\n            obj.setValue(val);\r\n        }\r\n    }\r\n\r\n    // Reference\r\n    el.progressbar = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.rating = (function(el, options) {\r\n    // Already created, update options\r\n    if (el.rating) {\r\n        return el.rating.setOptions(options, true);\r\n    }\r\n\r\n    // New instance\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    obj.setOptions = function(options, reset) {\r\n        // Default configuration\r\n        var defaults = {\r\n            number: 5,\r\n            value: 0,\r\n            tooltip: [ 'Very bad', 'Bad', 'Average', 'Good', 'Very good' ],\r\n            onchange: null,\r\n        };\r\n\r\n        // Loop through the initial configuration\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else {\r\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\r\n                    obj.options[property] = defaults[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Make sure the container is empty\r\n        el.innerHTML = '';\r\n\r\n        // Add elements\r\n        for (var i = 0; i < obj.options.number; i++) {\r\n            var div = document.createElement('div');\r\n            div.setAttribute('data-index', (i + 1))\r\n            div.setAttribute('title', obj.options.tooltip[i])\r\n            el.appendChild(div);\r\n        }\r\n\r\n        // Selected option\r\n        if (obj.options.value) {\r\n            for (var i = 0; i < obj.options.number; i++) {\r\n                if (i < obj.options.value) {\r\n                    el.children[i].classList.add('jrating-selected');\r\n                }\r\n            }\r\n        }\r\n\r\n        return obj;\r\n    }\r\n\r\n    // Set value\r\n    obj.setValue = function(index) {\r\n        for (var i = 0; i < obj.options.number; i++) {\r\n            if (i < index) {\r\n                el.children[i].classList.add('jrating-selected');\r\n            } else {\r\n                el.children[i].classList.remove('jrating-over');\r\n                el.children[i].classList.remove('jrating-selected');\r\n            }\r\n        }\r\n\r\n        obj.options.value = index;\r\n\r\n        if (typeof(obj.options.onchange) == 'function') {\r\n            obj.options.onchange(el, index);\r\n        }\r\n\r\n        // Lemonade JS\r\n        if (el.value != obj.options.value) {\r\n            el.value = obj.options.value;\r\n            if (typeof(el.onchange) == 'function') {\r\n                el.onchange({\r\n                    type: 'change',\r\n                    target: el,\r\n                    value: el.value\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.getValue = function() {\r\n        return obj.options.value;\r\n    }\r\n\r\n    var init = function() {\r\n        // Start plugin\r\n        obj.setOptions(options);\r\n\r\n        // Class\r\n        el.classList.add('jrating');\r\n\r\n        // Events\r\n        el.addEventListener(\"click\", function(e) {\r\n            var index = e.target.getAttribute('data-index');\r\n            if (index != undefined) {\r\n                if (index == obj.options.value) {\r\n                    obj.setValue(0);\r\n                } else {\r\n                    obj.setValue(index);\r\n                }\r\n            }\r\n        });\r\n\r\n        el.addEventListener(\"mouseover\", function(e) {\r\n            var index = e.target.getAttribute('data-index');\r\n            for (var i = 0; i < obj.options.number; i++) {\r\n                if (i < index) {\r\n                    el.children[i].classList.add('jrating-over');\r\n                } else {\r\n                    el.children[i].classList.remove('jrating-over');\r\n                }\r\n            }\r\n        });\r\n\r\n        el.addEventListener(\"mouseout\", function(e) {\r\n            for (var i = 0; i < obj.options.number; i++) {\r\n                el.children[i].classList.remove('jrating-over');\r\n            }\r\n        });\r\n\r\n        // Change\r\n        el.change = obj.setValue;\r\n\r\n        // Global generic value handler\r\n        el.val = function(val) {\r\n            if (val === undefined) {\r\n                return obj.getValue();\r\n            } else {\r\n                obj.setValue(val);\r\n            }\r\n        }\r\n\r\n        // Reference\r\n        el.rating = obj;\r\n    }\r\n\r\n    init();\r\n\r\n    return obj;\r\n});\r\n\r\n\r\njSuites.search = (function(el, options) {\r\n    if (el.search) {\r\n        return el.search;\r\n    }\r\n\r\n    var index =  null;\r\n\r\n    var select = function(e) {\r\n        if (e.target.classList.contains('jsearch_item')) {\r\n            var element = e.target;\r\n        } else {\r\n            var element = e.target.parentNode;\r\n        }\r\n\r\n        obj.selectIndex(element);\r\n        e.preventDefault();\r\n    }\r\n\r\n    var createList = function(data) {\r\n        // Reset container\r\n        container.innerHTML = '';\r\n        // Print results\r\n        if (! data.length) {\r\n            // Show container\r\n            el.style.display = '';\r\n        } else {\r\n            // Show container\r\n            el.style.display = 'block';\r\n\r\n            // Show items (only 10)\r\n            var len = data.length < 11 ? data.length : 10;\r\n            for (var i = 0; i < len; i++) {\r\n                if (typeof(data[i]) == 'string') {\r\n                    var text = data[i];\r\n                    var value = data[i];\r\n                } else {\r\n                    // Legacy\r\n                    var text = data[i].text;\r\n                    if (! text && data[i].name) {\r\n                        text = data[i].name;\r\n                    }\r\n                    var value = data[i].value;\r\n                    if (! value && data[i].id) {\r\n                        value = data[i].id;\r\n                    }\r\n                }\r\n\r\n                var div = document.createElement('div');\r\n                div.setAttribute('data-value', value);\r\n                div.setAttribute('data-text', text);\r\n                div.className = 'jsearch_item';\r\n\r\n                if (data[i].id) {\r\n                    div.setAttribute('id', data[i].id)\r\n                }\r\n\r\n                if (obj.options.forceSelect && i == 0) {\r\n                    div.classList.add('selected');\r\n                }\r\n                var img = document.createElement('img');\r\n                if (data[i].image) {\r\n                    img.src = data[i].image;\r\n                } else {\r\n                    img.style.display = 'none';\r\n                }\r\n                div.appendChild(img);\r\n\r\n                var item = document.createElement('div');\r\n                item.innerHTML = text;\r\n                div.appendChild(item);\r\n\r\n                // Append item to the container\r\n                container.appendChild(div);\r\n            }\r\n        }\r\n    }\r\n\r\n    var execute = function(str) {\r\n        if (str != obj.terms) {\r\n            // New terms\r\n            obj.terms = str;\r\n            // New index\r\n            if (obj.options.forceSelect) {\r\n                index = 0;\r\n            } else {\r\n                index = null;\r\n            }\r\n            // Array or remote search\r\n            if (Array.isArray(obj.options.data)) {\r\n                var test = function(o) {\r\n                    if (typeof(o) == 'string') {\r\n                        if ((''+o).toLowerCase().search(str.toLowerCase()) >= 0) {\r\n                            return true;\r\n                        }\r\n                    } else {\r\n                        for (var key in o) {\r\n                            var value = o[key];\r\n                            if ((''+value).toLowerCase().search(str.toLowerCase()) >= 0) {\r\n                                return true;\r\n                            }\r\n                        }\r\n                    }\r\n                    return false;\r\n                }\r\n\r\n                var results = obj.options.data.filter(function(item) {\r\n                    return test(item);\r\n                });\r\n\r\n                // Show items\r\n                createList(results);\r\n            } else {\r\n                // Get remove results\r\n                jSuites.ajax({\r\n                    url: obj.options.data + str,\r\n                    method: 'GET',\r\n                    dataType: 'json',\r\n                    success: function(data) {\r\n                        // Show items\r\n                        createList(data);\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    // Search timer\r\n    var timer = null;\r\n\r\n    // Search methods\r\n    var obj = function(str) {\r\n        if (timer) {\r\n            clearTimeout(timer);\r\n        }\r\n        timer = setTimeout(function() {\r\n            execute(str);\r\n        }, 500);\r\n    }\r\n    if(options.forceSelect === null) {\r\n        options.forceSelect = true;\r\n    }\r\n    obj.options = {\r\n        data: options.data || null,\r\n        input: options.input || null,\r\n        onselect: options.onselect || null,\r\n        forceSelect: options.forceSelect,\r\n    };\r\n\r\n    obj.selectIndex = function(item) {\r\n        var id = item.getAttribute('id');\r\n        var text = item.getAttribute('data-text');\r\n        var value = item.getAttribute('data-value');\r\n        // Onselect\r\n        if (typeof(obj.options.onselect) == 'function') {\r\n            obj.options.onselect(obj, text, value, id);\r\n        }\r\n        // Close container\r\n        obj.close();\r\n    }\r\n\r\n    obj.open = function() {\r\n        el.style.display = 'block';\r\n    }\r\n\r\n    obj.close = function() {\r\n        if (timer) {\r\n            clearTimeout(timer);\r\n        }\r\n        // Current terms\r\n        obj.terms = '';\r\n        // Remove results\r\n        container.innerHTML = '';\r\n        // Hide\r\n        el.style.display = '';\r\n    }\r\n\r\n    obj.isOpened = function() {\r\n        return el.style.display ? true : false;\r\n    }\r\n\r\n    obj.keydown = function(e) {\r\n        if (obj.isOpened()) {\r\n            if (e.key == 'Enter') {\r\n                // Enter\r\n                if (index!==null && container.children[index]) {\r\n                    obj.selectIndex(container.children[index]);\r\n                    e.preventDefault();\r\n                } else {\r\n                    obj.close();\r\n                }\r\n            } else if (e.key === 'ArrowUp') {\r\n                // Up\r\n                if (index!==null && container.children[0]) {\r\n                    container.children[index].classList.remove('selected');\r\n                    if(!obj.options.forceSelect && index === 0) {\r\n                        index = null;\r\n                    } else {\r\n                        index = Math.max(0, index-1);\r\n                        container.children[index].classList.add('selected');\r\n                    }\r\n                }\r\n                e.preventDefault();\r\n            } else if (e.key === 'ArrowDown') {\r\n                // Down\r\n                if(index == null) {\r\n                    index = -1;\r\n                } else {\r\n                    container.children[index].classList.remove('selected');\r\n                }\r\n                if (index < 9 && container.children[index+1]) {\r\n                    index++;\r\n                }\r\n                container.children[index].classList.add('selected');\r\n                e.preventDefault();\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.keyup = function(e) {\r\n        if (obj.options.input) {\r\n            obj(obj.options.input.value);\r\n        } else {\r\n            // Current node\r\n            var node = jSuites.getNode();\r\n            if (node) {\r\n                obj(node.innerText);\r\n            }\r\n        }\r\n    }\r\n    \r\n    // Add events\r\n    if (obj.options.input) {\r\n        obj.options.input.addEventListener(\"keyup\", obj.keyup);\r\n        obj.options.input.addEventListener(\"keydown\", obj.keydown);\r\n    }\r\n\r\n    // Append element\r\n    var container = document.createElement('div');\r\n    container.classList.add('jsearch_container');\r\n    container.onmousedown = select;\r\n    el.appendChild(container);\r\n\r\n    el.classList.add('jsearch');\r\n    el.search = obj;\r\n\r\n    return obj;\r\n});\r\n\r\n\r\njSuites.slider = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n    obj.currentImage = null;\r\n\r\n    if (options) {\r\n        obj.options = options;\r\n    }\r\n\r\n    // Focus\r\n    el.setAttribute('tabindex', '900')\r\n\r\n    // Items\r\n    obj.options.items = [];\r\n\r\n    if (! el.classList.contains('jslider')) {\r\n        el.classList.add('jslider');\r\n        el.classList.add('unselectable');\r\n\r\n        if (obj.options.height) {\r\n            el.style.minHeight = obj.options.height;\r\n        }\r\n        if (obj.options.width) {\r\n            el.style.width = obj.options.width;\r\n        }\r\n        if (obj.options.grid) {\r\n            el.classList.add('jslider-grid');\r\n            var number = el.children.length;\r\n            if (number > 4) {\r\n                el.setAttribute('data-total', number - 4);\r\n            }\r\n            el.setAttribute('data-number', (number > 4 ? 4 : number));\r\n        }\r\n\r\n        // Add slider counter\r\n        var counter = document.createElement('div');\r\n        counter.classList.add('jslider-counter');\r\n\r\n        // Move children inside\r\n        if (el.children.length > 0) {\r\n            // Keep children items\r\n            for (var i = 0; i < el.children.length; i++) {\r\n                obj.options.items.push(el.children[i]);\r\n                \r\n                // counter click event\r\n                var item = document.createElement('div');\r\n                item.onclick = function() {\r\n                    var index = Array.prototype.slice.call(counter.children).indexOf(this);\r\n                    obj.show(obj.currentImage = obj.options.items[index]);\r\n                }\r\n                counter.appendChild(item);\r\n            }\r\n        }\r\n        // Add caption\r\n        var caption = document.createElement('div');\r\n        caption.className = 'jslider-caption';\r\n\r\n        // Add close buttom\r\n        var controls = document.createElement('div');\r\n        var close = document.createElement('div');\r\n        close.className = 'jslider-close';\r\n        close.innerHTML = '';\r\n        \r\n        close.onclick = function() {\r\n            obj.close();\r\n        }\r\n        controls.appendChild(caption);\r\n        controls.appendChild(close);\r\n    }\r\n\r\n    obj.updateCounter = function(index) {\r\n        for (var i = 0; i < counter.children.length; i ++) {\r\n            if (counter.children[i].classList.contains('jslider-counter-focus')) {\r\n                counter.children[i].classList.remove('jslider-counter-focus');\r\n                break;\r\n            }\r\n        }\r\n        counter.children[index].classList.add('jslider-counter-focus');\r\n    }\r\n\r\n    obj.show = function(target) {\r\n        if (! target) {\r\n            var target = el.children[0];\r\n        }\r\n\r\n        // Focus element\r\n        el.classList.add('jslider-focus');\r\n        el.classList.remove('jslider-grid');\r\n        el.appendChild(controls);\r\n        el.appendChild(counter);\r\n\r\n        // Update counter\r\n        var index = obj.options.items.indexOf(target);\r\n        obj.updateCounter(index);\r\n\r\n        // Remove display\r\n        for (var i = 0; i < el.children.length; i++) {\r\n            el.children[i].style.display = '';\r\n        }\r\n        target.style.display = 'block';\r\n\r\n        // Is there any previous\r\n        if (target.previousElementSibling) {\r\n            el.classList.add('jslider-left');\r\n        } else {\r\n            el.classList.remove('jslider-left');\r\n        }\r\n\r\n        // Is there any next\r\n        if (target.nextElementSibling && target.nextElementSibling.tagName == 'IMG') {\r\n            el.classList.add('jslider-right');\r\n        } else {\r\n            el.classList.remove('jslider-right');\r\n        }\r\n\r\n        obj.currentImage = target;\r\n\r\n        // Vertical image\r\n        if (obj.currentImage.offsetHeight > obj.currentImage.offsetWidth) {\r\n            obj.currentImage.classList.add('jslider-vertical');\r\n        }\r\n\r\n        controls.children[0].innerText = obj.currentImage.getAttribute('title');\r\n    }\r\n\r\n    obj.open = function() {\r\n        obj.show();\r\n\r\n        // Event\r\n        if (typeof(obj.options.onopen) == 'function') {\r\n            obj.options.onopen(el);\r\n        }\r\n    }\r\n\r\n    obj.close = function() {\r\n        // Remove control classes\r\n        el.classList.remove('jslider-focus');\r\n        el.classList.remove('jslider-left');\r\n        el.classList.remove('jslider-right');\r\n        // Show as a grid depending on the configuration\r\n        if (obj.options.grid) {\r\n            el.classList.add('jslider-grid');\r\n        }\r\n        // Remove display\r\n        for (var i = 0; i < el.children.length; i++) {\r\n            el.children[i].style.display = '';\r\n        }\r\n        // Remove controls from the component\r\n        counter.remove();\r\n        controls.remove();\r\n        // Current image\r\n        obj.currentImage = null;\r\n        // Event\r\n        if (typeof(obj.options.onclose) == 'function') {\r\n            obj.options.onclose(el);\r\n        }\r\n    }\r\n\r\n    obj.reset = function() {\r\n        el.innerHTML = '';\r\n    }\r\n\r\n    obj.next = function() {\r\n        var nextImage = obj.currentImage.nextElementSibling;\r\n        if (nextImage && nextImage.tagName === 'IMG') {\r\n            obj.show(obj.currentImage.nextElementSibling);\r\n        }\r\n    }\r\n    \r\n    obj.prev = function() {\r\n        if (obj.currentImage.previousElementSibling) {\r\n            obj.show(obj.currentImage.previousElementSibling);\r\n        }\r\n    }\r\n\r\n    var mouseUp = function(e) {\r\n        // Open slider\r\n        if (e.target.tagName == 'IMG') {\r\n            obj.show(e.target);\r\n        } else if (! e.target.classList.contains('jslider-close') && ! (e.target.parentNode.classList.contains('jslider-counter') || e.target.classList.contains('jslider-counter'))){\r\n            // Arrow controls\r\n            var offsetX = e.offsetX || e.changedTouches[0].clientX;\r\n            if (e.target.clientWidth - offsetX < 40) {\r\n                // Show next image\r\n                obj.next();\r\n            } else if (offsetX < 40) {\r\n                // Show previous image\r\n                obj.prev();\r\n            }\r\n        }\r\n    }\r\n\r\n    if ('ontouchend' in document.documentElement === true) {\r\n        el.addEventListener('touchend', mouseUp);\r\n    } else {\r\n        el.addEventListener('mouseup', mouseUp);\r\n    }\r\n\r\n    // Add global events\r\n    el.addEventListener(\"swipeleft\", function(e) {\r\n        obj.next();\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n    });\r\n\r\n    el.addEventListener(\"swiperight\", function(e) {\r\n        obj.prev();\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n    });\r\n\r\n    el.addEventListener('keydown', function(e) {\r\n        if (e.which == 27) {\r\n            obj.close();\r\n        }\r\n    });\r\n\r\n    el.slider = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.sorting = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    var defaults = {\r\n        pointer: null,\r\n        direction: null,\r\n        ondragstart: null,\r\n        ondragend: null,\r\n        ondrop: null,\r\n    }\r\n\r\n    var dragElement = null;\r\n\r\n    // Loop through the initial configuration\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    el.classList.add('jsorting');\r\n\r\n    el.addEventListener('dragstart', function(e) {\r\n        var position = Array.prototype.indexOf.call(e.target.parentNode.children, e.target);\r\n        dragElement = {\r\n            element: e.target,\r\n            o: position,\r\n            d: position\r\n        }\r\n        e.target.style.opacity = '0.25';\r\n\r\n        if (typeof(obj.options.ondragstart) == 'function') {\r\n            obj.options.ondragstart(el, e.target, e);\r\n        }\r\n    });\r\n\r\n    el.addEventListener('dragover', function(e) {\r\n        e.preventDefault();\r\n\r\n        if (getElement(e.target) && dragElement) {\r\n            if (e.target.getAttribute('draggable') == 'true' && dragElement.element != e.target) {\r\n                if (! obj.options.direction) {\r\n                    var condition = e.target.clientHeight / 2 > e.offsetY;\r\n                } else {\r\n                    var condition = e.target.clientWidth / 2 > e.offsetX;\r\n                }\r\n\r\n                if (condition) {\r\n                    e.target.parentNode.insertBefore(dragElement.element, e.target);\r\n                } else {\r\n                    e.target.parentNode.insertBefore(dragElement.element, e.target.nextSibling);\r\n                }\r\n\r\n                dragElement.d = Array.prototype.indexOf.call(e.target.parentNode.children, dragElement.element);\r\n            }\r\n        }\r\n    });\r\n\r\n    el.addEventListener('dragleave', function(e) {\r\n        e.preventDefault();\r\n    });\r\n\r\n    el.addEventListener('dragend', function(e) {\r\n        e.preventDefault();\r\n\r\n        if (dragElement) {\r\n            if (typeof(obj.options.ondragend) == 'function') {\r\n                obj.options.ondragend(el, dragElement.element, e);\r\n            }\r\n\r\n            // Cancelled put element to the original position\r\n            if (dragElement.o < dragElement.d) {\r\n                e.target.parentNode.insertBefore(dragElement.element, e.target.parentNode.children[dragElement.o]);\r\n            } else {\r\n                e.target.parentNode.insertBefore(dragElement.element, e.target.parentNode.children[dragElement.o].nextSibling);\r\n            }\r\n\r\n            dragElement.element.style.opacity = '';\r\n            dragElement = null;\r\n        }\r\n    });\r\n\r\n    el.addEventListener('drop', function(e) {\r\n        e.preventDefault();\r\n\r\n        if (dragElement && (dragElement.o != dragElement.d)) {\r\n            if (typeof(obj.options.ondrop) == 'function') {\r\n                obj.options.ondrop(el, dragElement.o, dragElement.d, dragElement.element, e.target, e);\r\n            }\r\n        }\r\n\r\n        dragElement.element.style.opacity = '';\r\n        dragElement = null;\r\n    });\r\n\r\n    var getElement = function(element) {\r\n        var sorting = false;\r\n\r\n        function path (element) {\r\n            if (element.className) {\r\n                if (element.classList.contains('jsorting')) {\r\n                    sorting = true;\r\n                }\r\n            }\r\n\r\n            if (! sorting) {\r\n                path(element.parentNode);\r\n            }\r\n        }\r\n\r\n        path(element);\r\n\r\n        return sorting;\r\n    }\r\n\r\n    for (var i = 0; i < el.children.length; i++) {\r\n        if (! el.children[i].hasAttribute('draggable')) {\r\n            el.children[i].setAttribute('draggable', 'true');\r\n        }\r\n    }\r\n\r\n    el.val = function() {\r\n        var id = null;\r\n        var data = [];\r\n        for (var i = 0; i < el.children.length; i++) {\r\n            if (id = el.children[i].getAttribute('data-id')) {\r\n                data.push(id);\r\n            }\r\n        }\r\n        return data;\r\n    }\r\n\r\n    return el;\r\n});\r\n\r\njSuites.tabs = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        data: [],\r\n        position: null,\r\n        allowCreate: false,\r\n        allowChangePosition: false,\r\n        onclick: null,\r\n        onload: null,\r\n        onchange: null,\r\n        oncreate: null,\r\n        ondelete: null,\r\n        onbeforecreate: null,\r\n        onchangeposition: null,\r\n        animation: false,\r\n        hideHeaders: false,\r\n        padding: null,\r\n        palette: null,\r\n        maxWidth: null,\r\n    }\r\n\r\n    // Loop through the initial configuration\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Class\r\n    el.classList.add('jtabs');\r\n\r\n    var prev = null;\r\n    var next = null;\r\n    var border = null;\r\n\r\n    // Helpers\r\n    var setBorder = function(index) {\r\n        if (obj.options.animation) {\r\n            var rect = obj.headers.children[index].getBoundingClientRect();\r\n\r\n            if (obj.options.palette == 'modern') {\r\n                border.style.width = rect.width - 4 + 'px';\r\n                border.style.left = obj.headers.children[index].offsetLeft + 2 + 'px';\r\n            } else {\r\n                border.style.width = rect.width + 'px';\r\n                border.style.left = obj.headers.children[index].offsetLeft + 'px';\r\n            }\r\n\r\n            if (obj.options.position == 'bottom') {\r\n                border.style.top = '0px';\r\n            } else {\r\n                border.style.bottom = '0px';\r\n            }\r\n        }\r\n    }\r\n\r\n    var updateControls = function(x) {\r\n        if (typeof(obj.headers.scrollTo) == 'function') {\r\n            obj.headers.scrollTo({\r\n                left: x,\r\n                behavior: 'smooth',\r\n            });\r\n        } else {\r\n            obj.headers.scrollLeft = x;\r\n        }\r\n\r\n        if (x <= 1) {\r\n            prev.classList.add('disabled');\r\n        } else {\r\n            prev.classList.remove('disabled');\r\n        }\r\n\r\n        if (x >= obj.headers.scrollWidth - obj.headers.offsetWidth) {\r\n            next.classList.add('disabled');\r\n        } else {\r\n            next.classList.remove('disabled');\r\n        }\r\n\r\n        if (obj.headers.scrollWidth <= obj.headers.offsetWidth) {\r\n            prev.style.display = 'none';\r\n            next.style.display = 'none';\r\n        } else {\r\n            prev.style.display = '';\r\n            next.style.display = '';\r\n        }\r\n    }\r\n\r\n    obj.setBorder = setBorder;\r\n\r\n    // Set value\r\n    obj.open = function(index) {\r\n        var previous = null;\r\n        for (var i = 0; i < obj.headers.children.length; i++) {\r\n            if (obj.headers.children[i].classList.contains('jtabs-selected')) {\r\n                // Current one\r\n                previous = i;\r\n            }\r\n            // Remote selected\r\n            obj.headers.children[i].classList.remove('jtabs-selected');\r\n            if (obj.content.children[i]) {\r\n                obj.content.children[i].classList.remove('jtabs-selected');\r\n            }\r\n        }\r\n\r\n        obj.headers.children[index].classList.add('jtabs-selected');\r\n        if (obj.content.children[index]) {\r\n            obj.content.children[index].classList.add('jtabs-selected');\r\n        }\r\n\r\n        if (previous != index && typeof(obj.options.onchange) == 'function') {\r\n            if (obj.content.children[index]) {\r\n                obj.options.onchange(el, obj, index, obj.headers.children[index], obj.content.children[index]);\r\n            }\r\n        }\r\n\r\n        // Hide\r\n        if (obj.options.hideHeaders == true && (obj.headers.children.length < 3 && obj.options.allowCreate == false)) {\r\n            obj.headers.parentNode.style.display = 'none';\r\n        } else {\r\n            // Set border\r\n            setBorder(index);\r\n\r\n            obj.headers.parentNode.style.display = '';\r\n\r\n            var x1 = obj.headers.children[index].offsetLeft;\r\n            var x2 = x1 + obj.headers.children[index].offsetWidth;\r\n            var r1 = obj.headers.scrollLeft;\r\n            var r2 = r1 + obj.headers.offsetWidth;\r\n\r\n            if (! (r1 <= x1 && r2 >= x2)) {\r\n                // Out of the viewport\r\n                updateControls(x1 - 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.selectIndex = function(a) {\r\n        var index = Array.prototype.indexOf.call(obj.headers.children, a);\r\n        if (index >= 0) {\r\n            obj.open(index);\r\n        }\r\n\r\n        return index;\r\n    }\r\n\r\n    obj.rename = function(i, title) {\r\n        if (! title) {\r\n            title = prompt('New title', obj.headers.children[i].innerText);\r\n        }\r\n        obj.headers.children[i].innerText = title;\r\n        obj.open(i);\r\n    }\r\n\r\n    obj.create = function(title, url) {\r\n        if (typeof(obj.options.onbeforecreate) == 'function') {\r\n            var ret = obj.options.onbeforecreate(el);\r\n            if (ret === false) {\r\n                return false;\r\n            } else {\r\n                title = ret;\r\n            }\r\n        }\r\n\r\n        var div = obj.appendElement(title);\r\n\r\n        if (typeof(obj.options.oncreate) == 'function') {\r\n            obj.options.oncreate(el, div)\r\n        }\r\n\r\n        return div;\r\n    }\r\n\r\n    obj.remove = function(index) {\r\n        return obj.deleteElement(index);\r\n    }\r\n\r\n    obj.nextNumber = function() {\r\n        var num = 0;\r\n        for (var i = 0; i < obj.headers.children.length; i++) {\r\n            var tmp = obj.headers.children[i].innerText.match(/[0-9].*/);\r\n            if (tmp > num) {\r\n                num = parseInt(tmp);\r\n            }\r\n        }\r\n        if (! num) {\r\n            num = 1;\r\n        } else {\r\n            num++;\r\n        }\r\n\r\n        return num;\r\n    }\r\n\r\n    obj.deleteElement = function(index) {\r\n        if (! obj.headers.children[index]) {\r\n            return false;\r\n        } else {\r\n            obj.headers.removeChild(obj.headers.children[index]);\r\n            obj.content.removeChild(obj.content.children[index]);\r\n        }\r\n\r\n        obj.open(0);\r\n\r\n        if (typeof(obj.options.ondelete) == 'function') {\r\n            obj.options.ondelete(el, index)\r\n        }\r\n    }\r\n\r\n    obj.appendElement = function(title, cb) {\r\n        if (! title) {\r\n            var title = prompt('Title?', '');\r\n        }\r\n\r\n        if (title) {\r\n            // Add content\r\n            var div = document.createElement('div');\r\n            obj.content.appendChild(div);\r\n\r\n            // Add headers\r\n            var h = document.createElement('div');\r\n            h.innerHTML = title;\r\n            h.content = div;\r\n            obj.headers.insertBefore(h, obj.headers.lastChild);\r\n\r\n            // Sortable\r\n            if (obj.options.allowChangePosition) {\r\n                h.setAttribute('draggable', 'true');\r\n            }\r\n            // Open new tab\r\n            obj.selectIndex(h);\r\n\r\n            // Callback\r\n            if (typeof(cb) == 'function') {\r\n                cb(div, h);\r\n            }\r\n\r\n            // Return element\r\n            return div;\r\n        }\r\n    }\r\n\r\n    obj.getActive = function() {\r\n        for (var i = 0; i < obj.headers.children.length; i++) {\r\n            if (obj.headers.children[i].classList.contains('jtabs-selected')) {\r\n                return i\r\n            }\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    obj.updateContent = function(position, newContent) {\r\n        if (typeof newContent !== 'string') {\r\n            var contentItem = newContent;\r\n        } else {\r\n            var contentItem = document.createElement('div');\r\n            contentItem.innerHTML = newContent;\r\n        }\r\n\r\n        if (obj.content.children[position].classList.contains('jtabs-selected')) {\r\n            newContent.classList.add('jtabs-selected');\r\n        }\r\n\r\n        obj.content.replaceChild(newContent, obj.content.children[position]);\r\n    }\r\n\r\n    obj.updatePosition = function(f, t) {\r\n        // Ondrop update position of content\r\n        if (f > t) {\r\n            obj.content.insertBefore(obj.content.children[f], obj.content.children[t]);\r\n        } else {\r\n            obj.content.insertBefore(obj.content.children[f], obj.content.children[t].nextSibling);\r\n        }\r\n\r\n        // Open destination tab\r\n        obj.open(t);\r\n\r\n        // Call event\r\n        if (typeof(obj.options.onchangeposition) == 'function') {\r\n            obj.options.onchangeposition(obj.headers, f, t);\r\n        }\r\n    }\r\n\r\n    obj.move = function(f, t) {\r\n        if (f > t) {\r\n            obj.headers.insertBefore(obj.headers.children[f], obj.headers.children[t]);\r\n        } else {\r\n            obj.headers.insertBefore(obj.headers.children[f], obj.headers.children[t].nextSibling);\r\n        }\r\n\r\n        obj.updatePosition(f, t);\r\n    }\r\n\r\n    obj.setBorder = setBorder;\r\n\r\n    obj.init = function() {\r\n        el.innerHTML = '';\r\n\r\n        // Make sure the component is blank\r\n        obj.headers = document.createElement('div');\r\n        obj.content = document.createElement('div');\r\n        obj.headers.classList.add('jtabs-headers');\r\n        obj.content.classList.add('jtabs-content');\r\n\r\n        if (obj.options.palette) {\r\n            el.classList.add('jtabs-modern');\r\n        } else {\r\n            el.classList.remove('jtabs-modern');\r\n        }\r\n\r\n        // Padding\r\n        if (obj.options.padding) {\r\n            obj.content.style.padding = parseInt(obj.options.padding) + 'px';\r\n        }\r\n\r\n        // Header\r\n        var header = document.createElement('div');\r\n        header.className = 'jtabs-headers-container';\r\n        header.appendChild(obj.headers);\r\n        if (obj.options.maxWidth) {\r\n            header.style.maxWidth = parseInt(obj.options.maxWidth) + 'px';\r\n        }\r\n\r\n        // Controls\r\n        var controls = document.createElement('div');\r\n        controls.className = 'jtabs-controls';\r\n        controls.setAttribute('draggable', 'false');\r\n        header.appendChild(controls);\r\n\r\n        // Append DOM elements\r\n        if (obj.options.position == 'bottom') {\r\n            el.appendChild(obj.content);\r\n            el.appendChild(header);\r\n        } else {\r\n            el.appendChild(header);\r\n            el.appendChild(obj.content);\r\n        }\r\n\r\n        // New button\r\n        if (obj.options.allowCreate == true) {\r\n            var add = document.createElement('div');\r\n            add.className = 'jtabs-add';\r\n            add.onclick = function() {\r\n                obj.create();\r\n            }\r\n            controls.appendChild(add);\r\n        }\r\n\r\n        prev = document.createElement('div');\r\n        prev.className = 'jtabs-prev';\r\n        prev.onclick = function() {\r\n            updateControls(obj.headers.scrollLeft - obj.headers.offsetWidth);\r\n        }\r\n        controls.appendChild(prev);\r\n\r\n        next = document.createElement('div');\r\n        next.className = 'jtabs-next';\r\n        next.onclick = function() {\r\n            updateControls(obj.headers.scrollLeft + obj.headers.offsetWidth);\r\n        }\r\n        controls.appendChild(next);\r\n\r\n        // Data\r\n        for (var i = 0; i < obj.options.data.length; i++) {\r\n            // Title\r\n            if (obj.options.data[i].titleElement) {\r\n                var headerItem = obj.options.data[i].titleElement;\r\n            } else {\r\n                var headerItem = document.createElement('div');\r\n            }\r\n            // Icon\r\n            if (obj.options.data[i].icon) {\r\n                var iconContainer = document.createElement('div');\r\n                var icon = document.createElement('i');\r\n                icon.classList.add('material-icons');\r\n                icon.innerHTML = obj.options.data[i].icon;\r\n                iconContainer.appendChild(icon);\r\n                headerItem.appendChild(iconContainer);\r\n            }\r\n            // Title\r\n            if (obj.options.data[i].title) {\r\n                var title = document.createTextNode(obj.options.data[i].title);\r\n                headerItem.appendChild(title);\r\n            }\r\n            // Width\r\n            if (obj.options.data[i].width) {\r\n                headerItem.style.width = obj.options.data[i].width;\r\n            }\r\n            // Content\r\n            if (obj.options.data[i].contentElement) {\r\n                var contentItem = obj.options.data[i].contentElement;\r\n            } else {\r\n                var contentItem = document.createElement('div');\r\n                contentItem.innerHTML = obj.options.data[i].content;\r\n            }\r\n            obj.headers.appendChild(headerItem);\r\n            obj.content.appendChild(contentItem);\r\n        }\r\n\r\n        // Animation\r\n        border = document.createElement('div');\r\n        border.className = 'jtabs-border';\r\n        obj.headers.appendChild(border);\r\n\r\n        if (obj.options.animation) {\r\n            el.classList.add('jtabs-animation');\r\n        }\r\n\r\n        // Events\r\n        obj.headers.addEventListener(\"click\", function(e) {\r\n            if (e.target.parentNode.classList.contains('jtabs-headers')) {\r\n                var target = e.target;\r\n            } else {\r\n                if (e.target.tagName == 'I') {\r\n                    var target = e.target.parentNode.parentNode;\r\n                } else {\r\n                    var target = e.target.parentNode;\r\n                }\r\n            }\r\n\r\n            var index = obj.selectIndex(target);\r\n\r\n            if (typeof(obj.options.onclick) == 'function') {\r\n                obj.options.onclick(el, obj, index, obj.headers.children[index], obj.content.children[index]);\r\n            }\r\n        });\r\n\r\n        obj.headers.addEventListener(\"contextmenu\", function(e) {\r\n            obj.selectIndex(e.target);\r\n        });\r\n\r\n        if (obj.headers.children.length) {\r\n            // Open first tab\r\n            obj.open(0);\r\n        }\r\n\r\n        // Update controls\r\n        updateControls(0);\r\n\r\n        if (obj.options.allowChangePosition == true) {\r\n            jSuites.sorting(obj.headers, {\r\n                direction: 1,\r\n                ondrop: function(a,b,c) {\r\n                    obj.updatePosition(b,c);\r\n                },\r\n            });\r\n        }\r\n\r\n        if (typeof(obj.options.onload) == 'function') {\r\n            obj.options.onload(el, obj);\r\n        }\r\n    }\r\n\r\n    // Loading existing nodes as the data\r\n    if (el.children[0] && el.children[0].children.length) {\r\n        // Create from existing elements\r\n        for (var i = 0; i < el.children[0].children.length; i++) {\r\n            var item = obj.options.data && obj.options.data[i] ? obj.options.data[i] : {};\r\n\r\n            if (el.children[1] && el.children[1].children[i]) {\r\n                item.titleElement = el.children[0].children[i];\r\n                item.contentElement = el.children[1].children[i];\r\n            } else {\r\n                item.contentElement = el.children[0].children[i];\r\n            }\r\n\r\n            obj.options.data[i] = item;\r\n        }\r\n    }\r\n\r\n    // Remote controller flag\r\n    var loadingRemoteData = false;\r\n\r\n    // Create from data\r\n    if (obj.options.data) {\r\n        // Append children\r\n        for (var i = 0; i < obj.options.data.length; i++) {\r\n            if (obj.options.data[i].url) {\r\n                jSuites.ajax({\r\n                    url: obj.options.data[i].url,\r\n                    type: 'GET',\r\n                    dataType: 'text/html',\r\n                    index: i,\r\n                    success: function(result) {\r\n                        obj.options.data[this.index].content = result;\r\n                    },\r\n                    complete: function() {\r\n                        obj.init();\r\n                    }\r\n                });\r\n\r\n                // Flag loading\r\n                loadingRemoteData = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    if (! loadingRemoteData) {\r\n        obj.init();\r\n    }\r\n\r\n    el.tabs = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.tags = (function(el, options) {\r\n    // Redefine configuration\r\n    if (el.tags) {\r\n        return el.tags.setOptions(options, true);\r\n    }\r\n\r\n    var obj = { type:'tags' };\r\n    obj.options = {};\r\n\r\n    // Limit\r\n    var limit = function() {\r\n        return obj.options.limit && el.children.length >= obj.options.limit ? true : false;\r\n    }\r\n\r\n    // Search helpers\r\n    var search = null;\r\n    var searchContainer = null;\r\n\r\n    obj.setOptions = function(options, reset) {\r\n        /**\r\n         * @typedef {Object} defaults\r\n         * @property {(string|Array)} value - Initial value of the compontent\r\n         * @property {number} limit - Max number of tags inside the element\r\n         * @property {string} search - The URL for suggestions\r\n         * @property {string} placeholder - The default instruction text on the element\r\n         * @property {validation} validation - Method to validate the tags\r\n         * @property {requestCallback} onbeforechange - Method to be execute before any changes on the element\r\n         * @property {requestCallback} onchange - Method to be execute after any changes on the element\r\n         * @property {requestCallback} onfocus - Method to be execute when on focus\r\n         * @property {requestCallback} onblur - Method to be execute when on blur\r\n         * @property {requestCallback} onload - Method to be execute when the element is loaded\r\n         */\r\n        var defaults = {\r\n            value: '',\r\n            limit: null,\r\n            limitMessage: null,\r\n            search: null,\r\n            placeholder: null,\r\n            validation: null,\r\n            onbeforechange: null,\r\n            onlimit: null,\r\n            onchange: null,\r\n            onfocus: null,\r\n            onblur: null,\r\n            onload: null,\r\n            colors: null,\r\n        }\r\n\r\n        // Loop through though the default configuration\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else {\r\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\r\n                    obj.options[property] = defaults[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Placeholder\r\n        if (obj.options.placeholder) {\r\n            el.setAttribute('data-placeholder', obj.options.placeholder);\r\n        } else {\r\n            el.removeAttribute('data-placeholder');\r\n        }\r\n        el.placeholder = obj.options.placeholder;\r\n\r\n        // Update value\r\n        obj.setValue(obj.options.value);\r\n\r\n        // Validate items\r\n        filter();\r\n\r\n        // Create search box\r\n        if (obj.options.search) {\r\n            if (! searchContainer) {\r\n                searchContainer = document.createElement('div');\r\n                el.parentNode.insertBefore(searchContainer, el.nextSibling);\r\n\r\n                // Create container\r\n                search = jSuites.search(searchContainer, {\r\n                    data: obj.options.search,\r\n                    onselect: function(a,b,c) {\r\n                        obj.selectIndex(b,c);\r\n                    }\r\n                });\r\n            }\r\n        } else {\r\n            if (searchContainer) {\r\n                search = null;\r\n                searchContainer.remove();\r\n                searchContainer = null;\r\n            }\r\n        }\r\n\r\n        return obj;\r\n    }\r\n\r\n    /**\r\n     * Add a new tag to the element\r\n     * @param {(?string|Array)} value - The value of the new element\r\n     */\r\n    obj.add = function(value, focus) {\r\n        if (typeof(obj.options.onbeforechange) == 'function') {\r\n            var ret = obj.options.onbeforechange(el, obj, obj.options.value, value);\r\n            if (ret === false) {\r\n                return false;\r\n            } else { \r\n                if (ret != null) {\r\n                    value = ret;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Make sure search is closed\r\n        if (search) {\r\n            search.close();\r\n        }\r\n\r\n        if (limit()) {\r\n            if (typeof(obj.options.onlimit) == 'function') {\r\n                obj.options.onlimit(obj, obj.options.limit);\r\n            } else if (obj.options.limitMessage) {\r\n                alert(obj.options.limitMessage + ' ' + obj.options.limit);\r\n            }\r\n        } else {\r\n            // Get node\r\n            var node = jSuites.getNode();\r\n\r\n            if (node && node.parentNode && node.parentNode.classList.contains('jtags') &&\r\n                node.nextSibling && (! (node.nextSibling.innerText && node.nextSibling.innerText.trim()))) {\r\n                div = node.nextSibling;\r\n            } else {\r\n                // Remove not used last item\r\n                if (el.lastChild) {\r\n                    if (! el.lastChild.innerText.trim()) {\r\n                        el.removeChild(el.lastChild);\r\n                    }\r\n                }\r\n\r\n                // Mix argument string or array\r\n                if (! value || typeof(value) == 'string') {\r\n                    var div = createElement(value, value, node);\r\n                } else {\r\n                    for (var i = 0; i <= value.length; i++) {\r\n                        if (! limit()) {\r\n                            if (! value[i] || typeof(value[i]) == 'string') {\r\n                                var t = value[i] || '';\r\n                                var v = null;\r\n                            } else {\r\n                                var t = value[i].text;\r\n                                var v = value[i].value;\r\n                            }\r\n\r\n                            // Add element\r\n                            var div = createElement(t, v);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // Change\r\n                change();\r\n            }\r\n\r\n            // Place caret\r\n            if (focus) {\r\n                setFocus(div);\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.setLimit = function(limit) {\r\n        obj.options.limit = limit;\r\n        var n = el.children.length - limit;\r\n        while (el.children.length > limit) {\r\n            el.removeChild(el.lastChild);\r\n        }\r\n    }\r\n\r\n    // Remove a item node\r\n    obj.remove = function(node) {\r\n        // Remove node\r\n        node.parentNode.removeChild(node);\r\n        // Make sure element is not blank\r\n        if (! el.children.length) {\r\n            obj.add('', true);\r\n        } else {\r\n            change();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get all tags in the element\r\n     * @return {Array} data - All tags as an array\r\n     */\r\n    obj.getData = function() {\r\n        var data = [];\r\n        for (var i = 0; i < el.children.length; i++) {\r\n            // Get value\r\n            var text = el.children[i].innerText.replace(\"\\n\", \"\");\r\n            // Get id\r\n            var value = el.children[i].getAttribute('data-value');\r\n            if (! value) {\r\n                value = text;\r\n            }\r\n            // Item\r\n            if (text || value) {\r\n                data.push({ text: text, value: value });\r\n            }\r\n        }\r\n        return data;\r\n    }\r\n\r\n    /**\r\n     * Get the value of one tag. Null for all tags\r\n     * @param {?number} index - Tag index number. Null for all tags.\r\n     * @return {string} value - All tags separated by comma\r\n     */\r\n    obj.getValue = function(index) {\r\n        var value = null;\r\n\r\n        if (index != null) {\r\n            // Get one individual value\r\n            value = el.children[index].getAttribute('data-value');\r\n            if (! value) {\r\n                value = el.children[index].innerText.replace(\"\\n\", \"\");\r\n            }\r\n        } else {\r\n            // Get all\r\n            var data = [];\r\n            for (var i = 0; i < el.children.length; i++) {\r\n                value = el.children[i].innerText.replace(\"\\n\", \"\");\r\n                if (value) {\r\n                    data.push(obj.getValue(i));\r\n                }\r\n            }\r\n            value = data.join(',');\r\n        }\r\n\r\n        return value;\r\n    }\r\n\r\n    /**\r\n     * Set the value of the element based on a string separeted by (,|;|\\r\\n)\r\n     * @param {mixed} value - A string or array object with values\r\n     */\r\n    obj.setValue = function(mixed) {\r\n        if (! mixed) {\r\n            obj.reset();\r\n        } else {\r\n            if (el.value != mixed) {\r\n                if (Array.isArray(mixed)) {\r\n                    obj.add(mixed);\r\n                } else {\r\n                    // Remove whitespaces\r\n                    var text = (''+mixed).trim();\r\n                    // Tags\r\n                    var data = extractTags(text);\r\n                    // Reset\r\n                    el.innerHTML = '';\r\n                    // Add tags to the element\r\n                    obj.add(data);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Reset the data from the element\r\n     */\r\n    obj.reset = function() {\r\n        // Empty class\r\n        el.classList.add('jtags-empty');\r\n        // Empty element\r\n        el.innerHTML = '<div></div>';\r\n        // Execute changes\r\n        change();\r\n    }\r\n\r\n    /**\r\n     * Verify if all tags in the element are valid\r\n     * @return {boolean}\r\n     */\r\n    obj.isValid = function() {\r\n        var test = 0;\r\n        for (var i = 0; i < el.children.length; i++) {\r\n            if (el.children[i].classList.contains('jtags_error')) {\r\n                test++;\r\n            }\r\n        }\r\n        return test == 0 ? true : false;\r\n    }\r\n\r\n    /**\r\n     * Add one element from the suggestions to the element\r\n     * @param {object} item - Node element in the suggestions container\r\n     */ \r\n    obj.selectIndex = function(text, value) {\r\n        var node = jSuites.getNode();\r\n        if (node) {\r\n            // Append text to the caret\r\n            node.innerText = text;\r\n            // Set node id\r\n            if (value) {\r\n                node.setAttribute('data-value', value);\r\n            }\r\n            // Remove any error\r\n            node.classList.remove('jtags_error');\r\n            if (! limit()) {\r\n                // Add new item\r\n                obj.add('', true);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Search for suggestions\r\n     * @param {object} node - Target node for any suggestions\r\n     */\r\n    obj.search = function(node) {\r\n        // Search for\r\n        var terms = node.innerText;\r\n    }\r\n\r\n    // Destroy tags element\r\n    obj.destroy = function() {\r\n        // Bind events\r\n        el.removeEventListener('mouseup', tagsMouseUp);\r\n        el.removeEventListener('keydown', tagsKeyDown);\r\n        el.removeEventListener('keyup', tagsKeyUp);\r\n        el.removeEventListener('paste', tagsPaste);\r\n        el.removeEventListener('focus', tagsFocus);\r\n        el.removeEventListener('blur', tagsBlur);\r\n\r\n        // Remove element\r\n        el.parentNode.removeChild(el);\r\n    }\r\n\r\n    var setFocus = function(node) {\r\n        if (el.children.length > 1) {\r\n            var range = document.createRange();\r\n            var sel = window.getSelection();\r\n            if (! node) {\r\n                var node = el.childNodes[el.childNodes.length-1];\r\n            }\r\n            range.setStart(node, node.length)\r\n            range.collapse(true)\r\n            sel.removeAllRanges()\r\n            sel.addRange(range)\r\n            el.scrollLeft = el.scrollWidth;\r\n        }\r\n    }\r\n\r\n    var createElement = function(label, value, node) {\r\n        var div = document.createElement('div');\r\n        div.innerHTML = label ? label : '';\r\n        if (value) {\r\n            div.setAttribute('data-value', value);\r\n        }\r\n\r\n        if (node && node.parentNode.classList.contains('jtags')) {\r\n            el.insertBefore(div, node.nextSibling);\r\n        } else {\r\n            el.appendChild(div);\r\n        }\r\n\r\n        return div;\r\n    }\r\n\r\n    var change = function() {\r\n        // Value\r\n        var value = obj.getValue();\r\n\r\n        if (value != obj.options.value) {\r\n            obj.options.value = value;\r\n            if (typeof(obj.options.onchange) == 'function') {\r\n                obj.options.onchange(el, obj, obj.options.value);\r\n            }\r\n\r\n            // Lemonade JS\r\n            if (el.value != obj.options.value) {\r\n                el.value = obj.options.value;\r\n                if (typeof(el.onchange) == 'function') {\r\n                    el.onchange({\r\n                        type: 'change',\r\n                        target: el,\r\n                        value: el.value\r\n                    });\r\n                }\r\n            }\r\n        }\r\n\r\n        filter();\r\n    }\r\n\r\n    /**\r\n     * Filter tags\r\n     */\r\n    var filter = function() {\r\n        for (var i = 0; i < el.children.length; i++) {\r\n            // Create label design\r\n            if (! obj.getValue(i)) {\r\n                el.children[i].classList.remove('jtags_label');\r\n            } else {\r\n                el.children[i].classList.add('jtags_label');\r\n\r\n                // Validation in place\r\n                if (typeof(obj.options.validation) == 'function') {\r\n                    if (obj.getValue(i)) {\r\n                        if (! obj.options.validation(el.children[i], el.children[i].innerText, el.children[i].getAttribute('data-value'))) {\r\n                            el.children[i].classList.add('jtags_error');\r\n                        } else {\r\n                            el.children[i].classList.remove('jtags_error');\r\n                        }\r\n                    } else {\r\n                        el.children[i].classList.remove('jtags_error');\r\n                    }\r\n                } else {\r\n                    el.children[i].classList.remove('jtags_error');\r\n                }\r\n            }\r\n        }\r\n\r\n        isEmpty();\r\n    }\r\n\r\n    var isEmpty = function() {\r\n        // Can't be empty\r\n        if (! el.innerText.trim()) {\r\n            el.innerHTML = '<div></div>';\r\n            el.classList.add('jtags-empty');\r\n        } else {\r\n            el.classList.remove('jtags-empty');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Extract tags from a string\r\n     * @param {string} text - Raw string\r\n     * @return {Array} data - Array with extracted tags\r\n     */\r\n    var extractTags = function(text) {\r\n        /** @type {Array} */\r\n        var data = [];\r\n\r\n        /** @type {string} */\r\n        var word = '';\r\n\r\n        // Remove whitespaces\r\n        text = text.trim();\r\n\r\n        if (text) {\r\n            for (var i = 0; i < text.length; i++) {\r\n                if (text[i] == ',' || text[i] == ';' || text[i] == '\\n') {\r\n                    if (word) {\r\n                        data.push(word.trim());\r\n                        word = '';\r\n                    }\r\n                } else {\r\n                    word += text[i];\r\n                }\r\n            }\r\n\r\n            if (word) {\r\n                data.push(word);\r\n            }\r\n        }\r\n\r\n        return data;\r\n    }\r\n\r\n    /** @type {number} */\r\n    var anchorOffset = 0;\r\n\r\n    /**\r\n     * Processing event keydown on the element\r\n     * @param e {object}\r\n     */\r\n    var tagsKeyDown = function(e) {\r\n        // Anchoroffset\r\n        anchorOffset = window.getSelection().anchorOffset;\r\n\r\n        // Verify if is empty\r\n        isEmpty();\r\n\r\n        // Comma\r\n        if (e.key === 'Tab'  || e.key === ';' || e.key === ',') {\r\n            var n = window.getSelection().anchorOffset;\r\n            if (n > 1) {\r\n                if (limit()) {\r\n                    if (typeof(obj.options.onlimit) == 'function') {\r\n                        obj.options.onlimit(obj, obj.options.limit)\r\n                    }\r\n                } else {\r\n                    obj.add('', true);\r\n                }\r\n            }\r\n            e.preventDefault();\r\n        } else if (e.key == 'Enter') {\r\n            if (! search || ! search.isOpened()) {\r\n                var n = window.getSelection().anchorOffset;\r\n                if (n > 1) {\r\n                    if (! limit()) {\r\n                        obj.add('', true);\r\n                    }\r\n                }\r\n                e.preventDefault();\r\n            }\r\n        } else if (e.key == 'Backspace') {\r\n            // Back space - do not let last item to be removed\r\n            if (el.children.length == 1 && window.getSelection().anchorOffset < 1) {\r\n                e.preventDefault();\r\n            }\r\n        }\r\n\r\n        // Search events\r\n        if (search) {\r\n            search.keydown(e);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Processing event keyup on the element\r\n     * @param e {object}\r\n     */\r\n    var tagsKeyUp = function(e) {\r\n        if (e.which == 39) {\r\n            // Right arrow\r\n            var n = window.getSelection().anchorOffset;\r\n            if (n > 1 && n == anchorOffset) {\r\n                obj.add('', true);\r\n            }\r\n        } else if (e.which == 13 || e.which == 38 || e.which == 40) {\r\n            e.preventDefault();\r\n        } else {\r\n            if (search) {\r\n                search.keyup(e);\r\n            }\r\n        }\r\n\r\n        filter();\r\n    }\r\n\r\n    /**\r\n     * Processing event paste on the element\r\n     * @param e {object}\r\n     */\r\n    var tagsPaste =  function(e) {\r\n        if (e.clipboardData || e.originalEvent.clipboardData) {\r\n            var text = (e.originalEvent || e).clipboardData.getData('text/plain');\r\n        } else if (window.clipboardData) {\r\n            var text = window.clipboardData.getData('Text');\r\n        }\r\n\r\n        var data = extractTags(text);\r\n        if (data.length > 1) {\r\n            obj.add(data, true);\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Processing event mouseup on the element\r\n     * @param e {object}\r\n     */\r\n    var tagsMouseUp = function(e) {\r\n        if (e.target.parentNode && e.target.parentNode.classList.contains('jtags')) {\r\n            if (e.target.classList.contains('jtags_label') || e.target.classList.contains('jtags_error')) {\r\n                var rect = e.target.getBoundingClientRect();\r\n                if (rect.width - (e.clientX - rect.left) < 16) {\r\n                    obj.remove(e.target);\r\n                }\r\n            }\r\n        }\r\n\r\n        // Set focus in the last item\r\n        if (e.target == el) {\r\n            setFocus();\r\n        }\r\n    }\r\n\r\n    var tagsFocus = function() {\r\n        if (! el.classList.contains('jtags-focus')) {\r\n            if (! el.children.length || obj.getValue(el.children.length - 1)) {\r\n                if (! limit()) {\r\n                    createElement('');\r\n                }\r\n            }\r\n\r\n            if (typeof(obj.options.onfocus) == 'function') {\r\n                obj.options.onfocus(el, obj, obj.getValue());\r\n            }\r\n\r\n            el.classList.add('jtags-focus');\r\n        }\r\n    }\r\n\r\n    var tagsBlur = function() {\r\n        if (el.classList.contains('jtags-focus')) {\r\n            if (search) {\r\n                search.close();\r\n            }\r\n\r\n            for (var i = 0; i < el.children.length - 1; i++) {\r\n                // Create label design\r\n                if (! obj.getValue(i)) {\r\n                    el.removeChild(el.children[i]);\r\n                }\r\n            }\r\n\r\n            change();\r\n\r\n            el.classList.remove('jtags-focus');\r\n\r\n            if (typeof(obj.options.onblur) == 'function') {\r\n                obj.options.onblur(el, obj, obj.getValue());\r\n            }\r\n        }\r\n    }\r\n\r\n    var init = function() {\r\n        // Bind events\r\n        if ('touchend' in document.documentElement === true) {\r\n            el.addEventListener('touchend', tagsMouseUp);\r\n        } else {\r\n            el.addEventListener('mouseup', tagsMouseUp);\r\n        }\r\n\r\n        el.addEventListener('keydown', tagsKeyDown);\r\n        el.addEventListener('keyup', tagsKeyUp);\r\n        el.addEventListener('paste', tagsPaste);\r\n        el.addEventListener('focus', tagsFocus);\r\n        el.addEventListener('blur', tagsBlur);\r\n\r\n        // Editable\r\n        el.setAttribute('contenteditable', true);\r\n\r\n        // Prepare container\r\n        el.classList.add('jtags');\r\n\r\n        // Initial options\r\n        obj.setOptions(options);\r\n\r\n        if (typeof(obj.options.onload) == 'function') {\r\n            obj.options.onload(el, obj);\r\n        }\r\n\r\n        // Change methods\r\n        el.change = obj.setValue;\r\n\r\n        // Global generic value handler\r\n        el.val = function(val) {\r\n            if (val === undefined) {\r\n                return obj.getValue();\r\n            } else {\r\n                obj.setValue(val);\r\n            }\r\n        }\r\n\r\n        el.tags = obj;\r\n    }\r\n\r\n    init();\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.toolbar = (function(el, options) {\r\n    // New instance\r\n    var obj = { type:'toolbar' };\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        app: null,\r\n        container: false,\r\n        badge: false,\r\n        title: false,\r\n        responsive: false,\r\n        maxWidth: null,\r\n        bottom: true,\r\n        items: [],\r\n    }\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    if (! el && options.app && options.app.el) {\r\n        el = document.createElement('div');\r\n        options.app.el.appendChild(el);\r\n    }\r\n\r\n    // Arrow\r\n    var toolbarArrow = document.createElement('div');\r\n    toolbarArrow.classList.add('jtoolbar-item');\r\n    toolbarArrow.classList.add('jtoolbar-arrow');\r\n\r\n    var toolbarFloating = document.createElement('div');\r\n    toolbarFloating.classList.add('jtoolbar-floating');\r\n    toolbarArrow.appendChild(toolbarFloating);\r\n\r\n    obj.selectItem = function(element) {\r\n        var elements = toolbarContent.children;\r\n        for (var i = 0; i < elements.length; i++) {\r\n            if (element != elements[i]) {\r\n                elements[i].classList.remove('jtoolbar-selected');\r\n            }\r\n        }\r\n        element.classList.add('jtoolbar-selected');\r\n    }\r\n\r\n    obj.hide = function() {\r\n        jSuites.animation.slideBottom(el, 0, function() {\r\n            el.style.display = 'none';\r\n        });\r\n    }\r\n\r\n    obj.show = function() {\r\n        el.style.display = '';\r\n        jSuites.animation.slideBottom(el, 1);\r\n    }\r\n\r\n    obj.get = function() {\r\n        return el;\r\n    }\r\n\r\n    obj.setBadge = function(index, value) {\r\n        toolbarContent.children[index].children[1].firstChild.innerHTML = value;\r\n    }\r\n\r\n    obj.destroy = function() {\r\n        toolbar.remove();\r\n        el.innerHTML = '';\r\n    }\r\n\r\n    obj.update = function(a, b) {\r\n        for (var i = 0; i < toolbarContent.children.length; i++) {\r\n            // Toolbar element\r\n            var toolbarItem = toolbarContent.children[i];\r\n            // State management\r\n            if (typeof(toolbarItem.updateState) == 'function') {\r\n                toolbarItem.updateState(el, obj, toolbarItem, a, b);\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.create = function(items) {\r\n        // Reset anything in the toolbar\r\n        toolbarContent.innerHTML = '';\r\n        // Create elements in the toolbar\r\n        for (var i = 0; i < items.length; i++) {\r\n            var toolbarItem = document.createElement('div');\r\n            toolbarItem.classList.add('jtoolbar-item');\r\n\r\n            if (items[i].width) {\r\n                toolbarItem.style.width = parseInt(items[i].width) + 'px'; \r\n            }\r\n\r\n            if (items[i].k) {\r\n                toolbarItem.k = items[i].k;\r\n            }\r\n\r\n            if (items[i].tooltip) {\r\n                toolbarItem.setAttribute('title', items[i].tooltip);\r\n            }\r\n\r\n            // Id\r\n            if (items[i].id) {\r\n                toolbarItem.setAttribute('id', items[i].id);\r\n            }\r\n\r\n            // Selected\r\n            if (items[i].updateState) {\r\n                toolbarItem.updateState = items[i].updateState;\r\n            }\r\n\r\n            if (items[i].active) {\r\n                toolbarItem.classList.add('jtoolbar-active');\r\n            }\r\n\r\n            if (items[i].type == 'select' || items[i].type == 'dropdown') {\r\n                jSuites.picker(toolbarItem, items[i]);\r\n            } else if (items[i].type == 'divisor') {\r\n                toolbarItem.classList.add('jtoolbar-divisor');\r\n            } else if (items[i].type == 'label') {\r\n                toolbarItem.classList.add('jtoolbar-label');\r\n                toolbarItem.innerHTML = items[i].content;\r\n            } else {\r\n                // Material icons\r\n                var toolbarIcon = document.createElement('i');\r\n                if (typeof(items[i].class) === 'undefined') {\r\n                    toolbarIcon.classList.add('material-icons');\r\n                } else {\r\n                    var c = items[i].class.split(' ');\r\n                    for (var j = 0; j < c.length; j++) {\r\n                        toolbarIcon.classList.add(c[j]);\r\n                    }\r\n                }\r\n                toolbarIcon.innerHTML = items[i].content ? items[i].content : '';\r\n                toolbarItem.appendChild(toolbarIcon);\r\n\r\n                // Badge options\r\n                if (obj.options.badge == true) {\r\n                    var toolbarBadge = document.createElement('div');\r\n                    toolbarBadge.classList.add('jbadge');\r\n                    var toolbarBadgeContent = document.createElement('div');\r\n                    toolbarBadgeContent.innerHTML = items[i].badge ? items[i].badge : '';\r\n                    toolbarBadge.appendChild(toolbarBadgeContent);\r\n                    toolbarItem.appendChild(toolbarBadge);\r\n                }\r\n\r\n                // Title\r\n                if (items[i].title) {\r\n                    if (obj.options.title == true) {\r\n                        var toolbarTitle = document.createElement('span');\r\n                        toolbarTitle.innerHTML = items[i].title;\r\n                        toolbarItem.appendChild(toolbarTitle);\r\n                    } else {\r\n                        toolbarItem.setAttribute('title', items[i].title);\r\n                    }\r\n                }\r\n\r\n                if (obj.options.app && items[i].route) {\r\n                    // Route\r\n                    toolbarItem.route = items[i].route;\r\n                    // Onclick for route\r\n                    toolbarItem.onclick = function() {\r\n                        obj.options.app.pages(this.route);\r\n                    }\r\n                    // Create pages\r\n                    obj.options.app.pages(items[i].route, {\r\n                        toolbarItem: toolbarItem,\r\n                        closed: true\r\n                    });\r\n                }\r\n            }\r\n\r\n            if (items[i].onclick) {\r\n                toolbarItem.onclick = items[i].onclick.bind(items[i], el, obj, toolbarItem);\r\n            }\r\n\r\n            toolbarContent.appendChild(toolbarItem);\r\n        }\r\n\r\n        // Fits to the page\r\n        setTimeout(function() {\r\n            obj.refresh();\r\n        }, 0);\r\n    }\r\n\r\n    obj.open = function() {\r\n        toolbarArrow.classList.add('jtoolbar-arrow-selected');\r\n\r\n        var rectElement = el.getBoundingClientRect();\r\n        var rect = toolbarFloating.getBoundingClientRect();\r\n        if (rect.bottom > window.innerHeight || obj.options.bottom) {\r\n            toolbarFloating.style.bottom = '0';\r\n        } else {\r\n            toolbarFloating.style.removeProperty('bottom');\r\n        }\r\n\r\n        toolbarFloating.style.right = '0';\r\n\r\n        toolbarArrow.children[0].focus();\r\n        // Start tracking\r\n        jSuites.tracking(obj, true);\r\n    }\r\n\r\n    obj.close = function() {\r\n        toolbarArrow.classList.remove('jtoolbar-arrow-selected')\r\n        // End tracking\r\n        jSuites.tracking(obj, false);\r\n    }\r\n\r\n    obj.refresh = function() {\r\n        if (obj.options.responsive == true) {\r\n            // Width of the c\r\n            var rect = el.parentNode.getBoundingClientRect();\r\n            if (! obj.options.maxWidth) {\r\n                obj.options.maxWidth = rect.width;\r\n            }\r\n            // Available parent space\r\n            var available = parseInt(obj.options.maxWidth);\r\n            // Remove arrow\r\n            toolbarArrow.remove();\r\n            // Move all items to the toolbar\r\n            while (toolbarFloating.firstChild) {\r\n                toolbarContent.appendChild(toolbarFloating.firstChild);\r\n            }\r\n            // Toolbar is larger than the parent, move elements to the floating element\r\n            if (available < toolbarContent.offsetWidth) {\r\n                // Give space to the floating element\r\n                available -= 50;\r\n                // Move to the floating option\r\n                while (toolbarContent.lastChild && available < toolbarContent.offsetWidth) {\r\n                    toolbarFloating.insertBefore(toolbarContent.lastChild, toolbarFloating.firstChild);\r\n                }\r\n            }\r\n            // Show arrow\r\n            if (toolbarFloating.children.length > 0) {\r\n                toolbarContent.appendChild(toolbarArrow);\r\n            }\r\n        }\r\n    }\r\n\r\n    el.onclick = function(e) {\r\n        var element = jSuites.findElement(e.target, 'jtoolbar-item');\r\n        if (element) {\r\n            obj.selectItem(element);\r\n        }\r\n\r\n        if (e.target.classList.contains('jtoolbar-arrow')) {\r\n            obj.open();\r\n        }\r\n    }\r\n\r\n    window.addEventListener('resize', function() {\r\n        obj.refresh();\r\n    });\r\n\r\n    // Toolbar\r\n    el.classList.add('jtoolbar');\r\n    // Reset content\r\n    el.innerHTML = '';\r\n    // Container\r\n    if (obj.options.container == true) {\r\n        el.classList.add('jtoolbar-container');\r\n    }\r\n    // Content\r\n    var toolbarContent = document.createElement('div');\r\n    el.appendChild(toolbarContent);\r\n    // Special toolbar for mobile applications\r\n    if (obj.options.app) {\r\n        el.classList.add('jtoolbar-mobile');\r\n    }\r\n    // Create toolbar\r\n    obj.create(obj.options.items);\r\n    // Shortcut\r\n    el.toolbar = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.validations = function(value, options) {\r\n    if (typeof(jSuites.validations[options.type]) === 'function') {\r\n        return jSuites.validations[options.type](value, options);\r\n    }\r\n    return null;\r\n};\r\n\r\n// Legacy\r\njSuites.validations.email = function(data) {\r\n    var pattern = new RegExp(/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/);\r\n    return data && pattern.test(data) ? true : false; \r\n}\r\n\r\njSuites.validations.required = function(data) {\r\n    return data.trim() ? true : false;\r\n}\r\n\r\njSuites.validations.number = function(data) {\r\n    return jSuites.isNumber(data);\r\n}\r\n\r\njSuites.validations.login = function(data) {\r\n    var pattern = new RegExp(/^[a-zA-Z0-9\\_\\-\\.\\s+]+$/);\r\n    return data && pattern.test(data) ? true : false;\r\n}\r\n\r\n/**\r\n * Options: Object,\r\n * Properties: \r\n * Constraint,\r\n * Reference,\r\n * Value\r\n */\r\n\r\nvar valueComparisons = function(data, options) {\r\n    if (options.constraint === '=') {\r\n        return data === options.reference;\r\n    }\r\n    if (options.constraint === '<') {\r\n        return data < options.reference;\r\n    }\r\n    if (options.constraint === '<=') {\r\n        return data <= options.reference;\r\n    }\r\n    if (options.constraint === '>') {\r\n        return data > options.reference;\r\n    }\r\n    if (options.constraint === '>=') {\r\n        return data >= options.reference;\r\n    }\r\n    if (options.constraint === 'between') {\r\n        return data >= options.reference[0] && data <= options.reference[1];\r\n    }\r\n    if (options.constraint === 'not between') {\r\n        return data < options.reference[0] || data > options.reference[1];\r\n    }\r\n\r\n    return null;\r\n}\r\n\r\njSuites.validations.number = function(data, options) {\r\n    if (!jSuites.isNumeric(data)) {\r\n        return false;\r\n    }\r\n\r\n    if (options === undefined || options.constraint === undefined) {\r\n        return true;\r\n    }\r\n\r\n    return valueComparisons(data, options);\r\n}\r\n\r\njSuites.validations.date = function(data, options) {\r\n    if (new Date(data) == 'Invalid Date') {\r\n        return false;\r\n    }\r\n\r\n    if (options === undefined || options.constraint === undefined) {\r\n        return true;\r\n    } else if (typeof(options) === 'object') {\r\n        data = new Date(data).getTime();\r\n\r\n        if (Array.isArray(options.reference)) {\r\n            options.reference = options.reference.map(function(reference) {\r\n                return new Date(reference).getTime();\r\n            });\r\n        } else {\r\n            options.reference = new Date(options.reference).getTime();\r\n        }\r\n\r\n        return valueComparisons(data, options);\r\n    }\r\n    return null;\r\n}\r\n\r\njSuites.validations.itemList = function(data, options) {\r\n    return options.reference.some(function(reference) {\r\n        return reference == data;\r\n    });\r\n}\r\n\r\njSuites.validations.text = function(data, options) {\r\n    if (typeof data !== 'string') {\r\n        return false;\r\n    }\r\n\r\n    if (options === undefined || options.constraint === undefined) {\r\n        return true;\r\n    }\r\n    if (options.constraint === '=') {\r\n        return data === options.reference;\r\n    }\r\n    if (options.constraint === 'contains') {\r\n        return data.includes(options.reference);\r\n    }\r\n    if (options.constraint === 'not contain') {\r\n        return !data.includes(options.reference);\r\n    }\r\n    if (options.constraint === 'email') {\r\n        return jSuites.validations.email(data);\r\n    }\r\n    if (options.constraint === 'url') {\r\n        var pattern = new RegExp(/(((https?:\\/\\/)|(www\\.))[-A-Z0-9+&@#\\/%?=~_|!:,.;]*[-A-Z0-9+&@#\\/%=~_|]+)/ig);\r\n        return pattern.test(data) ? true : false;\r\n    }\r\n    return null;\r\n}\r\n\r\njSuites.validations.constraints = function() {\r\n}\r\n\r\n\r\n\r\n    return jSuites;\r\n\r\n})));","var isCallable = require('../internals/is-callable');\nvar isObject = require('../internals/is-object');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\n\n// makes subclassing work correct for wrapped built-ins\nmodule.exports = function ($this, dummy, Wrapper) {\n  var NewTarget, NewTargetPrototype;\n  if (\n    // it can work only with native `setPrototypeOf`\n    setPrototypeOf &&\n    // we haven't completely correct pre-ES6 way for getting `new.target`, so use this\n    isCallable(NewTarget = dummy.constructor) &&\n    NewTarget !== Wrapper &&\n    isObject(NewTargetPrototype = NewTarget.prototype) &&\n    NewTargetPrototype !== Wrapper.prototype\n  ) setPrototypeOf($this, NewTargetPrototype);\n  return $this;\n};\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/sass-resources-loader/lib/loader.js??ref--9-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Sheet.vue?vue&type=style&index=0&id=77beb34c&scoped=true&lang=scss&\"","var anObject = require('../internals/an-object');\nvar iteratorClose = require('../internals/iterator-close');\n\n// call something on iterator step with safe closing on error\nmodule.exports = function (iterator, fn, value, ENTRIES) {\n  try {\n    return ENTRIES ? fn(anObject(value)[0], value[1]) : fn(value);\n  } catch (error) {\n    iteratorClose(iterator, 'throw', error);\n  }\n};\n","var $ = require('../internals/export');\nvar from = require('../internals/array-from');\nvar checkCorrectnessOfIteration = require('../internals/check-correctness-of-iteration');\n\nvar INCORRECT_ITERATION = !checkCorrectnessOfIteration(function (iterable) {\n  // eslint-disable-next-line es/no-array-from -- required for testing\n  Array.from(iterable);\n});\n\n// `Array.from` method\n// https://tc39.es/ecma262/#sec-array.from\n$({ target: 'Array', stat: true, forced: INCORRECT_ITERATION }, {\n  from: from\n});\n","'use strict';\nvar fails = require('../internals/fails');\n\nmodule.exports = function (METHOD_NAME, argument) {\n  var method = [][METHOD_NAME];\n  return !!method && fails(function () {\n    // eslint-disable-next-line no-useless-call,no-throw-literal -- required for testing\n    method.call(null, argument || function () { throw 1; }, 1);\n  });\n};\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"sheet\"},[_c('div',{staticClass:\"custom-toolbar\"},[_c('div',{staticClass:\"toolbar-item\",on:{\"click\":_vm.setTableDataHandle}},[_c('v-icon',{domProps:{\"textContent\":_vm._s('mdi-apps')}}),_c('span',[_vm._v(\"数据\")])],1),_c('div',{staticClass:\"toolbar-item\"},[_c('v-icon',{domProps:{\"textContent\":_vm._s('mdi-function')}}),_c('span',[_vm._v(\"函数\")])],1)]),_c('v-row',[_c('v-col',{attrs:{\"cols\":\"6\"}},[_c('v-text-field',{attrs:{\"label\":_vm.cell.name},on:{\"change\":_vm.changeHandle},model:{value:(_vm.cell.value),callback:function ($$v) {_vm.$set(_vm.cell, \"value\", $$v)},expression:\"cell.value\"}})],1),_c('v-col',{attrs:{\"cols\":\"6\"}},[_c('v-btn',{attrs:{\"small\":\"\"}},[_vm._v(\"函数\")]),_c('v-btn',{attrs:{\"small\":\"\"},on:{\"click\":_vm.changeHeaderTypeHandle}},[_vm._v(\"表头类型 \")])],1)],1),_c('div',{attrs:{\"id\":\"spreadsheet\"}}),_c('v-dialog',{attrs:{\"width\":\"500\"},model:{value:(_vm.dialog),callback:function ($$v) {_vm.dialog=$$v},expression:\"dialog\"}},[_c('v-card',[_c('div',{staticClass:\"types\"},[_c('div',{staticClass:\"type-wrapper\"},[_c('v-list',{attrs:{\"flat\":\"\"}},[_c('v-list-item-group',_vm._l((_vm.columnTypes),function(item,index){return _c('v-list-item',{key:index,on:{\"click\":function($event){return _vm.changeColumnType(item)}}},[_vm._v(_vm._s(item.label)+\" \")])}),1)],1)],1)])])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"sheet\">\n    <div class=\"custom-toolbar\">\n      <div class=\"toolbar-item\"\n           @click=\"setTableDataHandle\">\n        <v-icon v-text=\"'mdi-apps'\"></v-icon>\n        <span>数据</span>\n      </div>\n      <div class=\"toolbar-item\">\n        <v-icon v-text=\"'mdi-function'\"></v-icon>\n        <span>函数</span>\n      </div>\n    </div>\n    <v-row>\n      <v-col cols=\"6\">\n        <v-text-field\n            :label=\"cell.name\"\n            v-model=\"cell.value\"\n            @change=\"changeHandle\"\n        ></v-text-field>\n      </v-col>\n      <v-col cols=\"6\">\n        <v-btn small>函数</v-btn>\n        <v-btn small\n               @click=\"changeHeaderTypeHandle\">表头类型\n        </v-btn>\n      </v-col>\n    </v-row>\n    <div id=\"spreadsheet\"></div>\n    <v-dialog\n        v-model=\"dialog\"\n        width=\"500\">\n      <v-card>\n        <!-- 选中了头部显示在头部的右侧 popover弹窗-->\n        <div class=\"types\">\n          <div class=\"type-wrapper\">\n            <v-list flat>\n              <v-list-item-group>\n                <v-list-item\n                    v-for=\"(item,index) in  columnTypes\"\n                    :key=\"index\"\n                    @click=\"changeColumnType(item)\">{{ item.label }}\n                </v-list-item>\n              </v-list-item-group>\n            </v-list>\n          </div>\n        </div>\n      </v-card>\n    </v-dialog>\n  </div>\n</template>\n\n\n<script>\nimport jspreadsheet from 'jspreadsheet-ce/dist/index'\nimport 'jspreadsheet-ce/dist/jspreadsheet.css'\n// import 'jspreadsheet-ce/dist/jspreadsheet.datatables.css'\n// import 'jspreadsheet-ce/dist/jspreadsheet.theme.css'\nconst TableHeader = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J']\nexport default {\n  name: 'sheet',\n  data() {\n    return {\n      cell: {\n        name: '',\n        value: '',\n        index: 0\n      },\n      table: null,\n      fakeData: {\n        data: [\n          {\n            name: '张三1',\n            mobile: '18381306244',\n            idCard: '510902199511111111',\n            job: '工作',\n            gender: '男'\n          },\n          {\n            name: '张三2',\n            mobile: '18381306244',\n            idCard: '510902199511111111',\n            job: '工作',\n            gender: '女'\n          }\n        ],\n        totalNum: 0\n      },\n      dialog: false,\n      columnTypes: [\n        {\n          label: '单选',\n          value: 'radio'\n        },\n        {\n          label: '复选',\n          value: 'checkbox'\n        },\n        {\n          label: '数字',\n          value: 'numeric'\n        },\n        {\n          label: '日期',\n          value: 'calendar'\n        },\n        {\n          label: '下拉框',\n          value: 'dropdown'\n        }\n      ]\n    }\n  },\n  methods: {\n    // 改变头部类型\n    changeColumnType(item) {\n      console.log('changeColumnType', item, this.cell.index);\n      this.table.options.columns[this.cell.index].type = item.value;\n      this.dialog = false;\n    },\n    changeHeaderTypeHandle() {\n      this.table.options.columns[4] = {\n        source: ['男', '女'],\n        width: 100,\n        type: 'dropdown',\n      }\n    },\n    // 给表单回填数据\n    setTableDataHandle() {\n      let columns = [];\n      let data = []\n      this.fakeData.data.forEach((item, index) => {\n        let itemValue = []\n        if (index === 0) {\n          for (let key in item) {\n            // 第一行的数据（默认未表头）\n            columns.push(key)\n            itemValue.push(item[key])\n          }\n          data.push(columns)\n        } else {\n          for (let key in item) {\n            itemValue.push(item[key])\n          }\n        }\n        data.push(itemValue)\n      })\n      console.log('data', data)\n      this.table.setData(data);\n    },\n    // 回显到表单对应的单元格\n    changeHandle() {\n      this.table.setValue(this.cell.name, this.cell.value)\n    },\n    init() {\n      const _this = this;\n\n      function selectionActive(instance, x1, y1, x2, y2, origin) {\n        console.log('instance, x1, y1, x2, y2, origin', instance, x1, y1, x2, y2, origin)\n        const cellName1 = jspreadsheet.getColumnNameFromId([x1, y1]);\n        console.log('cellName1', cellName1)\n        const value = _this.table.getValue(cellName1)\n        console.log('value:', value)\n        _this.cell.name = cellName1;\n        _this.cell.value = value;\n        _this.cell.index = x1\n        //  TODO:如果是表头字段，显示设置表头类型\n        // const tableData = _this.table.getJson();\n        // console.log('tableData:', tableData)\n      }\n\n      this.table = jspreadsheet(document.getElementById('spreadsheet'), {\n        data: [],\n        minDimensions: [27, 100],\n        columns: [],\n        columnSorting: false,\n        defaultColWidth: 100,\n        allowExport: false,\n        tableWidth: '100vw',\n        tableOverflow: true,\n        contextMenu: function (obj, x, y) {\n          // 这两个组合可以实现合并单元格\n          let items = [\n            {\n              title: '在左侧插入一列',\n              onclick: () => {\n                obj.insertColumn(1, parseInt(x), 1);\n              }\n            },\n            {\n              title: '在右侧插入一列',\n              onclick: () => {\n                obj.insertColumn(1, parseInt(x), 0);\n              }\n            },\n            {\n              title: '删除选中列',\n              onclick: () => {\n                obj.deleteColumn(obj.getSelectedColumns().length ? undefined : parseInt(x));\n              }\n            },\n            {\n              title: '复制',\n              onclick: () => {\n                console.log('复制')\n              }\n            },\n          ];\n\n          if (y !== null) {\n            items.unshift(\n                ...[\n                  {\n                    title: '在上方插入一行',\n                    onclick: function () {\n                      obj.insertRow(1, parseInt(y), 1);\n                    }\n                  },\n                  {\n                    title: '在下方插入一行',\n                    onclick: function () {\n                      obj.insertRow(1, parseInt(y));\n                    }\n                  },\n                  {\n                    title: '删除选中行',\n                    onclick: function () {\n                      obj.deleteRow(obj.getSelectedRows().length ? undefined : parseInt(y));\n                    }\n                  },\n                ]\n            )\n\n            const selectedColumns = obj.getSelectedColumns();\n            const selectedRows = obj.getSelectedRows();\n\n            const colSpan = selectedColumns.length;\n            const rowSpan = selectedRows.length;\n            const startRow = Number(selectedRows[0].dataset['y']) + 1;\n            const startPos = TableHeader[selectedColumns[0]] + startRow;\n\n            console.log('selectedColumns[colSpan - 1]', selectedColumns, colSpan)\n\n            const allMerge = obj.getMerge();\n\n            const merges = _this.mergeInSelectedArea(TableHeader[selectedColumns[0]], TableHeader[selectedColumns[colSpan - 1]], allMerge)\n\n\n            let hasMerged = false;\n\n            if (merges && merges.length) {\n              console.log('merge', merges);\n\n\n              hasMerged = !!merges;\n            }\n            // 选中了两个以上才“显示合并单元格”\n            if (!hasMerged) {\n              if (colSpan > 1 || rowSpan > 1) {\n                items.push({\n                  title: '合并单元格',\n                  onclick: () => {\n                    obj.setMerge(startPos, colSpan, rowSpan)\n                  }\n                })\n              }\n            } else {\n              items.push({\n                title: '取消合并单元格',\n                onclick: () => {\n                  merges.forEach(item => {\n                    obj.removeMerge(item)\n                  })\n                }\n              })\n            }\n          }\n          return items;\n        },\n        onselection: selectionActive\n      });\n    },\n    // 合并的单元格是否在选中的区域\n    mergeInSelectedArea(startRange, endRange, merges) {\n      console.log('startRange', startRange)\n      console.log('endRange', endRange)\n      console.log('merges', merges)\n\n      const startIndex = TableHeader.findIndex(item => {\n        return item === startRange;\n      })\n\n      const endIndex = TableHeader.findIndex(item => {\n        return item === endRange;\n      })\n\n      const range = TableHeader.slice(startIndex, endIndex)\n      console.log('range:', range);\n\n      let inRangeMerge = []\n\n      for (let key in merges) {\n        const oneName = key.substring(0, 1);\n        console.log('oneName', oneName);\n        if (range.includes(oneName)) {\n          inRangeMerge.push(key)\n        }\n      }\n      console.log('inRangeMerge', inRangeMerge)\n      return inRangeMerge\n    },\n    sheetClickEvent() {\n      const dom = document.getElementById('spreadsheet');\n      dom.addEventListener('click', (e) => {\n        const className = Array.from(e.target.classList);\n        console.log('e', e.target, className)\n\n        if (className.includes('selected')) {\n          // 位置偏差（点到箭头位置才显示弹窗）\n          this.dialog = true;\n        }\n      })\n    },\n  },\n  mounted() {\n    this.$nextTick(() => {\n      this.init();\n      this.sheetClickEvent();\n    })\n  }\n}\n</script>\n\n\n<style scoped lang=\"scss\">\n.custom-toolbar {\n  @include flex();\n  border-bottom: 1px solid #eee;\n  background: #f9fafb;\n}\n\n.toolbar-item {\n  padding: 10px 10px;\n  cursor: pointer;\n}\n\n.type-item {\n  padding: 10px;\n  cursor: pointer;\n}\n\n</style>\n\n<style lang=\"scss\">\nthead {\n  td {\n    &.selected {\n      &::after {\n        content: '▼';\n        position: absolute;\n        right: 2px;\n        top: 50%;\n        transform: translate(0, -50%);\n        color: #999;\n      }\n    }\n  }\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Sheet.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Sheet.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Sheet.vue?vue&type=template&id=77beb34c&scoped=true&\"\nimport script from \"./Sheet.vue?vue&type=script&lang=js&\"\nexport * from \"./Sheet.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Sheet.vue?vue&type=style&index=0&id=77beb34c&scoped=true&lang=scss&\"\nimport style1 from \"./Sheet.vue?vue&type=style&index=1&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"77beb34c\",\n  null\n  \n)\n\nexport default component.exports","'use strict';\nvar DESCRIPTORS = require('../internals/descriptors');\nvar global = require('../internals/global');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar isForced = require('../internals/is-forced');\nvar redefine = require('../internals/redefine');\nvar hasOwn = require('../internals/has-own-property');\nvar inheritIfRequired = require('../internals/inherit-if-required');\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar isSymbol = require('../internals/is-symbol');\nvar toPrimitive = require('../internals/to-primitive');\nvar fails = require('../internals/fails');\nvar getOwnPropertyNames = require('../internals/object-get-own-property-names').f;\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar defineProperty = require('../internals/object-define-property').f;\nvar thisNumberValue = require('../internals/this-number-value');\nvar trim = require('../internals/string-trim').trim;\n\nvar NUMBER = 'Number';\nvar NativeNumber = global[NUMBER];\nvar NumberPrototype = NativeNumber.prototype;\nvar TypeError = global.TypeError;\nvar arraySlice = uncurryThis(''.slice);\nvar charCodeAt = uncurryThis(''.charCodeAt);\n\n// `ToNumeric` abstract operation\n// https://tc39.es/ecma262/#sec-tonumeric\nvar toNumeric = function (value) {\n  var primValue = toPrimitive(value, 'number');\n  return typeof primValue == 'bigint' ? primValue : toNumber(primValue);\n};\n\n// `ToNumber` abstract operation\n// https://tc39.es/ecma262/#sec-tonumber\nvar toNumber = function (argument) {\n  var it = toPrimitive(argument, 'number');\n  var first, third, radix, maxCode, digits, length, index, code;\n  if (isSymbol(it)) throw TypeError('Cannot convert a Symbol value to a number');\n  if (typeof it == 'string' && it.length > 2) {\n    it = trim(it);\n    first = charCodeAt(it, 0);\n    if (first === 43 || first === 45) {\n      third = charCodeAt(it, 2);\n      if (third === 88 || third === 120) return NaN; // Number('+0x1') should be NaN, old V8 fix\n    } else if (first === 48) {\n      switch (charCodeAt(it, 1)) {\n        case 66: case 98: radix = 2; maxCode = 49; break; // fast equal of /^0b[01]+$/i\n        case 79: case 111: radix = 8; maxCode = 55; break; // fast equal of /^0o[0-7]+$/i\n        default: return +it;\n      }\n      digits = arraySlice(it, 2);\n      length = digits.length;\n      for (index = 0; index < length; index++) {\n        code = charCodeAt(digits, index);\n        // parseInt parses a string to a first unavailable symbol\n        // but ToNumber should return NaN if a string contains unavailable symbols\n        if (code < 48 || code > maxCode) return NaN;\n      } return parseInt(digits, radix);\n    }\n  } return +it;\n};\n\n// `Number` constructor\n// https://tc39.es/ecma262/#sec-number-constructor\nif (isForced(NUMBER, !NativeNumber(' 0o1') || !NativeNumber('0b1') || NativeNumber('+0x1'))) {\n  var NumberWrapper = function Number(value) {\n    var n = arguments.length < 1 ? 0 : NativeNumber(toNumeric(value));\n    var dummy = this;\n    // check on 1..constructor(foo) case\n    return isPrototypeOf(NumberPrototype, dummy) && fails(function () { thisNumberValue(dummy); })\n      ? inheritIfRequired(Object(n), dummy, NumberWrapper) : n;\n  };\n  for (var keys = DESCRIPTORS ? getOwnPropertyNames(NativeNumber) : (\n    // ES3:\n    'MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,' +\n    // ES2015 (in case, if modules with ES2015 Number statics required before):\n    'EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,' +\n    // ESNext\n    'fromString,range'\n  ).split(','), j = 0, key; keys.length > j; j++) {\n    if (hasOwn(NativeNumber, key = keys[j]) && !hasOwn(NumberWrapper, key)) {\n      defineProperty(NumberWrapper, key, getOwnPropertyDescriptor(NativeNumber, key));\n    }\n  }\n  NumberWrapper.prototype = NumberPrototype;\n  NumberPrototype.constructor = NumberWrapper;\n  redefine(global, NUMBER, NumberWrapper);\n}\n","'use strict';\nvar $ = require('../internals/export');\nvar $findIndex = require('../internals/array-iteration').findIndex;\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\nvar FIND_INDEX = 'findIndex';\nvar SKIPS_HOLES = true;\n\n// Shouldn't skip holes\nif (FIND_INDEX in []) Array(1)[FIND_INDEX](function () { SKIPS_HOLES = false; });\n\n// `Array.prototype.findIndex` method\n// https://tc39.es/ecma262/#sec-array.prototype.findindex\n$({ target: 'Array', proto: true, forced: SKIPS_HOLES }, {\n  findIndex: function findIndex(callbackfn /* , that = undefined */) {\n    return $findIndex(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables(FIND_INDEX);\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar isArray = require('../internals/is-array');\nvar isConstructor = require('../internals/is-constructor');\nvar isObject = require('../internals/is-object');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar createProperty = require('../internals/create-property');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar un$Slice = require('../internals/array-slice');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('slice');\n\nvar SPECIES = wellKnownSymbol('species');\nvar Array = global.Array;\nvar max = Math.max;\n\n// `Array.prototype.slice` method\n// https://tc39.es/ecma262/#sec-array.prototype.slice\n// fallback for not array-like ES3 strings and DOM objects\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT }, {\n  slice: function slice(start, end) {\n    var O = toIndexedObject(this);\n    var length = lengthOfArrayLike(O);\n    var k = toAbsoluteIndex(start, length);\n    var fin = toAbsoluteIndex(end === undefined ? length : end, length);\n    // inline `ArraySpeciesCreate` for usage native `Array#slice` where it's possible\n    var Constructor, result, n;\n    if (isArray(O)) {\n      Constructor = O.constructor;\n      // cross-realm fallback\n      if (isConstructor(Constructor) && (Constructor === Array || isArray(Constructor.prototype))) {\n        Constructor = undefined;\n      } else if (isObject(Constructor)) {\n        Constructor = Constructor[SPECIES];\n        if (Constructor === null) Constructor = undefined;\n      }\n      if (Constructor === Array || Constructor === undefined) {\n        return un$Slice(O, k, fin);\n      }\n    }\n    result = new (Constructor === undefined ? Array : Constructor)(max(fin - k, 0));\n    for (n = 0; k < fin; k++, n++) if (k in O) createProperty(result, n, O[k]);\n    result.length = n;\n    return result;\n  }\n});\n"],"sourceRoot":""}